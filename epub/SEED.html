<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAF/QA6OjoAKysrABwcH" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SEED.html</title>
    <link rel="manifest" href="manifest.json" />
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
      }
    </script>
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const ki=!1;var rr=Array.isArray,Fo=Array.prototype.indexOf,Za=Array.from,ns=Object.defineProperty,Mn=Object.getOwnPropertyDescriptor,rs=Object.getOwnPropertyDescriptors,as=Object.prototype,Mo=Array.prototype,ua=Object.getPrototypeOf,Ti=Object.isExtensible;const Zt=()=>{};function Po(r){return r()}function Tr(r){for(var e=0;e<r.length;e++)r[e]()}function Lo(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const a of r)if(t.push(a),t.length===e)break;return t}const Qt=2,is=4,fa=8,Qa=16,bn=32,Un=64,Qr=128,Gt=256,ea=512,Wt=1024,un=2048,Cn=4096,gn=8192,pa=16384,Do=32768,ha=65536,ss=1<<17,os=1<<19,ls=1<<20,ja=1<<21,wn=Symbol("$state"),Ro=Symbol("legacy props"),Ao=Symbol("");function cs(r){return r===this.v}function ds(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function ei(r){return!ds(r,this.v)}function Oo(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Uo(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function zo(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Wo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function No(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function jo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Bo(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function $o(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let ar=!1,Ho=!1;function qo(){ar=!0}const ti=1,ni=2,us=4,Vo=8,Go=16,Xo=1,Ko=2,Yo=4,Jo=8,Zo=16,Qo=1,el=2,jt=Symbol(),tl="http://www.w3.org/1999/xhtml",fs="@attach",nl=[];function rl(r,e=!1){return Kr(r,new Map,"",nl)}function Kr(r,e,t,a,n=null){if(typeof r=="object"&&r!==null){var i=e.get(r);if(i!==void 0)return i;if(r instanceof Map)return new Map(r);if(r instanceof Set)return new Set(r);if(rr(r)){var s=Array(r.length);e.set(r,s),n!==null&&e.set(n,s);for(var l=0;l<r.length;l+=1){var c=r[l];l in r&&(s[l]=Kr(c,e,t,a))}return s}if(ua(r)===as){s={},e.set(r,s),n!==null&&e.set(n,s);for(var d in r)s[d]=Kr(r[d],e,t,a);return s}if(r instanceof Date)return structuredClone(r);if(typeof r.toJSON=="function")return Kr(r.toJSON(),e,t,a,r)}if(r instanceof EventTarget)return r;try{return structuredClone(r)}catch{return r}}function va(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ct=null;function Ci(r){ct=r}function Ii(r){return ri().get(r)}function al(r,e){return ri().set(r,e),e}function il(r){return ri().has(r)}function tt(r,e=!1,t){var a=ct={p:ct,c:null,d:!1,e:null,m:!1,s:r,x:null,l:null};ar&&!e&&(ct.l={s:null,u:null,r1:[],r2:er(!1)}),ga(()=>{a.d=!0})}function nt(r){const e=ct;if(e!==null){r!==void 0&&(e.x=r);const s=e.e;if(s!==null){var t=ft,a=ut;e.e=null;try{for(var n=0;n<s.length;n++){var i=s[n];Tn(i.effect),fn(i.reaction),ir(i.fn)}}finally{Tn(t),fn(a)}}ct=e.p,e.m=!0}return r||{}}function Or(){return!ar||ct!==null&&ct.l===null}function ri(r){return ct===null&&va(),ct.c??=new Map(sl(ct)||void 0)}function sl(r){let e=r.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}function Dt(r){if(typeof r!="object"||r===null||wn in r)return r;const e=ua(r);if(e!==as&&e!==Mo)return r;var t=new Map,a=rr(r),n=Pe(0),i=ut,s=l=>{var c=ut;fn(i);var d=l();return fn(c),d};return a&&t.set("length",Pe(r.length)),new Proxy(r,{defineProperty(l,c,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&jo();var u=t.get(c);return u===void 0?(u=s(()=>Pe(d.value)),t.set(c,u)):w(u,s(()=>Dt(d.value))),!0},deleteProperty(l,c){var d=t.get(c);if(d===void 0)c in l&&(t.set(c,s(()=>Pe(jt))),Fa(n));else{if(a&&typeof c=="string"){var u=t.get("length"),p=Number(c);Number.isInteger(p)&&p<u.v&&w(u,p)}w(d,jt),Fa(n)}return!0},get(l,c,d){if(c===wn)return r;var u=t.get(c),p=c in l;if(u===void 0&&(!p||Mn(l,c)?.writable)&&(u=s(()=>Pe(Dt(p?l[c]:jt))),t.set(c,u)),u!==void 0){var h=o(u);return h===jt?void 0:h}return Reflect.get(l,c,d)},getOwnPropertyDescriptor(l,c){var d=Reflect.getOwnPropertyDescriptor(l,c);if(d&&"value"in d){var u=t.get(c);u&&(d.value=o(u))}else if(d===void 0){var p=t.get(c),h=p?.v;if(p!==void 0&&h!==jt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(l,c){if(c===wn)return!0;var d=t.get(c),u=d!==void 0&&d.v!==jt||Reflect.has(l,c);if(d!==void 0||ft!==null&&(!u||Mn(l,c)?.writable)){d===void 0&&(d=s(()=>Pe(u?Dt(l[c]):jt)),t.set(c,d));var p=o(d);if(p===jt)return!1}return u},set(l,c,d,u){var p=t.get(c),h=c in l;if(a&&c==="length")for(var v=d;v<p.v;v+=1){var m=t.get(v+"");m!==void 0?w(m,jt):v in l&&(m=s(()=>Pe(jt)),t.set(v+"",m))}p===void 0?(!h||Mn(l,c)?.writable)&&(p=s(()=>Pe(void 0)),w(p,s(()=>Dt(d))),t.set(c,p)):(h=p.v!==jt,w(p,s(()=>Dt(d))));var y=Reflect.getOwnPropertyDescriptor(l,c);if(y?.set&&y.set.call(u,d),!h){if(a&&typeof c=="string"){var b=t.get("length"),M=Number(c);Number.isInteger(M)&&M>=b.v&&w(b,M+1)}Fa(n)}return!0},ownKeys(l){o(n);var c=Reflect.ownKeys(l).filter(p=>{var h=t.get(p);return h===void 0||h.v!==jt});for(var[d,u]of t)u.v!==jt&&!(d in l)&&c.push(d);return c},setPrototypeOf(){Bo()}})}function Fa(r,e=1){w(r,r.v+e)}function Fi(r){try{if(r!==null&&typeof r=="object"&&wn in r)return r[wn]}catch{}return r}function ol(r,e){return Object.is(Fi(r),Fi(e))}function Dn(r){var e=Qt|un,t=ut!==null&&(ut.f&Qt)!==0?ut:null;return ft===null||t!==null&&(t.f&Gt)!==0?e|=Gt:ft.f|=ls,{ctx:ct,deps:null,effects:null,equals:cs,f:e,fn:r,reactions:null,rv:0,v:null,wv:0,parent:t??ft}}function ne(r){const e=Dn(r);return Ms(e),e}function Te(r){const e=Dn(r);return e.equals=ei,e}function ps(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)Xt(e[t])}}function ll(r){for(var e=r.parent;e!==null;){if((e.f&Qt)===0)return e;e=e.parent}return null}function hs(r){var e,t=ft;Tn(ll(r));try{ps(r),e=Rs(r)}finally{Tn(t)}return e}function vs(r){var e=hs(r);if(r.equals(e)||(r.v=e,r.wv=Ls()),!or){var t=(En||(r.f&Gt)!==0)&&r.deps!==null?Cn:Wt;en(r,t)}}const Cr=new Map;function er(r,e){var t={f:0,v:r,reactions:null,equals:cs,rv:0,wv:0};return t}function Pe(r,e){const t=er(r);return Ms(t),t}function Ke(r,e=!1){const t=er(r);return e||(t.equals=ei),ar&&ct!==null&&ct.l!==null&&(ct.l.s??=[]).push(t),t}function et(r,e){return w(r,Lt(()=>o(r))),e}function w(r,e,t=!1){ut!==null&&!an&&Or()&&(ut.f&(Qt|Qa))!==0&&!yn?.includes(r)&&$o();let a=t?Dt(e):e;return Ir(r,a)}function Ir(r,e){if(!r.equals(e)){var t=r.v;or?Cr.set(r,e):Cr.set(r,t),r.v=e,(r.f&Qt)!==0&&((r.f&un)!==0&&hs(r),en(r,(r.f&Gt)===0?Wt:Cn)),r.wv=Ls(),ms(r,un),Or()&&ft!==null&&(ft.f&Wt)!==0&&(ft.f&(bn|Un))===0&&(Kt===null?bl([r]):Kt.push(r))}return e}function ms(r,e){var t=r.reactions;if(t!==null)for(var a=Or(),n=t.length,i=0;i<n;i++){var s=t[i],l=s.f;(l&un)===0&&(!a&&s===ft||(en(s,e),(l&(Wt|Gt))!==0&&((l&Qt)!==0?ms(s,Cn):xa(s))))}}function cl(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let dl=!1;var Ba,gs,ws,ys,bs;function ul(){if(Ba===void 0){Ba=window,gs=document,ws=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;ys=Mn(e,"firstChild").get,bs=Mn(e,"nextSibling").get,Ti(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),Ti(t)&&(t.__t=void 0)}}function Ur(r=""){return document.createTextNode(r)}function cn(r){return ys.call(r)}function ma(r){return bs.call(r)}function f(r,e){return cn(r)}function Ye(r,e){{var t=cn(r);return t instanceof Comment&&t.data===""?ma(t):t}}function g(r,e=1,t=!1){let a=r;for(;e--;)a=ma(a);return a}function fl(r){r.textContent=""}function xs(r){ft===null&&ut===null&&zo(),ut!==null&&(ut.f&Gt)!==0&&ft===null&&Uo(),or&&Oo()}function pl(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function zn(r,e,t,a=!0){var n=ft,i={ctx:ct,deps:null,nodes_start:null,nodes_end:null,f:r|un,first:null,fn:e,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(t)try{ba(i),i.f|=Do}catch(c){throw Xt(i),c}else e!==null&&xa(i);var s=t&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&(ls|Qr))===0;if(!s&&a&&(n!==null&&pl(i,n),ut!==null&&(ut.f&Qt)!==0)){var l=ut;(l.effects??=[]).push(i)}return i}function hl(){return ut!==null&&!an}function ga(r){const e=zn(fa,null,!1);return en(e,Wt),e.teardown=r,e}function Et(r){xs();var e=ft!==null&&(ft.f&bn)!==0&&ct!==null&&!ct.m;if(e){var t=ct;(t.e??=[]).push({fn:r,effect:ft,reaction:ut})}else{var a=ir(r);return a}}function _s(r){return xs(),sr(r)}function vl(r){const e=zn(Un,r,!0);return()=>{Xt(e)}}function ml(r){const e=zn(Un,r,!0);return(t={})=>new Promise(a=>{t.outro?ta(e,()=>{Xt(e),a(void 0)}):(Xt(e),a(void 0))})}function ir(r){return zn(is,r,!1)}function _t(r,e){var t=ct,a={effect:null,ran:!1};t.l.r1.push(a),a.effect=sr(()=>{r(),!a.ran&&(a.ran=!0,w(t.l.r2,!0),Lt(e))})}function sn(){var r=ct;sr(()=>{if(o(r.l.r2)){for(var e of r.l.r1){var t=e.effect;(t.f&Wt)!==0&&en(t,Cn),lr(t)&&ba(t),e.ran=!1}r.l.r2.v=!1}})}function sr(r){return zn(fa,r,!0)}function O(r,e=[],t=Dn){const a=e.map(t);return Wn(()=>r(...a.map(o)))}function Wn(r,e=0){return zn(fa|Qa|e,r,!0)}function kn(r,e=!0){return zn(fa|bn,r,!0,e)}function Ss(r){var e=r.teardown;if(e!==null){const t=or,a=ut;Mi(!0),fn(null);try{e.call(null)}finally{Mi(t),fn(a)}}}function Es(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){var a=t.next;(t.f&Un)!==0?t.parent=null:Xt(t,e),t=a}}function gl(r){for(var e=r.first;e!==null;){var t=e.next;(e.f&bn)===0&&Xt(e),e=t}}function Xt(r,e=!0){var t=!1;(e||(r.f&os)!==0)&&r.nodes_start!==null&&(ks(r.nodes_start,r.nodes_end),t=!0),Es(r,e&&!t),sa(r,0),en(r,pa);var a=r.transitions;if(a!==null)for(const i of a)i.stop();Ss(r);var n=r.parent;n!==null&&n.first!==null&&Ts(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function ks(r,e){for(;r!==null;){var t=r===e?null:ma(r);r.remove(),r=t}}function Ts(r){var e=r.parent,t=r.prev,a=r.next;t!==null&&(t.next=a),a!==null&&(a.prev=t),e!==null&&(e.first===r&&(e.first=a),e.last===r&&(e.last=t))}function ta(r,e){var t=[];ai(r,t,!0),Cs(t,()=>{Xt(r),e&&e()})}function Cs(r,e){var t=r.length;if(t>0){var a=()=>--t||e();for(var n of r)n.out(a)}else e()}function ai(r,e,t){if((r.f&gn)===0){if(r.f^=gn,r.transitions!==null)for(const s of r.transitions)(s.is_global||t)&&e.push(s);for(var a=r.first;a!==null;){var n=a.next,i=(a.f&ha)!==0||(a.f&bn)!==0;ai(a,e,i?t:!1),a=n}}}function na(r){Is(r,!0)}function Is(r,e){if((r.f&gn)!==0){r.f^=gn,(r.f&Wt)===0&&(r.f^=Wt),lr(r)&&(en(r,un),xa(r));for(var t=r.first;t!==null;){var a=t.next,n=(t.f&ha)!==0||(t.f&bn)!==0;Is(t,n?e:!1),t=a}if(r.transitions!==null)for(const i of r.transitions)(i.is_global||e)&&i.in()}}let Fr=[],$a=[];function Fs(){var r=Fr;Fr=[],Tr(r)}function wl(){var r=$a;$a=[],Tr(r)}function wa(r){Fr.length===0&&queueMicrotask(Fs),Fr.push(r)}function yl(){Fr.length>0&&Fs(),$a.length>0&&wl()}let Yr=!1,ra=!1,aa=null,Pn=!1,or=!1;function Mi(r){or=r}let xr=[];let ut=null,an=!1;function fn(r){ut=r}let ft=null;function Tn(r){ft=r}let yn=null;function Ms(r){ut!==null&&ut.f&ja&&(yn===null?yn=[r]:yn.push(r))}let At=null,qt=0,Kt=null;function bl(r){Kt=r}let Ps=1,ia=0,En=!1,Sn=null;function Ls(){return++Ps}function lr(r){var e=r.f;if((e&un)!==0)return!0;if((e&Cn)!==0){var t=r.deps,a=(e&Gt)!==0;if(t!==null){var n,i,s=(e&ea)!==0,l=a&&ft!==null&&!En,c=t.length;if(s||l){var d=r,u=d.parent;for(n=0;n<c;n++)i=t[n],(s||!i?.reactions?.includes(d))&&(i.reactions??=[]).push(d);s&&(d.f^=ea),l&&u!==null&&(u.f&Gt)===0&&(d.f^=Gt)}for(n=0;n<c;n++)if(i=t[n],lr(i)&&vs(i),i.wv>r.wv)return!0}(!a||ft!==null&&!En)&&en(r,Wt)}return!1}function xl(r,e){for(var t=e;t!==null;){if((t.f&Qr)!==0)try{t.fn(r);return}catch{t.f^=Qr}t=t.parent}throw Yr=!1,r}function Pi(r){return(r.f&pa)===0&&(r.parent===null||(r.parent.f&Qr)===0)}function ya(r,e,t,a){if(Yr){if(t===null&&(Yr=!1),Pi(e))throw r;return}if(t!==null&&(Yr=!0),xl(r,e),Pi(e))throw r}function Ds(r,e,t=!0){var a=r.reactions;if(a!==null)for(var n=0;n<a.length;n++){var i=a[n];yn?.includes(r)||((i.f&Qt)!==0?Ds(i,e,!1):e===i&&(t?en(i,un):(i.f&Wt)!==0&&en(i,Cn),xa(i)))}}function Rs(r){var e=At,t=qt,a=Kt,n=ut,i=En,s=yn,l=ct,c=an,d=r.f;At=null,qt=0,Kt=null,En=(d&Gt)!==0&&(an||!Pn||ut===null),ut=(d&(bn|Un))===0?r:null,yn=null,Ci(r.ctx),an=!1,ia++,r.f|=ja;try{var u=(0,r.fn)(),p=r.deps;if(At!==null){var h;if(sa(r,qt),p!==null&&qt>0)for(p.length=qt+At.length,h=0;h<At.length;h++)p[qt+h]=At[h];else r.deps=p=At;if(!En)for(h=qt;h<p.length;h++)(p[h].reactions??=[]).push(r)}else p!==null&&qt<p.length&&(sa(r,qt),p.length=qt);if(Or()&&Kt!==null&&!an&&p!==null&&(r.f&(Qt|Cn|un))===0)for(h=0;h<Kt.length;h++)Ds(Kt[h],r);return n!==null&&n!==r&&(ia++,Kt!==null&&(a===null?a=Kt:a.push(...Kt))),u}finally{At=e,qt=t,Kt=a,ut=n,En=i,yn=s,Ci(l),an=c,r.f^=ja}}function _l(r,e){let t=e.reactions;if(t!==null){var a=Fo.call(t,r);if(a!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[a]=t[n],t.pop())}}t===null&&(e.f&Qt)!==0&&(At===null||!At.includes(e))&&(en(e,Cn),(e.f&(Gt|ea))===0&&(e.f^=ea),ps(e),sa(e,0))}function sa(r,e){var t=r.deps;if(t!==null)for(var a=e;a<t.length;a++)_l(r,t[a])}function ba(r){var e=r.f;if((e&pa)===0){en(r,Wt);var t=ft,a=ct,n=Pn;ft=r,Pn=!0;try{(e&Qa)!==0?gl(r):Es(r),Ss(r);var i=Rs(r);r.teardown=typeof i=="function"?i:null,r.wv=Ps;var s=r.deps,l;ki&&Ho&&r.f&un}catch(c){ya(c,r,t,a||r.ctx)}finally{Pn=n,ft=t}}}function Sl(){try{Wo()}catch(r){if(aa!==null)ya(r,aa,null);else throw r}}function As(){var r=Pn;try{var e=0;for(Pn=!0;xr.length>0;){e++>1e3&&Sl();var t=xr,a=t.length;xr=[];for(var n=0;n<a;n++){var i=kl(t[n]);El(i)}Cr.clear()}}finally{ra=!1,Pn=r,aa=null}}function El(r){var e=r.length;if(e!==0)for(var t=0;t<e;t++){var a=r[t];if((a.f&(pa|gn))===0)try{lr(a)&&(ba(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?Ts(a):a.fn=null))}catch(n){ya(n,a,null,a.ctx)}}}function xa(r){ra||(ra=!0,queueMicrotask(As));for(var e=aa=r;e.parent!==null;){e=e.parent;var t=e.f;if((t&(Un|bn))!==0){if((t&Wt)===0)return;e.f^=Wt}}xr.push(e)}function kl(r){for(var e=[],t=r;t!==null;){var a=t.f,n=(a&(bn|Un))!==0,i=n&&(a&Wt)!==0;if(!i&&(a&gn)===0){if((a&is)!==0)e.push(t);else if(n)t.f^=Wt;else try{lr(t)&&ba(t)}catch(c){ya(c,t,null,t.ctx)}var s=t.first;if(s!==null){t=s;continue}}var l=t.parent;for(t=t.next;t===null&&l!==null;)t=l.next,l=l.parent}return e}function Tl(r){for(var e;;){if(yl(),xr.length===0)return e;ra=!0,As()}}async function Os(){await Promise.resolve(),Tl()}function o(r){var e=r.f,t=(e&Qt)!==0;if(Sn!==null&&Sn.add(r),ut!==null&&!an){if(!yn?.includes(r)){var a=ut.deps;r.rv<ia&&(r.rv=ia,At===null&&a!==null&&a[qt]===r?qt++:At===null?At=[r]:(!En||!At.includes(r))&&At.push(r))}}else if(t&&r.deps===null&&r.effects===null){var n=r,i=n.parent;i!==null&&(i.f&Gt)===0&&(n.f^=Gt)}return t&&(n=r,lr(n)&&vs(n)),or&&Cr.has(r)?Cr.get(r):r.v}function Cl(r){var e=Sn;Sn=new Set;var t=Sn,a;try{if(Lt(r),e!==null)for(a of Sn)e.add(a)}finally{Sn=e}return t}function Il(r){var e=Cl(()=>Lt(r));for(var t of e)if((t.f&ss)!==0)for(const a of t.deps||[])(a.f&Qt)===0&&Ir(a,a.v);else Ir(t,t.v)}function Lt(r){var e=an;try{return an=!0,r()}finally{an=e}}const Fl=-7169;function en(r,e){r.f=r.f&Fl|e}function wt(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(wn in r)Ha(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&wn in t&&Ha(t)}}}function Ha(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let a in r)try{Ha(r[a],e)}catch{}const t=ua(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const a=rs(t);for(let n in a){const i=a[n].get;if(i)try{i.call(r)}catch{}}}}}function Ml(){return Symbol(fs)}function Pl(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const Ll=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Dl(r){return Ll.includes(r)}const Rl={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Al(r){return r=r.toLowerCase(),Rl[r]??r}const Ol=["touchstart","touchmove"];function Ul(r){return Ol.includes(r)}function zl(r,e){if(e){const t=document.body;r.autofocus=!0,wa(()=>{document.activeElement===t&&r.focus()})}}let Li=!1;function Wl(){Li||(Li=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const e of r.target.elements)e.__on_r?.()})},{capture:!0}))}function Us(r){var e=ut,t=ft;fn(null),Tn(null);try{return r()}finally{fn(e),Tn(t)}}function zs(r,e,t,a=t){r.addEventListener(e,()=>Us(t));const n=r.__on_r;n?r.__on_r=()=>{n(),a(!0)}:r.__on_r=()=>a(!0),Wl()}const Ws=new Set,qa=new Set;function ii(r,e,t,a={}){function n(i){if(a.capture||yr.call(e,i),!i.cancelBubble)return Us(()=>t?.call(this,i))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?wa(()=>{e.addEventListener(r,n,a)}):e.addEventListener(r,n,a),n}function ln(r,e,t,a={}){var n=ii(e,r,t,a);return()=>{r.removeEventListener(e,n,a)}}function at(r,e,t,a,n){var i={capture:a,passive:n},s=ii(r,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&ga(()=>{e.removeEventListener(r,s,i)})}function yt(r){for(var e=0;e<r.length;e++)Ws.add(r[e]);for(var t of qa)t(r)}function yr(r){var e=this,t=e.ownerDocument,a=r.type,n=r.composedPath?.()||[],i=n[0]||r.target,s=0,l=r.__root;if(l){var c=n.indexOf(l);if(c!==-1&&(e===document||e===window)){r.__root=e;return}var d=n.indexOf(e);if(d===-1)return;c<=d&&(s=c)}if(i=n[s]||r.target,i!==e){ns(r,"currentTarget",{configurable:!0,get(){return i||t}});var u=ut,p=ft;fn(null),Tn(null);try{for(var h,v=[];i!==null;){var m=i.assignedSlot||i.parentNode||i.host||null;try{var y=i["__"+a];if(y!=null&&(!i.disabled||r.target===i))if(rr(y)){var[b,...M]=y;b.apply(i,[r,...M])}else y.call(i,r)}catch(T){h?v.push(T):h=T}if(r.cancelBubble||m===e||m===null)break;i=m}if(h){for(let T of v)queueMicrotask(()=>{throw T});throw h}}finally{r.__root=e,delete r.currentTarget,fn(u),Tn(p)}}}function Nl(r){var e;e=document.head.appendChild(Ur());try{Wn(()=>r(e),os)}finally{}}function si(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","\x3C!---->"),e.content}function tr(r,e){var t=ft;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function I(r,e){var t=(e&Qo)!==0,a=(e&el)!==0,n,i=!r.startsWith("<!>");return()=>{n===void 0&&(n=si(i?r:"<!>"+r),t||(n=cn(n)));var s=a||ws?document.importNode(n,!0):n.cloneNode(!0);if(t){var l=cn(s),c=s.lastChild;tr(l,c)}else tr(s,s);return s}}function jl(r,e,t="svg"){var a=!r.startsWith("<!>"),n=`<${t}>${a?r:"<!>"+r}</${t}>`,i;return()=>{if(!i){var s=si(n),l=cn(s);i=cn(l)}var c=i.cloneNode(!0);return tr(c,c),c}}function Ns(r,e){return jl(r,e,"svg")}function Pt(r=""){{var e=Ur(r+"");return tr(e,e),e}}function lt(){var r=document.createDocumentFragment(),e=document.createComment(""),t=Ur();return r.append(e,t),tr(e,t),r}function _(r,e){r!==null&&r.before(e)}function oi(){return(window.__svelte??={}).uid??=1,`c${window.__svelte.uid++}`}function x(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??=r.nodeValue)&&(r.__t=t,r.nodeValue=t+"")}function Bl(r,e){return $l(r,e)}const jn=new Map;function $l(r,{target:e,anchor:t,props:a={},events:n,context:i,intro:s=!0}){ul();var l=new Set,c=p=>{for(var h=0;h<p.length;h++){var v=p[h];if(!l.has(v)){l.add(v);var m=Ul(v);e.addEventListener(v,yr,{passive:m});var y=jn.get(v);y===void 0?(document.addEventListener(v,yr,{passive:m}),jn.set(v,1)):jn.set(v,y+1)}}};c(Za(Ws)),qa.add(c);var d=void 0,u=ml(()=>{var p=t??e.appendChild(Ur());return kn(()=>{if(i){tt({});var h=ct;h.c=i}n&&(a.$$events=n),d=r(p,a)||{},i&&nt()}),()=>{for(var h of l){e.removeEventListener(h,yr);var v=jn.get(h);--v===0?(document.removeEventListener(h,yr),jn.delete(h)):jn.set(h,v)}qa.delete(c),p!==t&&p.parentNode?.removeChild(p)}});return Hl.set(d,u),d}let Hl=new WeakMap;function j(r,e,[t,a]=[0,0]){var n=r,i=null,s=null,l=jt,c=t>0?ha:0,d=!1;const u=(h,v=!0)=>{d=!0,p(v,h)},p=(h,v)=>{l!==(l=h)&&(l?(i?na(i):v&&(i=kn(()=>v(n))),s&&ta(s,()=>{s=null})):(s?na(s):v&&(s=kn(()=>v(n,[t+1,a]))),i&&ta(i,()=>{i=null})))};Wn(()=>{d=!1,e(u),d||p(null,null)},c)}function It(r,e){return e}function ql(r,e,t,a){for(var n=[],i=e.length,s=0;s<i;s++)ai(e[s].e,n,!0);var l=i>0&&n.length===0&&t!==null;if(l){var c=t.parentNode;fl(c),c.append(t),a.clear(),_n(r,e[0].prev,e[i-1].next)}Cs(n,()=>{for(var d=0;d<i;d++){var u=e[d];l||(a.delete(u.k),_n(r,u.prev,u.next)),Xt(u.e,!l)}})}function kt(r,e,t,a,n,i=null){var s=r,l={flags:e,items:new Map,first:null},c=(e&us)!==0;if(c){var d=r;s=d.appendChild(Ur())}var u=null,p=!1,h=Te(()=>{var v=t();return rr(v)?v:v==null?[]:Za(v)});Wn(()=>{var v=o(h),m=v.length;p&&m===0||(p=m===0,Vl(v,l,s,n,e,a,t),i!==null&&(m===0?u?na(u):u=kn(()=>i(s)):u!==null&&ta(u,()=>{u=null})),o(h))})}function Vl(r,e,t,a,n,i,s){var l=(n&Vo)!==0,c=(n&(ti|ni))!==0,d=r.length,u=e.items,p=e.first,h=p,v,m=null,y,b=[],M=[],T,E,C,k;if(l)for(k=0;k<d;k+=1)T=r[k],E=i(T,k),C=u.get(E),C!==void 0&&(C.a?.measure(),(y??=new Set).add(C));for(k=0;k<d;k+=1){if(T=r[k],E=i(T,k),C=u.get(E),C===void 0){var X=h?h.e.nodes_start:t;m=Xl(X,e,m,m===null?e.first:m.next,T,E,k,a,n,s),u.set(E,m),b=[],M=[],h=m.next;continue}if(c&&Gl(C,T,k,n),(C.e.f&gn)!==0&&(na(C.e),l&&(C.a?.unfix(),(y??=new Set).delete(C))),C!==h){if(v!==void 0&&v.has(C)){if(b.length<M.length){var P=M[0],z;m=P.prev;var U=b[0],F=b[b.length-1];for(z=0;z<b.length;z+=1)Di(b[z],P,t);for(z=0;z<M.length;z+=1)v.delete(M[z]);_n(e,U.prev,F.next),_n(e,m,U),_n(e,F,P),h=P,m=F,k-=1,b=[],M=[]}else v.delete(C),Di(C,h,t),_n(e,C.prev,C.next),_n(e,C,m===null?e.first:m.next),_n(e,m,C),m=C;continue}for(b=[],M=[];h!==null&&h.k!==E;)(h.e.f&gn)===0&&(v??=new Set).add(h),M.push(h),h=h.next;if(h===null)continue;C=h}b.push(C),m=C,h=C.next}if(h!==null||v!==void 0){for(var S=v===void 0?[]:Za(v);h!==null;)(h.e.f&gn)===0&&S.push(h),h=h.next;var W=S.length;if(W>0){var R=(n&us)!==0&&d===0?t:null;if(l){for(k=0;k<W;k+=1)S[k].a?.measure();for(k=0;k<W;k+=1)S[k].a?.fix()}ql(e,S,R,u)}}l&&wa(()=>{if(y!==void 0)for(C of y)C.a?.apply()}),ft.first=e.first&&e.first.e,ft.last=m&&m.e}function Gl(r,e,t,a){(a&ti)!==0&&Ir(r.v,e),(a&ni)!==0?Ir(r.i,t):r.i=t}function Xl(r,e,t,a,n,i,s,l,c,d){var u=(c&ti)!==0,p=(c&Go)===0,h=u?p?Ke(n):er(n):n,v=(c&ni)===0?s:er(s),m={i:v,v:h,k:i,a:null,e:null,prev:t,next:a};try{return m.e=kn(()=>l(r,h,v,d),dl),m.e.prev=t&&t.e,m.e.next=a&&a.e,t===null?e.first=m:(t.next=m,t.e.next=m.e),a!==null&&(a.prev=m,a.e.prev=m.e),m}finally{}}function Di(r,e,t){for(var a=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,i=r.e.nodes_start;i!==a;){var s=ma(i);n.before(i),i=s}}function _n(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function js(r,e,t=!1,a=!1,n=!1){var i=r,s="";O(()=>{var l=ft;if(s!==(s=e()??"")&&(l.nodes_start!==null&&(ks(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),s!=="")){var c=s+"";t?c=`<svg>${c}</svg>`:a&&(c=`<math>${c}</math>`);var d=si(c);if((t||a)&&(d=cn(d)),tr(cn(d),d.lastChild),t||a)for(;cn(d);)i.before(cn(d));else i.before(d)}})}function Mt(r,e,t,a,n){var i=e.$$slots?.[t],s=!1;i===!0&&(i=e[t==="default"?"children":t],s=!0),i===void 0||i(r,s?()=>a:a)}function nr(r,e,...t){var a=r,n=Zt,i;Wn(()=>{n!==(n=e())&&(i&&(Xt(i),i=null),i=kn(()=>n(a,...t)))},ha)}function Kl(r,e){var t=void 0,a;Wn(()=>{t!==(t=e())&&(a&&(Xt(a),a=null),t&&(a=kn(()=>{ir(()=>t(r))})))})}function Bs(r){var e,t,a="";if(typeof r=="string"||typeof r=="number")a+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=Bs(r[e]))&&(a&&(a+=" "),a+=t)}else for(t in r)r[t]&&(a&&(a+=" "),a+=t);return a}function Jr(){for(var r,e,t=0,a="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=Bs(r))&&(a&&(a+=" "),a+=e);return a}function Yl(r){return typeof r=="object"?Jr(r):r??""}const Ri=[...` 	
\r\f \v\uFEFF`];function Jl(r,e,t){var a=r==null?"":""+r;if(e&&(a=a?a+" "+e:e),t){for(var n in t)if(t[n])a=a?a+" "+n:n;else if(a.length)for(var i=n.length,s=0;(s=a.indexOf(n,s))>=0;){var l=s+i;(s===0||Ri.includes(a[s-1]))&&(l===a.length||Ri.includes(a[l]))?a=(s===0?"":a.substring(0,s))+a.substring(l+1):s=l}}return a===""?null:a}function Ai(r,e=!1){var t=e?" !important;":";",a="";for(var n in r){var i=r[n];i!=null&&i!==""&&(a+=" "+n+": "+i+t)}return a}function Ma(r){return r[0]!=="-"||r[1]!=="-"?r.toLowerCase():r}function Zl(r,e){if(e){var t="",a,n;if(Array.isArray(e)?(a=e[0],n=e[1]):a=e,r){r=String(r).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var i=!1,s=0,l=!1,c=[];a&&c.push(...Object.keys(a).map(Ma)),n&&c.push(...Object.keys(n).map(Ma));var d=0,u=-1;const y=r.length;for(var p=0;p<y;p++){var h=r[p];if(l?h==="/"&&r[p-1]==="*"&&(l=!1):i?i===h&&(i=!1):h==="/"&&r[p+1]==="*"?l=!0:h==='"'||h==="'"?i=h:h==="("?s++:h===")"&&s--,!l&&i===!1&&s===0){if(h===":"&&u===-1)u=p;else if(h===";"||p===y-1){if(u!==-1){var v=Ma(r.substring(d,u).trim());if(!c.includes(v)){h!==";"&&p++;var m=r.substring(d,p).trim();t+=" "+m+";"}}d=p+1,u=-1}}}}return a&&(t+=Ai(a)),n&&(t+=Ai(n,!0)),t=t.trim(),t===""?null:t}return r==null?null:String(r)}function st(r,e,t,a,n,i){var s=r.__className;if(s!==t||s===void 0){var l=Jl(t,a,i);l==null?r.removeAttribute("class"):e?r.className=l:r.setAttribute("class",l),r.__className=t}else if(i&&n!==i)for(var c in i){var d=!!i[c];(n==null||d!==!!n[c])&&r.classList.toggle(c,d)}return i}function Pa(r,e={},t,a){for(var n in t){var i=t[n];e[n]!==i&&(t[n]==null?r.style.removeProperty(n):r.style.setProperty(n,i,a))}}function li(r,e,t,a){var n=r.__style;if(n!==e){var i=Zl(e,a);i==null?r.removeAttribute("style"):r.style.cssText=i,r.__style=e}else a&&(Array.isArray(a)?(Pa(r,t?.[0],a[0]),Pa(r,t?.[1],a[1],"important")):Pa(r,t,a));return a}function Rn(r,e,t){if(r.multiple){if(e==null)return;if(!rr(e))return cl();for(var a of r.options)a.selected=e.includes(_r(a));return}for(a of r.options){var n=_r(a);if(ol(n,e)){a.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function Mr(r,e){let t=!0;ir(()=>{e&&Rn(r,Lt(e),t),t=!1;var a=new MutationObserver(()=>{var n=r.__value;Rn(r,n)});return a.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function $s(r,e,t=e){var a=!0;zs(r,"change",n=>{var i=n?"[selected]":":checked",s;if(r.multiple)s=[].map.call(r.querySelectorAll(i),_r);else{var l=r.querySelector(i)??r.querySelector("option:not([disabled])");s=l&&_r(l)}t(s)}),ir(()=>{var n=e();if(Rn(r,n,a),a&&n===void 0){var i=r.querySelector(":checked");i!==null&&(n=_r(i),t(n))}r.__value=n,a=!1}),Mr(r)}function _r(r){return"__value"in r?r.__value:r.value}const dr=Symbol("class"),ur=Symbol("style"),Hs=Symbol("is custom element"),qs=Symbol("is html");function An(r,e){var t=Sa(r);t.value===(t.value=e??void 0)||r.value===e&&(e!==0||r.nodeName!=="PROGRESS")||(r.value=e??"")}function Vs(r,e){var t=Sa(r);t.checked!==(t.checked=e??void 0)&&(r.checked=e)}function Ql(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function ue(r,e,t,a){var n=Sa(r);n[e]!==(n[e]=t)&&(e==="loading"&&(r[Ao]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Gs(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function ec(r,e,t,a,n=!1){var i=Sa(r),s=i[Hs],l=!i[qs],c=e||{},d=r.tagName==="OPTION";for(var u in e)u in t||(t[u]=null);t.class?t.class=Yl(t.class):(a||t[dr])&&(t.class=null),t[ur]&&(t.style??=null);var p=Gs(r);for(const E in t){let C=t[E];if(d&&E==="value"&&C==null){r.value=r.__value="",c[E]=C;continue}if(E==="class"){var h=r.namespaceURI==="http://www.w3.org/1999/xhtml";st(r,h,C,a,e?.[dr],t[dr]),c[E]=C,c[dr]=t[dr];continue}if(E==="style"){li(r,C,e?.[ur],t[ur]),c[E]=C,c[ur]=t[ur];continue}var v=c[E];if(C!==v){c[E]=C;var m=E[0]+E[1];if(m!=="$$")if(m==="on"){const k={},X="$$"+E;let P=E.slice(2);var y=Dl(P);if(Pl(P)&&(P=P.slice(0,-7),k.capture=!0),!y&&v){if(C!=null)continue;r.removeEventListener(P,c[X],k),c[X]=null}if(C!=null)if(y)r[`__${P}`]=C,yt([P]);else{let z=function(U){c[E].call(this,U)};var T=z;c[X]=ii(P,r,z,k)}else y&&(r[`__${P}`]=void 0)}else if(E==="style")ue(r,E,C);else if(E==="autofocus")zl(r,!!C);else if(!s&&(E==="__value"||E==="value"&&C!=null))r.value=r.__value=C;else if(E==="selected"&&d)Ql(r,C);else{var b=E;l||(b=Al(b));var M=b==="defaultValue"||b==="defaultChecked";if(C==null&&!s&&!M)if(i[E]=null,b==="value"||b==="checked"){let k=r;const X=e===void 0;if(b==="value"){let P=k.defaultValue;k.removeAttribute(b),k.defaultValue=P,k.value=k.__value=X?P:null}else{let P=k.defaultChecked;k.removeAttribute(b),k.defaultChecked=P,k.checked=X?P:!1}}else r.removeAttribute(E);else M||p.includes(b)&&(s||typeof C!="string")?r[b]=C:typeof C!="function"&&ue(r,b,C)}}}return c}function _a(r,e,t=[],a,n=!1,i=Dn){const s=t.map(i);var l=void 0,c={},d=r.nodeName==="SELECT",u=!1;Wn(()=>{var p=e(...s.map(o));ec(r,l,p,a,n),u&&d&&"value"in p&&Rn(r,p.value,!1);for(let v of Object.getOwnPropertySymbols(c))p[v]||Xt(c[v]);for(let v of Object.getOwnPropertySymbols(p)){var h=p[v];v.description===fs&&(!l||h!==l[v])&&(c[v]&&Xt(c[v]),c[v]=kn(()=>Kl(r,()=>h)))}l=p}),d&&Mr(r,()=>l.value),u=!0}function Sa(r){return r.__attributes??={[Hs]:r.nodeName.includes("-"),[qs]:r.namespaceURI===tl}}var Oi=new Map;function Gs(r){var e=Oi.get(r.nodeName);if(e)return e;Oi.set(r.nodeName,e=[]);for(var t,a=r,n=Element.prototype;n!==a;){t=rs(a);for(var i in t)t[i].set&&e.push(i);a=ua(a)}return e}function Sr(r,e,t=e){var a=Or();zs(r,"input",n=>{var i=n?r.defaultValue:r.value;if(i=La(r)?Da(i):i,t(i),a&&i!==(i=e())){var s=r.selectionStart,l=r.selectionEnd;r.value=i??"",l!==null&&(r.selectionStart=s,r.selectionEnd=Math.min(l,r.value.length))}}),Lt(e)==null&&r.value&&t(La(r)?Da(r.value):r.value),sr(()=>{var n=e();La(r)&&n===Da(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function La(r){var e=r.type;return e==="number"||e==="range"}function Da(r){return r===""?null:+r}function Ut(r,e,t){var a=Mn(r,e);a&&a.set&&(r[e]=t,ga(()=>{r[e]=null}))}function Ui(r,e){return r===e||r?.[wn]===e}function Bt(r={},e,t,a){return ir(()=>{var n,i;return sr(()=>{n=i,i=[],Lt(()=>{r!==t(...i)&&(e(r,...i),n&&Ui(t(...n),r)&&e(null,...n))})}),()=>{wa(()=>{i&&Ui(t(...i),r)&&e(null,...i)})}}),r}function Rt(r=!1){const e=ct,t=e.l.u;if(!t)return;let a=()=>wt(e.s);if(r){let n=0,i={};const s=Dn(()=>{let l=!1;const c=e.s;for(const d in c)c[d]!==i[d]&&(i[d]=c[d],l=!0);return l&&n++,n});a=()=>o(s)}t.b.length&&_s(()=>{zi(e,a),Tr(t.b)}),Et(()=>{const n=Lt(()=>t.m.map(Po));return()=>{for(const i of n)typeof i=="function"&&i()}}),t.a.length&&Et(()=>{zi(e,a),Tr(t.a)})}function zi(r,e){if(r.l.s)for(const t of r.l.s)o(t);e()}function ci(r,e,t){if(r==null)return e(void 0),t&&t(void 0),Zt;const a=Lt(()=>r.subscribe(e,t));return a.unsubscribe?()=>a.unsubscribe():a}const Bn=[];function tc(r,e){return{subscribe:Jt(r,e).subscribe}}function Jt(r,e=Zt){let t=null;const a=new Set;function n(l){if(ds(r,l)&&(r=l,t)){const c=!Bn.length;for(const d of a)d[1](),Bn.push(d,r);if(c){for(let d=0;d<Bn.length;d+=2)Bn[d][0](Bn[d+1]);Bn.length=0}}}function i(l){n(l(r))}function s(l,c=Zt){const d=[l,c];return a.add(d),a.size===1&&(t=e(n,i)||Zt),l(r),()=>{a.delete(d),a.size===0&&t&&(t(),t=null)}}return{set:n,update:i,subscribe:s}}function zr(r,e,t){const a=!Array.isArray(r),n=a?[r]:r;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=e.length<2;return tc(t,(s,l)=>{let c=!1;const d=[];let u=0,p=Zt;const h=()=>{if(u)return;p();const m=e(a?d[0]:d,s,l);i?s(m):p=typeof m=="function"?m:Zt},v=n.map((m,y)=>ci(m,b=>{d[y]=b,u&=~(1<<y),c&&h()},()=>{u|=1<<y}));return c=!0,h(),function(){Tr(v),p(),c=!1}})}function dn(r){let e;return ci(r,t=>e=t)(),e}let jr=!1,Va=Symbol();function Qe(r,e,t){const a=t[e]??={store:null,source:Ke(void 0),unsubscribe:Zt};if(a.store!==r&&!(Va in t))if(a.unsubscribe(),a.store=r??null,r==null)a.source.v=void 0,a.unsubscribe=Zt;else{var n=!0;a.unsubscribe=ci(r,i=>{n?a.source.v=i:w(a.source,i)}),n=!1}return r&&Va in t?dn(r):o(a.source)}function ot(){const r={};function e(){ga(()=>{for(var t in r)r[t].unsubscribe();ns(r,Va,{enumerable:!1,value:!0})})}return[r,e]}function nc(r){var e=jr;try{return jr=!1,[r(),jr]}finally{jr=e}}const rc={get(r,e){if(!r.exclude.includes(e))return r.props[e]},set(r,e){return!1},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function di(r,e,t){return new Proxy({props:r,exclude:e},rc)}function Wi(r){return r.ctx?.d??!1}function $(r,e,t,a){var n=(t&Xo)!==0,i=!ar||(t&Ko)!==0,s=(t&Jo)!==0,l=(t&Zo)!==0,c=!1,d;s?[d,c]=nc(()=>r[e]):d=r[e];var u=wn in r||Ro in r,p=s&&(Mn(r,e)?.set??(u&&e in r&&(P=>r[e]=P)))||void 0,h=a,v=!0,m=!1,y=()=>(m=!0,v&&(v=!1,l?h=Lt(a):h=a),h);d===void 0&&a!==void 0&&(p&&i&&No(),d=y(),p&&p(d));var b;if(i)b=()=>{var P=r[e];return P===void 0?y():(v=!0,m=!1,P)};else{var M=(n?Dn:Te)(()=>r[e]);M.f|=ss,b=()=>{var P=o(M);return P!==void 0&&(h=void 0),P===void 0?h:P}}if((t&Yo)===0&&i)return b;if(p){var T=r.$$legacy;return function(P,z){return arguments.length>0?((!i||!z||T||c)&&p(z?b():P),P):b()}}var E=!1,C=!1,k=Ke(d),X=Dn(()=>{var P=b(),z=o(k);return E?(E=!1,C=!0,z):(C=!1,k.v=P)});return s&&o(X),n||(X.equals=ei),function(P,z){if(Sn!==null&&(E=C,b(),o(k)),arguments.length>0){const U=z?o(X):i&&s?Dt(P):P;if(!X.equals(U)){if(E=!0,w(k,U),m&&h!==void 0&&(h=U),Wi(X))return P;Lt(()=>o(X))}return P}return Wi(X)?X.v:o(X)}}function on(r){ct===null&&va(),ar&&ct.l!==null?ic(ct).m.push(r):Et(()=>{const e=Lt(r);if(typeof e=="function")return e})}function cr(r){ct===null&&va(),on(()=>()=>Lt(r))}function ac(r,e,{bubbles:t=!1,cancelable:a=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:a})}function tn(){const r=ct;return r===null&&va(),(e,t,a)=>{const n=r.s.$$events?.[e];if(n){const i=rr(n)?n.slice():[n],s=ac(e,t,a);for(const l of i)l.call(r.x,s);return!s.defaultPrevented}return!0}}function ic(r){var e=r.l;return e.u??={a:[],b:[],m:[]}}const sc="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(sc);qo();function oc(r){return typeof r=="function"}function ui(r){return r!==null&&typeof r=="object"}const lc=["string","number","bigint","boolean"];function Ga(r){return r==null||lc.includes(typeof r)?!0:Array.isArray(r)?r.every(e=>Ga(e)):typeof r=="object"?Object.getPrototypeOf(r)===Object.prototype:!1}const Pr=Symbol("box"),fi=Symbol("is-writable");function cc(r){return ui(r)&&Pr in r}function dc(r){return rt.isBox(r)&&fi in r}function rt(r){let e=Pe(Dt(r));return{[Pr]:!0,[fi]:!0,get current(){return o(e)},set current(t){w(e,t,!0)}}}function uc(r,e){const t=ne(r);return e?{[Pr]:!0,[fi]:!0,get current(){return o(t)},set current(a){e(a)}}:{[Pr]:!0,get current(){return r()}}}function fc(r){return rt.isBox(r)?r:oc(r)?rt.with(r):rt(r)}function pc(r){return Object.entries(r).reduce((e,[t,a])=>rt.isBox(a)?(rt.isWritableBox(a)?Object.defineProperty(e,t,{get(){return a.current},set(n){a.current=n}}):Object.defineProperty(e,t,{get(){return a.current}}),e):Object.assign(e,{[t]:a}),{})}function hc(r){return rt.isWritableBox(r)?{[Pr]:!0,get current(){return r.current}}:r}rt.from=fc;rt.with=uc;rt.flatten=pc;rt.readonly=hc;rt.isBox=cc;rt.isWritableBox=dc;function vc(...r){return function(e){for(const t of r)if(t){if(e.defaultPrevented)return;typeof t=="function"?t.call(this,e):t.current?.call(this,e)}}}function mc(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var $n={},Ra,Ni;function gc(){if(Ni)return Ra;Ni=1;var r=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,a=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,n=/^:\s*/,i=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,s=/^[;\s]*/,l=/^\s+|\s+$/g,c=`
`,d="/",u="*",p="",h="comment",v="declaration";Ra=function(y,b){if(typeof y!="string")throw new TypeError("First argument must be a string");if(!y)return[];b=b||{};var M=1,T=1;function E(R){var D=R.match(e);D&&(M+=D.length);var N=R.lastIndexOf(c);T=~N?R.length-N:T+R.length}function C(){var R={line:M,column:T};return function(D){return D.position=new k(R),z(),D}}function k(R){this.start=R,this.end={line:M,column:T},this.source=b.source}k.prototype.content=y;function X(R){var D=new Error(b.source+":"+M+":"+T+": "+R);if(D.reason=R,D.filename=b.source,D.line=M,D.column=T,D.source=y,!b.silent)throw D}function P(R){var D=R.exec(y);if(D){var N=D[0];return E(N),y=y.slice(N.length),D}}function z(){P(t)}function U(R){var D;for(R=R||[];D=F();)D!==!1&&R.push(D);return R}function F(){var R=C();if(!(d!=y.charAt(0)||u!=y.charAt(1))){for(var D=2;p!=y.charAt(D)&&(u!=y.charAt(D)||d!=y.charAt(D+1));)++D;if(D+=2,p===y.charAt(D-1))return X("End of comment missing");var N=y.slice(2,D-2);return T+=2,E(N),y=y.slice(D),T+=2,R({type:h,comment:N})}}function S(){var R=C(),D=P(a);if(D){if(F(),!P(n))return X("property missing ':'");var N=P(i),A=R({type:v,property:m(D[0].replace(r,p)),value:N?m(N[0].replace(r,p)):p});return P(s),A}}function W(){var R=[];U(R);for(var D;D=S();)D!==!1&&(R.push(D),U(R));return R}return z(),W()};function m(y){return y?y.replace(l,p):p}return Ra}var ji;function wc(){if(ji)return $n;ji=1;var r=$n&&$n.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty($n,"__esModule",{value:!0}),$n.default=t;var e=r(gc());function t(a,n){var i=null;if(!a||typeof a!="string")return i;var s=(0,e.default)(a),l=typeof n=="function";return s.forEach(function(c){if(c.type==="declaration"){var d=c.property,u=c.value;l?n(d,u,c):u&&(i=i||{},i[d]=u)}}),i}return $n}var yc=wc();const Bi=mc(yc),bc=Bi.default||Bi,xc=/\d/,_c=["-","_","/","."];function Sc(r=""){if(!xc.test(r))return r!==r.toLowerCase()}function Ec(r){const e=[];let t="",a,n;for(const i of r){const s=_c.includes(i);if(s===!0){e.push(t),t="",a=void 0;continue}const l=Sc(i);if(n===!1){if(a===!1&&l===!0){e.push(t),t=i,a=l;continue}if(a===!0&&l===!1&&t.length>1){const c=t.at(-1);e.push(t.slice(0,Math.max(0,t.length-1))),t=c+i,a=l;continue}}t+=i,a=l,n=s}return e.push(t),e}function Xs(r){return r?Ec(r).map(e=>Tc(e)).join(""):""}function kc(r){return Cc(Xs(r||""))}function Tc(r){return r?r[0].toUpperCase()+r.slice(1):""}function Cc(r){return r?r[0].toLowerCase()+r.slice(1):""}function Br(r){if(!r)return{};const e={};function t(a,n){if(a.startsWith("-moz-")||a.startsWith("-webkit-")||a.startsWith("-ms-")||a.startsWith("-o-")){e[Xs(a)]=n;return}if(a.startsWith("--")){e[a]=n;return}e[kc(a)]=n}return bc(r,t),e}function Ks(...r){return(...e)=>{for(const t of r)typeof t=="function"&&t(...e)}}function Ic(r,e,t,a){const n=Array.isArray(e)?e:[e];return n.forEach(i=>r.addEventListener(i,t,a)),()=>{n.forEach(i=>r.removeEventListener(i,t,a))}}function Fc(r,e){const t=RegExp(r,"g");return a=>{if(typeof a!="string")throw new TypeError(`expected an argument of type string, but got ${typeof a}`);return a.match(t)?a.replace(t,e):a}}const Mc=Fc(/[A-Z]/,r=>`-${r.toLowerCase()}`);function Pc(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError(`expected an argument of type object, but got ${typeof r}`);return Object.keys(r).map(e=>`${Mc(e)}: ${r[e]};`).join(`
`)}function Ys(r={}){return Pc(r).replace(`
`," ")}const Lc={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",transform:"translateX(-100%)"};Ys(Lc);const Dc=["onabort","onanimationcancel","onanimationend","onanimationiteration","onanimationstart","onauxclick","onbeforeinput","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncompositionend","oncompositionstart","oncompositionupdate","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onfocusin","onfocusout","onformdata","ongotpointercapture","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onlostpointercapture","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onpaste","onpause","onplay","onplaying","onpointercancel","onpointerdown","onpointerenter","onpointerleave","onpointermove","onpointerout","onpointerover","onpointerup","onprogress","onratechange","onreset","onresize","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onselectionchange","onselectstart","onslotchange","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ontransitioncancel","ontransitionend","ontransitionrun","ontransitionstart","onvolumechange","onwaiting","onwebkitanimationend","onwebkitanimationiteration","onwebkitanimationstart","onwebkittransitionend","onwheel"],Rc=new Set(Dc);function Ac(r){return Rc.has(r)}function pi(...r){const e={...r[0]};for(let t=1;t<r.length;t++){const a=r[t];if(a){for(const n of Object.keys(a)){const i=e[n],s=a[n],l=typeof i=="function",c=typeof s=="function";if(l&&Ac(n)){const d=i,u=s;e[n]=vc(d,u)}else if(l&&c)e[n]=Ks(i,s);else if(n==="class"){const d=Ga(i),u=Ga(s);d&&u?e[n]=Jr(i,s):d?e[n]=Jr(i):u&&(e[n]=Jr(s))}else if(n==="style"){const d=typeof i=="object",u=typeof s=="object",p=typeof i=="string",h=typeof s=="string";if(d&&u)e[n]={...i,...s};else if(d&&h){const v=Br(s);e[n]={...i,...v}}else if(p&&u){const v=Br(i);e[n]={...v,...s}}else if(p&&h){const v=Br(i),m=Br(s);e[n]={...v,...m}}else d?e[n]=i:u?e[n]=s:p?e[n]=i:h&&(e[n]=s)}else e[n]=s!==void 0?s:i}for(const n of Object.getOwnPropertySymbols(a)){const i=e[n],s=a[n];e[n]=s!==void 0?s:i}}}return typeof e.style=="object"&&(e.style=Ys(e.style).replaceAll(`
`," ")),e.hidden!==!0&&(e.hidden=void 0,delete e.hidden),e.disabled!==!0&&(e.disabled=void 0,delete e.disabled),e}const Oc=typeof window<"u"?window:void 0;function Uc(r){let e=r.activeElement;for(;e?.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}function zc(r){w(r,r.v+1)}function Js(r){let e=0,t=er(0),a;return()=>{hl()&&(o(t),sr(()=>(e===0&&(a=Lt(()=>r(()=>zc(t)))),e+=1,()=>{Os().then(()=>{e-=1,e===0&&(a?.(),a=void 0)})})))}}let Wc=class{#e;#t;constructor(e={}){const{window:t=Oc,document:a=t?.document}=e;t!==void 0&&(this.#e=a,this.#t=Js(n=>{const i=ln(t,"focusin",n),s=ln(t,"focusout",n);return()=>{i(),s()}}))}get current(){return this.#t?.(),this.#e?Uc(this.#e):null}};new Wc;function Nc(r){Os().then(r)}const jc=9;function Bc(r){return ui(r)&&r.nodeType===jc}function $c(r){return ui(r)&&r.constructor?.name==="VisualViewport"}function Hc(r){return Bc(r)?r:$c(r)?r.document:r?.ownerDocument??document}function qc(r){let e=r.activeElement;for(;e?.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}class hi{element;#e=ne(()=>this.element.current?this.element.current.getRootNode()??document:document);get root(){return o(this.#e)}set root(e){w(this.#e,e)}constructor(e){typeof e=="function"?this.element=rt.with(e):this.element=e}getDocument=()=>Hc(this.root);getWindow=()=>this.getDocument().defaultView??window;getActiveElement=()=>qc(this.root);isActiveElement=e=>e===this.getActiveElement();getElementById(e){return this.root.getElementById(e)}querySelector=e=>this.root?this.root.querySelector(e):null;querySelectorAll=e=>this.root?this.root.querySelectorAll(e):[];setTimeout=(e,t)=>this.getWindow().setTimeout(e,t);clearTimeout=e=>this.getWindow().clearTimeout(e)}function vi(r,e){return{[Ml()]:t=>rt.isBox(r)?(r.current=t,Lt(()=>e?.(t)),()=>{"isConnected"in t&&t.isConnected||(r.current=null)}):(r(t),Lt(()=>e?.(t)),()=>{"isConnected"in t&&t.isConnected||r(null)})}}function Vc({layout:r,panesArray:e,pivotIndices:t}){let a=0,n=100,i=0,s=0;const l=t[0];for(let p=0;p<e.length;p++){const h=e[p].constraints,{maxSize:v=100,minSize:m=0}=h;p===l?(a=m,n=v):(i+=m,s+=v)}const c=Math.min(n,100-i),d=Math.max(a,100-s),u=r[l];return{valueMax:c,valueMin:d,valueNow:u}}function vt(r,e="Assertion failed!"){if(!r)throw console.error(e),new Error(e)}const Gc=100,mi=10;function Vt(r,e,t=mi){return Lr(r,e,t)===0}function Lr(r,e,t=mi){const a=$i(r,t),n=$i(e,t);return Math.sign(a-n)}function fr(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function $i(r,e){return Number.parseFloat(r.toFixed(e))}const Ea=typeof document<"u";function Xc(r){return r instanceof HTMLElement}function Zs(r){return r.type==="keydown"}function Qs(r){return r.type.startsWith("mouse")}function eo(r){return r.type.startsWith("touch")}function Kn({paneConstraints:r,paneIndex:e,initialSize:t}){const a=r[e];vt(a!=null,"Pane constraints should not be null.");const{collapsedSize:n=0,collapsible:i,maxSize:s=100,minSize:l=0}=a;let c=t;return Lr(c,l)<0&&(c=Kc(c,i,n,l)),c=Math.min(s,c),Number.parseFloat(c.toFixed(mi))}function Kc(r,e,t,a){if(!e)return a;const n=(t+a)/2;return Lr(r,n)<0?t:a}function Ln(){}function Yc({groupId:r,layout:e,panesArray:t,domContext:a}){const n=Wr(r,a);for(let i=0;i<t.length-1;i++){const{valueMax:s,valueMin:l,valueNow:c}=Vc({layout:e,panesArray:t,pivotIndices:[i,i+1]}),d=n[i];if(Xc(d)){const u=t[i];d.setAttribute("aria-controls",u.opts.id.current),d.setAttribute("aria-valuemax",`${Math.round(s)}`),d.setAttribute("aria-valuemin",`${Math.round(l)}`),d.setAttribute("aria-valuenow",c!=null?`${Math.round(c)}`:"")}}return()=>{for(const i of n)i.removeAttribute("aria-controls"),i.removeAttribute("aria-valuemax"),i.removeAttribute("aria-valuemin"),i.removeAttribute("aria-valuenow")}}function Wr(r,e){return Ea?Array.from(e.querySelectorAll(`[data-pane-resizer-id][data-pane-group-id="${r}"]`)):[]}function to({groupId:r,id:e,domContext:t}){return Ea?Wr(r,t).findIndex(i=>i.getAttribute("data-pane-resizer-id")===e)??null:null}function Hi({groupId:r,dragHandleId:e,domContext:t}){const a=to({groupId:r,id:e,domContext:t});return a!=null?[a,a+1]:[-1,-1]}function Hn(r,e,t){const a=r.map(d=>d.constraints),n=Vn(r,e),i=a[n],l=n===r.length-1?[n-1,n]:[n,n+1],c=t[n];return{...i,paneSize:c,pivotIndices:l}}function Vn(r,e){return r.findIndex(t=>t.opts.id.current===e.opts.id.current)}function pr(r,e,t){for(let a=0;a<e.length;a++){const n=e[a],i=r[a];vt(i);const{collapsedSize:s=0,collapsible:l}=i.constraints,c=t[i.opts.id.current];if(!(c==null||n!==c))continue;t[i.opts.id.current]=n;const{onCollapse:d,onExpand:u,onResize:p}=i.callbacks;p?.(n,c),l&&(d||u)&&(u&&(c==null||c===s)&&n!==s&&u(),d&&(c==null||c!==s)&&n===s&&d())}}function Jc({panesArray:r}){const e=Array(r.length),t=r.map(i=>i.constraints);let a=0,n=100;for(let i=0;i<r.length;i++){const s=t[i];vt(s);const{defaultSize:l}=s;l!=null&&(a++,e[i]=l,n-=l)}for(let i=0;i<r.length;i++){const s=t[i];vt(s);const{defaultSize:l}=s;if(l!=null)continue;const c=r.length-a,d=n/c;a++,e[i]=d,n-=d}return e}function Zc({layout:r,paneConstraints:e}){const t=[...r],a=t.reduce((i,s)=>i+s,0);if(t.length!==e.length)throw new Error(`Invalid ${e.length} pane layout: ${t.map(i=>`${i}%`).join(", ")}`);if(!Vt(a,100))for(let i=0;i<e.length;i++){const s=t[i];vt(s!=null);const l=100/a*s;t[i]=l}let n=0;for(let i=0;i<e.length;i++){const s=t[i];vt(s!=null);const l=Kn({paneConstraints:e,paneIndex:i,initialSize:s});s!==l&&(n+=s-l,t[i]=l)}if(!Vt(n,0))for(let i=0;i<e.length;i++){const s=t[i];vt(s!=null);const l=s+n,c=Kn({paneConstraints:e,paneIndex:i,initialSize:l});if(s!==c&&(n-=c-s,t[i]=c,Vt(n,0)))break}return t}function Qc(r,e){if(!Ea)return null;const t=e.querySelector(`[data-pane-group][data-pane-group-id="${r}"]`);return t||null}function gi(r,e){if(!Ea)return null;const t=e.querySelector(`[data-pane-resizer-id="${r}"]`);return t||null}function ed({event:r,dragHandleId:e,dir:t,initialDragState:a,domContext:n}){const i=t==="horizontal",s=gi(e,n);vt(s);const l=s.getAttribute("data-pane-group-id");vt(l);const{initialCursorPosition:c}=a,d=no(t,r),u=Qc(l,n);vt(u);const p=u.getBoundingClientRect(),h=i?p.width:p.height;return(d-c)/h*100}function td({event:r,dragHandleId:e,dir:t,initialDragState:a,keyboardResizeBy:n,domContext:i}){if(Zs(r)){const s=t==="horizontal";let l=0;r.shiftKey?l=100:n!=null?l=n:l=10;let c=0;switch(r.key){case"ArrowDown":c=s?0:l;break;case"ArrowLeft":c=s?-l:0;break;case"ArrowRight":c=s?l:0;break;case"ArrowUp":c=s?0:-l;break;case"End":c=100;break;case"Home":c=-100;break}return c}else return a==null?0:ed({event:r,dragHandleId:e,dir:t,initialDragState:a,domContext:i})}function no(r,e){const t=r==="horizontal";if(Qs(e))return t?e.clientX:e.clientY;if(eo(e)){const a=e.touches[0];return vt(a),t?a.screenX:a.screenY}else throw new Error(`Unsupported event type "${e.type}"`)}function nd({groupId:r,handleId:e,panesArray:t,domContext:a}){const n=gi(e,a),i=Wr(r,a),s=n?i.indexOf(n):-1,l=t[s]?.opts.id.current??null,c=t[s+1]?.opts.id.current??null;return[l,c]}const rd=typeof window<"u"?window:void 0;function ad(r){let e=r.activeElement;for(;e?.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}class id{#e;#t;constructor(e={}){const{window:t=rd,document:a=t?.document}=e;t!==void 0&&(this.#e=a,this.#t=Js(n=>{const i=ln(t,"focusin",n),s=ln(t,"focusout",n);return()=>{i(),s()}}))}get current(){return this.#t?.(),this.#e?ad(this.#e):null}}new id;function sd(r,e){switch(r){case"post":Et(e);break;case"pre":_s(e);break}}function ro(r,e,t,a={}){const{lazy:n=!1}=a;let i=!n,s=Array.isArray(r)?[]:void 0;sd(e,()=>{const l=Array.isArray(r)?r.map(d=>d()):r();if(!i){i=!0,s=l;return}const c=Lt(()=>t(l,s));return s=l,c})}function Er(r,e,t){ro(r,"post",e,t)}function od(r,e,t){ro(r,"pre",e,t)}Er.pre=od;class ld{#e;#t;constructor(e){this.#e=e,this.#t=Symbol(e)}get key(){return this.#t}exists(){return il(this.#t)}get(){const e=Ii(this.#t);if(e===void 0)throw new Error(`Context "${this.#e}" not found`);return e}getOr(e){const t=Ii(this.#t);return t===void 0?e:t}set(e){return al(this.#t,e)}}function hr({delta:r,layout:e,paneConstraints:t,pivotIndices:a,trigger:n}){if(Vt(r,0))return e;const i=[...e],[s,l]=a;let c=0;if(n==="keyboard"){{const u=r<0?l:s,p=t[u];if(vt(p),p.collapsible){const h=e[u];vt(h!=null);const v=t[u];vt(v);const{collapsedSize:m=0,minSize:y=0}=v;if(Vt(h,m)){const b=y-h;Lr(b,Math.abs(r))>0&&(r=r<0?0-b:b)}}}{const u=r<0?s:l,p=t[u];vt(p);const{collapsible:h}=p;if(h){const v=e[u];vt(v!=null);const m=t[u];vt(m);const{collapsedSize:y=0,minSize:b=0}=m;if(Vt(v,b)){const M=v-y;Lr(M,Math.abs(r))>0&&(r=r<0?0-M:M)}}}}{const u=r<0?1:-1;let p=r<0?l:s,h=0;for(;;){const m=e[p];vt(m!=null);const b=Kn({paneConstraints:t,paneIndex:p,initialSize:100})-m;if(h+=b,p+=u,p<0||p>=t.length)break}const v=Math.min(Math.abs(r),Math.abs(h));r=r<0?0-v:v}{let p=r<0?s:l;for(;p>=0&&p<t.length;){const h=Math.abs(r)-Math.abs(c),v=e[p];vt(v!=null);const m=v-h,y=Kn({paneConstraints:t,paneIndex:p,initialSize:m});if(!Vt(v,y)&&(c+=v-y,i[p]=y,c.toPrecision(3).localeCompare(Math.abs(r).toPrecision(3),void 0,{numeric:!0})>=0))break;r<0?p--:p++}}if(Vt(c,0))return e;{const u=r<0?l:s,p=e[u];vt(p!=null);const h=p+c,v=Kn({paneConstraints:t,paneIndex:u,initialSize:h});if(i[u]=v,!Vt(v,h)){let m=h-v,b=r<0?l:s;for(;b>=0&&b<t.length;){const M=i[b];vt(M!=null);const T=M+m,E=Kn({paneConstraints:t,paneIndex:b,initialSize:T});if(Vt(M,E)||(m-=E-M,i[b]=E),Vt(m,0))break;r>0?b--:b++}}}const d=i.reduce((u,p)=>p+u,0);return Vt(d,100)?i:e}let Xa=null,Fn=null;function ao(r){switch(r){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function cd(){Fn!==null&&(document.head.removeChild(Fn),Xa=null,Fn=null)}function Aa(r,e){if(Xa===r)return;Xa=r;const t=ao(r);Fn===null&&(Fn=e.createElement("style"),e.head.appendChild(Fn)),Fn.innerHTML=`*{cursor: ${t}!important;}`}function dd({defaultSize:r,dragState:e,layout:t,panesArray:a,paneIndex:n,precision:i=3}){const s=t[n];let l;return s==null?l=r??"1":a.length===1?l="1":l=s.toPrecision(i),{flexBasis:0,flexGrow:l,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function qi(r){try{if(typeof localStorage>"u")throw new TypeError("localStorage is not supported in this environment");r.getItem=e=>localStorage.getItem(e),r.setItem=(e,t)=>localStorage.setItem(e,t)}catch(e){console.error(e),r.getItem=()=>null,r.setItem=()=>{}}}function io(r){return`paneforge:${r}`}function so(r){return r.map(t=>t.opts.order.current?`${t.opts.order.current}:${JSON.stringify(t.constraints)}`:JSON.stringify(t.constraints)).sort().join(",")}function oo(r,e){try{const t=io(r),a=e.getItem(t),n=JSON.parse(a||"");if(typeof n=="object"&&n!==null)return n}catch{}return null}function ud(r,e,t){const a=oo(r,t)||{},n=so(e);return a[n]||null}function fd(r,e,t,a,n){const i=io(r),s=so(e),l=oo(r,n)||{};l[s]={expandToSizes:Object.fromEntries(t.entries()),layout:a};try{n.setItem(i,JSON.stringify(l))}catch(c){console.error(c)}}const Vi={};function pd(r,e=10){let t=null;return(...n)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{r(...n)},e)}}function hd({autoSaveId:r,layout:e,storage:t,panesArray:a,paneSizeBeforeCollapse:n}){if(e.length===0||e.length!==a.length)return;let i=Vi[r];i==null&&(i=pd(fd,Gc),Vi[r]=i);const s=[...a],l=new Map(n);i(r,s,l,e,t)}const br={getItem:r=>(qi(br),br.getItem(r)),setItem:(r,e)=>{qi(br),br.setItem(r,e)}},wi=new ld("PaneGroup");class yi{static create(e){return wi.set(new yi(e))}opts;attachment;domContext;#e=Pe(null);get dragState(){return o(this.#e)}set dragState(e){w(this.#e,e)}#t=Pe([]);get layout(){return o(this.#t)}set layout(e){w(this.#t,e)}#r=Pe([]);get panesArray(){return o(this.#r)}set panesArray(e){w(this.#r,e)}#a=Pe(!1);get panesArrayChanged(){return o(this.#a)}set panesArrayChanged(e){w(this.#a,e,!0)}#n=Pe(Dt({}));get paneIdToLastNotifiedSizeMap(){return o(this.#n)}set paneIdToLastNotifiedSizeMap(e){w(this.#n,e,!0)}paneSizeBeforeCollapseMap=new Map;prevDelta=0;constructor(e){this.opts=e,this.attachment=vi(this.opts.ref),this.domContext=new hi(this.opts.ref),Er([()=>this.opts.id.current,()=>this.layout,()=>this.panesArray],()=>Yc({groupId:this.opts.id.current,layout:this.layout,panesArray:this.panesArray,domContext:this.domContext})),Et(()=>Lt(()=>this.#s())),Er([()=>this.opts.autoSaveId.current,()=>this.layout,()=>this.opts.storage.current],()=>{this.opts.autoSaveId.current&&hd({autoSaveId:this.opts.autoSaveId.current,layout:this.layout,storage:this.opts.storage.current,panesArray:this.panesArray,paneSizeBeforeCollapse:this.paneSizeBeforeCollapseMap})}),Er(()=>this.panesArrayChanged,()=>{if(!this.panesArrayChanged)return;this.panesArrayChanged=!1;const t=this.layout;let a=null;if(this.opts.autoSaveId.current){const i=ud(this.opts.autoSaveId.current,this.panesArray,this.opts.storage.current);i&&(this.paneSizeBeforeCollapseMap=new Map(Object.entries(i.expandToSizes)),a=i.layout)}a==null&&(a=Jc({panesArray:this.panesArray}));const n=Zc({layout:a,paneConstraints:this.panesArray.map(i=>i.constraints)});fr(t,n)||(this.layout=n,this.opts.onLayout.current?.(n),pr(this.panesArray,n,this.paneIdToLastNotifiedSizeMap))})}setLayout=e=>{this.layout=e};registerResizeHandle=e=>t=>{t.preventDefault();const a=this.opts.direction.current,n=this.dragState,i=this.opts.id.current,s=this.opts.keyboardResizeBy.current,l=this.layout,c=this.panesArray,{initialLayout:d}=n??{},u=this.domContext.getDocument(),p=Hi({groupId:i,dragHandleId:e,domContext:this.domContext});let h=td({event:t,dragHandleId:e,dir:a,initialDragState:n,keyboardResizeBy:s,domContext:this.domContext});if(h===0)return;const v=a==="horizontal";u.dir==="rtl"&&v&&(h=-h);const m=c.map(M=>M.constraints),y=hr({delta:h,layout:d??l,paneConstraints:m,pivotIndices:p,trigger:Zs(t)?"keyboard":"mouse-or-touch"}),b=!fr(l,y);(Qs(t)||eo(t))&&this.prevDelta!==h&&(this.prevDelta=h,Aa(b?v?"horizontal":"vertical":v?h<0?"horizontal-min":"horizontal-max":h<0?"vertical-min":"vertical-max",u)),b&&(this.setLayout(y),this.opts.onLayout.current?.(y),pr(c,y,this.paneIdToLastNotifiedSizeMap))};resizePane=(e,t)=>{const a=this.layout,n=this.panesArray,i=n.map(p=>p.constraints),{paneSize:s,pivotIndices:l}=Hn(n,e,a);vt(s!=null);const d=Vn(n,e)===n.length-1?s-t:t-s,u=hr({delta:d,layout:a,paneConstraints:i,pivotIndices:l,trigger:"imperative-api"});fr(a,u)||(this.setLayout(u),this.opts.onLayout.current?.(u),pr(n,u,this.paneIdToLastNotifiedSizeMap))};startDragging=(e,t)=>{const a=this.opts.direction.current,n=this.layout,i=gi(e,this.domContext);vt(i);const s=no(a,t);this.dragState={dragHandleId:e,dragHandleRect:i.getBoundingClientRect(),initialCursorPosition:s,initialLayout:n}};stopDragging=()=>{cd(),this.dragState=null};isPaneCollapsed=e=>{const t=this.panesArray,a=this.layout,{collapsedSize:n=0,collapsible:i,paneSize:s}=Hn(t,e,a);return i===!0&&s===n};expandPane=e=>{const t=this.layout,a=this.panesArray;if(!e.constraints.collapsible)return;const n=a.map(m=>m.constraints),{collapsedSize:i=0,paneSize:s,minSize:l=0,pivotIndices:c}=Hn(a,e,t);if(s!==i)return;const d=this.paneSizeBeforeCollapseMap.get(e.opts.id.current),u=d!=null&&d>=l?d:l,h=Vn(a,e)===a.length-1?s-u:u-s,v=hr({delta:h,layout:t,paneConstraints:n,pivotIndices:c,trigger:"imperative-api"});fr(t,v)||(this.setLayout(v),this.opts.onLayout.current?.(v),pr(a,v,this.paneIdToLastNotifiedSizeMap))};collapsePane=e=>{const t=this.layout,a=this.panesArray;if(!e.constraints.collapsible)return;const n=a.map(p=>p.constraints),{collapsedSize:i=0,paneSize:s,pivotIndices:l}=Hn(a,e,t);if(vt(s!=null),s===i)return;this.paneSizeBeforeCollapseMap.set(e.opts.id.current,s);const d=Vn(a,e)===a.length-1?s-i:i-s,u=hr({delta:d,layout:t,paneConstraints:n,pivotIndices:l,trigger:"imperative-api"});fr(t,u)||(this.layout=u,this.opts.onLayout.current?.(u),pr(a,u,this.paneIdToLastNotifiedSizeMap))};getPaneSize=e=>Hn(this.panesArray,e,this.layout).paneSize;getPaneStyle=(e,t)=>{const a=this.panesArray,n=this.layout,i=this.dragState,s=Vn(a,e);return dd({defaultSize:t,dragState:i,layout:n,panesArray:a,paneIndex:s})};isPaneExpanded=e=>{const{collapsedSize:t=0,collapsible:a,paneSize:n}=Hn(this.panesArray,e,this.layout);return!a||n>t};registerPane=e=>{const t=[...this.panesArray,e];return t.sort((a,n)=>{const i=a.opts.order.current,s=n.opts.order.current;return i==null&&s==null?0:i==null?-1:s==null?1:i-s}),this.panesArray=t,this.panesArrayChanged=!0,()=>{const a=[...this.panesArray],n=Vn(this.panesArray,e);n<0||(a.splice(n,1),this.panesArray=a,delete this.paneIdToLastNotifiedSizeMap[e.opts.id.current],this.panesArrayChanged=!0)}};#s=()=>{const e=this.opts.id.current,t=Wr(e,this.domContext),a=this.panesArray,n=t.map(i=>{const s=i.getAttribute("data-pane-resizer-id");if(!s)return Ln;const[l,c]=nd({groupId:e,handleId:s,panesArray:a,domContext:this.domContext});if(l==null||c==null)return Ln;const u=Ic(i,"keydown",p=>{if(p.defaultPrevented||p.key!=="Enter")return;p.preventDefault();const h=this.panesArray,v=h.findIndex(k=>k.opts.id.current===l);if(v<0)return;const m=h[v];vt(m);const y=this.layout,b=y[v],{collapsedSize:M=0,collapsible:T,minSize:E=0}=m.constraints;if(!(b!=null&&T))return;const C=hr({delta:Vt(b,M)?E-b:M-b,layout:y,paneConstraints:h.map(k=>k.constraints),pivotIndices:Hi({groupId:e,dragHandleId:s,domContext:this.domContext}),trigger:"keyboard"});y!==C&&(this.layout=C)});return()=>{u()}});return()=>{for(const i of n)i()}};#i=ne(()=>({id:this.opts.id.current,"data-pane-group":"","data-direction":this.opts.direction.current,"data-pane-group-id":this.opts.id.current,style:{display:"flex",flexDirection:this.opts.direction.current==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"},...this.attachment}));get props(){return o(this.#i)}set props(e){w(this.#i,e)}}const vd=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home"];class bi{static create(e){return new bi(e,wi.get())}opts;#e;attachment;domContext;#t=ne(()=>this.#e.dragState?.dragHandleId===this.opts.id.current);#r=Pe(!1);resizeHandler=null;constructor(e,t){this.opts=e,this.#e=t,this.attachment=vi(this.opts.ref),this.domContext=new hi(this.opts.ref),Et(()=>{this.opts.disabled.current?this.resizeHandler=null:this.resizeHandler=this.#e.registerResizeHandle(this.opts.id.current)}),Et(()=>{const a=this.opts.ref.current;if(!a)return;const n=this.opts.disabled.current,i=this.resizeHandler,s=o(this.#t);if(n||i===null||!s)return;const l=h=>{i(h)},c=h=>{i(h)},d=()=>{a.blur(),this.#e.stopDragging(),this.opts.onDraggingChange.current(!1)},u=this.domContext.getDocument().body,p=this.domContext.getWindow();return Ks(ln(u,"contextmenu",d),ln(u,"mousemove",l),ln(u,"touchmove",l,{passive:!1}),ln(u,"mouseleave",c),ln(p,"mouseup",d),ln(p,"touchend",d))})}#a=e=>{e.preventDefault(),!this.opts.disabled.current&&(this.#e.startDragging(this.opts.id.current,e),this.opts.onDraggingChange.current(!0))};#n=()=>{const e=this.opts.ref.current;e&&(e.blur(),this.#e.stopDragging(),this.opts.onDraggingChange.current(!1))};#s=e=>{if(this.opts.disabled.current||!this.resizeHandler||e.defaultPrevented)return;if(vd.includes(e.key)){e.preventDefault(),this.resizeHandler(e);return}if(e.key!=="F6")return;e.preventDefault();const t=Wr(this.#e.opts.id.current,this.domContext),a=to({groupId:this.#e.opts.id.current,id:this.opts.id.current,domContext:this.domContext});if(a===null)return;let n=0;e.shiftKey?a>0?n=a-1:n=t.length-1:a+1<t.length?n=a+1:n=0,t[n].focus()};#i=()=>{w(this.#r,!1)};#o=()=>{w(this.#r,!0)};#l=e=>{this.#a(e)};#d=()=>{this.#n()};#u=()=>{this.#n()};#f=()=>{this.#n()};#p=e=>{this.#a(e)};#c=ne(()=>({id:this.opts.id.current,role:"separator","data-direction":this.#e.opts.direction.current,"data-pane-group-id":this.#e.opts.id.current,"data-active":o(this.#t)?"pointer":o(this.#r)?"keyboard":void 0,"data-enabled":!this.opts.disabled.current,"data-pane-resizer-id":this.opts.id.current,"data-pane-resizer":"",tabIndex:this.opts.tabIndex.current,style:{cursor:ao(this.#e.opts.direction.current),touchAction:"none",userSelect:"none","-webkit-user-select":"none","-webkit-touch-callout":"none"},onkeydown:this.#s,onblur:this.#i,onfocus:this.#o,onmousedown:this.#l,onmouseup:this.#d,ontouchcancel:this.#u,ontouchend:this.#f,ontouchstart:this.#p,...this.attachment}));get props(){return o(this.#c)}set props(e){w(this.#c,e)}}class xi{static create(e){return new xi(e,wi.get())}opts;group;attachment;domContext;#e=Pe("");#t=ne(()=>({onCollapse:this.opts.onCollapse.current,onExpand:this.opts.onExpand.current,onResize:this.opts.onResize.current}));get callbacks(){return o(this.#t)}set callbacks(e){w(this.#t,e)}#r=ne(()=>({collapsedSize:this.opts.collapsedSize.current,collapsible:this.opts.collapsible.current,defaultSize:this.opts.defaultSize.current,maxSize:this.opts.maxSize.current,minSize:this.opts.minSize.current}));get constraints(){return o(this.#r)}set constraints(e){w(this.#r,e)}#a=e=>{w(this.#e,e,!0),Nc(()=>{if(this.opts.ref.current){const t=this.opts.ref.current;if(!(getComputedStyle(t).transitionDuration!=="0s")){w(this.#e,"");return}const i=s=>{s.propertyName==="flex-grow"&&(w(this.#e,""),t.removeEventListener("transitionend",i))};t.addEventListener("transitionend",i)}else w(this.#e,"")})};pane={collapse:()=>{this.#a("collapsing"),this.group.collapsePane(this)},expand:()=>{this.#a("expanding"),this.group.expandPane(this)},getSize:()=>this.group.getPaneSize(this),isCollapsed:()=>this.group.isPaneCollapsed(this),isExpanded:()=>this.group.isPaneExpanded(this),resize:e=>this.group.resizePane(this,e),getId:()=>this.opts.id.current};constructor(e,t){this.opts=e,this.group=t,this.attachment=vi(this.opts.ref),this.domContext=new hi(this.opts.ref),on(()=>this.group.registerPane(this)),Er(()=>rl(this.constraints),()=>{this.group.panesArrayChanged=!0})}#n=ne(()=>this.group.isPaneCollapsed(this));#s=ne(()=>o(this.#e)!==""?o(this.#e):o(this.#n)?"collapsed":"expanded");#i=ne(()=>({id:this.opts.id.current,style:this.group.getPaneStyle(this,this.opts.defaultSize.current),"data-pane":"","data-pane-id":this.opts.id.current,"data-pane-group-id":this.group.opts.id.current,"data-collapsed":o(this.#n)?"":void 0,"data-expanded":o(this.#n)?void 0:"","data-pane-state":o(this.#s),...this.attachment}));get props(){return o(this.#i)}set props(e){w(this.#i,e)}}var md=I("<div><!></div>");function gd(r,e){const t=oi();tt(e,!0);let a=$(e,"autoSaveId",3,null),n=$(e,"id",3,t),i=$(e,"keyboardResizeBy",3,null),s=$(e,"onLayoutChange",3,Ln),l=$(e,"storage",3,br),c=$(e,"ref",15,null),d=di(e,["$$slots","$$events","$$legacy","autoSaveId","direction","id","keyboardResizeBy","onLayoutChange","storage","ref","child","children"]);const u=yi.create({id:rt.with(()=>n()??t),ref:rt.with(()=>c(),E=>c(E)),autoSaveId:rt.with(()=>a()),direction:rt.with(()=>e.direction),keyboardResizeBy:rt.with(()=>i()),onLayout:rt.with(()=>s()),storage:rt.with(()=>l())}),p=()=>u.layout,h=u.setLayout,v=()=>u.opts.id.current,m=ne(()=>pi(d,u.props));var y=lt(),b=Ye(y);{var M=E=>{var C=lt(),k=Ye(C);nr(k,()=>e.child,()=>({props:o(m)})),_(E,C)},T=E=>{var C=md();_a(C,()=>({...o(m)}));var k=f(C);nr(k,()=>e.children??Zt),_(E,C)};j(b,E=>{e.child?E(M):E(T,!1)})}return _(r,y),nt({getLayout:p,setLayout:h,getId:v})}var wd=I("<div><!></div>");function Gi(r,e){const t=oi();tt(e,!0);let a=$(e,"id",3,t),n=$(e,"ref",15,null),i=$(e,"onCollapse",3,Ln),s=$(e,"onExpand",3,Ln),l=$(e,"onResize",3,Ln),c=di(e,["$$slots","$$events","$$legacy","id","ref","collapsedSize","collapsible","defaultSize","maxSize","minSize","onCollapse","onExpand","onResize","order","child","children"]);const d=xi.create({id:rt.with(()=>a()),ref:rt.with(()=>n(),X=>n(X)),collapsedSize:rt.with(()=>e.collapsedSize),collapsible:rt.with(()=>e.collapsible),defaultSize:rt.with(()=>e.defaultSize),maxSize:rt.with(()=>e.maxSize),minSize:rt.with(()=>e.minSize),onCollapse:rt.with(()=>i()),onExpand:rt.with(()=>s()),onResize:rt.with(()=>l()),order:rt.with(()=>e.order)}),u=d.pane.collapse,p=d.pane.expand,h=d.pane.getSize,v=d.pane.isCollapsed,m=d.pane.isExpanded,y=d.pane.resize,b=d.pane.getId,M=ne(()=>pi(c,d.props));var T=lt(),E=Ye(T);{var C=X=>{var P=lt(),z=Ye(P);nr(z,()=>e.child,()=>({props:o(M)})),_(X,P)},k=X=>{var P=wd();_a(P,()=>({...o(M)}));var z=f(P);nr(z,()=>e.children??Zt),_(X,P)};j(E,X=>{e.child?X(C):X(k,!1)})}return _(r,T),nt({collapse:u,expand:p,getSize:h,isCollapsed:v,isExpanded:m,resize:y,getId:b})}var yd=I("<div><!></div>");function bd(r,e){const t=oi();tt(e,!0);let a=$(e,"id",3,t),n=$(e,"ref",15,null),i=$(e,"disabled",3,!1),s=$(e,"onDraggingChange",3,Ln),l=$(e,"tabindex",3,0),c=di(e,["$$slots","$$events","$$legacy","id","ref","disabled","onDraggingChange","tabindex","child","children"]);const d=bi.create({id:rt.with(()=>a()),ref:rt.with(()=>n(),y=>n(y)),disabled:rt.with(()=>i()),onDraggingChange:rt.with(()=>s()),tabIndex:rt.with(()=>l())}),u=ne(()=>pi(c,d.props));var p=lt(),h=Ye(p);{var v=y=>{var b=lt(),M=Ye(b);nr(M,()=>e.child,()=>({props:o(u)})),_(y,b)},m=y=>{var b=yd();_a(b,()=>({...o(u)}));var M=f(b);nr(M,()=>e.children??Zt),_(y,b)};j(h,y=>{e.child?y(v):y(m,!1)})}_(r,p),nt()}const $r={SIDEBAR_EXPANDED:"editme_sidebar_expanded",SIDEBAR_SECTION:"editme_sidebar_section"},Oa={sidebar:{isExpanded:!0,activeSection:"about"},isInitialized:!1};function xd(){const{subscribe:r,set:e,update:t}=Jt(Oa);return{subscribe:r,set:e,update:t,initialize(){let a=Oa.sidebar.isExpanded,n=Oa.sidebar.activeSection;try{const i=localStorage.getItem($r.SIDEBAR_EXPANDED);i&&(a=JSON.parse(i))}catch(i){console.warn("Failed to load sidebar expanded state:",i)}try{const i=localStorage.getItem($r.SIDEBAR_SECTION);i&&_d(i)&&(n=i)}catch(i){console.warn("Failed to load sidebar section:",i)}t(i=>({...i,sidebar:{isExpanded:a,activeSection:n},isInitialized:!0}))},toggleSidebar(){t(a=>{const n=!a.sidebar.isExpanded;try{localStorage.setItem($r.SIDEBAR_EXPANDED,JSON.stringify(n))}catch(i){console.warn("Failed to save sidebar expanded state:",i)}return{...a,sidebar:{...a.sidebar,isExpanded:n}}})},setSidebarSection(a){t(n=>{try{localStorage.setItem($r.SIDEBAR_SECTION,a)}catch(i){console.warn("Failed to save sidebar section:",i)}return{...n,sidebar:{...n.sidebar,activeSection:a}}})}}}function _d(r){return["about","workspace","metadata","manifest","navigation","spine","settings"].includes(r)}const On=xd();typeof window<"u"&&On.initialize();const Dr={en:{code:"en",name:"English",direction:"ltr",englishName:"English"},de:{code:"de",name:"Deutsch",direction:"ltr",englishName:"German"},ka:{code:"ka",name:"ქართული",direction:"ltr",englishName:"Georgian"},ar:{code:"ar",name:"العربية",direction:"rtl",englishName:"Arabic"},he:{code:"he",name:"עברית",direction:"rtl",englishName:"Hebrew"},"zh-Hant":{code:"zh-Hant",name:"繁體中文",direction:"ltr",englishName:"Traditional Chinese"},ja:{code:"ja",name:"日本語",direction:"ltr",englishName:"Japanese"}},Rr="en",Sd=["ar","he"];function ka(r){return Sd.includes(r)}function lo(){if(typeof navigator>"u")return Rr;const r=navigator.languages||[navigator.language];for(const e of r){if(Dr[e])return e;const t=e.split("-")[0];if(Dr[t])return t;if(t==="zh"&&["zh-TW","zh-HK","zh-MO"].includes(e))return"zh-Hant"}return Rr}const Ed=`/**
 * OPFS Worker Script
 *
 * Handles OPFS sync access handle operations in a Web Worker.
 * Used primarily on Safari where sync access handles work better in workers.
 *
 * NOTE: This file MUST remain JavaScript (not TypeScript) because it gets
 * injected as a worker blob URL to support sync access handles in Safari.
 * Claude/agents should NOT convert this file to TypeScript.
 */

let opfsRoot = null;

async function getOPFSRoot() {
  if (!opfsRoot) {
    opfsRoot = await navigator.storage.getDirectory();
  }
  return opfsRoot;
}

async function ensureWorkspaceDirectory(workspaceId) {
  const root = await getOPFSRoot();
  const workspacesDir = await root.getDirectoryHandle('workspaces', { create: true });
  return await workspacesDir.getDirectoryHandle(workspaceId, { create: true });
}

async function ensureDirectoryPath(baseHandle, path) {
  const pathParts = path.split('/').filter(part => part.length > 0);
  let currentHandle = baseHandle;

  for (const part of pathParts) {
    currentHandle = await currentHandle.getDirectoryHandle(part, { create: true });
  }

  return currentHandle;
}

async function getFileHandle(workspaceId, path, create = false) {
  const workspaceHandle = await ensureWorkspaceDirectory(workspaceId);

  const pathParts = path.split('/');
  const fileName = pathParts.pop();
  const dirPath = pathParts.join('/');

  let targetDir = workspaceHandle;
  if (dirPath) {
    targetDir = await ensureDirectoryPath(workspaceHandle, dirPath);
  }

  return await targetDir.getFileHandle(fileName, { create });
}

async function createWorkspace(data) {
  try {
    await ensureWorkspaceDirectory(data.workspaceId);
    return { success: true };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

async function deleteWorkspace(data) {
  try {
    const root = await getOPFSRoot();
    const workspacesDir = await root.getDirectoryHandle('workspaces');
    await workspacesDir.removeEntry(data.workspaceId, { recursive: true });
    return { success: true };
  } catch (error) {
    if (error.name === 'NotFoundError') {
      return { success: true }; // Already deleted
    }
    return { success: false, error: error.message };
  }
}

async function listWorkspaces() {
  try {
    const root = await getOPFSRoot();
    const workspacesDir = await root.getDirectoryHandle('workspaces');
    const workspaces = [];

    for await (const [name, handle] of workspacesDir.entries()) {
      if (handle.kind === 'directory') {
        workspaces.push(name);
      }
    }

    return { success: true, workspaces: workspaces.sort() };
  } catch (error) {
    if (error.name === 'NotFoundError') {
      return { success: true, workspaces: [] };
    }
    return { success: false, error: error.message };
  }
}

async function writeFile(data) {
  try {
    const fileHandle = await getFileHandle(data.workspaceId, data.path, true);
    const syncHandle = await fileHandle.createSyncAccessHandle();

    try {
      // Truncate the file first to ensure complete overwrite
      syncHandle.truncate(data.content.byteLength);
      syncHandle.write(data.content, { at: 0 });
      syncHandle.flush();
    } finally {
      syncHandle.close();
    }

    return { success: true };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

async function readFile(data) {
  try {
    const fileHandle = await getFileHandle(data.workspaceId, data.path, false);
    const file = await fileHandle.getFile();
    const content = await file.arrayBuffer();
    return { success: true, content };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

async function deleteFile(data) {
  try {
    const workspaceHandle = await ensureWorkspaceDirectory(data.workspaceId);

    const pathParts = data.path.split('/');
    const fileName = pathParts.pop();
    const dirPath = pathParts.join('/');

    let targetDir = workspaceHandle;
    if (dirPath) {
      targetDir = await ensureDirectoryPath(workspaceHandle, dirPath);
    }

    await targetDir.removeEntry(fileName);
    return { success: true };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

async function collectFiles(dirHandle, currentPath, files) {
  for await (const [name, handle] of dirHandle.entries()) {
    const fullPath = currentPath ? \`\${currentPath}/\${name}\` : name;

    if (handle.kind === 'file') {
      files.push(fullPath);
    } else if (handle.kind === 'directory') {
      await collectFiles(handle, fullPath, files);
    }
  }
}

async function listFiles(data) {
  try {
    const workspaceHandle = await ensureWorkspaceDirectory(data.workspaceId);
    let targetDir = workspaceHandle;

    if (data.basePath) {
      try {
        targetDir = await ensureDirectoryPath(workspaceHandle, data.basePath);
      } catch (error) {
        if (error.name === 'NotFoundError') {
          return { success: true, files: [] };
        }
        throw error;
      }
    }

    const files = [];
    await collectFiles(targetDir, data.basePath || '', files);
    return { success: true, files: files.sort() };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

async function getQuota() {
  try {
    if ('storage' in navigator && 'estimate' in navigator.storage) {
      const estimate = await navigator.storage.estimate();
      return {
        success: true,
        quota: {
          used: estimate.usage || 0,
          available: (estimate.quota || 0) - (estimate.usage || 0),
        },
      };
    }
    return { success: true, quota: { used: 0, available: 0 } };
  } catch (error) {
    return { success: false, error: error.message };
  }
}

// Worker message handler
self.addEventListener('message', async event => {
  const { type, data, id } = event.data;
  let result;

  try {
    switch (type) {
      case 'createWorkspace':
        result = await createWorkspace(data);
        break;
      case 'deleteWorkspace':
        result = await deleteWorkspace(data);
        break;
      case 'listWorkspaces':
        result = await listWorkspaces();
        break;
      case 'writeFile':
        result = await writeFile(data);
        break;
      case 'readFile':
        result = await readFile(data);
        break;
      case 'deleteFile':
        result = await deleteFile(data);
        break;
      case 'listFiles':
        result = await listFiles(data);
        break;
      case 'getQuota':
        result = await getQuota();
        break;
      default:
        result = { success: false, error: \`Unknown operation: \${type}\` };
    }
  } catch (error) {
    result = { success: false, error: error.message };
  }

  const response = { type, result, id };
  self.postMessage(response);
});
`;class kd{worker=null;messageId=0;pendingMessages=new Map;timeout=1e4;isDestroyed=!1;constructor(){this.initWorker()}initWorker(){const e=new Blob([Ed],{type:"application/javascript"}),t=URL.createObjectURL(e);this.worker=new Worker(t),this.worker.onmessage=this.handleWorkerMessage.bind(this),this.worker.onerror=this.handleWorkerError.bind(this),this.worker.onmessageerror=this.handleWorkerMessageError.bind(this),URL.revokeObjectURL(t)}handleWorkerMessage(e){const{result:t,id:a,type:n}=e.data;if(n==="readFile"&&t&&!t.success?console.warn(`⚠️ Worker readFile failed: ${t.error}`):n==="readFile"&&t&&t.content===null&&console.warn(`⚠️ Empty ArrayBuffer received for ${t.path||"unknown path"}`),this.pendingMessages.has(a)){const{resolve:i}=this.pendingMessages.get(a);this.pendingMessages.delete(a),i(t)}}handleWorkerError(e){const t=new Error(`Worker error: ${e.message||"Unknown error"}`);this.rejectAllPendingMessages(t)}handleWorkerMessageError(e){const t=new Error("Worker message error: Failed to deserialize message");this.rejectAllPendingMessages(t)}rejectAllPendingMessages(e){for(const{reject:t}of this.pendingMessages.values())t(e);this.pendingMessages.clear()}async sendMessage(e,t){if(this.isDestroyed)throw new Error("Worker terminated");if(!this.worker)throw new Error("Worker not initialized");return new Promise((a,n)=>{const i=++this.messageId;this.pendingMessages.set(i,{resolve:a,reject:n}),this.worker.postMessage({type:e,data:t,id:i}),setTimeout(()=>{this.pendingMessages.has(i)&&(this.pendingMessages.delete(i),n(new Error(`Worker operation timed out after ${this.timeout}ms`)))},this.timeout)})}setTimeout(e){this.timeout=e}async createWorkspace(e){return await this.sendMessage("createWorkspace",{workspaceId:e})}async deleteWorkspace(e){return await this.sendMessage("deleteWorkspace",{workspaceId:e})}async listWorkspaces(){return await this.sendMessage("listWorkspaces")}async writeFile(e,t,a){return await this.sendMessage("writeFile",{workspaceId:e,path:t,content:a})}async readFile(e,t){return await this.sendMessage("readFile",{workspaceId:e,path:t})}async deleteFile(e,t){return await this.sendMessage("deleteFile",{workspaceId:e,path:t})}async listFiles(e,t){return await this.sendMessage("listFiles",{workspaceId:e,basePath:t})}async getFileInfo(e,t){return await this.sendMessage("getFileInfo",{workspaceId:e,path:t})}async getQuota(){return await this.sendMessage("getQuota")}destroy(){if(this.isDestroyed)return;this.isDestroyed=!0;const e=new Error("Worker terminated");this.rejectAllPendingMessages(e),this.worker&&(this.worker.terminate(),this.worker=null)}}class Td{capabilityCache=null;async testOPFSAvailable(){try{return"storage"in navigator&&"getDirectory"in navigator.storage}catch{return!1}}async testOPFSAsync(){try{if(!await this.testOPFSAvailable())return!1;const e=await navigator.storage.getDirectory(),t=await e.getFileHandle("__opfs_async_test__",{create:!0});if(!("createWritable"in t))return await e.removeEntry("__opfs_async_test__").catch(()=>{}),!1;try{return await(await t.createWritable()).close(),await e.removeEntry("__opfs_async_test__"),!0}catch{return await e.removeEntry("__opfs_async_test__").catch(()=>{}),!1}}catch{return!1}}async testOPFSSync(){try{if(!await this.testOPFSAvailable())return!1;const e=await navigator.storage.getDirectory(),t=await e.getFileHandle("__opfs_sync_test__",{create:!0});if(!("createSyncAccessHandle"in t))return await e.removeEntry("__opfs_sync_test__").catch(()=>{}),!1;try{return(await t.createSyncAccessHandle()).close(),await e.removeEntry("__opfs_sync_test__"),!0}catch{return await e.removeEntry("__opfs_sync_test__").catch(()=>{}),!1}}catch{return!1}}async testOPFSSyncWorker(){return new Promise(e=>{try{const t=`
					(async () => {
						try {
							const root = await navigator.storage.getDirectory();
							const testHandle = await root.getFileHandle('__worker_test__', { create: true });
							if ('createSyncAccessHandle' in testHandle) {
								const syncHandle = await testHandle.createSyncAccessHandle();
								syncHandle.close();
								await root.removeEntry('__worker_test__');
								self.postMessage({ success: true });
							} else {
								self.postMessage({ success: false });
							}
						} catch (error) {
							self.postMessage({ success: false, error: error.message });
						}
					})();
				`,a=new Blob([t],{type:"application/javascript"}),n=URL.createObjectURL(a),i=new Worker(n),s=setTimeout(()=>{i.terminate(),URL.revokeObjectURL(n),e(!1)},3e3);i.onmessage=l=>{clearTimeout(s),i.terminate(),URL.revokeObjectURL(n),e(l.data.success===!0)},i.onerror=()=>{clearTimeout(s),i.terminate(),URL.revokeObjectURL(n),e(!1)}}catch{e(!1)}})}async testIndexedDB(){return new Promise(e=>{try{if(!("indexedDB"in globalThis)){e(!1);return}const t=indexedDB.open("__capability_test__",1);t.onerror=()=>{e(!1)},t.onsuccess=()=>{t.result.close(),indexedDB.deleteDatabase("__capability_test__"),e(!0)},t.onupgradeneeded=a=>{const n=a.target.result;n.objectStoreNames.contains("test")||n.createObjectStore("test")}}catch{e(!1)}})}async testStorageEstimate(){try{return!("storage"in navigator)||!("estimate"in navigator.storage)?!1:(await navigator.storage.estimate(),!0)}catch{return!1}}async detectCapabilities(){if(this.capabilityCache)return this.capabilityCache;try{const[e,t,a,n,i,s]=await Promise.all([this.testOPFSAvailable().catch(()=>!1),this.testOPFSAsync().catch(()=>!1),this.testOPFSSync().catch(()=>!1),this.testOPFSSyncWorker().catch(()=>!1),this.testIndexedDB().catch(()=>!1),this.testStorageEstimate().catch(()=>!1)]);return this.capabilityCache={opfs:e,opfsAsync:t,opfsSync:a,opfsSyncWorker:n,indexedDB:i,storageEstimate:s},this.capabilityCache}catch{return this.capabilityCache={opfs:!1,opfsAsync:!1,opfsSync:!1,opfsSyncWorker:!1,indexedDB:!1,storageEstimate:!1},this.capabilityCache}}async detectOptimalBackend(){const e=await this.detectCapabilities();if(e.opfsAsync)return"opfs-async";if(e.opfsSyncWorker)return"opfs-sync";if(e.indexedDB)return"indexeddb";throw new Error("No storage backend available")}clearCache(){this.capabilityCache=null}}class Yn{static featureDetector=new Td;static cachedBackend=null;static async detectStorageBackend(){return await this.featureDetector.detectOptimalBackend()}static async testWorkerSyncAccessHandle(){return await this.featureDetector.testOPFSSyncWorker()}static async create(){if(Yn.cachedBackend)return Yn.cachedBackend;const e=await this.detectStorageBackend();let t;switch(e){case"opfs-sync":t=new Id;break;case"opfs-async":t=new Cd,await t.init?.();break;case"indexeddb":t=new Fd,await t.init?.();break;default:throw new Error(`Unsupported backend: ${e}`)}return Yn.cachedBackend=t,t}static async getCapabilities(){return await this.featureDetector.detectCapabilities()}static clearCache(){this.featureDetector.clearCache(),Yn.cachedBackend=null}}class Cd{root=null;async init(){if(!("storage"in navigator&&"getDirectory"in navigator.storage))throw new Error("OPFS not available");this.root=await navigator.storage.getDirectory()}async ensureWorkspaceDirectory(e){if(!this.root)throw new Error("Backend not initialized");return await(await this.root.getDirectoryHandle("workspaces",{create:!0})).getDirectoryHandle(e,{create:!0})}async ensureDirectoryPath(e,t){const a=t.split("/").filter(i=>i.length>0);let n=e;for(const i of a)n=await n.getDirectoryHandle(i,{create:!0});return n}async getFileHandle(e,t,a=!1){const n=await this.ensureWorkspaceDirectory(e),i=t.split("/"),s=i.pop(),l=i.join("/");let c=n;return l&&(c=await this.ensureDirectoryPath(n,l)),await c.getFileHandle(s,{create:a})}async createWorkspace(e){await this.ensureWorkspaceDirectory(e)}async deleteWorkspace(e){if(!this.root)throw new Error("Backend not initialized");try{await(await this.root.getDirectoryHandle("workspaces")).removeEntry(e,{recursive:!0})}catch(t){if(t.name!=="NotFoundError")throw t}}async listWorkspaces(){if(!this.root)throw new Error("Backend not initialized");try{const e=await this.root.getDirectoryHandle("workspaces"),t=[];for await(const[a,n]of e.entries())n.kind==="directory"&&t.push(a);return t.sort()}catch(e){if(e.name==="NotFoundError")return[];throw e}}async writeFile(e,t,a){const n=await this.getFileHandle(e,t,!0);await this.writeFileWithFallback(n,a)}async writeFileWithFallback(e,t){try{const a=await e.createWritable();try{await a.write(t)}finally{await a.close()}}catch(a){if("createSyncAccessHandle"in e){const n=await e.createSyncAccessHandle();try{n.truncate(t.byteLength),n.write(t,{at:0}),n.flush()}finally{n.close()}}else throw a}}async readFile(e,t){return await(await(await this.getFileHandle(e,t,!1)).getFile()).arrayBuffer()}async deleteFile(e,t){const a=await this.ensureWorkspaceDirectory(e),n=t.split("/"),i=n.pop(),s=n.join("/");let l=a;s&&(l=await this.ensureDirectoryPath(a,s)),await l.removeEntry(i)}async listFiles(e,t){const a=await this.ensureWorkspaceDirectory(e);let n=a;const i=t?t.replace(/\/+$/,""):"";if(i)try{n=await this.ensureDirectoryPath(a,i)}catch(l){if(l.name==="NotFoundError")return[];throw l}const s=[];return await this.collectFiles(n,i,s),s.sort()}async getFileInfo(e,t){const n=await(await this.getFileHandle(e,t,!1)).getFile();return{size:n.size,lastModified:new Date(n.lastModified)}}async collectFiles(e,t,a){for await(const[n,i]of e.entries()){const s=t?`${t}/${n}`:n;i.kind==="file"?a.push(s):i.kind==="directory"&&await this.collectFiles(i,s,a)}}async getQuota(){if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate();return{used:e.usage||0,available:(e.quota||0)-(e.usage||0)}}return{used:0,available:0}}getBackendType(){return"opfs-async"}}class Id{workerManager;constructor(){this.workerManager=new kd}async sendMessage(e,t){return await this.workerManager.sendMessage(e,t)}destroy(){this.workerManager.destroy()}async createWorkspace(e){const t=await this.workerManager.createWorkspace(e);if(!t.success)throw new Error(t.error?.message||"Failed to create workspace")}async deleteWorkspace(e){const t=await this.workerManager.deleteWorkspace(e);if(!t.success)throw new Error(t.error?.message||"Failed to delete workspace")}async listWorkspaces(){const e=await this.workerManager.listWorkspaces();if(!e.success)throw new Error(e.error?.message||"Failed to list workspaces");return e.workspaces||[]}async writeFile(e,t,a){const n=await this.workerManager.writeFile(e,t,a);if(!n.success)throw new Error(n.error?.message||"Failed to write file")}async readFile(e,t){const a=await this.workerManager.readFile(e,t);if(!a.success)throw new Error(a.error?.message||"Failed to read file");const n=a.content;if(!n||!(n instanceof ArrayBuffer))return console.warn(`⚠️ Invalid ArrayBuffer received for ${t}: ${typeof n}, length: ${n?.byteLength||"undefined"}`),new ArrayBuffer(0);try{return n.byteLength===0&&console.warn(`⚠️ Empty ArrayBuffer received for ${t}`),n}catch(i){return console.warn(`⚠️ Detached ArrayBuffer received for ${t}:`,i),new ArrayBuffer(0)}}async deleteFile(e,t){const a=await this.workerManager.deleteFile(e,t);if(!a.success)throw new Error(a.error?.message||"Failed to delete file")}async listFiles(e,t){const a=t?t.replace(/\/+$/,""):void 0,n=await this.workerManager.listFiles(e,a);if(!n.success)throw new Error(n.error?.message||"Failed to list files");return n.files||[]}async getFileInfo(e,t){const a=await this.workerManager.getFileInfo(e,t);if(!a.success)throw new Error(a.error?.message||"Failed to get file info");return a.data?.fileInfo||{size:0,lastModified:new Date}}async getQuota(){const e=await this.workerManager.getQuota();if(!e.success)throw new Error(e.error?.message||"Failed to get quota");return e.data?.quota||{used:0,available:0}}getBackendType(){return"opfs-sync"}}class Fd{db=null;dbName="editme-storage";version=1;async init(){return new Promise((e,t)=>{if(!("indexedDB"in globalThis)){t(new Error("IndexedDB not available"));return}const a=indexedDB.open(this.dbName,this.version);a.onerror=()=>{t(new Error(`Failed to open IndexedDB: ${a.error?.message}`))},a.onsuccess=()=>{this.db=a.result,e()},a.onupgradeneeded=n=>{const i=n.target.result;if(i.objectStoreNames.contains("workspaces")||i.createObjectStore("workspaces",{keyPath:"id"}).createIndex("created","created",{unique:!1}),!i.objectStoreNames.contains("files")){const s=i.createObjectStore("files",{keyPath:["workspaceId","path"]});s.createIndex("workspaceId","workspaceId",{unique:!1}),s.createIndex("modified","modified",{unique:!1})}}})}async transaction(e,t,a){if(!this.db)throw new Error("Database not initialized");return new Promise((n,i)=>{const s=this.db.transaction(e,t);s.onerror=()=>{i(new Error(`Transaction failed: ${s.error?.message}`))},a(s).then(n).catch(i)})}async putRecord(e,t){return new Promise((a,n)=>{const i=e.put(t);i.onsuccess=()=>a(),i.onerror=()=>n(new Error(`Put failed: ${i.error?.message}`))})}async getRecord(e,t){return new Promise((a,n)=>{const i=e.get(t);i.onsuccess=()=>a(i.result),i.onerror=()=>n(new Error(`Get failed: ${i.error?.message}`))})}async deleteRecord(e,t){return new Promise((a,n)=>{const i=e.delete(t);i.onsuccess=()=>a(),i.onerror=()=>n(new Error(`Delete failed: ${i.error?.message}`))})}async getAllRecords(e,t){return new Promise((a,n)=>{const i=e.getAll(t);i.onsuccess=()=>a(i.result),i.onerror=()=>n(new Error(`GetAll failed: ${i.error?.message}`))})}async createWorkspace(e){await this.transaction(["workspaces"],"readwrite",async t=>{const a=t.objectStore("workspaces");await this.putRecord(a,{id:e,created:Date.now()})})}async deleteWorkspace(e){await this.transaction(["workspaces","files"],"readwrite",async t=>{const a=t.objectStore("workspaces"),n=t.objectStore("files"),i=n.index("workspaceId"),s=await this.getAllRecords(i,IDBKeyRange.only(e));for(const l of s)await this.deleteRecord(n,[l.workspaceId,l.path]);await this.deleteRecord(a,e)})}async listWorkspaces(){return await this.transaction(["workspaces"],"readonly",async e=>{const t=e.objectStore("workspaces");return(await this.getAllRecords(t)).map(n=>n.id).sort()})}async writeFile(e,t,a){await this.transaction(["files"],"readwrite",async n=>{const i=n.objectStore("files");await this.putRecord(i,{workspaceId:e,path:t,content:a,modified:Date.now()})})}async readFile(e,t){return await this.transaction(["files"],"readonly",async a=>{const n=a.objectStore("files"),i=await this.getRecord(n,[e,t]);if(!i)throw new Error("File not found");return i.content})}async deleteFile(e,t){await this.transaction(["files"],"readwrite",async a=>{const n=a.objectStore("files");await this.deleteRecord(n,[e,t])})}async listFiles(e,t){return await this.transaction(["files"],"readonly",async a=>{const i=a.objectStore("files").index("workspaceId");let l=(await this.getAllRecords(i,IDBKeyRange.only(e))).map(c=>c.path);if(t){const d=t.replace(/\/+$/,"")+"/";l=l.filter(u=>u.startsWith(d))}return l.sort()})}async getFileInfo(e,t){return await this.transaction(["files"],"readonly",async a=>{const n=a.objectStore("files"),i=await this.getRecord(n,[e,t]);if(!i)throw new Error("File not found");return{size:i.content.byteLength,lastModified:new Date(i.modified)}})}async getQuota(){if("storage"in navigator&&"estimate"in navigator.storage)try{const e=await navigator.storage.estimate();return{used:e.usage||0,available:(e.quota||0)-(e.usage||0)}}catch{}return{used:0,available:0}}getBackendType(){return"indexeddb"}}class Md{backend=null;initialized=!1;async init(){this.initialized||(this.backend=await Yn.create(),this.initialized=!0)}isInitialized(){return this.initialized&&this.backend!==null}getBackendType(){if(!this.backend)throw new Error("Storage manager not initialized");return this.backend.getBackendType()}generateWorkspaceId(){return"workspace-"+"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}async createWorkspace(e){if(!this.backend)throw new Error("Storage manager not initialized");const t=e||this.generateWorkspaceId();return await this.backend.createWorkspace(t),t}async deleteWorkspace(e){if(!this.backend)throw new Error("Storage manager not initialized");await this.backend.deleteWorkspace(e)}async listWorkspaces(){if(!this.backend)throw new Error("Storage manager not initialized");return await this.backend.listWorkspaces()}async writeFile(e,t,a){if(!this.backend)throw new Error("Storage manager not initialized");await this.backend.writeFile(e,t,a)}async readFile(e,t){if(!this.backend)throw new Error("Storage manager not initialized");return await this.backend.readFile(e,t)}async deleteFile(e,t){if(!this.backend)throw new Error("Storage manager not initialized");await this.backend.deleteFile(e,t)}async listFiles(e,t){if(!this.backend)throw new Error("Storage manager not initialized");return await this.backend.listFiles(e,t)}async getFileInfo(e,t){if(!this.backend)throw new Error("Storage manager not initialized");return await this.backend.getFileInfo(e,t)}async getQuota(){if(!this.backend)throw new Error("Storage manager not initialized");return await this.backend.getQuota()}async writeTextFile(e,t,a){const i=new TextEncoder().encode(a).buffer;await this.writeFile(e,t,i)}async readTextFile(e,t){const a=await this.readFile(e,t);return new TextDecoder().decode(a)}async fileExists(e,t){try{return await this.readFile(e,t),!0}catch{return!1}}async getFileSize(e,t){return(await this.readFile(e,t)).byteLength}destroy(){this.backend&&"destroy"in this.backend&&this.backend.destroy(),this.backend=null,this.initialized=!1}}class Ot{static instance=null;manager;initPromise=null;constructor(){this.manager=new Md}static getInstance(){return Ot.instance||(Ot.instance=new Ot),Ot.instance}static async getInitializedInstance(){const e=Ot.getInstance();return e.isInitialized()||await e.init(),e}static resetInstance(){Ot.instance&&(Ot.instance.destroy(),Ot.instance=null)}async init(){if(!this.manager.isInitialized()){if(this.initPromise){await this.initPromise;return}this.initPromise=this.doInit();try{await this.initPromise}finally{this.initPromise=null}}}async doInit(){await this.manager.init(),console.log("FileStorageAPI initialized with backend:",this.manager.getBackendType())}isInitialized(){return this.manager.isInitialized()}getBackendType(){return this.manager.getBackendType()}async createWorkspace(e){return await this.manager.createWorkspace(e)}async deleteWorkspace(e){await this.manager.deleteWorkspace(e)}async listWorkspaces(){return await this.manager.listWorkspaces()}async writeFile(e,t,a){await this.manager.writeFile(e,t,a)}async readFile(e,t){return await this.manager.readFile(e,t)}async deleteFile(e,t){await this.manager.deleteFile(e,t)}async renameFile(e,t,a){const n=await this.manager.readFile(e,t);await this.manager.writeFile(e,a,n),await this.manager.deleteFile(e,t)}async listFiles(e,t){const a=t?t.replace(/\/+$/,""):void 0;return await this.manager.listFiles(e,a)}async getFileInfo(e,t){return await this.manager.getFileInfo(e,t)}async getQuota(){return await this.manager.getQuota()}async estimateWorkspaceSize(e){const t=await this.manager.listFiles(e);let a=0;for(const n of t)try{const i=await this.manager.getFileSize(e,n);a+=i}catch{}return a}async writeTextFile(e,t,a){await this.manager.writeTextFile(e,t,a)}async readTextFile(e,t){return await this.manager.readTextFile(e,t)}async fileExists(e,t){return await this.manager.fileExists(e,t)}supportsDirectBlobURLs(){const e=this.manager.getBackendType();return e==="opfs-async"||e==="opfs-sync"}async getFile(e,t){if(!this.manager.isInitialized())throw new Error("Storage manager not initialized");const a=this.manager.getBackendType();if(a==="opfs-async")return await(await this.manager.backend.getFileHandle(e,t,!1)).getFile();if(a==="opfs-sync"){const n=await this.readFile(e,t),i=t.split("/").pop()||"file";return new File([n],i)}else throw new Error("Direct file access not supported for IndexedDB backend")}destroy(){this.manager.destroy()}}function co(r){return new ReadableStream({start(e){e.enqueue(r),e.close()}})}function Pd(r,e="download.x"){const t=window.URL.createObjectURL(r),a=document.createElement("a");a.href=t,a.setAttribute("download",e),a.click(),window.URL.revokeObjectURL(t)}async function uo(r,e){const t=r.getReader();let a=!1;const n=[];for(;!a;){const i=await t.read();a=i.done,i.value&&n.push(i.value)}return new Blob(n,{type:e})}function hn(r,e,t){const a=[];for(let n=0;n<t;n++)a.push(String.fromCharCode(r.getUint8(e+n)));return a.join("")}class Ar{#e;#t=0;#r=[];#a=[];#n=null;constructor(e){this.#e=new DataView(e),this.read()}async extract(e){const t=this.#e.buffer.slice(e.startsAt,e.startsAt+e.compressedSize);if(e.compressionMethod===0)return new Blob([t]);if(e.compressionMethod===8){const a=new DecompressionStream("deflate-raw"),i=co(t).pipeThrough(a);return await uo(i)}else throw new Error(`Unsupported compression method: ${e.compressionMethod}`)}read(){for(;!this.#n&&this.#t<this.#e.byteLength-4;){const e=this.#e.getUint32(this.#t,!0);if(e===67324752){const t=this.readLocalFile(this.#t);t.startsAt=this.#t+30+t.fileNameLength+t.extraLength,t.extract=this.extract.bind(this,t),this.#r.push(t),this.#t=t.startsAt+t.compressedSize}else if(e===33639248){const t=this.readCentralDirectory(this.#t);this.#a.push(t),this.#t+=46+t.fileNameLength+t.extraLength+t.fileCommentLength}else if(e===101010256){this.#n=this.readEndCentralDirectory(this.#t);break}else this.#t++}}readLocalFile(e){const t=this.#e.getUint16(e+26,!0),a=this.#e.getUint16(e+28,!0);return{signature:hn(this.#e,e,4),version:this.#e.getUint16(e+4,!0),generalPurpose:this.#e.getUint16(e+6,!0),compressionMethod:this.#e.getUint16(e+8,!0),lastModifiedTime:this.#e.getUint16(e+10,!0),lastModifiedDate:this.#e.getUint16(e+12,!0),crc:this.#e.getUint32(e+14,!0),compressedSize:this.#e.getUint32(e+18,!0),uncompressedSize:this.#e.getUint32(e+22,!0),fileNameLength:t,fileName:hn(this.#e,e+30,t),extraLength:a,extra:hn(this.#e,e+30+t,a),startsAt:0,extract:()=>Promise.resolve(new Blob)}}readCentralDirectory(e){const t=this.#e.getUint16(e+28,!0),a=this.#e.getUint16(e+30,!0),n=this.#e.getUint16(e+32,!0);return{signature:hn(this.#e,e,4),versionCreated:this.#e.getUint16(e+4,!0),versionNeeded:this.#e.getUint16(e+6,!0),generalPurpose:this.#e.getUint16(e+8,!0),compressionMethod:this.#e.getUint16(e+10,!0),lastModifiedTime:this.#e.getUint16(e+12,!0),lastModifiedDate:this.#e.getUint16(e+14,!0),crc:this.#e.getUint32(e+16,!0),compressedSize:this.#e.getUint32(e+20,!0),uncompressedSize:this.#e.getUint32(e+24,!0),fileNameLength:t,extraLength:a,fileCommentLength:n,diskNumber:this.#e.getUint16(e+34,!0),internalAttributes:this.#e.getUint16(e+36,!0),externalAttributes:this.#e.getUint32(e+38,!0),offset:this.#e.getUint32(e+42,!0),fileName:hn(this.#e,e+46,t),extra:hn(this.#e,e+46+t,a),comments:hn(this.#e,e+46+t+a,n)}}readEndCentralDirectory(e){const t=this.#e.getUint16(e+20,!0);return{signature:hn(this.#e,e,4),numberOfDisks:this.#e.getUint16(e+4,!0),centralDirectoryStartDisk:this.#e.getUint16(e+6,!0),numberCentralDirectoryRecordsOnThisDisk:this.#e.getUint16(e+8,!0),numberCentralDirectoryRecords:this.#e.getUint16(e+10,!0),centralDirectorySize:this.#e.getUint32(e+12,!0),centralDirectoryOffset:this.#e.getUint32(e+16,!0),commentLength:t,comment:hn(this.#e,e+22,t)}}get entries(){return this.#r}}class Zn{#e=[];static _crcTable=[];constructor(){this.#e=[]}async addFile(e,t,a={}){const{compressionMethod:n=e==="mimetype"?0:8,lastModified:i=new Date}=a;let s,l,c,d,u;if(t instanceof ArrayBuffer)u=t;else if(t instanceof Uint8Array)u=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);else if(t instanceof Blob)u=await t.arrayBuffer();else if(typeof t=="string")u=new TextEncoder().encode(t).buffer;else throw new Error("Unsupported data type");if(c=u.byteLength,l=this.#s(new Uint8Array(u)),n===0)s=u,d=c;else if(n===8){const h=new CompressionStream("deflate-raw"),m=co(u).pipeThrough(h);s=await(await uo(m)).arrayBuffer(),d=s.byteLength}else throw new Error(`Unsupported compression method: ${n}`);const p={fileName:e,compressionMethod:n,lastModified:i,crc32:l,compressedSize:d,uncompressedSize:c,data:s,localHeaderOffset:0};return this.#e.push(p),this}async build(){const e=[];let t=0;const a=[...this.#e].sort((d,u)=>d.fileName==="mimetype"?-1:u.fileName==="mimetype"?1:0);for(const d of a){d.localHeaderOffset=t;const u=this.#t(d);e.push(u),t+=u.byteLength,e.push(d.data),t+=d.data.byteLength}const n=t;for(const d of a){const u=this.#r(d);e.push(u),t+=u.byteLength}const i=this.#a(this.#e.length,t-n,n);e.push(i);const s=e.reduce((d,u)=>d+u.byteLength,0),l=new Uint8Array(s);let c=0;for(const d of e)l.set(new Uint8Array(d),c),c+=d.byteLength;return l.buffer}async buildBlob(){const e=await this.build();return new Blob([e],{type:"application/zip"})}#t(e){const t=new TextEncoder().encode(e.fileName),a=30+t.length,n=new ArrayBuffer(a),i=new DataView(n),s=new Uint8Array(n);i.setUint32(0,67324752,!0),i.setUint16(4,20,!0),i.setUint16(6,0,!0),i.setUint16(8,e.compressionMethod,!0);const l=this.#n(e.lastModified);return i.setUint16(10,l.time,!0),i.setUint16(12,l.date,!0),i.setUint32(14,e.crc32,!0),i.setUint32(18,e.compressedSize,!0),i.setUint32(22,e.uncompressedSize,!0),i.setUint16(26,t.length,!0),i.setUint16(28,0,!0),s.set(t,30),n}#r(e){const t=new TextEncoder().encode(e.fileName),a=46+t.length,n=new ArrayBuffer(a),i=new DataView(n),s=new Uint8Array(n);i.setUint32(0,33639248,!0),i.setUint16(4,20,!0),i.setUint16(6,20,!0),i.setUint16(8,0,!0),i.setUint16(10,e.compressionMethod,!0);const l=this.#n(e.lastModified);return i.setUint16(12,l.time,!0),i.setUint16(14,l.date,!0),i.setUint32(16,e.crc32,!0),i.setUint32(20,e.compressedSize,!0),i.setUint32(24,e.uncompressedSize,!0),i.setUint16(28,t.length,!0),i.setUint16(30,0,!0),i.setUint16(32,0,!0),i.setUint16(34,0,!0),i.setUint16(36,0,!0),i.setUint32(38,0,!0),i.setUint32(42,e.localHeaderOffset,!0),s.set(t,46),n}#a(e,t,a){const n=new ArrayBuffer(22),i=new DataView(n);return i.setUint32(0,101010256,!0),i.setUint16(4,0,!0),i.setUint16(6,0,!0),i.setUint16(8,e,!0),i.setUint16(10,e,!0),i.setUint32(12,t,!0),i.setUint32(16,a,!0),i.setUint16(20,0,!0),n}#n(e){const t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),i=e.getHours(),s=e.getMinutes(),l=Math.floor(e.getSeconds()/2),c=t-1980<<9|a<<5|n,d=i<<11|s<<5|l;return{date:c,time:d}}#s(e){const t=this.#i();let a=4294967295;for(let n=0;n<e.length;n++){const i=e[n];a=a>>>8^t[(a^i)&255]}return(a^4294967295)>>>0}#i(){if(Zn._crcTable.length===0){const e=Array.from({length:256},()=>0);for(let t=0;t<256;t++){let a=t;for(let n=0;n<8;n++)a=a&1?3988292384^a>>>1:a>>>1;e[t]=a}Zn._crcTable=e}return Zn._crcTable}clear(){return this.#e=[],this}get fileCount(){return this.#e.length}getFileNames(){return this.#e.map(e=>e.fileName)}}const Hr="locales";function Ld(){return new Dd}class Dd{storage=Ot.getInstance();async needsUpdate(){return!0}async extractTranslations(){let e=globalThis.__EDITME_I18N_BUNDLE__,t;if(e)try{const n=e.split(",")[1];if(!n)throw new Error("Invalid data URL format: missing base64 data");const i=atob(n),s=new Uint8Array(i.length);for(let l=0;l<i.length;l++)s[l]=i.charCodeAt(l);t=s.buffer}catch(n){throw new Error(`Failed to decode embedded translation data: ${n instanceof Error?n.message:"Unknown error"}`)}finally{delete globalThis.__EDITME_I18N_BUNDLE__}else try{const n=await fetch("/i18n-bundle.zip");if(!n.ok)throw new Error(`Failed to fetch i18n-bundle.zip: ${n.status}`);t=await n.arrayBuffer()}catch{throw new Error('Translation data not found. For single file builds, please run "npm run build" to generate a new build with embedded translations.')}let a;try{a=new Ar(t)}catch(n){throw new Error(`Failed to parse ZIP archive: ${n instanceof Error?n.message:"Unknown error"}`)}this.storage.isInitialized()||await this.storage.init(),await this.storage.createWorkspace(Hr);for(const n of a.entries){if(!n.fileName.endsWith(".json"))continue;const s=await(await n.extract()).text();try{JSON.parse(s)}catch(l){throw new Error(`Invalid JSON in ${n.fileName}: ${l instanceof Error?l.message:"Unknown error"}`)}await this.storage.writeTextFile(Hr,n.fileName,s)}}async loadTranslations(){const e={};this.storage.isInitialized()||await this.storage.init();const a=(await this.storage.listFiles(Hr)).filter(n=>n.endsWith(".json"));for(const n of a)try{const i=await this.storage.readTextFile(Hr,n);let s;s=JSON.parse(i);const c=(n.split("/").pop()||n).replace(".json",""),d={locale:c,messages:this.extractMessages(s),headers:s[""]||{}};e[c]=d}catch{}return e}extractMessages(e){const t={};for(const[a,n]of Object.entries(e)){if(a==="")continue;const i=Array.isArray(n)?n[0]:n;typeof i=="string"&&(t[a]=i)}return t}}const zt=Jt({currentLocale:Rr,locales:Dr,catalogs:{},initialized:!1,loading:!1}),_i=zr(zt,r=>r.currentLocale);zr(zt,r=>r.loading);zr(zt,r=>r.initialized);zr(_i,r=>ka(r)?"rtl":"ltr");const oa={locale:"en",messages:{Save:"Save",Cancel:"Cancel",Delete:"Delete",Edit:"Edit",File:"File",Settings:"Settings",Workspace:"Workspace",Metadata:"Metadata",Manifest:"Manifest",Navigation:"Navigation","Spine Items":"Spine Items"},headers:{}},Rd=(r,e={})=>{const t=dn(zt);let n=t.catalogs[t.currentLocale]?.messages[r];if(!n&&t.currentLocale!=="en"&&(n=t.catalogs.en?.messages[r]||oa.messages[r]),n||(n=r),Object.keys(e).length>0)for(const[i,s]of Object.entries(e))n=n.replace(new RegExp(`\\{${i}\\}`,"g"),String(s));return n},dt=zr(zt,r=>(e,t={})=>{let n=r.catalogs[r.currentLocale]?.messages[e];if(!n&&r.currentLocale!=="en"&&(n=r.catalogs.en?.messages[e]||oa.messages[e]),n||(n=e),Object.keys(t).length>0)for(const[i,s]of Object.entries(t))n=n.replace(new RegExp(`\\{${i}\\}`,"g"),String(s));return n});async function fo(){const r=dn(zt);if(!(r.initialized||r.loading)){zt.update(e=>({...e,loading:!0}));try{const e=Ld();await e.extractTranslations();const t=await e.loadTranslations();t.en||(t.en=oa);const a=lo(),n=t[a]?a:Rr;typeof document<"u"&&(document.documentElement.setAttribute("data-dir",ka(n)?"rtl":"ltr"),document.documentElement.setAttribute("data-locale",n)),zt.update(i=>({...i,currentLocale:n,catalogs:t,initialized:!0,loading:!1}))}catch(e){console.error("Failed to initialize i18n:",e),zt.update(t=>({...t,currentLocale:Rr,catalogs:{en:oa},initialized:!0,loading:!1}))}}}async function Ad(r){const e=dn(zt);if(!e.initialized)throw new Error("i18n system not initialized");if(!Dr[r])throw new Error(`Unsupported locale: ${r}`);e.catalogs[r]||console.warn(`Translation catalog for ${r} not loaded, falling back to English`),typeof document<"u"&&(document.documentElement.setAttribute("data-dir",ka(r)?"rtl":"ltr"),document.documentElement.setAttribute("data-locale",r)),typeof localStorage<"u"&&localStorage.setItem("editme-locale",r),zt.update(t=>({...t,currentLocale:r}))}function Od(){const r=dn(zt);return Object.keys(r.locales).map(e=>r.locales[e])}const po={translate:Rd,getCurrentLocale:()=>dn(_i),setLocale:Ad,getAvailableLocales:Od,hasTranslation:(r,e)=>!!dn(zt).catalogs[r]?.messages[e],isLocaleSupported:r=>!!Dr[r],isRTL:ka,getCatalogs:()=>dn(zt).catalogs,isInitialized:()=>dn(zt).initialized,init:fo},qr="editme_theme_preference",Ud={current:"light",systemPreference:"light",isInitialized:!1};function zd(){const{subscribe:r,set:e,update:t}=Jt(Ud);return{subscribe:r,set:e,update:t,initialize(){let a=null,n="light";typeof window<"u"&&window.matchMedia&&(n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");try{const s=localStorage.getItem(qr);s&&Wd(s)&&(a=s)}catch(s){console.warn("Failed to load theme preference:",s)}const i=a||n;t(s=>({...s,current:i,systemPreference:n,isInitialized:!0})),vr(i),typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",l=>{const c=l.matches?"dark":"light";t(d=>({...d,systemPreference:c})),a||(t(d=>({...d,current:c})),vr(c))})},setTheme(a){t(n=>{try{localStorage.setItem(qr,a)}catch(i){console.warn("Failed to save theme preference:",i)}return vr(a),{...n,current:a}})},toggleTheme(){t(a=>{const n=a.current==="light"?"dark":"light";try{localStorage.setItem(qr,n)}catch(i){console.warn("Failed to save theme preference:",i)}return vr(n),{...a,current:n}})},useSystemPreference(){t(a=>{try{localStorage.removeItem(qr)}catch(n){console.warn("Failed to clear theme preference:",n)}return vr(a.systemPreference),{...a,current:a.systemPreference}})},getCurrentTheme(){return dn({subscribe:r}).current}}}function Wd(r){return r==="light"||r==="dark"}function vr(r){typeof document<"u"&&document.documentElement.setAttribute("data-theme",r)}const la=zd();typeof window<"u"&&la.initialize();var Nd=Ns('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-v7l3jb"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path></svg>'),jd=Ns('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-v7l3jb"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'),Bd=I('<span class="theme-toggle__label svelte-v7l3jb"> </span>'),$d=I('<button aria-label="Toggle theme"><span class="theme-toggle__icon svelte-v7l3jb" aria-hidden="true"><!></span> <!></button>');function Xi(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(la,"$themeStore",t),i=Ke(),s=Ke();let l=$(e,"size",8,"medium"),c=$(e,"showLabel",8,!0);function d(){la.toggleTheme()}_t(()=>n(),()=>{w(i,n().current)}),_t(()=>o(i),()=>{w(s,o(i)==="dark")}),sn(),Rt();var u=$d();let p;u.__click=d;var h=f(u),v=f(h);{var m=T=>{var E=Nd();_(T,E)},y=T=>{var E=jd();_(T,E)};j(v,T=>{o(s)?T(m):T(y,!1)})}var b=g(h,2);{var M=T=>{var E=Bd(),C=f(E);O(()=>x(C,o(s)?"Light":"Dark")),_(T,E)};j(b,T=>{c()&&T(M)})}O(T=>{p=st(u,1,"theme-toggle svelte-v7l3jb",null,p,T),ue(u,"title",`Switch to ${o(s)?"light":"dark"} theme`)},[()=>({"theme-toggle--small":l()==="small","theme-toggle--large":l()==="large"})],Te),_(r,u),nt(),a()}yt(["click"]);function Hd(){On.toggleSidebar()}function Ki(){const r=new CustomEvent("append-spine-item",{bubbles:!0});window.dispatchEvent(r)}var qd=I('<h2 class="sidebar-title svelte-trxc5p">SEED.html</h2> <div class="header-actions svelte-trxc5p"><!></div>',1),Vd=I('<div class="header-actions compact svelte-trxc5p"><!></div>'),Gd=I('<span class="workspace-extensions svelte-trxc5p"><!></span>'),Xd=I('<div class="workspace-title-header svelte-trxc5p"><h3 class="workspace-title svelte-trxc5p"> </h3> <!></div>'),Kd=I('<div class="extensions-indicator svelte-trxc5p"> </div>'),Yd=I('<div class="workspace-title-header compact svelte-trxc5p"><div class="workspace-title-compact svelte-trxc5p"> </div> <!></div>'),Jd=I('<div class="workspace-title-section svelte-trxc5p"><!></div>'),Zd=(r,e,t)=>e(o(t).id),Qd=I('<!> <button><span class="section-label svelte-trxc5p"><!></span></button>',1),eu=(r,e,t)=>e(o(t).id),tu=I('<button><span class="section-label svelte-trxc5p"><!></span></button>'),nu=I('<div class="spine-section-header svelte-trxc5p"><span class="section-label svelte-trxc5p"> </span> <button class="append-button-nav svelte-trxc5p"><span class="append-icon svelte-trxc5p">+</span></button></div>'),ru=I('<div class="spine-section-header compact svelte-trxc5p"><span class="section-label svelte-trxc5p"> </span> <button class="append-button-nav compact svelte-trxc5p"><span class="append-icon svelte-trxc5p">+</span></button></div>'),au=I('<aside><div class="sidebar-header svelte-trxc5p"><button class="sidebar-toggle svelte-trxc5p"> </button> <!></div> <div class="sidebar-main svelte-trxc5p"><nav class="sidebar-nav svelte-trxc5p"><!> <!> <!></nav> <div class="spine-items-container svelte-trxc5p"><!></div> <div class="section-content"><!> <!> <!> <!> <!> <!></div></div> <div class="sidebar-footer svelte-trxc5p"><!></div></aside>');function iu(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"isExpanded",3,!0),s=$(e,"activeSection",3,"workspace"),l=$(e,"hasWorkspace",3,!1),c=$(e,"currentWorkspace",3,null),d=$(e,"workspaceTitle",3,void 0),u=$(e,"extensionManager",3,null),p=Pe(Dt([])),h=Pe(!1);Et(()=>{c()?.id&&u()?(w(h,!0),u().listWorkspaceExtensions(c().id).then(te=>{w(p,te,!0),w(h,!1)}).catch(()=>{w(p,[],!0),w(h,!1)})):(w(p,[],!0),w(h,!1))});const v=[{id:"about",icon:"ℹ️",label:n()("About")},{id:"workspace",icon:"🏠",label:n()("Projects")},{id:"settings",icon:"⚙️",label:n()("Settings")},{id:"metadata",icon:"📄",label:n()("Metadata"),requiresWorkspace:!0},{id:"manifest",icon:"📋",label:n()("Manifest"),requiresWorkspace:!0},{id:"navigation",icon:"📖",label:n()("Navigation"),requiresWorkspace:!0}];function m(te){On.setSidebarSection(te)}function y(te){return!te.requiresWorkspace||l()}function b(te){return te.slice(0,2).toUpperCase()}var M=au();let T;var E=f(M),C=f(E);C.__click=[Hd];var k=f(C),X=g(C,2);{var P=te=>{var ae=qd(),be=g(Ye(ae),2),ke=f(be);Xi(ke,{size:"small",showLabel:!1}),_(te,ae)},z=te=>{var ae=Vd(),be=f(ae);Xi(be,{size:"small",showLabel:!1}),_(te,ae)};j(X,te=>{i()?te(P):te(z,!1)})}var U=g(E,2),F=f(U),S=f(F);kt(S,17,()=>v.filter(te=>!te.requiresWorkspace),It,(te,ae)=>{var be=Qd(),ke=Ye(be);{var We=ve=>{var me=lt(),Ee=Ye(me);{var He=ee=>{var Se=Jd(),ge=f(Se);{var Ge=G=>{var J=Xd(),de=f(J),we=f(de),q=g(de,2);{var se=ce=>{var pe=Gd(),ye=f(pe);{var Ce=Fe=>{var oe=Pt("Loading...");_(Fe,oe)},Ne=Fe=>{var oe=Pt();O(Ue=>x(oe,Ue),[()=>o(p).map(Ue=>Ue.name).join(", ")]),_(Fe,oe)};j(ye,Fe=>{o(h)?Fe(Ce):Fe(Ne,!1)})}_(ce,pe)};j(q,ce=>{(o(p).length>0||o(h))&&ce(se)})}O(()=>{ue(de,"title",d()||"Untitled Project"),x(we,d()||"Untitled Project")}),_(G,J)},H=G=>{var J=Yd(),de=f(J),we=f(de),q=g(de,2);{var se=ce=>{var pe=Kd(),ye=f(pe);O(Ce=>{ue(pe,"title",Ce),x(ye,`•${o(p).length??""}`)},[()=>o(p).map(Ce=>Ce.name).join(", ")]),_(ce,pe)};j(q,ce=>{o(p).length>0&&!o(h)&&ce(se)})}O(ce=>{ue(de,"title",d()||"Untitled Project"),x(we,ce)},[()=>(d()||"Untitled Project").slice(0,2).toUpperCase()]),_(G,J)};j(ge,G=>{i()?G(Ge):G(H,!1)})}_(ee,Se)};j(Ee,ee=>{l()&&c()&&ee(He)})}_(ve,me)};j(ke,ve=>{o(ae).id==="settings"&&ve(We)})}var je=g(ke,2);let Re;je.__click=[Zd,m,ae];var Be=f(je),Ae=f(Be);{var $e=ve=>{var me=Pt();O(Ee=>x(me,Ee),[()=>n()(o(ae).label)]),_(ve,me)},Ve=ve=>{var me=Pt();O(Ee=>x(me,Ee),[()=>b(n()(o(ae).label))]),_(ve,me)};j(Ae,ve=>{i()?ve($e):ve(Ve,!1)})}O((ve,me)=>{Re=st(je,1,"sidebar-section svelte-trxc5p",null,Re,ve),ue(je,"aria-current",s()===o(ae).id?"page":void 0),ue(je,"title",me)},[()=>({active:s()===o(ae).id}),()=>n()(o(ae).label)]),_(te,be)});var W=g(S,2);kt(W,17,()=>v.filter(te=>te.requiresWorkspace),It,(te,ae)=>{var be=lt(),ke=Ye(be);{var We=je=>{var Re=tu();let Be;Re.__click=[eu,m,ae];var Ae=f(Re),$e=f(Ae);{var Ve=me=>{var Ee=Pt();O(He=>x(Ee,He),[()=>n()(o(ae).label)]),_(me,Ee)},ve=me=>{var Ee=Pt();O(He=>x(Ee,He),[()=>b(n()(o(ae).label))]),_(me,Ee)};j($e,me=>{i()?me(Ve):me(ve,!1)})}O((me,Ee)=>{Be=st(Re,1,"sidebar-section svelte-trxc5p",null,Be,me),ue(Re,"aria-current",s()===o(ae).id?"page":void 0),ue(Re,"title",Ee)},[()=>({active:s()===o(ae).id}),()=>n()(o(ae).label)]),_(je,Re)};j(ke,je=>{y(o(ae))&&je(We)})}_(te,be)});var R=g(W,2);{var D=te=>{var ae=lt(),be=Ye(ae);{var ke=je=>{var Re=nu(),Be=f(Re),Ae=f(Be),$e=g(Be,2);$e.__click=[Ki],O((Ve,ve,me)=>{x(Ae,Ve),ue($e,"aria-label",ve),ue($e,"title",me)},[()=>n()("Chapters"),()=>n()("Append Item"),()=>n()("Append Item")]),_(je,Re)},We=je=>{var Re=ru(),Be=f(Re),Ae=f(Be),$e=g(Be,2);$e.__click=[Ki],O((Ve,ve,me)=>{x(Ae,Ve),ue($e,"aria-label",ve),ue($e,"title",me)},[()=>b(n()("Chapters")),()=>n()("Append Item"),()=>n()("Append Item")]),_(je,Re)};j(be,je=>{i()?je(ke):je(We,!1)})}_(te,ae)};j(R,te=>{l()&&te(D)})}var N=g(F,2),A=f(N);Mt(A,e,"sidebar-spine",{});var B=g(N,2),Q=f(B);Mt(Q,e,"sidebar-about",{});var le=g(Q,2);Mt(le,e,"sidebar-workspace",{});var Ie=g(le,2);Mt(Ie,e,"sidebar-metadata",{});var Me=g(Ie,2);Mt(Me,e,"sidebar-manifest",{});var Oe=g(Me,2);Mt(Oe,e,"sidebar-navigation",{});var Le=g(Oe,2);Mt(Le,e,"sidebar-settings",{});var fe=g(U,2),Y=f(fe);Mt(Y,e,"sidebar-footer",{}),O((te,ae,be)=>{T=st(M,1,"sidebar svelte-trxc5p",null,T,te),ue(C,"aria-expanded",i()),ue(C,"aria-label",ae),x(k,i()?"◀️":"▶️"),ue(F,"aria-label",be)},[()=>({collapsed:!i()}),()=>n()("Toggle sidebar"),()=>n()("Main navigation")]),_(r,M),nt(),a()}yt(["click"]);var su=I('<div class="pane-content svelte-4h1481"><!></div>'),ou=I('<div class="pane-content svelte-4h1481"><!></div>'),lu=I("<!> <!> <!>",1),cu=I('<div class="single-pane-container svelte-4h1481"><!></div>'),du=I('<div class="app-layout svelte-4h1481"><!> <div class="main-content svelte-4h1481"><!></div></div>');function uu(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(On,"$layoutStore",t),i=Ke(),s=Ke(),l=Ke();let c=$(e,"hasWorkspace",8,!1),d=$(e,"currentWorkspace",8,null),u=$(e,"workspaceTitle",8,void 0),p=$(e,"extensionManager",8,null);_t(()=>(o(i),n()),()=>{(T=>{w(i,T.sidebar)})(n())}),_t(()=>o(i),()=>{w(s,o(i).isExpanded?"250px":"48px")}),_t(()=>o(i),()=>{w(l,o(i).activeSection!=="workspace"&&o(i).activeSection!=="settings")}),sn();var h=du(),v=f(h);iu(v,{get isExpanded(){return o(i).isExpanded},get activeSection(){return o(i).activeSection},get hasWorkspace(){return c()},get currentWorkspace(){return d()},get workspaceTitle(){return u()},get extensionManager(){return p()},$$slots:{"sidebar-workspace":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-workspace",{}),_(T,C)},"sidebar-metadata":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-metadata",{}),_(T,C)},"sidebar-manifest":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-manifest",{}),_(T,C)},"sidebar-navigation":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-navigation",{}),_(T,C)},"sidebar-spine":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-spine",{}),_(T,C)},"sidebar-settings":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-settings",{}),_(T,C)},"sidebar-footer":(T,E)=>{var C=lt(),k=Ye(C);Mt(k,e,"sidebar-footer",{}),_(T,C)}}});var m=g(v,2),y=f(m);{var b=T=>{gd(T,{direction:"horizontal",autoSaveId:"editme-content-panes",children:(E,C)=>{var k=lu(),X=Ye(k);Gi(X,{defaultSize:50,minSize:25,children:(U,F)=>{var S=su(),W=f(S);Mt(W,e,"left-content",{}),_(U,S)},$$slots:{default:!0}});var P=g(X,2);bd(P,{});var z=g(P,2);Gi(z,{defaultSize:50,minSize:20,children:(U,F)=>{var S=ou(),W=f(S);Mt(W,e,"right-content",{}),_(U,S)},$$slots:{default:!0}}),_(E,k)},$$slots:{default:!0}})},M=T=>{var E=cu(),C=f(E);Mt(C,e,"left-content",{}),_(T,E)};j(y,T=>{o(l)?T(b):T(M,!1)})}O(()=>li(h,`grid-template-columns: ${o(s)??""} 1fr`)),_(r,h),nt(),a()}const In={CURRENT_VIEW:"editme_nav_current_view",VIEW_HISTORY:"editme_nav_view_history",VIEW_DATA:"editme_nav_view_data"},fu=20,Ua={currentView:"about",previousView:null,viewHistory:["about"],viewData:{},isTransitioning:!1,canNavigateBack:!1,canNavigateForward:!1},pu=["about","workspace","metadata","manifest","navigation","spine","settings"];function hu(){const{subscribe:r,set:e,update:t}=Jt(Ua),a={guards:new Map,nextId:1};let n=0;return{subscribe:r,set:e,update:t,initialize(){let p=Ua.currentView,h=[...Ua.viewHistory],v={};try{const b=localStorage.getItem(In.CURRENT_VIEW);b&&s(b)&&(p=b);const M=localStorage.getItem(In.VIEW_HISTORY);if(M){const E=JSON.parse(M);Array.isArray(E)&&E.every(s)&&(h=E)}const T=localStorage.getItem(In.VIEW_DATA);if(T){const E=JSON.parse(T);typeof E=="object"&&E!==null&&(v=E)}}catch(b){console.warn("Failed to load navigation state:",b)}n=h.length-1;const m=n>0,y=!1;t(b=>({...b,currentView:p,previousView:h.length>1?h[h.length-2]:null,viewHistory:h,viewData:v,canNavigateBack:m,canNavigateForward:y,isInitialized:!0})),u(p),On.subscribe(({sidebar:b})=>{let M=null;this.subscribe(E=>{M=E.currentView})(),b.activeSection!==M&&(navigator.userAgent.includes("Firefox")?queueMicrotask(()=>{this.navigateTo(b.activeSection,{replaceHistory:!0})}):this.navigateTo(b.activeSection,{replaceHistory:!0}))})},async navigateTo(p,h={}){if(!s(p))return console.error("Invalid view type:",p),!1;const v=i();if(v.currentView===p&&!h.force)return!0;t(m=>({...m,isTransitioning:!0}));try{if(!h.force&&!await l(v.currentView,p))return t(y=>({...y,isTransitioning:!1})),!1;if(v.currentView==="spine"&&p!=="spine"){const m=new CustomEvent("clear-spine-selection");window.dispatchEvent(m)}return await c(p,h),!0}catch(m){return console.error("Navigation error:",m),t(y=>({...y,isTransitioning:!1})),!1}},async canNavigate(p){const h=i(),v=p||h.currentView;if(!s(v))return!1;try{return await l(h.currentView,v)}catch(m){return console.error("Guard execution error:",m),!1}},async goBack(){const p=i();if(!p.canNavigateBack||n<=0)return!1;const h=p.viewHistory[n-1];return!h||!await l(p.currentView,h)?!1:(n--,await d(h,{isHistoryNavigation:!0}),!0)},async goForward(){const p=i();if(!p.canNavigateForward||n>=p.viewHistory.length-1)return!1;const h=p.viewHistory[n+1];return!h||!await l(p.currentView,h)?!1:(n++,await d(h,{isHistoryNavigation:!0}),!0)},setViewData(p,h){if(!s(p)){console.error("Invalid view type for setViewData:",p);return}t(v=>{const m={...v.viewData,[p]:h};try{localStorage.setItem(In.VIEW_DATA,JSON.stringify(m))}catch(y){console.warn("Failed to save view data:",y)}return{...v,viewData:m}})},getViewData(p){return s(p)?i().viewData[p]||null:(console.error("Invalid view type for getViewData:",p),null)},clearViewData(p){if(!s(p)){console.error("Invalid view type for clearViewData:",p);return}t(h=>{const v={...h.viewData};delete v[p];try{localStorage.setItem(In.VIEW_DATA,JSON.stringify(v))}catch(m){console.warn("Failed to save view data:",m)}return{...h,viewData:v}})},addNavigationGuard(p){const h=`guard_${a.nextId++}`;return a.guards.set(h,p),h},removeNavigationGuard(p){return a.guards.delete(p)}};function i(){let p;return r(h=>p=h)(),p}function s(p){return pu.includes(p)}async function l(p,h){const v=Array.from(a.guards.values());for(const m of v)try{if(!await m(p,h))return!1}catch(y){return console.error("Navigation guard error:",y),!1}return!0}async function c(p,h){const v=i();h.viewData&&t(y=>({...y,viewData:{...y.viewData,[p]:h.viewData}}));let m=[...v.viewHistory];h.replaceHistory?(m[m.length-1]=p,n=m.length-1):(m=m.slice(0,n+1),m.push(p),n=m.length-1,m.length>fu&&(m=m.slice(-20),n=m.length-1)),await d(p,{newHistory:m})}async function d(p,h={}){const v=i(),m=h.newHistory||v.viewHistory,y=n>0,b=n<m.length-1;t(M=>({...M,currentView:p,previousView:M.currentView,viewHistory:m,canNavigateBack:y,canNavigateForward:b,isTransitioning:!1}));try{localStorage.setItem(In.CURRENT_VIEW,p),localStorage.setItem(In.VIEW_HISTORY,JSON.stringify(m))}catch(M){console.warn("Failed to save navigation state:",M)}h.isHistoryNavigation||u(p)}function u(p){try{On.setSidebarSection(p)}catch(h){console.warn("Failed to sync to layout store:",h)}}}const Ct=hu();typeof window<"u"&&Ct.initialize();const vu=`SEED.html Freeware - License

This software is provided free of charge for personal, non-commercial use only.
You may not otherwise use this software without obtaining a separate commercial license agreement with the author.
You may not modify, decompile or reverse-engineer this software.
You may redistribute this software provided this license agreement and copyright notice are included in all copies.
The software is provided "as is" without warranty of any kind.
The author is not liable for any damages arising from its use.
Endangered Language Exception: This software can be used to create an EPUB file in which the majority of content is in an endangered language for any purpose without obtaining a seperate commercial license.

(c) 2025 Stewart Haines
`;var mu=I('<div class="about-view svelte-jmnys0"><div class="about-content svelte-jmnys0"><header class="about-header svelte-jmnys0"><h1 class="app-title svelte-jmnys0"> </h1> <p class="app-version svelte-jmnys0"> </p></header> <section class="about-section svelte-jmnys0"><h2 class="svelte-jmnys0"> </h2> <p class="svelte-jmnys0"> </p> <p class="svelte-jmnys0"><a href="https://stewarthaines.com/epub" target="_blank" rel="noopener noreferrer" class="external-link svelte-jmnys0"> </a></p> <p class="svelte-jmnys0"> </p></section> <section class="about-section svelte-jmnys0"><h2 class="svelte-jmnys0"> </h2> <pre class="license-text svelte-jmnys0"> </pre></section></div></div>');function gu(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i="0.4.1";Rt();var s=mu(),l=f(s),c=f(l),d=f(c),u=f(d),p=g(d,2),h=f(p),v=g(c,2),m=f(v),y=f(m),b=g(m,2),M=f(b),T=g(b,2),E=f(T),C=f(E),k=g(T,2),X=f(k),P=g(v,2),z=f(P),U=f(z),F=g(z,2),S=f(F);O((W,R,D,N,A,B,Q)=>{x(u,W),x(h,`${R??""}: ${i}`),x(y,D),x(M,N),x(C,A),x(X,B),x(U,Q),x(S,vu)},[()=>n()("about.subtitle"),()=>n()("about.version"),()=>n()("about.description.title"),()=>n()("about.description.content"),()=>n()("about.website.link"),()=>n()("about.attribution.content"),()=>n()("about.license.title")],Te),_(r,s),nt(),a()}var wu=I('<span class="library-version svelte-3a2w4e"> </span>'),yu=I('<div class="library-item svelte-3a2w4e"><h3 class="library-name svelte-3a2w4e"><a target="_blank" rel="noopener noreferrer" class="external-link svelte-3a2w4e"> </a> <!></h3> <p class="library-description svelte-3a2w4e"> </p> <p class="library-copyright svelte-3a2w4e"> </p></div>'),bu=I('<div class="thirdparty-view svelte-3a2w4e"><div class="thirdparty-content svelte-3a2w4e"><header class="thirdparty-header svelte-3a2w4e"><h1 class="svelte-3a2w4e"> </h1> <p class="thirdparty-intro svelte-3a2w4e"> </p></header> <section class="libraries-section svelte-3a2w4e"><div class="library-list svelte-3a2w4e"></div> <div class="mit-license-section svelte-3a2w4e"><h3 class="svelte-3a2w4e"> </h3> <pre class="license-text svelte-3a2w4e"></pre></div></section></div></div>');function xu(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=[{name:"Svelte",version:"^5.28.1",license:"MIT",url:"https://github.com/sveltejs/svelte",description:"Cybernetically enhanced web apps",copyright:"Copyright (c) 2016-present, sveltejs"},{name:"paneforge",version:"^1.0.0",license:"MIT",url:"https://github.com/svecosystem/paneforge",description:"Headless pane management for Svelte",copyright:"Copyright (c) 2024 Hunter Johnston <https://github.com/huntabyte> Copyright (c) 2023 Brian Vaughn <https://github.com/bvaughn>"},{name:"ndesmic/zip",version:"N/A",license:"MIT",url:"https://github.com/ndesmic/zip",description:"Browser-native ZIP implementation (substantial portions used)",copyright:"Copyright (c) 2021 ndesmic"}];Rt();var s=bu(),l=f(s),c=f(l),d=f(c),u=f(d),p=g(d,2),h=f(p),v=g(c,2),m=f(v);kt(m,5,()=>i,It,(E,C)=>{var k=yu(),X=f(k),P=f(X),z=f(P),U=g(P,2);{var F=N=>{var A=wu(),B=f(A);O(()=>x(B,`v${o(C).version??""}`)),_(N,A)};j(U,N=>{o(C).version!=="N/A"&&N(F)})}var S=g(X,2),W=f(S),R=g(S,2),D=f(R);O(()=>{ue(P,"href",o(C).url),x(z,o(C).name),x(W,o(C).description),x(D,o(C).copyright)}),_(E,k)});var y=g(m,2),b=f(y),M=f(b),T=g(b,2);T.textContent=`MIT License

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.`,O((E,C,k)=>{x(u,E),x(h,C),x(M,`${k??""}: MIT`)},[()=>n()("about.thirdparty.title"),()=>n()("about.thirdparty.intro"),()=>n()("about.thirdparty.license")],Te),_(r,s),nt(),a()}const _u=(r,e)=>{console.log("🎯 WorkspaceActionBar: Create New button clicked!"),e("createNewRequested"),console.log("🎯 WorkspaceActionBar: createNewRequested event dispatched")},Su=(r,e)=>{e("loadEpubRequested")};var Eu=I('<div class="workspace-action-bar svelte-4wg9d"><h3 class="section-title svelte-4wg9d"> </h3> <div class="action-buttons svelte-4wg9d"><button type="button" class="action-button primary svelte-4wg9d"><span class="button-icon svelte-4wg9d" aria-hidden="true">➕</span> <div class="button-content svelte-4wg9d"><span class="button-title svelte-4wg9d"> </span> <span class="button-subtitle svelte-4wg9d"> </span></div></button> <button type="button" class="action-button secondary svelte-4wg9d"><span class="button-icon svelte-4wg9d" aria-hidden="true">📁</span> <div class="button-content svelte-4wg9d"><span class="button-title svelte-4wg9d"> </span> <span class="button-subtitle svelte-4wg9d"> </span></div></button></div></div>');function ku(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=tn();let s=$(e,"isLoading",8,!1);Rt();var l=Eu(),c=f(l),d=f(c),u=g(c,2),p=f(u);p.__click=[_u,i];var h=g(f(p),2),v=f(h),m=f(v),y=g(v,2),b=f(y),M=g(p,2);M.__click=[Su,i];var T=g(f(M),2),E=f(T),C=f(E),k=g(E,2),X=f(k);O((P,z,U,F,S,W,R)=>{x(d,P),p.disabled=s(),ue(p,"aria-label",z),x(m,U),x(b,F),M.disabled=s(),ue(M,"aria-label",S),x(C,W),x(X,R)},[()=>n()("Get Started"),()=>n()("Create a new minimal EPUB project"),()=>n()("Create New"),()=>n()("Start fresh"),()=>n()("Load an existing EPUB file for editing"),()=>n()("Load EPUB"),()=>n()("Edit existing file")],Te),_(r,l),nt(),a()}yt(["click"]);const Tu=(r,e,t)=>{r.stopPropagation(),e("deleteRequested",{workspaceId:t().id})},Cu=(r,e)=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),e())};var Iu=I('<span class="workspace-icon error svelte-ijd5ei">⚠️</span>'),Fu=I('<span class="workspace-icon svelte-ijd5ei" aria-hidden="true">📖</span>'),Mu=I('<span class="workspace-author-inline svelte-ijd5ei"> </span>'),Pu=I('<span class="current-badge svelte-ijd5ei"> </span>'),Lu=I('<div role="button" tabindex="0"><div class="workspace-main svelte-ijd5ei"><div class="workspace-icon-container svelte-ijd5ei"><!></div> <div class="workspace-info svelte-ijd5ei"><div class="workspace-header svelte-ijd5ei"><h3 class="workspace-title svelte-ijd5ei"> <!> <!></h3> <span class="workspace-time svelte-ijd5ei"> </span></div> <div class="workspace-meta svelte-ijd5ei"><span class="workspace-language svelte-ijd5ei"> </span> <span class="meta-separator svelte-ijd5ei">•</span> <span class="workspace-stats svelte-ijd5ei"> <!> <!></span></div></div></div> <div class="workspace-actions svelte-ijd5ei"><button type="button" class="delete-button svelte-ijd5ei"><span aria-hidden="true">🗑️</span></button></div></div>');function Du(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=tn();let s=$(e,"workspace",8),l=$(e,"isCurrent",8,!1),c=$(e,"hasError",8,!1);const d=()=>{i("selected",{workspaceId:s().id})},u=fe=>{const te=new Date().getTime()-fe.getTime(),ae=Math.floor(te/(1e3*60*60)),be=Math.floor(ae/24);return ae<1?n()("Just now"):ae<24?n()("{count}h ago",{count:ae}):be===1?n()("1 day ago"):be<7?n()("{count} days ago",{count:be}):n()("{count}w ago",{count:Math.floor(be/7)})},p=fe=>{if(fe===0)return"0 B";const Y=1024,te=["B","KB","MB","GB"],ae=Math.floor(Math.log(fe)/Math.log(Y));return parseFloat((fe/Math.pow(Y,ae)).toFixed(1))+" "+te[ae]};Rt();var h=Lu();let v;h.__click=d,h.__keydown=[Cu,d];var m=f(h),y=f(m),b=f(y);{var M=fe=>{var Y=Iu();O((te,ae)=>{ue(Y,"aria-label",te),ue(Y,"title",ae)},[()=>n()("Error"),()=>n()("Project has errors")],Te),_(fe,Y)},T=fe=>{var Y=Fu();_(fe,Y)};j(b,fe=>{c()||s().hasError?fe(M):fe(T,!1)})}var E=g(y,2),C=f(E),k=f(C),X=f(k),P=g(X);{var z=fe=>{var Y=Mu(),te=f(Y);O(()=>x(te,`- ${s().author??""}`)),_(fe,Y)};j(P,fe=>{s().author&&fe(z)})}var U=g(P,2);{var F=fe=>{var Y=Pu(),te=f(Y);O((ae,be)=>{ue(Y,"aria-label",ae),x(te,be)},[()=>n()("Currently open"),()=>n()("Current")],Te),_(fe,Y)};j(U,fe=>{l()&&fe(F)})}var S=g(k,2),W=f(S),R=g(C,2),D=f(R),N=f(D),A=g(D,4),B=f(A),Q=g(B);{var le=fe=>{var Y=Pt();O(te=>x(Y,`• ${te??""}`),[()=>p(s().totalSize)],Te),_(fe,Y)};j(Q,fe=>{s().totalSize>0&&fe(le)})}var Ie=g(Q,2);{var Me=fe=>{var Y=Pt();O(te=>x(Y,`• ${te??""}`),[()=>s().extensionIds.join(", ")],Te),_(fe,Y)};j(Ie,fe=>{s().extensionIds&&s().extensionIds.length>0&&fe(Me)})}var Oe=g(m,2),Le=f(Oe);Le.__click=[Tu,i,s],O((fe,Y,te,ae,be,ke)=>{v=st(h,1,"workspace-item svelte-ijd5ei",null,v,fe),ue(h,"aria-label",Y),x(X,`${s().title??""} `),x(W,te),x(N,s().language),x(B,`${s().fileCount??""}
          ${ae??""} `),ue(Le,"aria-label",be),ue(Le,"title",ke)},[()=>({current:l(),error:c()||s().hasError}),()=>n()("Open project: {title}",{title:s().title}),()=>u(s().lastModified),()=>n()("files"),()=>n()("Delete project: {title}",{title:s().title}),()=>n()("Delete project")],Te),_(r,h),nt(),a()}yt(["click","keydown"]);var Ru=I('<button type="button" class="clear-search svelte-1juhm6m">×</button>'),Au=I('<div class="search-container svelte-1juhm6m"><div class="search-input-wrapper svelte-1juhm6m"><input type="search" class="search-input svelte-1juhm6m"/> <!></div></div>'),Ou=I('<div class="loading-state svelte-1juhm6m"><div class="skeleton-item svelte-1juhm6m" aria-hidden="true"></div> <div class="skeleton-item svelte-1juhm6m" aria-hidden="true"></div> <div class="skeleton-item svelte-1juhm6m" aria-hidden="true"></div> <p class="loading-text svelte-1juhm6m"> </p></div>'),Uu=I('<div class="empty-state svelte-1juhm6m"><div class="empty-tips svelte-1juhm6m"><h5 class="tips-title svelte-1juhm6m"> </h5> <ul class="tips-list svelte-1juhm6m"><li class="svelte-1juhm6m"> </li> <li class="svelte-1juhm6m"> </li> <li class="svelte-1juhm6m"><!></li></ul></div></div>'),zu=I('<div class="no-results svelte-1juhm6m"><div class="no-results-icon svelte-1juhm6m" aria-hidden="true">🔍</div> <h4 class="no-results-title svelte-1juhm6m"> </h4> <p class="no-results-description svelte-1juhm6m"> </p> <button type="button" class="clear-search-button svelte-1juhm6m"> </button></div>'),Wu=I('<div class="search-results-info svelte-1juhm6m"><p class="results-text svelte-1juhm6m"> </p></div>'),Nu=I('<div class="workspace-grid svelte-1juhm6m"></div> <!>',1),ju=I('<div class="workspace-list svelte-1juhm6m"><div class="list-header svelte-1juhm6m"><!></div> <div class="list-content svelte-1juhm6m"><!></div></div>');function Bu(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=Ke(),s=Ke(),l=tn();let c=$(e,"workspaces",24,()=>[]),d=$(e,"currentWorkspaceId",8,null),u=$(e,"isLoading",8,!1),p=Ke("");const h=U=>{l("workspaceSelected",U.detail)},v=U=>{l("workspaceDeleted",U.detail)},m=U=>{l("packageRequested",U.detail)},y=U=>{const F=U.target;w(p,F.value)},b=()=>{w(p,"")};_t(()=>(wt(c()),o(p)),()=>{w(i,c().filter(U=>{if(!o(p))return!0;const F=o(p).toLowerCase();return U.title.toLowerCase().includes(F)||U.author?.toLowerCase().includes(F)||U.language.toLowerCase().includes(F)}))}),_t(()=>o(i),()=>{w(s,[...o(i)].sort((U,F)=>F.lastModified.getTime()-U.lastModified.getTime()))}),sn(),Rt();var M=ju(),T=f(M),E=f(T);{var C=U=>{var F=Au(),S=f(F),W=f(S),R=g(W,2);{var D=N=>{var A=Ru();O(B=>ue(A,"aria-label",B),[()=>n()("Clear search")],Te),at("click",A,b),_(N,A)};j(R,N=>{o(p)&&N(D)})}O((N,A)=>{ue(W,"placeholder",N),An(W,o(p)),ue(W,"aria-label",A)},[()=>n()("Search projects…"),()=>n()("Search projects")],Te),at("input",W,y),_(U,F)};j(E,U=>{c().length>0&&U(C)})}var k=g(T,2),X=f(k);{var P=U=>{var F=Ou(),S=g(f(F),6),W=f(S);O(R=>x(W,R),[()=>n()("Loading projects…")],Te),_(U,F)},z=(U,F)=>{{var S=R=>{var D=Uu(),N=f(D),A=f(N),B=f(A),Q=g(A,2),le=f(Q),Ie=f(le),Me=g(le,2),Oe=f(Me),Le=g(Me,2),fe=f(Le);js(fe,()=>n()("Download: Start with a sample from {link}",{link:`<a target="_blank" href="https://stewarthaines.com/epub">${n()("SEED.html home page")}</a>`})),O((Y,te,ae)=>{x(B,Y),x(Ie,te),x(Oe,ae)},[()=>n()("Quick Start Tips:"),()=>n()("Create New: Start with a minimal project"),()=>n()("Load EPUB: Load .epub file from the filesystem")],Te),_(R,D)},W=(R,D)=>{{var N=B=>{var Q=zu(),le=g(f(Q),2),Ie=f(le),Me=g(le,2),Oe=f(Me),Le=g(Me,2),fe=f(Le);O((Y,te,ae)=>{x(Ie,Y),x(Oe,te),x(fe,ae)},[()=>n()("No projects found"),()=>n()('No projects match your search for "{query}"',{query:o(p)}),()=>n()("Clear search")],Te),at("click",Le,b),_(B,Q)},A=B=>{var Q=Nu(),le=Ye(Q);kt(le,5,()=>o(s),Oe=>Oe.id,(Oe,Le)=>{const fe=Te(()=>o(Le).id===d()),Y=Te(()=>o(Le).hasError||!1);Du(Oe,{get workspace(){return o(Le)},get isCurrent(){return o(fe)},get hasError(){return o(Y)},$$events:{selected:h,deleteRequested:v,packageRequested:m}})});var Ie=g(le,2);{var Me=Oe=>{var Le=Wu(),fe=f(Le),Y=f(fe);O(te=>x(Y,te),[()=>n()("Showing {filtered} of {total} workspaces",{filtered:o(i).length,total:c().length})],Te),_(Oe,Le)};j(Ie,Oe=>{o(p)&&o(i).length<c().length&&Oe(Me)})}_(B,Q)};j(R,B=>{o(i).length===0?B(N):B(A,!1)},D)}};j(U,R=>{c().length===0?R(S):R(W,!1)},F)}};j(X,U=>{u()?U(P):U(z,!1)})}_(r,M),nt(),a()}function mn(){return new Date().toISOString().replace(/\.\d{3}Z$/,"Z")}class xt{static parseContainerXml(e){try{if(!globalThis.DOMParser)return{error:"DOMParser not available"};const a=new DOMParser().parseFromString(e,"application/xml");if(a.querySelector("parsererror"))return{error:"Invalid XML in container.xml"};const i=a.querySelector("rootfile");if(!i)return{error:"No rootfile element found in container.xml"};const s=i.getAttribute("full-path");return s?s.endsWith(".opf")?{rootfilePath:s}:{error:`Rootfile does not appear to be an OPF file: ${s}`}:{error:"No full-path attribute found in rootfile element"}}catch(t){return{error:`Failed to parse container.xml: ${t instanceof Error?t.message:"Unknown error"}`}}}static validateXML(e){try{if(!globalThis.DOMParser)return{isValid:!1,error:"DOMParser not available"};const n=new DOMParser().parseFromString(e,"application/xml").querySelector("parsererror");return n?{isValid:!1,error:n.textContent||"Unknown XML parsing error"}:{isValid:!0}}catch(t){return{isValid:!1,error:t instanceof Error?t.message:"XML validation failed"}}}static parseOPFMetadata(e){const t="http://purl.org/dc/elements/1.1/";let a=e.getElementsByTagNameNS(t,"title");a.length===0&&(a=e.querySelectorAll("dc\\:title, title"));let n=e.getElementsByTagNameNS(t,"language");n.length===0&&(n=e.querySelectorAll("dc\\:language, language"));let i=e.getElementsByTagNameNS(t,"identifier");if(i.length===0&&(i=e.querySelectorAll("dc\\:identifier, identifier")),a.length===0||!a[0].textContent?.trim())throw new Error("Missing required dc:title in OPF metadata");if(n.length===0||!n[0].textContent?.trim())throw new Error("Missing required dc:language in OPF metadata");if(i.length===0||!i[0].textContent?.trim())throw new Error("Missing required dc:identifier in OPF metadata");let s=e.getElementsByTagNameNS(t,"creator");s.length===0&&(s=e.querySelectorAll("dc\\:creator, creator"));let l=e.getElementsByTagNameNS(t,"contributor");l.length===0&&(l=e.querySelectorAll("dc\\:contributor, contributor"));let c=e.getElementsByTagNameNS(t,"subject");c.length===0&&(c=e.querySelectorAll("dc\\:subject, subject"));const d=e.getElementsByTagNameNS(t,"publisher"),u=e.getElementsByTagNameNS(t,"date"),p=e.getElementsByTagNameNS(t,"description"),h=e.getElementsByTagNameNS(t,"rights"),v=e.getElementsByTagNameNS(t,"source"),m=e.getElementsByTagNameNS(t,"relation"),y=e.getElementsByTagNameNS(t,"coverage"),b=e.getElementsByTagNameNS(t,"type"),M=e.getElementsByTagNameNS(t,"format"),T=e.querySelectorAll('meta[property="dcterms:modified"]'),E=Array.from(s).map(S=>S.textContent?.trim()).filter(Boolean),C=Array.from(l).map(S=>S.textContent?.trim()).filter(Boolean),k=Array.from(c).map(S=>S.textContent?.trim()).filter(Boolean),X=e.querySelector('meta[property="rendition:layout"]'),P=e.querySelector('meta[property="rendition:orientation"]'),z=e.querySelector('meta[property="rendition:spread"]'),F=e.querySelector("spine")?.getAttribute("page-progression-direction");return{title:a[0].textContent.trim(),language:n[0].textContent.trim(),identifier:i[0].textContent.trim(),creator:E.length>0?E:void 0,contributor:C.length>0?C:void 0,publisher:d.length>0?d[0].textContent?.trim():void 0,date:u.length>0?u[0].textContent?.trim():void 0,description:p.length>0?p[0].textContent?.trim():void 0,subject:k.length>0?k:void 0,rights:h.length>0?h[0].textContent?.trim():void 0,source:v.length>0?v[0].textContent?.trim():void 0,relation:m.length>0?m[0].textContent?.trim():void 0,coverage:y.length>0?y[0].textContent?.trim():void 0,type:b.length>0?b[0].textContent?.trim():void 0,format:M.length>0?M[0].textContent?.trim():void 0,modifiedDate:T.length>0?T[0].textContent?.trim():void 0,renditionLayout:X?.textContent?.trim()||void 0,renditionOrientation:P?.textContent?.trim()||void 0,renditionSpread:z?.textContent?.trim()||void 0,pageProgressionDirection:F||void 0}}static parseOPFDocument(e){const t=this.validateXML(e);if(!t.isValid)throw new Error(`Invalid OPF XML: ${t.error}`);const n=new DOMParser().parseFromString(e,"application/xml"),s=n.querySelector("package")?.getAttribute("version")||"2.0",l=this.parseOPFMetadata(n),c=[];n.querySelectorAll("manifest item").forEach(m=>{const y=m.getAttribute("id"),b=m.getAttribute("href"),M=m.getAttribute("media-type");if(y&&b&&M){const T=m.getAttribute("properties"),E=m.getAttribute("fallback");c.push({id:y,href:b,mediaType:M,properties:T?T.split(" "):void 0,fallback:E||void 0})}});const u=[];n.querySelectorAll("spine itemref").forEach(m=>{const y=m.getAttribute("idref");if(y){const b=m.getAttribute("linear"),M=m.getAttribute("properties");u.push({idref:y,linear:b!=="no",properties:M?M.split(" "):void 0})}});const h=[];return n.querySelectorAll("guide reference").forEach(m=>{const y=m.getAttribute("type"),b=m.getAttribute("href");if(y&&b){const M=m.getAttribute("title");h.push({type:y,href:b,title:M||void 0})}}),{metadata:l,manifest:c,spine:u,guide:h.length>0?h:void 0,version:s}}static generateOPFXML(e){const{metadata:t,manifest:a,spine:n,guide:i,version:s}=e,l=u=>u.replace(/[<>&'"]/g,p=>{switch(p){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;";case"'":return"&apos;";default:return p}}),c=a.find(u=>u.id==="uuid")?.id||"uuid";let d=`<?xml version="1.0" encoding="utf-8"?>
<package version="${s}" xmlns="http://www.idpf.org/2007/opf" unique-identifier="${c}" prefix="rendition: http://www.idpf.org/vocab/rendition/# ibooks: http://vocabulary.itunes.apple.com/rdf/ibooks/vocabulary-extensions-1.0/">
  <metadata xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:ibooks="http://vocabulary.itunes.apple.com/rdf/ibooks/vocabularies/2012/01/ibooks-specific">
    <dc:title>${l(t.title)}</dc:title>
    <dc:language>${l(t.language)}</dc:language>
    <dc:identifier id="${c}">${l(t.identifier)}</dc:identifier>`;return t.creator&&t.creator.length>0&&t.creator.forEach(u=>{d+=`
    <dc:creator>${l(u)}</dc:creator>`}),t.contributor&&t.contributor.length>0&&t.contributor.forEach(u=>{d+=`
    <dc:contributor>${l(u)}</dc:contributor>`}),t.publisher&&(d+=`
    <dc:publisher>${l(t.publisher)}</dc:publisher>`),t.date&&(d+=`
    <dc:date>${l(t.date)}</dc:date>`),t.description&&(d+=`
    <dc:description>${l(t.description)}</dc:description>`),t.subject&&t.subject.length>0&&t.subject.forEach(u=>{d+=`
    <dc:subject>${l(u)}</dc:subject>`}),t.rights&&(d+=`
    <dc:rights>${l(t.rights)}</dc:rights>`),t.source&&(d+=`
    <dc:source>${l(t.source)}</dc:source>`),t.relation&&(d+=`
    <dc:relation>${l(t.relation)}</dc:relation>`),t.coverage&&(d+=`
    <dc:coverage>${l(t.coverage)}</dc:coverage>`),t.type&&(d+=`
    <dc:type>${l(t.type)}</dc:type>`),t.format&&(d+=`
    <dc:format>${l(t.format)}</dc:format>`),t.modifiedDate&&(d+=`
    <meta property="dcterms:modified">${l(t.modifiedDate)}</meta>`),t.renditionLayout&&t.renditionLayout!=="reflowable"&&(d+=`
    <meta property="rendition:layout">${l(t.renditionLayout)}</meta>`),t.renditionOrientation&&t.renditionOrientation!=="auto"&&(d+=`
    <meta property="rendition:orientation">${l(t.renditionOrientation)}</meta>`),t.renditionSpread&&t.renditionSpread!=="auto"&&(d+=`
    <meta property="rendition:spread">${l(t.renditionSpread)}</meta>`),d+=`
    <meta property="ibooks:specified-fonts">true</meta>`,d+=`
  </metadata>
  <manifest>`,a.forEach(u=>{d+=`
    <item id="${l(u.id)}" href="${l(u.href)}" media-type="${l(u.mediaType)}"`,u.properties&&u.properties.length>0&&(d+=` properties="${l(u.properties.join(" "))}"`),u.fallback&&(d+=` fallback="${l(u.fallback)}"`),d+=" />"}),d+=`
  </manifest>`,t.pageProgressionDirection&&t.pageProgressionDirection!=="default"?d+=`
  <spine page-progression-direction="${l(t.pageProgressionDirection)}">`:d+=`
  <spine>`,n.forEach(u=>{d+=`
    <itemref idref="${l(u.idref)}"`,u.linear===!1&&(d+=' linear="no"'),u.properties&&u.properties.length>0&&(d+=` properties="${l(u.properties.join(" "))}"`),d+=" />"}),d+=`
  </spine>`,i&&i.length>0&&(d+=`
  <guide>`,i.forEach(u=>{d+=`
    <reference type="${l(u.type)}" href="${l(u.href)}"`,u.title&&(d+=` title="${l(u.title)}"`),d+=" />"}),d+=`
  </guide>`),d+=`
</package>`,d}static detectEPUBVersion(e){try{if(!globalThis.DOMParser)return;const a=new DOMParser().parseFromString(e,"application/xml");if(a.querySelector("parsererror"))return;const i=a.querySelector("package");if(i){const s=i.getAttribute("version");if(s)return s.startsWith("2.")?"EPUB 2.0":s.startsWith("3.")?"EPUB 3.0":`EPUB ${s}`}return a.querySelector("[properties]")||a.querySelector("[epub\\:type]")?"EPUB 3.0":"EPUB 2.0"}catch{return}}static parseRootfilePath(e){const t=e.match(/<rootfile[^>]+full-path\s*=\s*["']([^"']+)["'][^>]*>/i);if(!t)throw new Error("Could not find rootfile path in container.xml");return t[1]}static generateContainerXML(e="OEBPS/content.opf"){return`<?xml version="1.0" encoding="UTF-8"?>
<container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
  <rootfiles>
    <rootfile full-path="${e}" media-type="application/oebps-package+xml"/>
  </rootfiles>
</container>`}static validateManifestSpineConsistency(e,t){const a=[],n=new Set(e.map(i=>i.id));return t.forEach((i,s)=>{n.has(i.idref)||a.push(`Spine item ${s} references non-existent manifest item: ${i.idref}`)}),a}}const $u={"application/xhtml+xml":"Text/","text/html":"Text/","text/css":"Styles/","text/javascript":"Scripts/","application/javascript":"Scripts/","image/jpeg":"Images/","image/png":"Images/","image/gif":"Images/","image/svg+xml":"Images/","image/webp":"Images/","audio/mpeg":"Audio/","audio/ogg":"Audio/","audio/wav":"Audio/","audio/mp4":"Audio/","video/mp4":"Video/","video/webm":"Video/","video/ogg":"Video/","font/ttf":"Fonts/","font/otf":"Fonts/","font/woff":"Fonts/","font/woff2":"Fonts/","application/font-woff":"Fonts/","application/pdf":"Misc/","text/plain":"Text/"};function Hu(r){const e=r.split(";")[0].trim().toLowerCase();return $u[e]||""}function Ka(r,e){return Hu(e)+r}const qu={html:"text/html",xhtml:"application/xhtml+xml",xml:"application/xml",css:"text/css",js:"application/javascript",txt:"text/plain",json:"application/json",opf:"application/oebps-package+xml",ncx:"application/x-dtbncx+xml",epub:"application/epub+zip",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",svg:"image/svg+xml",webp:"image/webp",mp3:"audio/mpeg",wav:"audio/wav",ogg:"audio/ogg",m4a:"audio/mp4",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg",gz:"application/gzip",zip:"application/zip"};function ho(r){const e=r.split(".").pop()?.toLowerCase();return qu[e||""]||"application/octet-stream"}function vo(r){const e=r.startsWith("SOURCE/")?r.substring(7):r;return e==="settings.json"?"settings":e.startsWith("text/")?"text":e.startsWith("scripts/")?"script":e.startsWith("extensions/")?"extension":"other"}function Vu(r){if(!r||typeof r!="string"||r.trim()==="")return!1;let e=r.trim();if(e=e.replace(/\\/g,"/"),!e.startsWith("SOURCE/")||e.startsWith("/")||/^[A-Za-z]:/.test(e)||e.includes(".."))return!1;const t=e.split("/").pop()?.toLowerCase()||"",a=["con","aux","prn","nul","com1","com2","com3","com4","com5","com6","com7","com8","com9","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9"],n=t.split(".")[0];return!(a.includes(n)||t===".ds_store"||t==="thumbs.db")}function Jn(r){return!r||typeof r!="string"?!1:r.startsWith("SOURCE/")&&r.length>7}function Gu(r){const e={isValid:!0,errors:[],warnings:[]};if(!r||r.trim()==="")return e.isValid=!1,e.errors.push("Empty settings"),e;let t;try{t=JSON.parse(r)}catch(i){e.isValid=!1;const s=`Invalid JSON syntax: ${i}`;return e.errors.push(s),e}const a=["version"];for(const i of a)i in t?(t[i]===null||t[i]===void 0)&&(e.isValid=!1,e.errors.push(`Field '${i}' cannot be null or undefined`)):(e.isValid=!1,e.errors.push(`Missing required field: ${i}`));"is_draft"in t&&typeof t.is_draft!="boolean"&&(e.isValid=!1,e.errors.push('Field "is_draft" must be a boolean')),"draft_id"in t&&typeof t.draft_id!="number"&&(e.isValid=!1,e.errors.push('Field "draft_id" must be a number')),"text_transform"in t&&typeof t.text_transform!="string"&&(e.isValid=!1,e.errors.push('Field "text_transform" must be a string')),"dom_transforms"in t&&!Array.isArray(t.dom_transforms)&&(e.isValid=!1,e.errors.push('Field "dom_transforms" must be an array')),"version"in t&&typeof t.version!="string"&&(e.isValid=!1,e.errors.push('Field "version" must be a string'));const n=["is_draft","draft_id","text_transform","dom_transforms","version"];for(const i in t)n.includes(i)||e.warnings.push(`Unknown field: ${i}`);return e}async function Xu(r,e){const a=(await r.listFiles(e)).filter(i=>Jn(i)),n={totalFiles:a.length,totalSize:0,directories:{text:0,scripts:0,extensions:0},hasSettingsFile:!1};for(const i of a){try{const s=await r.readFile(e,i);n.totalSize+=s.byteLength}catch{continue}i==="SOURCE/settings.json"&&(n.hasSettingsFile=!0),i.startsWith("SOURCE/text/")?n.directories.text++:i.startsWith("SOURCE/scripts/")?n.directories.scripts++:i.startsWith("SOURCE/extensions/")&&n.directories.extensions++}return n}function Ku(r){if(!r||typeof r!="string")return"";let e=r.trim();return e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/"),e=e.split("/").filter(n=>n!=="."&&n!=="").join("/"),e.length>1&&e.endsWith("/")&&(e=e.slice(0,-1)),e}const Yu={is_draft:!1,draft_id:1,text_transform:"markdown-transform.js",dom_transforms:["custom-dom.js"],version:"1.0.0"};class mo{constructor(e){this.fileStorage=e}async createSourceZip(e){try{if(!(await this.fileStorage.listWorkspaces()).includes(e))throw new Error(`Workspace ${e} not found`);const n=(await this.fileStorage.listFiles(e)).filter(s=>Jn(s));if(n.length===0)return null;const i=new Zn;for(const s of n)try{const l=await this.fileStorage.readFile(e,s);await i.addFile(s,l)}catch(l){throw new Error(`Failed to read file ${s}: ${l}`)}try{return await i.buildBlob()}catch(s){throw new Error(`ZIP creation failed: ${s}`)}}catch(t){throw t instanceof Error?t:new Error(`Failed to create SOURCE.zip: ${t}`)}}async extractSourceZip(e,t){try{const a=await t.arrayBuffer(),n=new Ar(a);for(const i of n.entries){const s=Ku(i.fileName);if(!Vu(s))throw new Error(`Invalid file path: ${i.fileName}`);try{const c=await(await i.extract()).arrayBuffer();await this.fileStorage.writeFile(e,s,c)}catch(l){throw new Error(`Failed to write file ${s}: ${l}`)}}}catch(a){throw a instanceof Error?a:new Error(`Failed to extract SOURCE.zip: ${a}`)}}async hasSourceFiles(e){try{return(await this.fileStorage.listFiles(e)).filter(n=>Jn(n)).length>0}catch(t){throw new Error(`Failed to check SOURCE/ files: ${t}`)}}async listSourceFiles(e){try{const a=(await this.fileStorage.listFiles(e)).filter(i=>Jn(i)).filter(i=>!i.endsWith(".gitkeep")),n=[];for(const i of a)try{const s=await this.fileStorage.readFile(e,i),l={path:i,size:s.byteLength,type:vo(i)};n.push(l)}catch{continue}return n}catch(t){throw new Error(`Failed to list SOURCE/ files: ${t}`)}}async initializeSourceStructure(e){try{const t="SOURCE/settings.json";if(!await this.fileStorage.fileExists(e,t)){const a=JSON.stringify(Yu,null,2);await this.fileStorage.writeTextFile(e,t,a)}}catch(t){throw new Error(`Failed to initialize SOURCE/ structure: ${t}`)}}async validateSourceStructure(e){const t={isValid:!0,errors:[],warnings:[],fileCount:0,totalSize:0,hasSettings:!1};try{const n=(await this.fileStorage.listFiles(e)).filter(i=>Jn(i));t.fileCount=n.length;for(const i of n)try{const s=await this.fileStorage.readFile(e,i);if(t.totalSize+=s.byteLength,i==="SOURCE/settings.json"){t.hasSettings=!0;const c=new TextDecoder().decode(s),d=Gu(c);d.isValid||(t.isValid=!1,t.errors.push(...d.errors.map(u=>`Invalid settings.json format: ${u}`))),t.warnings.push(...d.warnings)}const l=i.substring(7);!l.includes("/")&&i!=="SOURCE/settings.json"&&t.warnings.push(`Unexpected file in SOURCE/ root: ${l}`)}catch{continue}t.hasSettings||t.warnings.push("Missing settings.json file")}catch(a){t.isValid=!1,t.errors.push(`Failed to validate SOURCE/ structure: ${a}`)}return t}async getSourceDirectoryStats(e){try{return await Xu(this.fileStorage,e)}catch(t){throw new Error(`Failed to get SOURCE/ directory statistics: ${t}`)}}}class Si{fileStorage;sourceManager;constructor(){this.fileStorage=Ot.getInstance(),this.sourceManager=new mo(this.fileStorage)}async packageEPUB(e,t={}){const a=Date.now();try{const n=await this.readWorkspaceFiles(e);if(n.length===0)return{success:!1,error:"Workspace is empty"};const i=await this.extractMetadata(n),s=new Zn,l=n.reduce((p,h)=>p+h.size,0);let c=0;for(let p=0;p<n.length;p++){const h=n[p],v=this.optimizeCompression(h.path,h.content);await s.addFile(h.path,h.content,{compressionMethod:v.method,lastModified:new Date}),c+=h.size,t.progressCallback?.({phase:"compressing",currentFile:h.path,processedFiles:p+1,totalFiles:n.length,currentBytes:c,totalBytes:l})}t.progressCallback?.({phase:"writing",processedFiles:n.length,totalFiles:n.length,currentBytes:l,totalBytes:l});const d=await s.buildBlob(),u=this.generateFilename(i);return t.progressCallback?.({phase:"complete",processedFiles:n.length,totalFiles:n.length,currentBytes:l,totalBytes:l}),{success:!0,blob:d,filename:u,totalSize:l,compressedSize:d.size,fileCount:n.length,processingTime:Date.now()-a}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error",processingTime:Date.now()-a}}}async readWorkspaceFiles(e){const t=await this.fileStorage.listFiles(e),a=t.filter(s=>s.startsWith("SOURCE/")),n=t.filter(s=>!s.startsWith("SOURCE/")),i=[];for(const s of n)try{const l=await this.fileStorage.readFile(e,s);i.push({path:s,content:l,size:l.byteLength,mimeType:ho(s)})}catch(l){console.warn(`Failed to read file ${s}:`,l)}if(a.length>0)try{const s=await this.sourceManager.createSourceZip(e);if(s){const l=await s.arrayBuffer();i.push({path:"SOURCE.zip",content:l,size:l.byteLength,mimeType:"application/zip"})}}catch(s){console.warn("Failed to create SOURCE.zip:",s)}return i}async extractMetadata(e){const t=e.find(u=>u.path==="META-INF/container.xml");if(!t)throw new Error("Missing META-INF/container.xml file - invalid EPUB structure");const a=new TextDecoder,n=a.decode(t.content),i=xt.parseRootfilePath(n),s=e.find(u=>u.path===i);if(!s)throw new Error(`Missing OPF file at path: ${i}`);const l=a.decode(s.content),d=new DOMParser().parseFromString(l,"application/xml");return xt.parseOPFMetadata(d)}optimizeCompression(e,t){if(e==="mimetype")return{method:0,reason:"EPUB compliance requirement"};const a=e.split(".").pop()?.toLowerCase();return["jpg","jpeg","png","gif","mp3","mp4","webp","zip"].includes(a||"")?{method:0,reason:"Already compressed format"}:["html","xhtml","xml","css","js","txt","opf","ncx"].includes(a||"")?{method:8,reason:"Text-based content compresses well"}:{method:8,reason:"Default compression"}}generateFilename(e){const t=this.sanitizeFilename(e.title||"Untitled"),a=e.creator?.[0]?this.sanitizeFilename(e.creator[0]):null,n=new Date().toISOString().split("T")[0],i=[t];return a&&i.push(a),i.push(n),`${i.join(" - ")}.epub`}sanitizeFilename(e){return e.replace(/[<>:"/\\|?*]/g,"").replace(/\s+/g," ").trim().substring(0,50)}downloadEPUB(e,t){Pd(e,t)}}var Ju=I('<div class="error-banner svelte-9tke9n"><span class="error-icon svelte-9tke9n" aria-hidden="true">⚠️</span> <span class="error-text svelte-9tke9n"> </span> <button type="button" class="retry-button svelte-9tke9n"> </button></div>'),Zu=I('<div class="unsaved-indicator svelte-9tke9n"><span class="indicator-icon svelte-9tke9n" aria-hidden="true">⚠️</span> <span> </span></div>'),Qu=I('<div class="workspace-view svelte-9tke9n"><main class="view-content svelte-9tke9n"><!> <!>  <!> <!></main></div>');function ef(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=()=>Qe(_i,"$currentLocale",t);let s=$(e,"onWorkspaceChange",3,null),l=$(e,"currentWorkspaceId",3,null),c=Pe(Dt([])),d=Pe(null),u=Pe(!1),p=Pe(null),h=Pe(!1),v=Pe(""),m=Pe(!1);const y=new Si;Et(()=>{l()&&o(c).length>0?w(d,o(c).find(Y=>Y.id===l())||null,!0):w(d,null)});const b=async Y=>{if(Y){w(d,o(c).find(te=>te.id===Y)||null,!0),localStorage.setItem("currentWorkspace",Y);try{await e.onLoadWorkspace(Y)}catch(te){console.error("Failed to load workspace:",te)}}else w(d,null),localStorage.removeItem("currentWorkspace");s()&&s()(Y),e.onWorkspaceChanged?.(Y)},M=()=>{},T=async()=>{try{w(u,!0),w(p,null),w(c,await e.onListWorkspaces(),!0),M()}catch(Y){console.error("Failed to load workspaces:",Y),w(p,n()("Failed to load projects"),!0),w(c,[],!0)}finally{w(u,!1)}},E=()=>({title:"Untitled Book Project",identifier:crypto.randomUUID(),creator:["Unknown"]}),C=async()=>{try{w(u,!0);const Y=i(),te=E(),ae=await e.onCreateWorkspace({title:te.title||"Untitled Book Project",language:Y});console.log("✅ Workspace created:",ae),await T(),await b(ae),e.onNavigationRequested?.("metadata",ae),e.onWorkspaceOpened?.(ae)}catch(Y){console.error("Failed to create workspace:",Y),alert(n()("Failed to create workspace: {error}",{error:Y instanceof Error?Y.message:"Unknown error"}))}finally{w(u,!1)}},k=async()=>{try{w(u,!0),await e.onEpubImportRequested(),await T()}catch(Y){console.error("Failed to import EPUB:",Y),alert(n()("Failed to import EPUB: {error}",{error:Y instanceof Error?Y.message:"Unknown error"}))}finally{w(u,!1)}},X=async Y=>{const{workspaceId:te}=Y.detail;try{await b(te),e.onSmartNavigationRequested?.(te),e.onWorkspaceOpened?.(te)}catch(ae){console.error("Failed to open workspace:",ae),alert(n()("Failed to open workspace: {error}",{error:ae instanceof Error?ae.message:"Unknown error"}))}},P=async Y=>{const{workspaceId:te}=Y.detail,ae=o(c).find(ke=>ke.id===te);if(!(!ae||!confirm(n()('Delete "{title}"? This cannot be undone.',{title:ae.title}))))try{w(u,!0),await e.onDeleteWorkspace(te),await T(),l()===te&&await b(null)}catch(ke){console.error("Failed to delete workspace:",ke),alert(n()("Failed to delete workspace: {error}",{error:ke instanceof Error?ke.message:"Unknown error"}))}finally{w(u,!1)}},z=async Y=>{const{workspaceId:te}=Y.detail;if(o(c).find(be=>be.id===te))try{w(m,!0);const be=await y.packageEPUB(te,{progressCallback:ke=>{console.log(`Packaging progress: ${ke.phase} - ${ke.processedFiles}/${ke.totalFiles} files`)}});if(be.success&&be.blob&&be.filename)y.downloadEPUB(be.blob,be.filename),console.log(`✅ Successfully packaged and downloaded: ${be.filename}`);else throw new Error(be.error||"Unknown packaging error")}catch(be){console.error("Failed to package EPUB:",be),alert(n()("Failed to package EPUB: {error}",{error:be instanceof Error?be.message:"Unknown error"}))}finally{w(m,!1)}};async function U(){return o(h)?window.confirm(n()("You have unsaved project changes. Continue?")):!0}function F(Y){}function S(){}function W(){return{currentWorkspaceId:l(),hasUnsavedChanges:o(h)}}async function R(Y){Y.currentWorkspaceId&&await b(Y.currentWorkspaceId),Y.hasUnsavedChanges!==void 0&&w(h,Y.hasUnsavedChanges,!0)}const D=()=>{T()};on(async()=>{w(v,Ct.addNavigationGuard(U),!0),window.addEventListener("workspace-list-refresh",D),await T()}),cr(()=>{o(v)&&Ct.removeNavigationGuard(o(v)),window.removeEventListener("workspace-list-refresh",D)});var N=Qu(),A=f(N),B=f(A);ku(B,{get isLoading(){return o(u)},$$events:{createNewRequested:C,loadEpubRequested:k}});var Q=g(B,2);{var le=Y=>{var te=Ju(),ae=g(f(te),2),be=f(ae),ke=g(ae,2);ke.__click=T;var We=f(ke);O(je=>{x(be,o(p)),x(We,je)},[()=>n()("Retry")]),_(Y,te)};j(Q,Y=>{o(p)&&Y(le)})}var Ie=g(Q,2);const Me=ne(()=>o(u)||o(m));Bu(Ie,{get workspaces(){return o(c)},get currentWorkspaceId(){return l()},get isLoading(){return o(Me)},$$events:{workspaceSelected:X,workspaceDeleted:P,packageRequested:z}});var Oe=g(Ie,2);{var Le=Y=>{var te=Zu(),ae=g(f(te),2),be=f(ae);O(ke=>x(be,ke),[()=>n()("You have unsaved changes")]),_(Y,te)};j(Oe,Y=>{o(h)&&Y(Le)})}_(r,N);var fe=nt({canLeave:U,onViewEnter:F,onViewLeave:S,getViewData:W,setViewData:R});return a(),fe}yt(["click"]);var tf=I('<span class="error-indicator svelte-z75kp3">!</span>'),nf=I('<button><span class="tab-label svelte-z75kp3"> </span> <!></button>');function rf(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=tn();let s=$(e,"id",8,""),l=$(e,"label",8,""),c=$(e,"active",8,!1),d=$(e,"errorCount",8,0),u=$(e,"disabled",8,!1);const p=()=>{u()||i("click",{tabId:s()})},h=E=>{(E.key==="Enter"||E.key===" ")&&!u()&&(E.preventDefault(),i("click",{tabId:s()}))};Rt();var v=nf();let m;var y=f(v),b=f(y),M=g(y,2);{var T=E=>{var C=tf();O(k=>ue(C,"aria-label",k),[()=>n()("validation.errorsCount",{count:d()})],Te),_(E,C)};j(M,E=>{d()>0&&E(T)})}O(E=>{m=st(v,1,"metadata-tab svelte-z75kp3",null,m,E),v.disabled=u(),ue(v,"aria-controls",`metadata-panel-${s()??""}`),ue(v,"id",`metadata-tab-${s()??""}`),x(b,l())},[()=>({active:c(),"has-errors":d()>0,disabled:u()})],Te),at("click",v,p),at("keydown",v,h),_(r,v),nt(),a()}var af=I('<div class="metadata-tab-bar svelte-1pzcjt6" tabindex="-1"></div>');function sf(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=tn();let s=$(e,"activeTab",8,"basic"),l=$(e,"validationErrors",24,()=>[]),c=$(e,"tabs",24,()=>[{id:"basic",label:n()("metadata.tab.basic")},{id:"advanced",label:n()("metadata.tab.advanced")},{id:"publication",label:n()("metadata.tab.publication")},{id:"accessibility",label:n()("metadata.tab.accessibility")}]);const d=v=>{const m=u(v);return l().filter(y=>m.includes(y.field)).length},u=v=>{switch(v){case"basic":return["title","language","identifier","creator"];case"advanced":return["publisher","date","description","subject","rights","source","relation","coverage","type","format","contributor"];case"publication":return["series","seriesPosition","epubVersion","uniqueIdentifierScheme","primaryCreatorFileAs","creatorRoles"];case"accessibility":return["accessMode","accessModeSufficient","accessibilityFeature","accessibilityHazard","accessibilitySummary","accessibilityCertification","accessibilityCertifier"];default:return[]}},p=v=>{i("tabClick",v.detail)};Rt();var h=af();kt(h,5,c,It,(v,m)=>{const y=Te(()=>s()===o(m).id),b=Te(()=>d(o(m).id));rf(v,{get id(){return o(m).id},get label(){return o(m).label},get active(){return o(y)},get errorCount(){return o(b)},$$events:{click:p}})}),_(r,h),nt(),a()}const of=(r,e,t)=>{w(e,r.target.value,!0),t.onchange?.({value:o(e)})},lf=(r,e,t)=>{r.key==="Enter"&&(w(e,r.target.value,!0),t.onblur?.({value:o(e)}))};var cf=I('<span class="field-error svelte-cp96ig" role="alert"> </span>'),df=I("<label><!></label>"),uf=I('<div class="metadata-field svelte-cp96ig"><!> <input type="text"/></div>');function rn(r,e){tt(e,!0);let t=$(e,"value",3,""),a=$(e,"placeholder",3,""),n=$(e,"required",3,!1),i=$(e,"disabled",3,!1),s=$(e,"error",3,""),l=$(e,"label",3,""),c=$(e,"id",3,""),d=Pe(Dt(t()));Et(()=>{w(d,t())});let u=ne(()=>n()&&(!o(d)||o(d).trim()===""));const p=T=>{w(d,T.target.value,!0),e.onblur?.({value:o(d)})},h=()=>{e.onfocus?.({field:c()})};var v=uf(),m=f(v);{var y=T=>{var E=df();let C;var k=f(E);{var X=z=>{var U=cf(),F=f(U);O(()=>{ue(U,"id",`${c()??""}-error`),x(F,s())}),_(z,U)},P=z=>{var U=Pt();O(()=>x(U,l())),_(z,U)};j(k,z=>{s()?z(X):z(P,!1)})}O(z=>{ue(E,"for",c()),C=st(E,1,"field-label svelte-cp96ig",null,C,z)},[()=>({"needs-attention":o(u)})]),_(T,E)};j(m,T=>{l()&&T(y)})}var b=g(m,2);let M;b.__input=[of,d,e],b.__keydown=[lf,d,e],O(T=>{ue(b,"id",c()),ue(b,"placeholder",a()),b.required=n(),b.disabled=i(),M=st(b,1,"field-input svelte-cp96ig",null,M,T),ue(b,"aria-describedby",s()?`${c()}-error`:void 0),ue(b,"aria-invalid",!!s()||o(u))},[()=>({error:!!s(),"needs-attention":o(u)})]),at("blur",b,p),at("focus",b,h),Sr(b,()=>o(d),T=>w(d,T)),_(r,v),nt()}yt(["input","keydown"]);const ff=(r,e)=>{const t=r.target;e.onblur?.({value:t.value})},pf=(r,e)=>{r.key==="Enter"&&e.onblur?.({value:r.target.value})};var hf=I('<div class="field-error svelte-bssb4o" role="alert"> </div>'),vf=I("<label><!></label>"),mf=I("<option> </option>"),gf=I("<option> </option>"),wf=I('<div class="metadata-field svelte-bssb4o"><!> <select><!><!></select></div>');function Gn(r,e){tt(e,!0);let t=$(e,"value",3,""),a=$(e,"options",19,()=>[]),n=$(e,"required",3,!1),i=$(e,"disabled",3,!1),s=$(e,"error",3,""),l=$(e,"label",3,""),c=$(e,"id",3,""),d=$(e,"placeholder",3,""),u=ne(()=>n()&&(!t()||t().trim()===""));const p=X=>{const P=X.target;e.onblur?.({value:P.value})},h=()=>{e.onfocus?.({field:c()})};var v=wf(),m=f(v);{var y=X=>{var P=vf();let z;var U=f(P);{var F=W=>{var R=hf(),D=f(R);O(()=>{ue(R,"id",`${c()??""}-error`),x(D,s())}),_(W,R)},S=W=>{var R=Pt();O(()=>x(R,l())),_(W,R)};j(U,W=>{s()?W(F):W(S,!1)})}O(W=>{ue(P,"for",c()),z=st(P,1,"field-label svelte-bssb4o",null,z,W)},[()=>({"needs-attention":o(u)})]),_(X,P)};j(m,X=>{l()&&X(y)})}var b=g(m,2);Mr(b,t);var M;let T;b.__change=[ff,e],b.__keydown=[pf,e];var E=f(b);{var C=X=>{var P=mf();P.value=P.__value="";var z=f(P);O(()=>x(z,d())),_(X,P)};j(E,X=>{d()&&!n()&&X(C)})}var k=g(E);kt(k,17,a,It,(X,P)=>{var z=gf(),U={},F=f(z);O(()=>{U!==(U=o(P).value)&&(z.value=(z.__value=o(P).value)??""),x(F,o(P).label)}),_(X,z)}),O(X=>{ue(b,"id",c()),M!==(M=t())&&(b.value=(b.__value=t())??"",Rn(b,t())),b.required=n(),b.disabled=i(),T=st(b,1,"field-select svelte-bssb4o",null,T,X),ue(b,"aria-describedby",s()?`${c()}-error`:void 0),ue(b,"aria-invalid",!!s()||o(u))},[()=>({error:!!s(),"needs-attention":o(u)})]),at("blur",b,p),at("focus",b,h),_(r,v),nt()}yt(["change","keydown"]);const yf=(r,e)=>{e.onchange?.({value:r.target.value})},bf=(r,e)=>{r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),e.onblur?.({value:r.target.value}))};var xf=I('<span class="required svelte-1c704qf">*</span>'),_f=I("<label> <!></label>"),Sf=I('<div class="field-error svelte-1c704qf" role="alert"> </div>'),Ef=I('<div class="metadata-field svelte-1c704qf"><!> <textarea></textarea> <!></div>');function kf(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"value",3,""),s=$(e,"placeholder",3,""),l=$(e,"required",3,!1),c=$(e,"disabled",3,!1),d=$(e,"error",3,""),u=$(e,"label",3,""),p=$(e,"id",3,""),h=$(e,"rows",3,4),v=ne(()=>l()&&(!i()||i().trim()===""));const m=P=>{e.onblur?.({value:P.target.value})},y=()=>{e.onfocus?.({field:p()})};var b=Ef(),M=f(b);{var T=P=>{var z=_f();let U;var F=f(z),S=g(F);{var W=R=>{var D=xf();O(N=>ue(D,"aria-label",N),[()=>n()("Required field")]),_(R,D)};j(S,R=>{l()&&R(W)})}O(R=>{ue(z,"for",p()),U=st(z,1,"field-label svelte-1c704qf",null,U,R),x(F,`${u()??""} `)},[()=>({"needs-attention":o(v)})]),_(P,z)};j(M,P=>{u()&&P(T)})}var E=g(M,2);let C;E.__input=[yf,e],E.__keydown=[bf,e];var k=g(E,2);{var X=P=>{var z=Sf(),U=f(z);O(()=>{ue(z,"id",`${p()??""}-error`),x(U,d())}),_(P,z)};j(k,P=>{d()&&P(X)})}O(P=>{ue(E,"id",p()),An(E,i()),ue(E,"placeholder",s()),E.required=l(),E.disabled=c(),ue(E,"rows",h()),C=st(E,1,"field-textarea svelte-1c704qf",null,C,P),ue(E,"aria-describedby",d()?`${p()}-error`:void 0),ue(E,"aria-invalid",!!d()||o(v))},[()=>({error:!!d(),"needs-attention":o(v)})]),at("blur",E,m),at("focus",E,y),_(r,b),nt(),a()}yt(["input","keydown"]);const Tf=(r,e)=>{e.ongenerateIdentifier?.(new CustomEvent("generateIdentifier"))};var Cf=I('<div class="array-item svelte-1nofkco"><!> <button type="button" class="remove-button svelte-1nofkco">×</button></div>'),If=(r,e)=>e("creator"),Ff=I('<div class="basic-info-fields svelte-1nofkco" tabindex="-1"><div class="form-columns svelte-1nofkco" tabindex="-1"><div class="column svelte-1nofkco" tabindex="-1"><fieldset class="field-group svelte-1nofkco" tabindex="-1"><legend class="group-title svelte-1nofkco" tabindex="-1"> </legend> <!> <!> <div class="identifier-field svelte-1nofkco"><!> <button type="button" class="generate-button svelte-1nofkco"> </button></div></fieldset> <fieldset class="field-group svelte-1nofkco"><legend class="group-title svelte-1nofkco" tabindex="-1"> </legend> <div class="array-field svelte-1nofkco"><!> <button type="button" class="add-button svelte-1nofkco"> </button></div></fieldset></div> <div class="column svelte-1nofkco"><fieldset class="field-group svelte-1nofkco"><legend class="group-title svelte-1nofkco" tabindex="-1"> </legend> <!></fieldset> <fieldset class="field-group svelte-1nofkco"><legend class="group-title svelte-1nofkco" tabindex="-1"> </legend> <!> <!> <!> <!></fieldset></div></div></div>');function Mf(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"metadata",19,()=>({title:"",language:"",identifier:""})),s=$(e,"validationErrors",19,()=>[]),l=$(e,"saving",3,!1);const c=[{value:"en",label:"English"},{value:"de",label:"Deutsch"},{value:"es",label:"Español"},{value:"fr",label:"Français"},{value:"it",label:"Italiano"},{value:"pt",label:"Português"},{value:"ja",label:"日本語"},{value:"zh",label:"中文"},{value:"ar",label:"العربية"},{value:"he",label:"עברית"},{value:"ka",label:"ქართული"}],d=[{value:"reflowable",label:n()("Reflowable")},{value:"pre-paginated",label:n()("Pre-paginated")}],u=[{value:"default",label:n()("Default")},{value:"ltr",label:n()("Left to Right")},{value:"rtl",label:n()("Right to Left")}],p=[{value:"auto",label:n()("Auto")},{value:"landscape",label:n()("Landscape")},{value:"portrait",label:n()("Portrait")}],h=[{value:"auto",label:n()("Auto")},{value:"none",label:n()("None")},{value:"both",label:n()("Both")}],v=V=>{const he=s().find(K=>K.field===V);return he?he.message:""},m=(V,he)=>{e.onfieldChange?.(new CustomEvent("fieldChange",{detail:{field:V,value:he}}))},y=(V,he)=>{e.onfieldSave?.(new CustomEvent("fieldSave",{detail:{field:V,value:he}}))},b=V=>{e.onfieldFocus?.(new CustomEvent("fieldFocus",{detail:{field:V}}))},M=V=>{e.onarrayAdd?.(new CustomEvent("arrayAdd",{detail:{field:V}}))},T=(V,he)=>{e.onarrayRemove?.(new CustomEvent("arrayRemove",{detail:{field:V,index:he}}))},E=(V,he,K)=>{},C=(V,he)=>{const K=[...i().creator||[]];K[V]=he,e.onfieldSave?.(new CustomEvent("fieldSave",{detail:{field:"creator",value:K}}))};var k=Ff(),X=f(k),P=f(X),z=f(P),U=f(z),F=f(U),S=g(U,2);const W=ne(()=>n()("Title")),R=ne(()=>i().title||""),D=ne(()=>n()("Enter book title")),N=ne(()=>v("title"));rn(S,{id:"title",get label(){return o(W)},get value(){return o(R)},get placeholder(){return o(D)},required:!0,get error(){return o(N)},onchange:V=>m("title",V.value),onblur:V=>y("title",V.value),onfocus:()=>b("title")});var A=g(S,2);const B=ne(()=>n()("Language")),Q=ne(()=>i().language||""),le=ne(()=>n()("Select language")),Ie=ne(()=>v("language"));Gn(A,{id:"language",get label(){return o(B)},get value(){return o(Q)},get options(){return c},get placeholder(){return o(le)},required:!0,get error(){return o(Ie)},onchange:V=>m("language",V.value),onblur:V=>y("language",V.value),onfocus:()=>b("language")});var Me=g(A,2),Oe=f(Me);const Le=ne(()=>n()("Identifier")),fe=ne(()=>i().identifier||""),Y=ne(()=>n()("Enter a unique identifier")),te=ne(()=>v("identifier"));rn(Oe,{id:"identifier",get label(){return o(Le)},get value(){return o(fe)},get placeholder(){return o(Y)},required:!0,get error(){return o(te)},onchange:V=>m("identifier",V.value),onblur:V=>y("identifier",V.value),onfocus:()=>b("identifier")});var ae=g(Oe,2);ae.__click=[Tf,e];var be=f(ae),ke=g(z,2),We=f(ke),je=f(We),Re=g(We,2),Be=f(Re);kt(Be,17,()=>i().creator||[],It,(V,he,K)=>{var xe=Cf(),L=f(xe);const re=ne(()=>n()("Author name")),ie=ne(()=>v(`creator[${K}]`));rn(L,{id:`creator-${K}`,get value(){return o(he)},get placeholder(){return o(re)},get error(){return o(ie)},onchange:ze=>E("creator",K,ze.value),onblur:ze=>C(K,ze.value),onfocus:()=>b("creator")});var _e=g(L,2);_e.__click=()=>T("creator",K),O(ze=>{_e.disabled=l(),ue(_e,"aria-label",ze)},[()=>n()("Remove author")]),_(V,xe)});var Ae=g(Be,2);Ae.__click=[If,M];var $e=f(Ae),Ve=g(P,2),ve=f(Ve),me=f(ve),Ee=f(me),He=g(me,2);const ee=ne(()=>i().description||""),Se=ne(()=>n()("Enter book description")),ge=ne(()=>v("description"));kf(He,{id:"description",label:void 0,get value(){return o(ee)},get placeholder(){return o(Se)},get error(){return o(ge)},rows:3,onchange:V=>m("description",V.value),onblur:V=>y("description",V.value),onfocus:()=>b("description")});var Ge=g(ve,2),H=f(Ge),G=f(H),J=g(H,2);const de=ne(()=>n()("Layout")),we=ne(()=>i().renditionLayout||"reflowable"),q=ne(()=>v("renditionLayout"));Gn(J,{id:"renditionLayout",get label(){return o(de)},get value(){return o(we)},get options(){return d},get error(){return o(q)},onchange:V=>m("renditionLayout",V.value),onblur:V=>y("renditionLayout",V.value),onfocus:()=>b("renditionLayout")});var se=g(J,2);const ce=ne(()=>n()("Page Progression")),pe=ne(()=>i().pageProgressionDirection||"default"),ye=ne(()=>v("pageProgressionDirection"));Gn(se,{id:"pageProgressionDirection",get label(){return o(ce)},get value(){return o(pe)},get options(){return u},get error(){return o(ye)},onchange:V=>m("pageProgressionDirection",V.value),onblur:V=>y("pageProgressionDirection",V.value),onfocus:()=>b("pageProgressionDirection")});var Ce=g(se,2);const Ne=ne(()=>n()("Orientation")),Fe=ne(()=>i().renditionOrientation||"auto"),oe=ne(()=>v("renditionOrientation"));Gn(Ce,{id:"renditionOrientation",get label(){return o(Ne)},get value(){return o(Fe)},get options(){return p},get error(){return o(oe)},onchange:V=>m("renditionOrientation",V.value),onblur:V=>y("renditionOrientation",V.value),onfocus:()=>b("renditionOrientation")});var Ue=g(Ce,2);const Je=ne(()=>n()("Spread")),De=ne(()=>i().renditionSpread||"auto"),Z=ne(()=>v("renditionSpread"));Gn(Ue,{id:"renditionSpread",get label(){return o(Je)},get value(){return o(De)},get options(){return h},get error(){return o(Z)},onchange:V=>m("renditionSpread",V.value),onblur:V=>y("renditionSpread",V.value),onfocus:()=>b("renditionSpread")}),O((V,he,K,xe,L,re)=>{x(F,V),ae.disabled=l(),x(be,he),x(je,K),Ae.disabled=l(),x($e,xe),x(Ee,L),x(G,re)},[()=>n()("Essential Information"),()=>n()("Generate"),()=>n()("Authors"),()=>n()("Add Another Author"),()=>n()("Description"),()=>n()("Rendition Properties")]),_(r,k),nt(),a()}yt(["click"]);const Pf=(r,e)=>{e.onchange?.({value:r.target.value})},Lf=(r,e)=>{const t=new Date().toISOString().split("T")[0];e.onchange?.({value:t}),e.onblur?.({value:t})};var Df=I('<span class="required svelte-14vfa0w">*</span>'),Rf=I("<label> <!></label>"),Af=I('<button type="button" class="today-button svelte-14vfa0w"> </button>'),Of=I('<div class="field-error svelte-14vfa0w" role="alert"> </div>'),Uf=I('<div class="metadata-field svelte-14vfa0w"><!> <div class="date-input-wrapper svelte-14vfa0w"><input type="date"/> <!></div> <!></div>');function zf(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"value",3,""),s=$(e,"required",3,!1),l=$(e,"disabled",3,!1),c=$(e,"error",3,""),d=$(e,"label",3,""),u=$(e,"id",3,""),p=ne(()=>s()&&(!i()||i().trim()===""));const h=z=>{e.onblur?.({value:z.target.value})},v=()=>{e.onfocus?.({field:u()})};var m=Uf(),y=f(m);{var b=z=>{var U=Rf();let F;var S=f(U),W=g(S);{var R=D=>{var N=Df();O(A=>ue(N,"aria-label",A),[()=>n()("Required field")]),_(D,N)};j(W,D=>{s()&&D(R)})}O(D=>{ue(U,"for",u()),F=st(U,1,"field-label svelte-14vfa0w",null,F,D),x(S,`${d()??""} `)},[()=>({"needs-attention":o(p)})]),_(z,U)};j(y,z=>{d()&&z(b)})}var M=g(y,2),T=f(M);let E;T.__input=[Pf,e];var C=g(T,2);{var k=z=>{var U=Af();U.__click=[Lf,e];var F=f(U);O((S,W)=>{ue(U,"aria-label",S),x(F,W)},[()=>n()("Set to today"),()=>n()("Today")]),_(z,U)};j(C,z=>{l()||z(k)})}var X=g(M,2);{var P=z=>{var U=Of(),F=f(U);O(()=>{ue(U,"id",`${u()??""}-error`),x(F,c())}),_(z,U)};j(X,z=>{c()&&z(P)})}O(z=>{ue(T,"id",u()),An(T,i()),T.required=s(),T.disabled=l(),E=st(T,1,"field-input svelte-14vfa0w",null,E,z),ue(T,"aria-describedby",c()?`${u()}-error`:void 0),ue(T,"aria-invalid",!!c())},[()=>({error:!!c(),"needs-attention":o(p)})]),at("blur",T,h),at("focus",T,v),_(r,m),nt(),a()}yt(["input","click"]);var Wf=I('<div class="array-item svelte-fuok1"><!> <button type="button" class="remove-button svelte-fuok1">×</button></div>'),Nf=(r,e)=>e("subject"),jf=I('<div class="array-item svelte-fuok1"><!> <button type="button" class="remove-button svelte-fuok1">×</button></div>'),Bf=(r,e)=>e("contributor"),$f=I('<div class="advanced-fields svelte-fuok1"><div class="form-columns svelte-fuok1"><div class="column svelte-fuok1"><fieldset class="field-group svelte-fuok1"><legend class="group-title svelte-fuok1" tabindex="-1"> </legend> <!> <!> <!> <!></fieldset> <fieldset class="field-group svelte-fuok1"><legend class="group-title svelte-fuok1" tabindex="-1"> </legend> <!> <!> <!> <!></fieldset></div> <div class="column svelte-fuok1"><fieldset class="field-group svelte-fuok1"><legend class="group-title svelte-fuok1" tabindex="-1"> </legend> <div class="array-field svelte-fuok1"><!> <button type="button" class="add-button svelte-fuok1"> </button></div></fieldset> <fieldset class="field-group svelte-fuok1"><legend class="group-title svelte-fuok1" tabindex="-1"> </legend> <div class="array-field svelte-fuok1"><!> <button type="button" class="add-button svelte-fuok1"> </button></div></fieldset></div></div></div>');function Hf(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"metadata",19,()=>({title:"",language:"",identifier:""})),s=$(e,"validationErrors",19,()=>[]),l=$(e,"saving",3,!1);const c=[{value:"fiction",label:n()("Fiction")},{value:"non-fiction",label:n()("Non-fiction")},{value:"poetry",label:n()("Poetry")},{value:"drama",label:n()("Drama")},{value:"biography",label:n()("Biography")},{value:"textbook",label:n()("Textbook")},{value:"reference",label:n()("Reference")},{value:"children",label:n()("Children")}],d=K=>{const xe=s().find(L=>L.field===K);return xe?xe.message:""},u=(K,xe)=>{e.onfieldChange?.(new CustomEvent("fieldChange",{detail:{field:K,value:xe}}))},p=(K,xe)=>{e.onfieldSave?.(new CustomEvent("fieldSave",{detail:{field:K,value:xe}}))},h=K=>{e.onfieldFocus?.(new CustomEvent("fieldFocus",{detail:{field:K}}))},v=K=>{e.onarrayAdd?.(new CustomEvent("arrayAdd",{detail:{field:K}}))},m=(K,xe)=>{e.onarrayRemove?.(new CustomEvent("arrayRemove",{detail:{field:K,index:xe}}))},y=(K,xe,L)=>{},b=(K,xe)=>{const L=[...i().subject||[]];L[K]=xe,p("subject",L)},M=(K,xe)=>{const L=[...i().contributor||[]];L[K]=xe,p("contributor",L)};var T=$f(),E=f(T),C=f(E),k=f(C),X=f(k),P=f(X),z=g(X,2);const U=ne(()=>n()("Publisher")),F=ne(()=>i().publisher||""),S=ne(()=>n()("Enter publisher name")),W=ne(()=>d("publisher"));rn(z,{id:"publisher",get label(){return o(U)},get value(){return o(F)},get placeholder(){return o(S)},get error(){return o(W)},onchange:K=>u("publisher",K.value),onblur:K=>p("publisher",K.value),onfocus:()=>h("publisher")});var R=g(z,2);const D=ne(()=>n()("Publication Date")),N=ne(()=>i().date||""),A=ne(()=>d("date"));zf(R,{id:"date",get label(){return o(D)},get value(){return o(N)},get error(){return o(A)},onchange:K=>u("date",K.value),onblur:K=>p("date",K.value),onfocus:()=>h("date")});var B=g(R,2);const Q=ne(()=>n()("Rights")),le=ne(()=>i().rights||""),Ie=ne(()=>n()("Enter copyright information")),Me=ne(()=>d("rights"));rn(B,{id:"rights",get label(){return o(Q)},get value(){return o(le)},get placeholder(){return o(Ie)},get error(){return o(Me)},onchange:K=>u("rights",K.value),onblur:K=>p("rights",K.value),onfocus:()=>h("rights")});var Oe=g(B,2);const Le=ne(()=>n()("Content Type")),fe=ne(()=>i().type||""),Y=ne(()=>n()("Select content type")),te=ne(()=>d("type"));Gn(Oe,{id:"type",get label(){return o(Le)},get value(){return o(fe)},get options(){return c},get placeholder(){return o(Y)},get error(){return o(te)},onchange:K=>u("type",K.value),onblur:K=>p("type",K.value),onfocus:()=>h("type")});var ae=g(k,2),be=f(ae),ke=f(be),We=g(be,2);const je=ne(()=>n()("Source")),Re=ne(()=>i().source||""),Be=ne(()=>n()("Enter source information")),Ae=ne(()=>d("source"));rn(We,{id:"source",get label(){return o(je)},get value(){return o(Re)},get placeholder(){return o(Be)},get error(){return o(Ae)},onchange:K=>u("source",K.value),onblur:K=>p("source",K.value),onfocus:()=>h("source")});var $e=g(We,2);const Ve=ne(()=>n()("Relation")),ve=ne(()=>i().relation||""),me=ne(()=>n()("Enter related work information")),Ee=ne(()=>d("relation"));rn($e,{id:"relation",get label(){return o(Ve)},get value(){return o(ve)},get placeholder(){return o(me)},get error(){return o(Ee)},onchange:K=>u("relation",K.value),onblur:K=>p("relation",K.value),onfocus:()=>h("relation")});var He=g($e,2);const ee=ne(()=>n()("Coverage")),Se=ne(()=>i().coverage||""),ge=ne(()=>n()("Enter spatial or temporal coverage")),Ge=ne(()=>d("coverage"));rn(He,{id:"coverage",get label(){return o(ee)},get value(){return o(Se)},get placeholder(){return o(ge)},get error(){return o(Ge)},onchange:K=>u("coverage",K.value),onblur:K=>p("coverage",K.value),onfocus:()=>h("coverage")});var H=g(He,2);const G=ne(()=>n()("Format")),J=ne(()=>i().format||""),de=ne(()=>n()("Enter format information")),we=ne(()=>d("format"));rn(H,{id:"format",get label(){return o(G)},get value(){return o(J)},get placeholder(){return o(de)},get error(){return o(we)},onchange:K=>u("format",K.value),onblur:K=>p("format",K.value),onfocus:()=>h("format")});var q=g(C,2),se=f(q),ce=f(se),pe=f(ce),ye=g(ce,2),Ce=f(ye);kt(Ce,17,()=>i().subject||[],It,(K,xe,L)=>{var re=Wf(),ie=f(re);const _e=ne(()=>n()("Subject or keyword")),ze=ne(()=>d(`subject[${L}]`));rn(ie,{id:`subject-${L}`,get value(){return o(xe)},get placeholder(){return o(_e)},get error(){return o(ze)},onchange:Xe=>y("subject",L,Xe.value),onblur:Xe=>b(L,Xe.value),onfocus:()=>h("subject")});var qe=g(ie,2);qe.__click=()=>m("subject",L),O(Xe=>{qe.disabled=l(),ue(qe,"aria-label",Xe)},[()=>n()("Remove subject")]),_(K,re)});var Ne=g(Ce,2);Ne.__click=[Nf,v];var Fe=f(Ne),oe=g(se,2),Ue=f(oe),Je=f(Ue),De=g(Ue,2),Z=f(De);kt(Z,17,()=>i().contributor||[],It,(K,xe,L)=>{var re=jf(),ie=f(re);const _e=ne(()=>n()("Contributor name")),ze=ne(()=>d(`contributor[${L}]`));rn(ie,{id:`contributor-${L}`,get value(){return o(xe)},get placeholder(){return o(_e)},get error(){return o(ze)},onchange:Xe=>y("contributor",L,Xe.value),onblur:Xe=>M(L,Xe.value),onfocus:()=>h("contributor")});var qe=g(ie,2);qe.__click=()=>m("contributor",L),O(Xe=>{qe.disabled=l(),ue(qe,"aria-label",Xe)},[()=>n()("Remove contributor")]),_(K,re)});var V=g(Z,2);V.__click=[Bf,v];var he=f(V);O((K,xe,L,re,ie,_e)=>{x(P,K),x(ke,xe),x(pe,L),Ne.disabled=l(),x(Fe,re),x(Je,ie),V.disabled=l(),x(he,_e)},[()=>n()("Publication"),()=>n()("Additional Information"),()=>n()("Subjects"),()=>n()("Add Another Subject"),()=>n()("Contributors"),()=>n()("Add Another Contributor")]),_(r,T),nt(),a()}yt(["click"]);class vn extends Error{constructor(e,t,a){super(e),this.code=t,this.workspaceId=a,this.name="MetadataServiceError"}}class Yi extends vn{constructor(e,t,a){super(e,"VALIDATION_FAILED",a),this.validationResults=t,this.name="MetadataValidationError"}}class qf{constructor(e){this.workspaceService=e}loadMetadata(e){return e.opf.metadata}async updateField(e,t,a){try{const n={[t]:a},i=this.validateMetadataUpdates(n);if(i.some(s=>s.type==="error"))throw new Yi("Field validation failed",i,e.id);return await this.workspaceService.updateMetadata(e,n)}catch(n){throw n instanceof vn?n:new vn(`Failed to update field ${String(t)}: ${n instanceof Error?n.message:"Unknown error"}`,"UPDATE_ERROR",e.id)}}async updateMetadata(e,t){try{const a=this.validateMetadataUpdates(t);if(a.filter(i=>i.type==="error").length>0)throw new Yi("Metadata validation failed",a,e.id);return await this.workspaceService.updateMetadata(e,t)}catch(a){throw a instanceof vn?a:new vn(`Failed to update metadata: ${a instanceof Error?a.message:"Unknown error"}`,"UPDATE_ERROR",e.id)}}async addArrayItem(e,t,a=""){try{const n=e.opf.metadata[t]||[],i={[t]:[...n,a||this.getDefaultArrayValue(t)]};return await this.workspaceService.updateMetadata(e,i)}catch(n){throw new vn(`Failed to add ${t} item: ${n instanceof Error?n.message:"Unknown error"}`,"ARRAY_ADD_ERROR",e.id)}}async removeArrayItem(e,t,a){try{const n=e.opf.metadata[t]||[];if(a<0||a>=n.length)throw new vn(`Invalid index ${a} for ${t} array`,"INVALID_INDEX",e.id);const i=[...n];i.splice(a,1);const s={[t]:i};return await this.workspaceService.updateMetadata(e,s)}catch(n){throw n instanceof vn?n:new vn(`Failed to remove ${t} item: ${n instanceof Error?n.message:"Unknown error"}`,"ARRAY_REMOVE_ERROR",e.id)}}validateMetadata(e){const t=[];return e.title?.trim()||t.push({field:"title",message:"Title is required",type:"error"}),e.language?.trim()||t.push({field:"language",message:"Language is required",type:"error"}),e.identifier?.trim()||t.push({field:"identifier",message:"Identifier is required",type:"error"}),e.language&&!/^[a-z]{2}(-[A-Z]{2})?$/.test(e.language)&&t.push({field:"language",message:'Invalid language code format (use ISO 639-1, e.g., "en" or "en-US")',type:"warning"}),e.title&&e.title.length>200&&t.push({field:"title",message:"Title should be under 200 characters",type:"warning"}),e.creator&&e.creator.some(a=>!a.trim())&&t.push({field:"creator",message:"Creator entries cannot be empty",type:"warning"}),t}validateMetadataUpdates(e){const t=[];return e.title!==void 0&&!e.title.trim()&&t.push({field:"title",message:"Title cannot be empty",type:"error"}),e.language!==void 0&&(e.language.trim()?/^[a-z]{2}(-[A-Z]{2})?$/.test(e.language)||t.push({field:"language",message:"Invalid language code format",type:"warning"}):t.push({field:"language",message:"Language cannot be empty",type:"error"})),e.identifier!==void 0&&!e.identifier.trim()&&t.push({field:"identifier",message:"Identifier cannot be empty",type:"error"}),t}getDefaultArrayValue(e){switch(e){case"creator":return"Unknown Author";case"contributor":return"Unknown Contributor";case"subject":return"New Subject";default:return""}}}var Vf=I('<div class="loading-state svelte-17s3g49"><p> </p></div>'),Gf=(r,e)=>w(e,null),Xf=I('<div class="error-state svelte-17s3g49"><p class="error-message svelte-17s3g49"> </p> <button type="button" class="retry-button svelte-17s3g49"> </button></div>'),Kf=I('<div class="placeholder-panel svelte-17s3g49"><p class="svelte-17s3g49"> </p> <p class="placeholder-description svelte-17s3g49"> </p></div>'),Yf=I('<div class="placeholder-panel svelte-17s3g49"><p class="svelte-17s3g49"> </p> <p class="placeholder-description svelte-17s3g49"> </p></div>'),Jf=I('<div class="tab-panel svelte-17s3g49" tabindex="-1"><!></div>'),Zf=I('<div class="metadata-editor svelte-17s3g49"><div class="pane-header svelte-17s3g49" tabindex="-1"><!></div> <div class="pane-content svelte-17s3g49" tabindex="-1"><!></div></div>');function Qf(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=tn();let s=$(e,"workspace",15,null),l=ne(()=>s()?.opf.metadata??{title:"",language:"",identifier:""}),c=ne(()=>e.metadataService.validateMetadata(o(l))),d=ne(()=>!s()),u=Pe("basic"),p=Pe(!1),h=Pe(null),v=ne(()=>[{id:"basic",label:n()("Basic Info")},{id:"advanced",label:n()("Advanced")},{id:"publication",label:n()("Publication Details")},{id:"accessibility",label:n()("Accessibility")}]);const m=W=>{},y=W=>{i("fieldFocus",W.detail)},b=async W=>{const{field:R,value:D}=W.detail;if(!s())return;const N={[R]:D};if(!(e.metadataService.validateMetadataUpdates(N).filter(Q=>Q.type==="error").length>0))try{s(await e.metadataService.updateField(s(),R,D)),i("metadataChanged",{field:R,value:D}),w(h,null)}catch(Q){console.error(`Failed to save field ${R}:`,Q),w(h,n()("Failed to save metadata field"),!0)}},M=async W=>{const{field:R}=W.detail;if(s())try{w(p,!0),(R==="creator"||R==="subject"||R==="contributor")&&(s(await e.metadataService.addArrayItem(s(),R)),i("metadataChanged",{field:R,value:s().opf.metadata[R]})),w(h,null)}catch(D){console.error(`Failed to add ${R}:`,D),w(h,n()("Failed to add metadata item"),!0)}finally{w(p,!1)}},T=async W=>{const{field:R,index:D}=W.detail;if(s())try{w(p,!0),(R==="creator"||R==="subject"||R==="contributor")&&(s(await e.metadataService.removeArrayItem(s(),R,D)),i("metadataChanged",{field:R,value:s().opf.metadata[R]})),w(h,null)}catch(N){console.error(`Failed to remove ${R}:`,N),w(h,n()("Failed to remove metadata item"),!0)}finally{w(p,!1)}},E=async()=>{const W=`urn:uuid:${crypto.randomUUID()}`;await b({detail:{field:"identifier",value:W}})},C=async W=>{const R=W.detail.tabId;w(u,R,!0)};var k=Zf(),X=f(k),P=f(X);sf(P,{get activeTab(){return o(u)},get validationErrors(){return o(c)},get tabs(){return o(v)},$$events:{tabClick:C}});var z=g(X,2),U=f(z);{var F=W=>{var R=Vf(),D=f(R),N=f(D);O(A=>x(N,A),[()=>n()("Loading metadata…")]),_(W,R)},S=(W,R)=>{{var D=A=>{var B=Xf(),Q=f(B),le=f(Q),Ie=g(Q,2);Ie.__click=[Gf,h];var Me=f(Ie);O(Oe=>{x(le,o(h)),x(Me,Oe)},[()=>n()("Retry")]),_(A,B)},N=A=>{var B=Jf(),Q=f(B);{var le=Me=>{Mf(Me,{get metadata(){return o(l)},get validationErrors(){return o(c)},get saving(){return o(p)},onfieldChange:m,onfieldSave:b,onfieldFocus:y,onarrayAdd:M,onarrayRemove:T,ongenerateIdentifier:E})},Ie=(Me,Oe)=>{{var Le=Y=>{Hf(Y,{get metadata(){return o(l)},get validationErrors(){return o(c)},get saving(){return o(p)},onfieldChange:m,onfieldSave:b,onfieldFocus:y,onarrayAdd:M,onarrayRemove:T})},fe=(Y,te)=>{{var ae=ke=>{var We=Kf(),je=f(We),Re=f(je),Be=g(je,2),Ae=f(Be);O(($e,Ve,ve)=>{x(Re,$e),x(Ae,`${Ve??""} - ${ve??""}`)},[()=>n()("Coming Soon"),()=>n()("Publication Details"),()=>n()("Series information, EPUB version, and publication-specific metadata")]),_(ke,We)},be=(ke,We)=>{{var je=Re=>{var Be=Yf(),Ae=f(Be),$e=f(Ae),Ve=g(Ae,2),ve=f(Ve);O((me,Ee,He)=>{x($e,me),x(ve,`${Ee??""} - ${He??""}`)},[()=>n()("Coming Soon"),()=>n()("Accessibility"),()=>n()("Accessibility features, hazards, and certification information")]),_(Re,Be)};j(ke,Re=>{o(u)==="accessibility"&&Re(je)},We)}};j(Y,ke=>{o(u)==="publication"?ke(ae):ke(be,!1)},te)}};j(Me,Y=>{o(u)==="advanced"?Y(Le):Y(fe,!1)},Oe)}};j(Q,Me=>{o(u)==="basic"?Me(le):Me(Ie,!1)})}O(()=>{ue(B,"id",`metadata-panel-${o(u)??""}`),ue(B,"aria-labelledby",`metadata-tab-${o(u)??""}`)}),_(A,B)};j(W,A=>{o(h)?A(D):A(N,!1)},R)}};j(U,W=>{o(d)?W(F):W(S,!1)})}_(r,k),nt(),a()}yt(["click"]);var ep=I('<div class="coming-soon-badge svelte-skhkuy"><span class="badge-text">Phase 3</span></div>'),tp=I('<li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li>',1),np=I('<li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li>',1),rp=I('<li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li>',1),ap=I('<li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li>',1),ip=I('<li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li> <li class="svelte-skhkuy"> </li>',1),sp=(r,e)=>e("demo_action_1"),op=(r,e)=>e("demo_action_2"),lp=()=>Ct.navigateTo("workspace"),cp=I('<div class="last-action svelte-skhkuy"><span class="action-icon svelte-skhkuy">✨</span> <span> </span></div>'),dp=I('<div class="placeholder-view svelte-skhkuy"><header class="view-header svelte-skhkuy"><div class="header-content svelte-skhkuy"><span class="view-icon svelte-skhkuy"> </span> <div class="header-text svelte-skhkuy"><h2 class="svelte-skhkuy"> </h2> <p class="svelte-skhkuy"> </p></div></div> <!></header> <main class="view-content svelte-skhkuy"><div class="placeholder-content svelte-skhkuy"><div class="placeholder-icon svelte-skhkuy"><span class="large-icon svelte-skhkuy"> </span></div> <h3 class="svelte-skhkuy"> </h3> <p class="placeholder-description svelte-skhkuy"> </p> <div class="feature-preview svelte-skhkuy"><h4 class="svelte-skhkuy"> </h4> <ul class="feature-list svelte-skhkuy"><!></ul></div> <div class="demo-actions svelte-skhkuy"><h4 class="svelte-skhkuy"> </h4> <div class="action-buttons svelte-skhkuy"><button class="btn btn-primary svelte-skhkuy"> </button> <button class="btn btn-secondary svelte-skhkuy"> </button> <button class="btn btn-secondary svelte-skhkuy"> </button></div></div> <!></div></main></div>');function Vr(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"viewType",8,"Unknown"),s=$(e,"title",8,"View"),l=$(e,"description",8,"This view will be implemented in Phase 3."),c=$(e,"icon",8,"📄"),d=$(e,"comingSoon",8,!0),u,p=Ke({});function h(ge){ge&&w(p,{...o(p),...ge});const Ge=Ct.getViewData(i());Ge&&w(p,Ge)}function v(){Ct.setViewData(i(),o(p))}function m(){return o(p)}function y(ge){w(p,{...o(p),...ge})}async function b(){return!0}on(()=>{u=Ct.addNavigationGuard(b),h()}),cr(()=>{u&&Ct.removeNavigationGuard(u),v()});function M(ge){console.log(`${i()} action:`,ge),et(p,o(p).lastAction=ge),et(p,o(p).actionTime=new Date().toISOString()),Ct.setViewData(i(),o(p))}Rt();var T=dp(),E=f(T),C=f(E),k=f(C),X=f(k),P=g(k,2),z=f(P),U=f(z),F=g(z,2),S=f(F),W=g(C,2);{var R=ge=>{var Ge=ep();_(ge,Ge)};j(W,ge=>{d()&&ge(R)})}var D=g(E,2),N=f(D),A=f(N),B=f(A),Q=f(B),le=g(A,2),Ie=f(le),Me=g(le,2),Oe=f(Me),Le=g(Me,2),fe=f(Le),Y=f(fe),te=g(fe,2),ae=f(te);{var be=ge=>{var Ge=tp(),H=Ye(Ge),G=f(H),J=g(H,2),de=f(J),we=g(J,2),q=f(we),se=g(we,2),ce=f(se);O((pe,ye,Ce,Ne)=>{x(G,`📋 ${pe??""}`),x(de,`🔍 ${ye??""}`),x(q,`📁 ${Ce??""}`),x(ce,`👁️ ${Ne??""}`)},[()=>n()("File listing and management"),()=>n()("Search and filter files"),()=>n()("Add/remove manifest items"),()=>n()("Preview file contents")],Te),_(ge,Ge)},ke=(ge,Ge)=>{{var H=J=>{var de=np(),we=Ye(de),q=f(we),se=g(we,2),ce=f(se),pe=g(se,2),ye=f(pe),Ce=g(pe,2),Ne=f(Ce);O((Fe,oe,Ue,Je)=>{x(q,`📖 ${Fe??""}`),x(ce,`🔗 ${oe??""}`),x(ye,`📝 ${Ue??""}`),x(Ne,`🎯 ${Je??""}`)},[()=>n()("Table of contents editing"),()=>n()("Navigation link management"),()=>n()("TOC structure editing"),()=>n()("Auto-generation from spine")],Te),_(J,de)},G=(J,de)=>{{var we=se=>{var ce=rp(),pe=Ye(ce),ye=f(pe),Ce=g(pe,2),Ne=f(Ce),Fe=g(Ce,2),oe=f(Fe),Ue=g(Fe,2),Je=f(Ue);O((De,Z,V,he)=>{x(ye,`📚 ${De??""}`),x(Ne,`🔄 ${Z??""}`),x(oe,`📄 ${V??""}`),x(Je,`🔗 ${he??""}`)},[()=>n()("Chapter ordering interface"),()=>n()("Drag-and-drop reordering"),()=>n()("Spine item management"),()=>n()("Link to source files")],Te),_(se,ce)},q=(se,ce)=>{{var pe=Ce=>{var Ne=ap(),Fe=Ye(Ne),oe=f(Fe),Ue=g(Fe,2),Je=f(Ue),De=g(Ue,2),Z=f(De),V=g(De,2),he=f(V);O((K,xe,L,re)=>{x(oe,`⚙️ ${K??""}`),x(Je,`🎨 ${xe??""}`),x(Z,`💾 ${L??""}`),x(he,`🔧 ${re??""}`)},[()=>n()("Application preferences"),()=>n()("Theme and UI settings"),()=>n()("Export/import settings"),()=>n()("Advanced configurations")],Te),_(Ce,Ne)},ye=Ce=>{var Ne=ip(),Fe=Ye(Ne),oe=f(Fe),Ue=g(Fe,2),Je=f(Ue),De=g(Ue,2),Z=f(De),V=g(De,2),he=f(V);O((K,xe,L,re)=>{x(oe,`🚀 ${K??""}`),x(Je,`📊 ${xe??""}`),x(Z,`🔄 ${L??""}`),x(he,`💡 ${re??""}`)},[()=>n()("Enhanced functionality"),()=>n()("Improved user interface"),()=>n()("Seamless integration"),()=>n()("New capabilities")],Te),_(Ce,Ne)};j(se,Ce=>{i()==="settings"?Ce(pe):Ce(ye,!1)},ce)}};j(J,se=>{i()==="spine"?se(we):se(q,!1)},de)}};j(ge,J=>{i()==="navigation"?J(H):J(G,!1)},Ge)}};j(ae,ge=>{i()==="manifest"?ge(be):ge(ke,!1)})}var We=g(Le,2),je=f(We),Re=f(je),Be=g(je,2),Ae=f(Be);Ae.__click=[sp,M];var $e=f(Ae),Ve=g(Ae,2);Ve.__click=[op,M];var ve=f(Ve),me=g(Ve,2);me.__click=[lp];var Ee=f(me),He=g(We,2);{var ee=ge=>{var Ge=cp(),H=g(f(Ge),2),G=f(H);O((J,de,we)=>x(G,`${J??""}: ${o(p).lastAction??""}
            ${de??""}
            ${we??""}`),[()=>n()("Last action"),()=>n()("at"),()=>new Date(o(p).actionTime).toLocaleTimeString()],Te),_(ge,Ge)};j(He,ge=>{o(p).lastAction&&ge(ee)})}O((ge,Ge,H,G,J,de,we)=>{x(X,c()),x(U,s()),x(S,l()),x(Q,c()),x(Ie,ge),x(Oe,Ge),x(Y,`${H??""}:`),x(Re,`${G??""}:`),x($e,J),x(ve,de),x(Ee,we)},[()=>n()("Coming Soon"),()=>n()("The {title} interface will be implemented in Phase 3 of the EDITME development. This will include full content management capabilities.",{title:s().toLowerCase()}),()=>n()("Planned Features"),()=>n()("Navigation Demo"),()=>n()("Demo Action 1"),()=>n()("Demo Action 2"),()=>n()("Back to Projects")],Te),_(r,T),Ut(e,"onViewEnter",h),Ut(e,"onViewLeave",v),Ut(e,"getViewData",m),Ut(e,"setViewData",y),Ut(e,"canLeave",b);var Se=nt({onViewEnter:h,onViewLeave:v,getViewData:m,setViewData:y,canLeave:b});return a(),Se}yt(["click"]);function up(r,e){e.onPaneToggle?.()}function fp(r,e){e.onForceUpdate?.()}var pp=I('<div class="status-indicator transforming svelte-1o393xc" title="Transform in progress"><div class="status-spinner svelte-1o393xc"></div> <span class="svelte-1o393xc">Transforming...</span></div>'),hp=I('<div class="status-indicator error svelte-1o393xc" title="Transform error"><span class="status-icon svelte-1o393xc">⚠️</span> <span class="svelte-1o393xc">Error</span></div>'),vp=I('<div class="status-indicator error svelte-1o393xc" title="Syntax error prevents transform"><span class="status-icon svelte-1o393xc">⚠️</span> <span class="svelte-1o393xc">Syntax Error</span></div>'),mp=I('<div class="status-indicator warning svelte-1o393xc"><span class="status-icon svelte-1o393xc">⚠️</span> <span class="svelte-1o393xc"> </span></div>'),gp=I('<div class="status-indicator success svelte-1o393xc" title="Transform successful"><span class="status-icon svelte-1o393xc">✅</span> <span class="svelte-1o393xc"> </span></div>'),wp=(r,e)=>e(2,r),yp=I('<option class="svelte-1o393xc"> </option>'),bp=I('<div class="pane-error-overlay svelte-1o393xc"><span class="error-icon svelte-1o393xc" aria-hidden="true">⚠️</span> <span class="error-message svelte-1o393xc"> </span></div>'),xp=I('<div class="editor-pane pane-2 svelte-1o393xc"><div class="pane-header svelte-1o393xc"><select class="file-selector svelte-1o393xc" aria-label="Select file for pane 2"><option disabled class="svelte-1o393xc">Select file...</option><!></select></div> <div class="textarea-container svelte-1o393xc"><textarea autocomplete="off" autocapitalize="off" aria-label="Pane 2 content"></textarea> <!></div></div>'),_p=(r,e)=>e(1,r),Sp=I('<option class="svelte-1o393xc"> </option>'),Ep=I('<div class="pane-error-overlay svelte-1o393xc"><span class="error-icon svelte-1o393xc" aria-hidden="true">⚠️</span> <span class="error-message svelte-1o393xc"> </span></div>'),kp=I('<details class="error-stack svelte-1o393xc"><summary class="svelte-1o393xc">Stack Trace</summary> <pre class="svelte-1o393xc"> </pre></details>'),Tp=I('<div class="error-display svelte-1o393xc"><div class="error-header svelte-1o393xc"><span class="error-icon svelte-1o393xc" aria-hidden="true">🚨</span> <strong class="svelte-1o393xc"> </strong></div> <div class="error-message svelte-1o393xc"> </div> <!></div>'),Cp=I('<li class="svelte-1o393xc"> </li>'),Ip=I('<div class="warnings-display svelte-1o393xc"><div class="warnings-header svelte-1o393xc"><span class="warning-icon svelte-1o393xc" aria-hidden="true">⚠️</span> <strong class="svelte-1o393xc"> </strong></div> <ul class="warnings-list svelte-1o393xc"></ul></div>'),Fp=I('<div class="editor-pane-container svelte-1o393xc"><div class="editor-header svelte-1o393xc"><div class="editor-controls svelte-1o393xc"><button type="button" class="pane-toggle-btn svelte-1o393xc"><span class="toggle-icon svelte-1o393xc" aria-hidden="true"> </span> <span class="toggle-label svelte-1o393xc"> </span></button></div> <div class="editor-status svelte-1o393xc"><!> <button type="button" class="force-update-btn svelte-1o393xc" title="Force immediate preview update">🔄</button></div></div> <div class="editor-content svelte-1o393xc"><div><!> <div class="editor-pane pane-1 svelte-1o393xc"><div class="pane-header svelte-1o393xc"><select class="file-selector svelte-1o393xc" aria-label="Select file for pane 1"><option disabled class="svelte-1o393xc">Select file...</option><!></select></div> <div class="textarea-container svelte-1o393xc"><textarea autocomplete="off" autocapitalize="off" aria-label="Pane 1 content"></textarea> <!></div></div></div></div> <!> <!></div>');function Mp(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(T(),"$pane1FileStore",t),i=()=>Qe(E(),"$pane2FileStore",t),s=()=>Qe(dt,"$t",t);let l=$(e,"transformError",3,null),c=$(e,"transformWarnings",19,()=>[]),d=$(e,"isTransforming",3,!1),u=$(e,"executionTime",3,0),p=$(e,"availableFiles1",19,()=>[]),h=$(e,"availableFiles2",19,()=>[]),v=$(e,"editorMode",3,"single"),m=$(e,"pane1SelectedFile",3,""),y=$(e,"pane2SelectedFile",3,""),b=$(e,"pane1Error",15),M=$(e,"pane2Error",15),T=$(e,"pane1FileStore",3,null),E=$(e,"pane2FileStore",3,null);$(e,"onPreviewClick",3,null);function C(q,se){const ce=se.target,ye=(q===1?p():h()).find(Ce=>Ce.value===ce.value);ye&&e.onFileSelect?.(q,ye.path,ye.type)}function k(q){const se=q.target.value;if(!T()){console.warn("🚫 No file store available for input in pane 1");return}const ce=e.contentService.validateFileContent(se,m());if(ce){b(ce);return}else b(null);T().updateContent(se)}function X(q){const se=q.target.value;if(!E()){console.warn("🚫 No file store available for input in pane 2");return}const ce=e.contentService.validateFileContent(se,y());if(ce){M(ce);return}else M(null);E().updateContent(se)}function P(q){return q.includes("css")?"syntax-css":q.includes("javascript")||q.includes("js")||q.includes("transform")?"syntax-js":"syntax-text"}function z(q){return q.includes("css")||q.includes("javascript")||q.includes("js")||q.includes("transform")}function U(q){return q==="text"?`Enter your chapter content here...

This will be transformed to XHTML using your configured text transform script.`:q.includes("css")?`/* Stylesheet content */

body {
  /* Your styles here */
}`:q.includes("javascript")||q.includes("js")?`// JavaScript content

(function() {
  // Your code here
})();`:q.includes("transform")?`// Transform script

function transform(input) {
  // Your transform logic here
  return input;
}`:""}function F(q){return q<1e3?`${q}ms`:`${(q/1e3).toFixed(1)}s`}let S=Pe(void 0),W=Pe(void 0);function R(q){let se=q.trim();return se=se.split("").map(ce=>{const pe=ce.charCodeAt(0);return pe===8217||pe===8216?"'":pe===8221||pe===8220?'"':ce}).join(""),se=se.replace(/[""„‚]/g,'"'),se=se.replace(/\s+/g," "),se}function D(q){const{text:se}=q;let ce=null,pe="";if(T()&&m()&&o(S)&&n()?.content?(ce=o(S),pe=n().content):E()&&y()&&o(W)&&i()?.content&&(ce=o(W),pe=i().content),!ce||!pe)return;const ye=se.trim(),Ce=R(ye),Ne=pe.toLowerCase(),Fe=Ce.toLowerCase();let oe=Ne.indexOf(Fe);if(oe!==-1){N(ce,oe,oe+Ce.length);return}if(ye.length>=8){const Ue=ye.toLowerCase();if(oe=Ne.indexOf(Ue),oe!==-1){N(ce,oe,oe+ye.length);return}}}function N(q,se,ce){q.focus(),q.setSelectionRange(se,ce);const ye=q.value.substring(0,se).split(`
`).length-1,Ce=parseInt(getComputedStyle(q).lineHeight)||20,Ne=ye*Ce;q.scrollTop=Math.max(0,Ne-q.clientHeight/2)}var A=Fp(),B=f(A),Q=f(B),le=f(Q);le.__click=[up,e];var Ie=f(le),Me=f(Ie),Oe=g(Ie,2),Le=f(Oe),fe=g(Q,2),Y=f(fe);{var te=q=>{var se=pp();_(q,se)},ae=(q,se)=>{{var ce=ye=>{var Ce=hp();_(ye,Ce)},pe=(ye,Ce)=>{{var Ne=oe=>{var Ue=vp();_(oe,Ue)},Fe=(oe,Ue)=>{{var Je=Z=>{var V=mp(),he=g(f(V),2),K=f(he);O(()=>{ue(V,"title",`${c().length} warnings`),x(K,`${c().length??""} warnings`)}),_(Z,V)},De=Z=>{var V=gp(),he=g(f(V),2),K=f(he);O(xe=>x(K,xe),[()=>F(u())]),_(Z,V)};j(oe,Z=>{c().length>0?Z(Je):Z(De,!1)},Ue)}};j(ye,oe=>{b()||M()?oe(Ne):oe(Fe,!1)},Ce)}};j(q,ye=>{l()&&l().stage!=="syntax-validation"?ye(ce):ye(pe,!1)},se)}};j(Y,q=>{d()?q(te):q(ae,!1)})}var be=g(Y,2);be.__click=[fp,e];var ke=g(B,2),We=f(ke);let je;var Re=f(We);{var Be=q=>{var se=xp(),ce=f(se),pe=f(ce);Mr(pe,y);var ye;pe.__change=[wp,C];var Ce=f(pe);Ce.value=Ce.__value="";var Ne=g(Ce);kt(Ne,17,h,It,(Z,V)=>{var he=yp(),K={},xe=f(he);O(()=>{K!==(K=o(V).value)&&(he.value=(he.__value=o(V).value)??""),x(xe,o(V).label)}),_(Z,he)});var Fe=g(ce,2),oe=f(Fe);let Ue;oe.__input=X,Bt(oe,Z=>w(W,Z),()=>o(W));var Je=g(oe,2);{var De=Z=>{var V=bp(),he=g(f(V),2),K=f(he);O(()=>x(K,M())),_(Z,V)};j(Je,Z=>{M()&&Z(De)})}O((Z,V,he,K)=>{ye!==(ye=y())&&(pe.value=(pe.__value=y())??"",Rn(pe,y())),Ue=st(oe,1,`content-textarea ${Z??""}`,"svelte-1o393xc",Ue,V),An(oe,E()&&i()?.content||""),ue(oe,"placeholder",he),ue(oe,"spellcheck",y()==="text"),ue(oe,"dir",K),oe.dir=oe.dir},[()=>P(y()),()=>({"has-error":M()}),()=>U(y()),()=>z(y())?"ltr":void 0]),_(q,se)};j(Re,q=>{v()==="dual"&&q(Be)})}var Ae=g(Re,2),$e=f(Ae),Ve=f($e);Mr(Ve,m);var ve;Ve.__change=[_p,C];var me=f(Ve);me.value=me.__value="";var Ee=g(me);kt(Ee,17,p,It,(q,se)=>{var ce=Sp(),pe={},ye=f(ce);O(()=>{pe!==(pe=o(se).value)&&(ce.value=(ce.__value=o(se).value)??""),x(ye,o(se).label)}),_(q,ce)});var He=g($e,2),ee=f(He);let Se;ee.__input=k,Bt(ee,q=>w(S,q),()=>o(S));var ge=g(ee,2);{var Ge=q=>{var se=Ep(),ce=g(f(se),2),pe=f(ce);O(()=>x(pe,b())),_(q,se)};j(ge,q=>{b()&&q(Ge)})}var H=g(ke,2);{var G=q=>{var se=Tp(),ce=f(se),pe=g(f(ce),2),ye=f(pe),Ce=g(ce,2),Ne=f(Ce),Fe=g(Ce,2);{var oe=Ue=>{var Je=kp(),De=g(f(Je),2),Z=f(De);O(()=>x(Z,l().stack)),_(Ue,Je)};j(Fe,Ue=>{l().stack&&Ue(oe)})}O(()=>{x(ye,`Transform Error (${l().stage??""})`),x(Ne,l().message)}),_(q,se)};j(H,q=>{l()&&l().stage!=="syntax-validation"&&q(G)})}var J=g(H,2);{var de=q=>{var se=Ip(),ce=f(se),pe=g(f(ce),2),ye=f(pe),Ce=g(ce,2);kt(Ce,21,c,It,(Ne,Fe)=>{var oe=Cp(),Ue=f(oe);O(()=>x(Ue,o(Fe))),_(Ne,oe)}),O(()=>x(ye,`${c().length??""} Warnings`)),_(q,se)};j(J,q=>{c().length>0&&q(de)})}O((q,se,ce,pe,ye,Ce)=>{ue(le,"title",v()==="single"?"Add second editor pane":"Switch to single pane"),x(Me,v()==="single"?"⊞":"⊟"),x(Le,q),be.disabled=d(),je=st(We,1,"editor-panes svelte-1o393xc",null,je,se),ve!==(ve=m())&&(Ve.value=(Ve.__value=m())??"",Rn(Ve,m())),Se=st(ee,1,`content-textarea ${ce??""}`,"svelte-1o393xc",Se,pe),An(ee,T()&&n()?.content||""),ue(ee,"placeholder",ye),ue(ee,"spellcheck",m()==="text"),ue(ee,"dir",Ce),ee.dir=ee.dir},[()=>v()==="single"?s()("Split Pane"):s()("Single Pane"),()=>({"dual-mode":v()==="dual"}),()=>P(m()),()=>({"has-error":b()}),()=>U(m()),()=>z(m())?"ltr":void 0]),_(r,A);var we=nt({findAndSelectText:D});return a(),we}yt(["click","change","input"]);function Pp(r,e,t,a){w(e,o(e)==="portrait"?"landscape":"portrait",!0),t(o(a))}function Lp(r,e,t,a,n,i){console.log("🔄 CLICK EVENT FIRED! toggleSourceView() called"),console.log("🔄 Current showSource state:",o(e));const s=o(e);w(e,!o(e)),console.log("🔄 State toggled from",s,"to",o(e)),o(e)||(console.log("🔄 About to call updatePreviewContent and re-apply device settings"),setTimeout(()=>{console.log("🔄 updatePreviewContent called"),t(a()),n(o(i))},0)),console.log("🔄 toggleSourceView completed")}var Dp=I('<button type="button" class="orientation-toggle svelte-32psnf" title="Toggle orientation" aria-label="Toggle device orientation"> </button>'),Rp=(r,e)=>e(r.target.value),Ap=I('<option class="svelte-32psnf"> </option>'),Op=I('<optgroup class="svelte-32psnf"></optgroup>'),Up=I('<div class="transform-status transforming svelte-32psnf"><div class="status-spinner svelte-32psnf"></div> <span class="svelte-32psnf">Transforming content...</span></div>'),zp=I('<div class="transform-status error svelte-32psnf"><span class="status-icon svelte-32psnf">🚨</span> <span class="svelte-32psnf"> </span></div>'),Wp=I('<div class="transform-status warning svelte-32psnf"><span class="status-icon svelte-32psnf">⚠️</span> <span class="svelte-32psnf"> </span></div>'),Np=I('<div class="source-view svelte-32psnf"><pre class="source-code svelte-32psnf" dir="ltr"> </pre></div>'),jp=I('<details class="svelte-32psnf"><summary class="svelte-32psnf">Stack Trace</summary> <pre class="error-stack svelte-32psnf"> </pre></details>'),Bp=I('<div class="preview-error svelte-32psnf"><div class="error-content svelte-32psnf"><h3 class="svelte-32psnf">Transform Error</h3> <p class="svelte-32psnf"><strong class="svelte-32psnf">Stage:</strong> </p> <p class="svelte-32psnf"><strong class="svelte-32psnf">Message:</strong> </p> <!></div></div>'),$p=I('<iframe class="preview-iframe svelte-32psnf" title="XHTML Preview"></iframe>'),Hp=I('<div class="preview-empty svelte-32psnf"><div class="empty-content svelte-32psnf"><span class="empty-icon svelte-32psnf" aria-hidden="true">📝</span> <h3 class="svelte-32psnf">No Content</h3> <p class="svelte-32psnf">Start typing in the editor to see your XHTML preview here.</p></div></div>'),qp=I('<div class="preview-viewport svelte-32psnf"><div class="preview-frame-wrapper svelte-32psnf"><div><!></div></div></div>'),Vp=I('<span class="update-time svelte-32psnf"> </span>'),Gp=I('<span class="content-size svelte-32psnf"> </span>'),Xp=I('<span class="warning-count svelte-32psnf"> </span>'),Kp=I('<div class="preview-pane-container svelte-32psnf"><div class="preview-header svelte-32psnf"><div class="preview-title svelte-32psnf"><button title="Toggle source view"> </button></div> <div class="preview-controls svelte-32psnf"><!>  <select class="device-selector svelte-32psnf"></select></div></div> <!> <div class="preview-content svelte-32psnf"><!></div> <div class="preview-footer svelte-32psnf"><div class="meta-info svelte-32psnf"><!> <!> <!></div></div></div>');function Yp(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=()=>Qe(X,"$lastUpdateTime",t);let s=$(e,"xhtmlContent",3,""),l=$(e,"isTransforming",3,!1),c=$(e,"transformError",3,null),d=$(e,"transformWarnings",19,()=>[]);$(e,"executionTime",3,0);let u=$(e,"onPreviewClick",3,null);const p=[{id:"desktop",name:"Fill",width:"100%",height:"100%",icon:"🖥️",category:"responsive"},{id:"galaxy-s23",name:"Pocket",width:"360px",height:"800px",icon:"📱",category:"commute"},{id:"iphone",name:"Standard",width:"375px",height:"667px",icon:"📱",category:"commute"},{id:"pixel-7",name:"Large",width:"393px",height:"851px",icon:"📱",category:"commute"},{id:"iphone-plus",name:"Plus",width:"414px",height:"736px",icon:"📱",category:"commute"},{id:"ipad",name:"Compact",width:"768px",height:"1024px",icon:"📱",category:"home"},{id:"galaxy-tab-s9",name:"Large",width:"800px",height:"1280px",icon:"📱",category:"home"},{id:"ipad-air",name:"Extra Large",width:"820px",height:"1180px",icon:"📱",category:"home"},{id:"kindle",name:"Standard",width:"600px",height:"800px",icon:"📚",category:"travel"},{id:"kobo-clara-2e",name:"Large",width:"758px",height:"1024px",icon:"📚",category:"travel"}],h=H=>{switch(H){case"responsive":return n()("Responsive");case"commute":return n()("Commute (phone)");case"home":return n()("Home (tablet)");case"travel":return n()("Travel (e-ink)");default:return H}},v=H=>{switch(H.name){case"Fill":return n()("Fill");case"Pocket":return n()("Pocket");case"Standard":return n()("Standard");case"Large":return n()("Large");case"Plus":return n()("Plus");case"Compact":return n()("Compact");case"Extra Large":return n()("Extra Large");default:return H.name}};let m=Pe("desktop"),y=Pe("portrait"),b=Pe(!1),M=Pe(void 0),T=Pe(void 0),E=Pe(void 0),C=Pe(1),k=Pe(null);const X=Jt(Date.now()),P=ne(()=>{const H={};for(const G of p)H[G.category]||(H[G.category]=[]),H[G.category].push(G);return H});Et(()=>{F(s())});function z(H){try{const G=H.documentElement,J=G.scrollTop||H.body.scrollTop,de=G.clientWidth/2,we=Math.min(100,G.clientHeight/4),q=H.elementFromPoint(de,we);if(!q||q===H.body||q===G)return{element:null,id:null,offset:J};let se=q;for(;se&&se!==H.body;){if(se.id){const Ce=se.getBoundingClientRect(),Ne=J-(Ce.top+J-we);return{element:se,id:se.id,offset:Ne}}se=se.parentElement}const ce=q.tagName.toLowerCase(),ye=Array.from(H.querySelectorAll(ce)).indexOf(q);if(ye>=0){const Ce=q.getBoundingClientRect(),Ne=J-(Ce.top+J-we);return{element:q,id:`${ce}[${ye}]`,offset:Ne}}return{element:null,id:null,offset:J}}catch(G){return console.warn("Failed to find scroll anchor:",G),null}}function U(H,G,J){if(!G){H.documentElement.scrollTop=J,H.body&&(H.body.scrollTop=J);return}try{let de=null;if(G.id)if(G.id.includes("[")&&G.id.includes("]")){const[we,q]=G.id.split("["),se=parseInt(q.replace("]",""),10);de=H.querySelectorAll(we)[se]||null}else de=H.getElementById(G.id);if(de){if(de.scrollIntoView({behavior:"instant",block:"start"}),G.offset!==0){const we=H.documentElement.scrollTop||H.body?.scrollTop||0,q=Math.max(0,we+G.offset);H.documentElement.scrollTop=q,H.body&&(H.body.scrollTop=q)}}else H.documentElement.scrollTop=J,H.body&&(H.body.scrollTop=J)}catch(de){console.warn("Failed to restore scroll position:",de),H.documentElement.scrollTop=J,H.body&&(H.body.scrollTop=J)}}function F(H){if(!(!o(M)||!H))try{const G=o(M).contentDocument;if(!G)return;const J=G.documentElement.scrollTop||G.body?.scrollTop||0,de=J>0?z(G):null;w(k,{anchor:de,fallbackScrollTop:J},!0),G.open(),G.write(H),G.close(),X.set(Date.now())}catch(G){console.error("Failed to update preview content:",G)}}function S(H){const G=parseInt(H.width.replace("px","")),J=parseInt(H.height.replace("px",""));return o(y)==="landscape"?{width:J,height:G}:{width:G,height:J}}function W(H){if(H.id==="desktop")return 1;try{if(!o(E))return 1;const G=o(E).getBoundingClientRect(),J=Math.max(200,G.width-40),de=Math.max(200,G.height-40),{width:we,height:q}=S(H),se=J/de,ce=we/q;let pe;return se>ce?pe=de/q:pe=J/we,Math.min(Math.max(pe,.1),2)}catch(G){return console.warn("Failed to calculate optimal scale:",G),1}}function R(H){w(m,H,!0);const G=p.find(J=>J.id===H);if(G&&o(T)){const J=o(T).parentElement;G.id==="desktop"?(o(T).style.width="100%",o(T).style.height="100%",o(T).style.maxWidth="none",o(T).style.maxHeight="none",J&&(J.style.width="100%",J.style.height="100%"),w(C,1)):setTimeout(()=>{if(o(T)){const de=W(G),{width:we,height:q}=S(G);o(T).style.width=we+"px",o(T).style.height=q+"px",o(T).style.maxWidth=we+"px",o(T).style.maxHeight=q+"px",J&&(J.style.width=Math.round(we*de)+"px",J.style.height=Math.round(q*de)+"px"),w(C,de,!0)}},0)}}function D(H){return new Date(H).toLocaleTimeString()}function N(H){const G=o(M)?.contentDocument;if(!G)return 0;try{const J=G.createTreeWalker(G.body,NodeFilter.SHOW_TEXT,null);let de=0,we;for(;(we=J.nextNode())&&!H.contains(we);)de+=we.textContent?.length||0;return de}catch(J){return console.warn("Failed to estimate document position:",J),0}}function A(H){if(!u())return;const G=H.target;if(!G)return;const J=G.closest("p, h1, h2, h3, h4, h5, h6, div, span, li, blockquote, td, th")||G,de=J.textContent?.trim();if(!(!de||de.length<8)&&!(de.length>500))try{const we=N(J),q=J.tagName.toLowerCase();u()({text:de,documentPosition:we,elementType:q})}catch(we){console.warn("Failed to handle preview click:",we)}}function B(H){H.addEventListener("click",A);const G=H.createElement("style");G.textContent=`
      body {
        /* margin: 0; */
        /* padding: 0; */
        /* font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; */
        /* line-height: 1.6; */
      }

      /* Ensure images are responsive */
      img {
        max-width: 100%;
        height: auto;
      }

      /* Add some visual feedback for empty content */
      body:empty::before {
        content: 'No content to preview';
        color: #666;
        font-style: italic;
        display: block;
        text-align: center;
        padding: 2rem;
      }

      /* Indicate clickable text elements */
      p, h1, h2, h3, h4, h5, h6, div, span, li, blockquote, td, th {
        cursor: pointer;
      }

      /* Visual feedback on hover */
      p:hover, h1:hover, h2:hover, h3:hover, h4:hover, h5:hover, h6:hover,
      div:hover, span:hover, li:hover, blockquote:hover, td:hover, th:hover {
        /* background-color: rgba(59, 130, 246, 0.1); */
        outline: 1px solid rgba(59, 130, 246, 0.3);
        outline-offset: 1px;
      }
    `,H.head.appendChild(G)}function Q(){if(o(M)?.contentDocument){const H=o(M).contentDocument;B(H),o(k)&&requestAnimationFrame(()=>{U(H,o(k).anchor,o(k).fallbackScrollTop),w(k,null)})}}let le=null;on(()=>{R(o(m)),typeof ResizeObserver<"u"&&(le=new ResizeObserver(()=>{setTimeout(()=>{R(o(m))},400)}),o(E)&&le.observe(o(E)));const H=()=>{setTimeout(()=>R(o(m)),400)};return window.addEventListener("resize",H),()=>{le?.disconnect(),window.removeEventListener("resize",H)}});var Ie=Kp(),Me=f(Ie),Oe=f(Me),Le=f(Oe);let fe;Le.__click=[Lp,b,F,s,R,m];var Y=f(Le),te=g(Oe,2),ae=f(te);{var be=H=>{var G=Dp();G.__click=[Pp,y,R,m];var J=f(G);O(()=>x(J,o(y)==="portrait"?"▭":"▯")),_(H,G)};j(ae,H=>{o(m)!=="desktop"&&H(be)})}var ke=g(ae,2);ke.__change=[Rp,R],kt(ke,21,()=>Object.entries(o(P)),It,(H,G)=>{var J=ne(()=>Lo(o(G),2));let de=()=>o(J)[0],we=()=>o(J)[1];var q=Op();kt(q,21,we,It,(se,ce)=>{var pe=Ap(),ye={},Ce=f(pe);O(Ne=>{ye!==(ye=o(ce).id)&&(pe.value=(pe.__value=o(ce).id)??""),x(Ce,`${o(ce).icon??""}
                ${Ne??""}`)},[()=>v(o(ce))]),_(se,pe)}),O(se=>ue(q,"label",se),[()=>h(de())]),_(H,q)});var We=g(Me,2);{var je=H=>{var G=Up();_(H,G)},Re=(H,G)=>{{var J=we=>{var q=zp(),se=g(f(q),2),ce=f(se);O(()=>x(ce,`Transform failed: ${c().message??""}`)),_(we,q)},de=(we,q)=>{{var se=ce=>{var pe=Wp(),ye=g(f(pe),2),Ce=f(ye);O(()=>x(Ce,`${d().length??""} warnings`)),_(ce,pe)};j(we,ce=>{d().length>0&&ce(se)},q)}};j(H,we=>{c()?we(J):we(de,!1)},G)}};j(We,H=>{l()?H(je):H(Re,!1)})}var Be=g(We,2),Ae=f(Be);{var $e=H=>{var G=Np(),J=f(G),de=f(J);O(()=>{x(de,s()||"\x3C!-- No content generated yet -->"),J.dir=J.dir}),_(H,G)},Ve=H=>{var G=qp(),J=f(G),de=f(J);let we,q;var se=f(de);{var ce=ye=>{var Ce=Bp(),Ne=f(Ce),Fe=g(f(Ne),2),oe=g(f(Fe)),Ue=g(Fe,2),Je=g(f(Ue)),De=g(Ue,2);{var Z=V=>{var he=jp(),K=g(f(he),2),xe=f(K);O(()=>x(xe,c().stack)),_(V,he)};j(De,V=>{c().stack&&V(Z)})}O(()=>{x(oe,` ${c().stage??""}`),x(Je,` ${c().message??""}`)}),_(ye,Ce)},pe=(ye,Ce)=>{{var Ne=oe=>{var Ue=$p();Bt(Ue,Je=>w(M,Je),()=>o(M)),at("load",Ue,Q),_(oe,Ue)},Fe=oe=>{var Ue=Hp();_(oe,Ue)};j(ye,oe=>{s()?oe(Ne):oe(Fe,!1)},Ce)}};j(se,ye=>{c()?ye(ce):ye(pe,!1)})}Bt(de,ye=>w(T,ye),()=>o(T)),O(ye=>{we=st(de,1,"preview-frame-container svelte-32psnf",null,we,ye),q=li(de,"",q,{transform:o(m)!=="desktop"?`scale(${o(C)})`:"none","transform-origin":"top left"})},[()=>({"device-frame":o(m)!=="desktop"})]),_(H,G)};j(Ae,H=>{o(b)?H($e):H(Ve,!1)})}Bt(Be,H=>w(E,H),()=>o(E));var ve=g(Be,2),me=f(ve),Ee=f(me);{var He=H=>{var G=Vp(),J=f(G);O(de=>x(J,`Updated: ${de??""}`),[()=>D(i())]),_(H,G)};j(Ee,H=>{i()&&H(He)})}var ee=g(Ee,2);{var Se=H=>{var G=Gp(),J=f(G);O(de=>x(J,`${de??""}KB`),[()=>Math.round(s().length/1024)]),_(H,G)};j(ee,H=>{s()&&H(Se)})}var ge=g(ee,2);{var Ge=H=>{var G=Xp(),J=f(G);O(()=>x(J,`${d().length??""} warnings`)),_(H,G)};j(ge,H=>{d().length>0&&H(Ge)})}O((H,G)=>{fe=st(Le,1,"view-toggle svelte-32psnf",null,fe,H),x(Y,o(b)?"👁️":"📄"),ue(ke,"aria-label",G)},[()=>({active:o(b)}),()=>n()("Select device preset")]),$s(ke,()=>o(m),H=>w(m,H)),_(r,Ie),nt(),a()}yt(["click","change"]);function Ji(r,e="Text"){return r.startsWith("../")||r.startsWith("./")||r.startsWith("http")||r.startsWith("data:")||r.startsWith("blob:")||r.startsWith("/")?r:e&&e!==""?`../${r}`:r}function za(r,e="Text"){return!r.startsWith("../")||r.startsWith("http")||r.startsWith("data:")||r.startsWith("blob:")?r:e&&e!==""&&r.startsWith("../")?r.substring(3):r}class Jp{constructor(e,t,a,n,i,s){this.workspaceId=e,this.fileStorage=t,this.extensionManager=a,this.blobURLManager=n,this.transformEngine=i,this.settingsService=s}async executeTransform(e,t=3e3,a){try{const n=await this.loadTransformScripts();return await this.transformEngine.setTransformScripts(n),await this.transformEngine.executeTransform(e,t,a)}catch(n){return{success:!1,error:{stage:"communication",message:String(n?.message||n)}}}}async loadTransformScripts(){try{const e={textTransform:"",domTransforms:[]};if(this.settingsService){const t=await this.settingsService.loadEPUBSettings(this.workspaceId);if(t.text_transform)try{e.textTransform=await this.fileStorage.readTextFile(this.workspaceId,`SOURCE/scripts/${t.text_transform}`)}catch{console.warn(`Failed to load text transform script: ${t.text_transform}`)}if(t.dom_transforms&&t.dom_transforms.length>0){e.domTransforms=[];for(const a of t.dom_transforms)try{const n=await this.fileStorage.readTextFile(this.workspaceId,`SOURCE/scripts/${a}`);e.domTransforms.push(n)}catch{console.warn(`Failed to load DOM transform script: ${a}`)}}}return e}catch(e){throw new Error(`Failed to load transform scripts: ${e instanceof Error?e.message:String(e)}`)}}async setDebugMode(e){try{await this.transformEngine.setDebugMode(e)}catch(t){console.warn("Failed to set debug mode:",t)}}async ping(e={}){return await this.transformEngine.ping({data:e})}cleanup(){}}class Zp{transformPipeline;debounceTimer;currentContent;isTransforming=!1;lastTransformTime=0;workspaceId;fileStorage;extensionManager;blobURLManager;workspaceService;settingsService;transformEngine;config;onPreviewUpdate;onError;spineItemId;spineItem;constructor(e,t,a,n,i,s,l,c,d,u,p,h){this.workspaceId=e,this.fileStorage=a,this.extensionManager=n,this.blobURLManager=i,this.workspaceService=s,this.settingsService=l,this.transformEngine=c,this.config=d,this.onPreviewUpdate=u,this.onError=p,this.spineItemId=t,this.spineItem=h,this.transformPipeline=new Jp(e,a,n,i,c,l),this.currentContent={text:""},this.blobURLManager.setActiveWorkspace(e)}async initialize(){await this.transformPipeline.loadTransformScripts()}updateContent(e,t){this.currentContent[e]=t,this.debounceRender()}async loadInitialContent(){try{try{this.currentContent.text=await this.fileStorage.readTextFile(this.workspaceId,`SOURCE/text/${this.spineItemId}.txt`)}catch{this.currentContent.text=""}this.debounceRender()}catch(e){this.handleError("initialization",e)}}getCurrentContent(){return{...this.currentContent}}debounceRender(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.renderPreview()},this.config.debounceMs)}async renderPreview(){if(this.isTransforming){this.debounceRender();return}this.isTransforming=!0;const e=performance.now();try{this.config.autoSave&&await this.autoSaveChangedContent();const t=await this.transformPipeline.executeTransform(this.currentContent.text,this.config.transformTimeout,this.spineItemId);if(!t.success){this.handleError("transform",t.error);return}const a=await this.generateChapterMetadata(),n=this.generateXHTML(t.html||"",a);this.config.persistToManifest&&await this.saveXHTMLToManifest(n);const i=await this.blobURLManager.processXHTMLForPreview(n),s=performance.now()-e;this.lastTransformTime=s,this.onPreviewUpdate({xhtml:i,warnings:t.warnings||[],executionTime:Math.round(s),timestamp:Date.now()})}catch(t){this.handleError("preview",t)}finally{this.isTransforming=!1}}async autoSaveChangedContent(){const e={success:!0,savedFiles:[],errors:[]},t={path:`SOURCE/text/${this.spineItemId}.txt`,content:this.currentContent.text,type:"text"};if(t.content.trim())try{await this.fileStorage.writeTextFile(this.workspaceId,t.path,t.content),e.savedFiles.push(t.path)}catch(a){e.success=!1,e.errors.push({file:t.path,error:a instanceof Error?a.message:String(a)})}return e}async saveXHTMLToManifest(e){try{const t=await this.workspaceService.loadWorkspace(this.workspaceId),a=t.opf.manifest.find(i=>i.id===this.spineItemId);if(!a){console.warn(`Manifest item not found for spine item: ${this.spineItemId}`);return}const n=this.resolveManifestPath(a.href,t.pathInfo.basePath);await this.workspaceService.writeFile(this.workspaceId,n,e),await this.updateSVGProperty(e,t,a)}catch(t){console.warn("Failed to save XHTML to manifest:",t)}}resolveManifestPath(e,t){return!t||e.startsWith(t+"/")?e:`${t}/${e}`}detectInlineSVG(e){try{return new DOMParser().parseFromString(e,"text/html").querySelectorAll("svg").length>0}catch(t){return console.warn("Failed to parse XHTML for SVG detection:",t),!1}}async updateSVGProperty(e,t,a){try{if(a.mediaType!=="application/xhtml+xml")return;const n=this.detectInlineSVG(e),i=a.properties||[],s=i.includes("svg");if(n&&!s)await this.workspaceService.updateManifestItem(t,this.spineItemId,{properties:[...i,"svg"]});else if(!n&&s){const l=i.filter(c=>c!=="svg");await this.workspaceService.updateManifestItem(t,this.spineItemId,{properties:l.length>0?l:void 0})}}catch(n){console.warn("Failed to update SVG property:",n)}}async generateChapterMetadata(){const e=this.spineItemId;let t="en";try{t=(await this.workspaceService.loadWorkspace(this.workspaceId))?.opf?.metadata?.language||"en"}catch(i){console.warn("Could not load workspace language, using default:",i)}const a=[],n=[];try{const i=await this.workspaceService.loadWorkspace(this.workspaceId);i.opf.manifest.filter(s=>s.mediaType==="text/css").forEach(s=>{a.push(s.href)}),i.opf.manifest.filter(s=>s.mediaType==="text/javascript"||s.mediaType==="application/javascript").forEach(s=>{n.push(s.href)})}catch{}return{title:e,language:t,stylesheets:a,scripts:n}}generateXHTML(e,t){const a=t.stylesheets.map(i=>`  <link rel="stylesheet" type="text/css" href="${this.escapeHtml(Ji(i))}" />`).join(`
`),n=t.scripts.map(i=>`  <script src="${this.escapeHtml(Ji(i))}"><\/script>`).join(`
`);return`<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="${this.escapeHtml(t.language)}" lang="${this.escapeHtml(t.language)}">
<head>
  <title>${this.escapeHtml(t.title)}</title>
${a}
${n}
</head>
${e}
</html>`}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}handleError(e,t){const a={stage:e,message:t?.message||(typeof t=="string"?t:"Unknown error"),stack:t?.stack};this.onError({error:a,stage:e,timestamp:Date.now()})}getStats(){return{isTransforming:this.isTransforming,lastTransformTime:this.lastTransformTime,contentLength:{text:this.currentContent.text.length}}}async forcePreviewUpdate(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=void 0),await this.renderPreview()}async setDebugMode(e){try{await this.transformPipeline.setDebugMode(e)}catch(t){console.warn("Failed to set debug mode:",t)}}async pingTransformPipeline(){try{return await this.transformPipeline.ping({timestamp:Date.now()}),!0}catch(e){return console.warn("Transform pipeline ping failed:",e),!1}}async switchToSpineItem(e,t){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=void 0),this.isTransforming=!1,this.lastTransformTime=0,this.spineItemId=e,this.spineItem=t,this.currentContent={text:""};try{await this.loadInitialContent()}catch(a){console.warn("Failed to load initial content for spine item switch:",a)}}cleanup(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=void 0),this.transformPipeline.cleanup(),this.blobURLManager.cleanup(),this.isTransforming=!1,this.lastTransformTime=0}}function Qp(r,e,t,a,n,i,s,l,c={},d,u,p){const v={...{debounceMs:300,transformTimeout:3e3,autoSave:!0,persistToManifest:!0},...c};return new Zp(r,e,t,a,n,i,s,l,v,d,u,p)}const eh={debounceMs:300,transformTimeout:3e3,autoSave:!0,persistToManifest:!0};class kr extends Error{constructor(e,t){super(e),this.code=t,this.name="BlobURLError"}}class Gr extends kr{constructor(e,t){super(`Blob URL capacity exceeded: ${e}/${t}`,"CAPACITY_EXCEEDED")}}class Zi extends kr{constructor(e,t){super(e,"XHTML_PROCESSING_ERROR"),this.originalError=t}}class go{activeWorkspaceId=null;registry;fileStorage;basePath;supportsDirectBlobs;onCapacityReached;constructor(e){this.fileStorage=e.fileStorage,this.basePath=e.basePath,this.onCapacityReached=e.onCapacityReached,this.registry={urls:new Map,created:new Map,count:0,maxCount:e.maxBlobURLs||100},this.supportsDirectBlobs=this.fileStorage.supportsDirectBlobURLs()}setActiveWorkspace(e){this.activeWorkspaceId!==e&&(this.cleanup(),this.activeWorkspaceId=e)}async createBlobURL(e){if(this.registry.count>=this.registry.maxCount)throw this.onCapacityReached?.(),new Gr(this.registry.count,this.registry.maxCount);if(this.registry.urls.has(e))return this.registry.urls.get(e);if(!this.activeWorkspaceId)throw new kr("No active workspace set","NO_WORKSPACE");const t=this.resolveManifestPath(e);try{let a;const n=e.toLowerCase().endsWith(".css");if(this.supportsDirectBlobs&&!n){const i=await this.fileStorage.getFile(this.activeWorkspaceId,t),s=this.getMimeType(e),l=new File([i],i.name,{type:s});a=URL.createObjectURL(l)}else{let i;if(n){const c=await this.fileStorage.readTextFile(this.activeWorkspaceId,t),d=await this.processCSSFontURLs(c);i=new TextEncoder().encode(d).buffer}else i=await this.fileStorage.readFile(this.activeWorkspaceId,t);const s=this.getMimeType(e),l=new Blob([i],{type:s});a=URL.createObjectURL(l)}return this.addToRegistry(e,a),a}catch(a){throw new kr(`Failed to create blob URL for ${e}: ${a instanceof Error?a.message:String(a)}`,"CREATION_FAILED")}}createBlobFromContent(e,t){const a=new Blob([e],{type:t});return URL.createObjectURL(a)}async processXHTMLForPreview(e){if(this.isAtCapacity())throw this.onCapacityReached?.(),new Gr(this.getBlobURLCount(),this.registry.maxCount);try{const a=new DOMParser().parseFromString(e,"application/xhtml+xml");if(a.documentElement&&a.documentElement.tagName==="parsererror")throw new Zi("Invalid XHTML content");const n=this.findAssetElements(a);for(const s of n)await this.processAssetElement(s);return new XMLSerializer().serializeToString(a)}catch(t){throw t instanceof kr?t:new Zi(`XHTML processing failed: ${t instanceof Error?t.message:String(t)}`,t instanceof Error?t:new Error(String(t)))}}revokeBlobURL(e){URL.revokeObjectURL(e),this.removeFromRegistry(e)}revokeFileBlob(e){const t=this.registry.urls.get(e);t&&this.revokeBlobURL(t)}cleanup(){for(const e of this.registry.urls.values())URL.revokeObjectURL(e);this.registry.urls.clear(),this.registry.created.clear(),this.registry.count=0}getMimeType(e){return ho(e)}isResourcePath(e){return!e.startsWith("http")&&!e.startsWith("data:")&&!e.startsWith("blob:")&&!e.startsWith("/")&&!e.startsWith("ftp:")&&!e.startsWith("mailto:")&&!e.startsWith("tel:")&&!e.startsWith("file:")&&!e.startsWith("about:")&&!e.startsWith("javascript:")&&!e.startsWith("//")&&e.trim().length>0}getBlobURLCount(){return this.registry.count}isAtCapacity(){return this.registry.count>=this.registry.maxCount}resolveManifestPath(e){return this.basePath?`${this.basePath}/${e}`:e}findAssetElements(e){const t=[],a=["script[src]","link[href]","a[href]","audio[src]","video[src]","video[poster]","img[src]","object[data]","image[href]","*[data-src]"];for(const n of a){const i=e.querySelectorAll(n);t.push(...Array.from(i))}return t}async processAssetElement(e){let t;if(e.hasAttribute("src"))t="src";else if(e.hasAttribute("href"))t="href";else if(e.hasAttribute("data"))t="data";else if(e.hasAttribute("poster"))t="poster";else if(e.hasAttribute("data-src"))t="data-src";else return;const a=e.getAttribute(t);if(!(!a||!this.isResourcePath(a)))try{if(this.getBlobURLCount()>=this.registry.maxCount)throw this.onCapacityReached?.(),new Gr(this.getBlobURLCount(),this.registry.maxCount);const n=za(a),i=await this.createBlobURL(n);e.setAttribute(t,i)}catch(n){this.handleMissingAsset(e,a,n)}}handleMissingAsset(e,t,a){const n=e.tagName.toLowerCase(),i=za(t),s=this.resolveManifestPath(i);if(["img","video","audio","object","image"].includes(n)){console.warn(`Missing image: ${s} (referenced by <${n}> element)`);const l=e.hasAttribute("src")?"src":e.hasAttribute("href")?"href":"data";e.setAttribute(l,this.getErrorIconSVG()),e.setAttribute("alt",`Missing: ${t}`)}else["script","link"].includes(n)&&console.warn(`Missing asset: ${s} (referenced by <${n}> element)`)}getErrorIconSVG(){return`data:image/svg+xml,${encodeURIComponent(`
      <svg width="24" height="24" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" fill="#f44336" stroke="#d32f2f"/>
        <text x="12" y="16" text-anchor="middle" fill="white" font-size="12">!</text>
      </svg>
    `)}`}addToRegistry(e,t){this.registry.urls.set(e,t),this.registry.created.set(e,new Date),this.registry.count++}removeFromRegistry(e){for(const[t,a]of this.registry.urls.entries())if(a===e){this.registry.urls.delete(t),this.registry.created.delete(t),this.registry.count--;break}}async processCSSFontURLs(e){const t=/url\(\s*(['"]?)(.*?)\1\s*\)/g;let a=e;const n=Array.from(e.matchAll(t));for(const i of n){const s=i[0],l=i[1],c=i[2];if(this.isResourcePath(c))try{if(this.getBlobURLCount()>=this.registry.maxCount)throw this.onCapacityReached?.(),new Gr(this.getBlobURLCount(),this.registry.maxCount);const d=za(c),u=await this.createBlobURL(d),p=`url(${l}${u}${l})`;a=a.replace(s,p)}catch(d){console.warn(`Failed to process CSS url(${c}):`,d)}}return a}getLoadedGlobals(){return{}}}class mr extends Error{constructor(e,t){super(e),this.code=t,this.name="SettingsServiceError"}}class Qn{constructor(e,t,a,n){this.fileStorage=e,this.extensionManager=t,this.themeStore=a,this.i18nStore=n}static GLOBAL_SETTINGS_KEY="editme_global_settings";static SUPPORTED_LOCALES=new Set(["en","de","ar","he","ja","ka","zh-hant","fr","es","it","pt","ru","pl","nl","sv"]);static VALID_THEMES=new Set(["light","dark","system"]);loadGlobalSettings(){try{if(typeof localStorage>"u")return this.getDefaultGlobalSettings();const e=localStorage.getItem(Qn.GLOBAL_SETTINGS_KEY);if(!e)return this.getDefaultGlobalSettings();const t=JSON.parse(e);if(typeof t!="object"||!t)return this.getDefaultGlobalSettings();const a=this.getDefaultGlobalSettings();return{theme:this.isValidTheme(t.theme)?t.theme:a.theme,locale:this.isValidLocale(t.locale)?t.locale:a.locale,editor_font_size:this.isValidFontSize(t.editor_font_size)?t.editor_font_size:a.editor_font_size}}catch{return this.getDefaultGlobalSettings()}}saveGlobalSettings(e){try{if(typeof localStorage>"u")return;localStorage.setItem(Qn.GLOBAL_SETTINGS_KEY,JSON.stringify(e)),e.theme==="system"?this.themeStore.useSystemPreference():this.themeStore.setTheme(e.theme),this.i18nStore.setLocale(e.locale)}catch(t){throw new mr(`Failed to save global settings: ${t instanceof Error?t.message:"Unknown error"}`,"GLOBAL_SETTINGS_SAVE_ERROR")}}getDefaultGlobalSettings(){return{theme:"system",locale:"en",editor_font_size:14}}async loadWorkspaceSettings(e){try{const t=await this.fileStorage.readTextFile(e,".workspace-metadata.json"),a=JSON.parse(t),n=this.getDefaultWorkspaceSettings();return{bust_cache:a.bust_cache??n.bust_cache,draft_id:a.draft_id??n.draft_id,editor:{preview_delay_ms:a.editor?.preview_delay_ms??n.editor.preview_delay_ms,advanced_mode:a.editor?.advanced_mode??n.editor.advanced_mode}}}catch{return this.getDefaultWorkspaceSettings()}}async saveWorkspaceSettings(e,t){try{let a={};try{const i=await this.fileStorage.readTextFile(e,".workspace-metadata.json");a=JSON.parse(i)}catch{}const n={...a,bust_cache:t.bust_cache,draft_id:t.draft_id,editor:t.editor};await this.fileStorage.writeTextFile(e,".workspace-metadata.json",JSON.stringify(n,null,2))}catch(a){throw new mr(`Failed to save workspace settings: ${a instanceof Error?a.message:"Unknown error"}`,"WORKSPACE_SETTINGS_SAVE_ERROR")}}getDefaultWorkspaceSettings(){return{bust_cache:!1,draft_id:0,editor:{preview_delay_ms:500,advanced_mode:!1}}}async loadEPUBSettings(e){try{const t=await this.fileStorage.readTextFile(e,"SOURCE/settings.json"),a=JSON.parse(t),n=this.getDefaultEPUBSettings();return{text_transform:a.text_transform??n.text_transform,dom_transforms:a.dom_transforms??n.dom_transforms,spine_basename:a.spine_basename??n.spine_basename,cover:a.cover?{template:a.cover.template??"default",background_color:a.cover.background_color??"#ffffff",text_color:a.cover.text_color??"#000000",font_family:a.cover.font_family??"serif"}:void 0}}catch{return this.getDefaultEPUBSettings()}}async saveEPUBSettings(e,t){try{await this.fileStorage.writeTextFile(e,"SOURCE/settings.json",JSON.stringify(t,null,2))}catch(a){throw new mr(`Failed to save EPUB settings: ${a instanceof Error?a.message:"Unknown error"}`,"EPUB_SETTINGS_SAVE_ERROR")}}getDefaultEPUBSettings(){return{text_transform:"SOURCE/scripts/transformText.js",dom_transforms:["SOURCE/scripts/transformDom.js"],spine_basename:"chapter"}}async incrementDraftId(e){const t=await this.loadWorkspaceSettings(e),a=t.draft_id+1;return await this.saveWorkspaceSettings(e,{...t,draft_id:a}),a}generateDraftTitle(e,t){return`${e} (Draft ${t})`}extractDraftInfo(e){const t=e.match(/^(.+?)\s+\(Draft\s+(\d+)\)$/);return t?{baseTitle:t[1],draftId:parseInt(t[2],10)}:{baseTitle:e,draftId:null}}async getAvailableTransforms(e){try{return await this.extensionManager.getAvailableTransforms(e)}catch(t){throw new mr(`Failed to get available transforms: ${t instanceof Error?t.message:"Unknown error"}`,"TRANSFORM_DISCOVERY_ERROR")}}async resolveTransformScripts(e,t){try{let a=null;const n=[];if(t.text_transform)try{a=await this.fileStorage.readTextFile(e,t.text_transform)}catch{}for(const i of t.dom_transforms)try{const s=await this.fileStorage.readTextFile(e,i);n.push(s)}catch{}return{textTransform:a,domTransforms:n}}catch(a){throw new mr(`Failed to resolve transform scripts: ${a instanceof Error?a.message:"Unknown error"}`,"TRANSFORM_RESOLUTION_ERROR")}}validateGlobalSettings(e){const t=[],a=[];return e.theme!==void 0&&!this.isValidTheme(e.theme)&&t.push(`Invalid theme: ${e.theme}`),e.locale!==void 0&&!this.isValidLocale(e.locale)&&a.push(`Unsupported locale: ${e.locale}`),e.editor_font_size!==void 0&&!this.isValidFontSize(e.editor_font_size)&&t.push("Font size must be between 8-32 pixels"),{isValid:t.length===0,errors:t,warnings:a}}validateWorkspaceSettings(e){const t=[],a=[];if(e.draft_id!==void 0&&(e.draft_id<0||!Number.isInteger(e.draft_id))&&t.push("Draft ID must be a non-negative integer"),e.editor){const{preview_delay_ms:n}=e.editor;n!==void 0&&(n<100||n>2e3)&&t.push("Preview delay must be between 100-2000ms")}return{isValid:t.length===0,errors:t,warnings:a}}validateEPUBSettings(e){const t=[],a=[];if(e.text_transform!==void 0&&e.text_transform&&(e.text_transform.startsWith("SOURCE/")||t.push("Text transform must start with SOURCE/")),e.dom_transforms!==void 0)for(const n of e.dom_transforms)n.startsWith("SOURCE/")||t.push(`DOM transform must start with SOURCE/: ${n}`);if(e.spine_basename!==void 0&&!e.spine_basename.trim()&&t.push("Spine basename cannot be empty"),e.cover){const{background_color:n,text_color:i}=e.cover;n&&!this.isValidColor(n)&&t.push("Invalid background color format"),i&&!this.isValidColor(i)&&t.push("Invalid text color format")}return{isValid:t.length===0,errors:t,warnings:a}}isValidTheme(e){return Qn.VALID_THEMES.has(e)}isValidLocale(e){return typeof e=="string"&&e.length>0}isValidFontSize(e){return typeof e=="number"&&e>=8&&e<=32&&Number.isInteger(e)}isValidColor(e){return/^#[0-9A-Fa-f]{6}$/.test(e)}}function th(r){let e=r;return e.endsWith(".js")&&(e=e.slice(0,-3)),e.endsWith(".min")&&(e=e.slice(0,-4)),e=e.replace(/[-@](?:v?\d+[\.\-]\d+|\d+[\.\-]\d+)(?:[\.\-]\w+)*$/i,""),Ya(e)}function Ya(r){return r.toLowerCase().replace(/[^a-z0-9-]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").substring(0,50)}function nh(r){const e=r.name.toLowerCase();return e.endsWith(".js")?r.size===0?{isValid:!1,fileType:"javascript",error:"JavaScript file cannot be empty"}:r.size>50*1024*1024?{isValid:!1,fileType:"javascript",error:"JavaScript file too large (max 50MB)"}:{isValid:!0,fileType:"javascript"}:e==="license.txt"||e==="license"?r.size>1024*1024?{isValid:!1,fileType:"license",error:"License file too large (max 1MB)"}:{isValid:!0,fileType:"license"}:{isValid:!1,fileType:"unknown",error:"Invalid file type: only JavaScript (.js) and license files are supported"}}function Xn(r){const e=r.slice().sort((a,n)=>a.name.localeCompare(n.name)),t=r.reduce((a,n)=>a+n.size,0);return{files:e,totalSize:t}}function Ja(r,e){return r.totalSize!==e.totalSize||r.files.length!==e.files.length?!1:r.files.every((t,a)=>t.name===e.files[a].name&&t.size===e.files[a].size)}function rh(r){return!(!r||r.length===0||r.length>100||!/^[a-z0-9-]+$/.test(r)||r.startsWith("-")||r.endsWith("-")||/^-+$/.test(r))}const Nt="extensions-cache";class ah{constructor(e){this.fileStorage=e}async listCachedExtensions(){try{const e=await this.fileStorage.listFiles(Nt),t=new Set;for(const n of e){const i=n.split("/");i.length>=2&&t.add(i[0])}const a=[];for(const n of t)try{const i=await this.getExtensionInfo(n);a.push(i)}catch{}return a.sort((n,i)=>n.name.localeCompare(i.name))}catch(e){if(e instanceof Error&&e.message.includes("not found"))return[];throw e}}async getExtensionInfo(e){const a=(await this.fileStorage.listFiles(Nt)).filter(s=>s.startsWith(e+"/"));if(a.length===0)throw new Error(`Extension '${e}' not found in cache`);const n=[];let i=0;for(const s of a){const l=s.split("/").pop(),d={size:(await this.fileStorage.readFile(Nt,s)).byteLength};let u;if(l.endsWith(".js"))u="javascript";else if(l.toLowerCase().includes("license"))u="license";else continue;n.push({filename:s.replace(`${e}/`,""),size:d.size,type:u}),i+=d.size}if(n.length===0)throw new Error(`Extension '${e}' has no valid files`);return{name:e,files:n,totalSize:i,location:"cache"}}async cacheExtension(e,t){if(await this.hasConflict(e,t))throw new Error(`Extension '${e}' already cached with different content`);for(const[n,i]of t.entries()){const s=`${e}/${n}`;await this.fileStorage.writeFile(Nt,s,i)}}async copyToWorkspace(e,t){const n=(await this.fileStorage.listFiles(Nt)).filter(i=>i.startsWith(e+"/"));if(n.length===0)throw new Error(`Extension '${e}' not found in cache`);for(const i of n){const s=await this.fileStorage.readFile(Nt,i),l=`SOURCE/extensions/${i}`;await this.fileStorage.writeFile(t,l,s)}}async deleteExtension(e){const a=(await this.fileStorage.listFiles(Nt)).filter(n=>n.startsWith(e+"/"));if(a.length===0)throw new Error(`Extension '${e}' not found in cache`);for(const n of a)await this.fileStorage.deleteFile(Nt,n)}async hasConflict(e,t){try{const a=await this.getExtensionInfo(e),n=Xn(Array.from(t.keys()).map(s=>({name:s,size:t.get(s).byteLength}))),i=Xn(a.files.map(s=>({name:s.filename,size:s.size})));return!Ja(n,i)}catch{return!1}}async getExtensionSignature(e){try{const a=(await this.fileStorage.listFiles(Nt)).filter(i=>i.startsWith(e+"/"));if(a.length===0)return null;const n=[];for(const i of a){const s=i.split("/").pop();if(s.endsWith(".js")||s.toLowerCase().includes("license"))try{const l=await this.fileStorage.getFileInfo(Nt,i);n.push({name:s,size:l.size})}catch{const l=await this.fileStorage.readFile(Nt,i);n.push({name:s,size:l.byteLength})}}return Xn(n)}catch{return null}}async addToCache(e,t){const n=(await this.fileStorage.listFiles(e)).filter(s=>s.startsWith(`SOURCE/extensions/${t}/`));if(n.length===0)throw new Error(`Extension '${t}' does not exist in workspace`);const i=new Map;for(const s of n){const l=s.replace(`SOURCE/extensions/${t}/`,""),c=await this.fileStorage.readFile(e,s);i.set(l,c)}await this.cacheExtension(t,i)}async removeFromCache(e){await this.deleteExtension(e)}get cacheWorkspaceId(){return Nt}async importFromCache(e,t){if((await this.fileStorage.listFiles(t)).some(i=>i.startsWith(`SOURCE/extensions/${e}/`)))throw new Error(`Extension '${e}' already exists in workspace`);await this.copyToWorkspace(e,t)}async deleteCachedExtension(e){await this.deleteExtension(e)}async isCached(e){try{return await this.getExtensionInfo(e),!0}catch{return!1}}async compareExtensions(e,t,a){try{const i=(await this.fileStorage.listFiles(e)).filter(u=>u.startsWith(`SOURCE/extensions/${t}/`)),l=(await this.fileStorage.listFiles(Nt)).filter(u=>u.startsWith(`${a}/`));if(i.length!==l.length)return!0;const c=await this.createWorkspaceSignature(e,t,i),d=await this.createCacheSignature(a,l);return!Ja(c,d)}catch{return!0}}async createWorkspaceSignature(e,t,a){const n=[];for(const i of a){const s=i.replace(`SOURCE/extensions/${t}/`,""),l=i.split("/").pop();if(l.endsWith(".js")||l.toLowerCase().includes("license")){const c=await this.fileStorage.readFile(e,i);n.push({name:s,size:c.byteLength})}}return Xn(n)}async createCacheSignature(e,t){const a=[];for(const n of t){const i=n.replace(`${e}/`,""),s=n.split("/").pop();if(s.endsWith(".js")||s.toLowerCase().includes("license")){const l=await this.fileStorage.readFile(Nt,n);a.push({name:i,size:l.byteLength})}}return Xn(a)}async getCacheStats(){const e=await this.listCachedExtensions(),t={};for(const a of e)t[a.name]=a.files.length;return{totalExtensions:e.length,totalSize:e.reduce((a,n)=>a+n.totalSize,0),extensionCount:t}}}class Ei{constructor(e){if(this.fileStorage=e,!e)throw new Error("FileStorageAPI is required");this.cache=new ah(e)}cache;get extensionCache(){return this.cache}async importExtension(e,t,a){const n=Ya(a);if(!rh(n))throw new Error(`Invalid extension name: '${a}' contains illegal characters`);const i=this.validateExtensionFile(t);if(!i.isValid)throw new Error(i.error);if((await this.listWorkspaceExtensions(e)).some(u=>u.name===n))throw new Error(`Extension '${n}' already exists in workspace`);const l=await t.arrayBuffer(),c=`SOURCE/extensions/${n}/${t.name}`;await this.fileStorage.writeFile(e,c,l);const d=new Map([[t.name,l]]);try{await this.cache.cacheExtension(n,d)}catch{}return{name:n,files:[{filename:t.name,size:t.size,type:i.fileType}],totalSize:t.size,location:"workspace"}}async addFileToExtension(e,t,a){const n=this.validateExtensionFile(a);if(!n.isValid)throw new Error(n.error);if(!(await this.listWorkspaceExtensions(e)).some(d=>d.name===t))throw new Error(`Extension '${t}' does not exist in workspace`);const s=`SOURCE/extensions/${t}/${a.name}`;if(await this.fileStorage.fileExists(e,s))throw new Error(`File '${a.name}' already exists in extension '${t}'`);const c=await a.arrayBuffer();await this.fileStorage.writeFile(e,s,c);try{const d=await this.getWorkspaceExtensionFiles(e,t);await this.cache.cacheExtension(t,d)}catch{}}async listWorkspaceExtensions(e){try{const a=(await this.fileStorage.listFiles(e)).filter(s=>s.startsWith("SOURCE/extensions/")),n=new Set;for(const s of a){const l=s.split("/");l.length>=3&&n.add(l[2])}const i=[];for(const s of n)try{const l=await this.getWorkspaceExtensionInfo(e,s);i.push(l)}catch{}return i.sort((s,l)=>s.name.localeCompare(l.name))}catch(t){if(t instanceof Error&&t.message.includes("not found"))return[];throw t}}async deleteWorkspaceExtension(e,t){const n=(await this.fileStorage.listFiles(e)).filter(i=>i.startsWith(`SOURCE/extensions/${t}/`));if(n.length===0)throw new Error(`Extension '${t}' does not exist in workspace`);for(const i of n)await this.fileStorage.deleteFile(e,i)}async getExtensionLicense(e,t){try{const a=`SOURCE/extensions/${t}/LICENSE.txt`,n=await this.fileStorage.readFile(e,a);return new TextDecoder().decode(n)}catch{return""}}async saveExtensionLicense(e,t,a){if(!(await this.listWorkspaceExtensions(e)).some(c=>c.name===t))throw new Error(`Extension '${t}' does not exist in workspace`);const i=`SOURCE/extensions/${t}/LICENSE.txt`,l=new TextEncoder().encode(a);await this.fileStorage.writeFile(e,i,l.buffer)}async listCachedExtensions(){return this.cache.listCachedExtensions()}async importFromCache(e,t){if(!(await this.cache.listCachedExtensions()).some(i=>i.name===t))throw new Error(`Extension '${t}' not found in cache`);if((await this.listWorkspaceExtensions(e)).some(i=>i.name===t))throw new Error(`Extension '${t}' already exists in workspace`);await this.cache.copyToWorkspace(t,e)}async deleteCachedExtension(e){await this.cache.deleteExtension(e)}async cacheExtension(e,t){if(!(await this.fileStorage.listFiles(e)).some(l=>l.startsWith(`SOURCE/extensions/${t}/`)))throw new Error(`Extension '${t}' does not exist in workspace`);const i=await this.cache.getExtensionSignature(t);if(i){const l=await this.getWorkspaceExtensionSignature(e,t);if(Ja(i,l))return;throw new Error(`Extension '${t}' already cached with different content`)}const s=await this.getWorkspaceExtensionFiles(e,t);await this.cache.cacheExtension(t,s)}async scanAndCacheExtensions(e){const t=await this.listWorkspaceExtensions(e),a={successCount:0,totalScanned:t.length,conflicts:[],errors:[]};for(const n of t)try{const i=await this.getWorkspaceExtensionFiles(e,n.name);if(await this.cache.hasConflict(n.name,i)){a.conflicts.push(n.name);continue}await this.cache.cacheExtension(n.name,i),a.successCount++}catch(i){a.errors.push({extensionName:n.name,reason:"storage",message:i instanceof Error?i.message:"Unknown error"})}return a}detectExtensionName(e){return th(e)}validateExtensionFile(e){return nh(e)}normalizeExtensionName(e){return Ya(e)}compareExtensions(e,t){const a=e.name||"unknown",n=t.name||"unknown";if(a!==n||e.totalSize!==t.totalSize||e.files.length!==t.files.length)return!1;const i=e.files.slice().sort((l,c)=>(l.filename||l.name).localeCompare(c.filename||c.name)),s=t.files.slice().sort((l,c)=>(l.filename||l.name).localeCompare(c.filename||c.name));return i.every((l,c)=>{const d=s[c],u=l.filename||l.name,p=d.filename||d.name;return u===p&&l.size===d.size})}sanitizeFilename(e){return e.replace(/\.\.\//g,"").replace(/\.\.\\/g,"").replace(/[<>:"/\\|?*\x00-\x1f]/g,"-").replace(/^\.+/,"").replace(/\.+$/,"").replace(/-+/g,"-").replace(/^-|-$/g,"").substring(0,255)}async getWorkspaceExtensionSignature(e,t){const n=(await this.fileStorage.listFiles(e)).filter(s=>s.startsWith(`SOURCE/extensions/${t}/`));if(n.length===0)throw new Error(`Extension '${t}' does not exist in workspace`);const i=[];for(const s of n){const l=s.split("/").pop();if(l.endsWith(".js")||l.toLowerCase().includes("license"))try{const c=await this.fileStorage.getFileInfo(e,s);i.push({name:l,size:c.size})}catch{const c=await this.fileStorage.readFile(e,s);i.push({name:l,size:c.byteLength})}}return Xn(i)}async getWorkspaceExtensionInfo(e,t){const n=(await this.fileStorage.listFiles(e)).filter(l=>l.startsWith(`SOURCE/extensions/${t}/`));if(n.length===0)throw new Error(`Extension '${t}' does not exist in workspace`);const i=[];let s=0;for(const l of n){const c=l.split("/").pop(),u={size:(await this.fileStorage.readFile(e,l)).byteLength};let p;if(c.endsWith(".js"))p="javascript";else if(c.toLowerCase().includes("license"))p="license";else continue;i.push({filename:c,size:u.size,type:p}),s+=u.size}return{name:t,files:i,totalSize:s,location:"workspace"}}async getWorkspaceExtensionFiles(e,t){const n=(await this.fileStorage.listFiles(e)).filter(s=>s.startsWith(`SOURCE/extensions/${t}/`)),i=new Map;for(const s of n){const l=s.split("/").pop(),c=await this.fileStorage.readFile(e,s);i.set(l,c)}return i}async getAvailableTransforms(e){const t=[];try{const a=await this.fileStorage.listFiles(e),n=a.filter(s=>s.startsWith("SOURCE/")&&s.endsWith(".js"));for(const s of n){const l=s.split("/").pop()||"";(l.includes("transform")||l.includes("Transform")||l==="transformText.js"||l==="transformDom.js")&&t.push({path:s,extensionName:`Transform: ${l}`,fileName:l})}const i=a.filter(s=>s.startsWith("SOURCE/extensions/")&&s.endsWith(".js")&&(s.includes("transform")||s.includes("Transform")));for(const s of i){const l=s.split("/"),c=l.pop()||"",d=l[2]||"Unknown Extension";t.push({path:s,extensionName:d,fileName:c})}}catch(a){console.warn("Failed to get available transforms:",a)}return t}}const Zr=new Set;let Qi=0;function wo(r,e=""){if(Zr.has(r))throw new Error(`Editor ID "${r}" is already in use`);Zr.add(r);function t(){return Qi++,Date.now()+Qi*.001}const a=Jt({content:e,isEmpty:e.trim()==="",lastUpdated:t()}),n=[];function i(u){typeof u=="string"&&a.update(p=>({content:u,isEmpty:u.trim()==="",lastUpdated:t()}))}function s(){a.update(u=>({content:"",isEmpty:!0,lastUpdated:t()}))}function l(){let u="";return a.subscribe(h=>{u=h.content})(),u}function c(u){const p=a.subscribe(u);return n.push(p),()=>{p();const h=n.indexOf(p);h>-1&&n.splice(h,1)}}function d(){n.forEach(u=>u()),n.length=0,Zr.delete(r)}return{subscribe:c,updateContent:i,reset:s,getContent:l,destroy:d}}function ih(){Zr.clear()}var sh=I('<div class="loading-state svelte-19lb94x"><div class="spinner svelte-19lb94x"></div> <p> </p></div>'),oh=I('<div class="error-state svelte-19lb94x"><span class="error-icon svelte-19lb94x">⚠️</span> <p> </p></div>'),lh=I('<div class="empty-state svelte-19lb94x"><div class="empty-icon svelte-19lb94x">📚</div> <h3 class="svelte-19lb94x"> </h3> <p class="svelte-19lb94x"> </p></div>'),ch=I('<div data-spine-view="" class="spine-editor-wrapper svelte-19lb94x"><!></div>'),dh=I('<div class="loading-state svelte-19lb94x"><div class="spinner svelte-19lb94x"></div> <p> </p></div>');function uh(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=()=>Qe(le,"$transformError",t),s=()=>Qe(Q,"$transformWarnings",t),l=()=>Qe(Ie,"$isTransforming",t),c=()=>Qe(Me,"$executionTime",t);let d=$(e,"workspace",8),u=$(e,"workspaceService",8),p=$(e,"spineService",8),h=$(e,"contentService",8),v=$(e,"selectedItemId",12,null),m=$(e,"transformEngine",8),y=Ke(null),b=Ke(!1),M=Ke(null),T,E,C,k,X,P=Ke(!1),z=Ke(null),U={text:""},F=[],S=Ke([]),W=Ke([]),R=Ke(null),D=!1,N=Ke(),A=Ke({mode:"single",pane1:{filePath:"",fileHref:"",fileType:"",contentType:null,selectedFileValue:"",content:""},pane2:{filePath:"",fileHref:"",fileType:"",contentType:null,selectedFileValue:"",content:""}});const B=Jt(""),Q=Jt([]),le=Jt(null),Ie=Jt(!1),Me=Jt(0);let Oe=Ke(null),Le=Ke(null),fe=new Map,Y=Ke(null),te=Ke(null),ae=Ke(null);const be=tn();function ke(L){Ae(),v()&&oe()}function We(){}function je(){return{selectedItemId:v(),selectedItem:o(y)}}function Re(L){L.selectedItemId&&(v(L.selectedItemId),oe())}async function Be(){return!0}async function Ae(){if(!o(P))try{E=Ot.getInstance(),C=new Ei(E),k=new go({fileStorage:E,basePath:"OEBPS",maxBlobURLs:100,onCapacityReached:()=>{console.warn("Blob URL capacity reached - consider cleanup")}}),X=new Qn(E,C,la,po),w(P,!0)}catch(L){w(M,L instanceof Error?L.message:"Failed to initialize services"),console.error("Failed to initialize spine editor services:",L)}}function $e(){if(o(A).mode==="single")w(S,F),w(W,F);else{const L=o(A).pane1.fileType==="text",re=o(A).pane2.fileType==="text";w(S,F.filter(ie=>!(ie.type==="text"&&re))),w(W,F.filter(ie=>!(ie.type==="text"&&L)))}}async function Ve(){if(!(!v()||!o(P)))try{const L=[{value:"text",label:"Text Content",path:`SOURCE/text/${v()}.txt`,href:`SOURCE/text/${v()}.txt`,type:"text"}];try{const re=await E.listFiles(d().id,"OEBPS/Styles");for(const ie of re)if(ie.endsWith(".css")){const _e=ie.split("/").pop()?.replace(".css","")||ie,ze=ie.startsWith("OEBPS/")?ie.substring(6):ie;L.push({value:`css-${_e}`,label:`CSS: ${_e}`,path:ie,href:ze,type:"css"})}}catch{}try{const re=await E.listFiles(d().id,"OEBPS/Scripts");for(const ie of re)if(ie.endsWith(".js")){const _e=ie.split("/").pop()?.replace(".js","")||ie,ze=ie.startsWith("OEBPS/")?ie.substring(6):ie;L.push({value:`js-${_e}`,label:`JS: ${_e}`,path:ie,href:ze,type:"javascript"})}}catch{}try{const re=await E.listFiles(d().id,"SOURCE/scripts");for(const ie of re)if(ie.endsWith(".js")){const _e=ie.split("/").pop()?.replace(".js","")||ie;L.push({value:`transform-${_e}`,label:`Transform: ${_e}`,path:ie,href:ie,type:"transform"})}}catch{}F=L,$e()}catch(L){console.error("Failed to load available files:",L),F=[{value:"text",label:"Text Content",path:`SOURCE/text/${v()}.txt`,href:`SOURCE/text/${v()}.txt`,type:"text"}],$e()}}async function ve(L,re,ie){const _e=L.path,ze=`file-content-${_e.replace(/[^a-zA-Z0-9]/g,"-")}`;let qe="";try{const it=await ie.readFile(re,_e);qe=new TextDecoder().decode(it)}catch{}const Xe=wo(ze,qe);let Ze;return Xe.subscribe(it=>{o(z)&&(clearTimeout(Ze),Ze=setTimeout(async()=>{try{await ie.writeFile(re,L.path,it.content),L.type==="text"?o(z).updateContent("text",it.content):["css","javascript","transform"].includes(L.type)&&(L.href&&k&&k.revokeFileBlob(L.href),o(z).forcePreviewUpdate())}catch(pt){console.error("Auto-save failed:",pt)}},300))}),Xe}async function me(L,re,ie){try{const _e=L.path;if(fe.has(_e))return fe.get(_e);const ze=await ve(L,re,ie);return fe.has(_e)?(ze.destroy(),fe.get(_e)):(fe.set(_e,ze),ze)}catch(_e){return console.error(`Failed to get/create file store for ${L.path}:`,_e),null}}async function Ee(){if(!(!v()||!o(P)))try{if(await Ve(),!o(y)||o(y).id!==v()){console.warn("⚠️ Spine item synchronization issue:",{selectedItemId:v(),selectedItemActualId:o(y)?.id,selectedItem:o(y)});return}o(z)?await o(z).switchToSpineItem(o(y).idref,o(y)):(w(z,Qp(d().id,o(y).idref,E,C,k,u(),X,m(),eh,pe,ye,o(y))),await o(z).initialize(),await o(z).loadInitialContent()),U=o(z).getCurrentContent(),await He()}catch(L){w(M,L instanceof Error?L.message:"Failed to initialize spine editor"),console.error("Failed to initialize spine editor:",L)}}async function He(){if(F.length===0)return;const L=Ct.getViewData("spine");if(L&&(L.pane1||L.pane2))await se(L);else{const re=F.find(ie=>ie.type==="text");if(re){const ie=ee(re.type);et(A,o(A).mode="single"),et(A,o(A).pane1={filePath:re.path,fileHref:re.href,fileType:re.type,contentType:ie,selectedFileValue:re.value,content:""}),console.warn("restoreOrInitializePaneContent bypassed loadFileIntoPane for text content"),q()}}o(z)&&await o(z).forcePreviewUpdate()}function ee(L){return L==="text"?"text":null}function Se(L){return L==="text"}async function ge(L){const{pane:re,filePath:ie,fileType:_e}=L.detail,ze=F.find(ht=>ht.path===ie);if(!ze)return;const qe=ze.href,Xe=ze.value,Ze=`pane${re}`,it=ee(_e);et(A,o(A)[Ze]={filePath:ie,fileHref:qe,fileType:_e,contentType:it,selectedFileValue:Xe,content:""}),w(re===1?Oe:Le,null),re===2&&o(A).mode==="single"&&et(A,o(A).mode="dual"),q();const pt=await me(ze,d().id,u());pt?w(re===1?Y:te,pt):console.error("❌ Failed to create file store for:",ie),$e()}function Ge(L){if(!L||L.trim()==="")return null;try{return new Function(L),null}catch(re){return re instanceof SyntaxError?`JavaScript syntax error: ${re.message}`:`JavaScript validation error: ${re instanceof Error?re.message:String(re)}`}}function H(L){const{pane:re,content:ie}=L.detail,_e=`pane${re}`;et(A,o(A)[_e].content=ie);const{contentType:ze,filePath:qe,fileHref:Xe,fileType:Ze}=o(A)[_e];if((Ze.includes("javascript")||Ze.includes("js")||Ze==="transform")&&ie.trim()){const it=Ge(ie);if(it){w(re===1?Oe:Le,it);return}else w(re===1?Oe:Le,null)}else w(re===1?Oe:Le,null);ze&&o(z)&&(U[ze]=ie,o(z).updateContent(ze,ie)),qe&&de(qe,Xe,ie)}async function G(){const L=o(A).mode==="single"?"dual":"single";if(L==="dual"){let re=null;if(o(A).pane1.fileType==="text"&&o(A).pane2.fileType==="text"?(re=F.find(ie=>ie.type!=="text"),console.log("🔄 Text conflict resolved: moving pane 2 from text to",re?.label||"empty")):(!o(A).pane2.selectedFileValue||o(A).pane2.selectedFileValue==="")&&(re=F[0]),re){et(A,o(A).pane2={selectedFileValue:re.value,filePath:re.path,fileType:re.type,fileHref:re.href,contentType:"text",content:""});try{const ie=await me(re,d().id,u());ie&&w(te,ie)}catch(ie){console.error("Failed to create store for pane 2 default selection:",ie)}}}et(A,o(A).mode=L),q(),$e()}let J=new Map;function de(L,re,ie){const _e=J.get(L);_e&&clearTimeout(_e);const ze=setTimeout(async()=>{try{if(!we(L,ie))return;await E.writeTextFile(d().id,L,ie),k&&(L.includes("/Styles/")||L.includes("/Scripts/"))&&(k.revokeFileBlob(re),o(z)&&o(z).forcePreviewUpdate())}catch{}finally{J.delete(L)}},500);J.set(L,ze)}function we(L,re){if(L.includes("SOURCE/text/")&&v()){const ie=`SOURCE/text/${v()}.txt`;if(L!==ie)return!1;if(re.includes("chapter")||re.includes("Chapter")){const _e=L.match(/chapter(\d+)/)?.[1];if(_e&&re.toLowerCase().includes("chapter")&&!re.toLowerCase().includes(`chapter ${_e}`)&&!re.toLowerCase().includes(`chapter${_e}`))return!1}}return!0}function q(){const L={pane1:o(A).pane1.fileType?{fileType:o(A).pane1.fileType,selectedFile:o(A).pane1.filePath}:null,pane2:o(A).pane2.fileType?{fileType:o(A).pane2.fileType,selectedFile:o(A).pane2.filePath}:null,mode:o(A).mode};Ct.setViewData("spine",L)}async function se(L){et(A,o(A).mode=L.mode),L.pane1&&await ce(1,L.pane1),L.pane2&&await ce(2,L.pane2)}async function ce(L,re){const{fileType:ie,selectedFile:_e,content:ze}=re;let qe;if(ie==="text"?qe=F.find(Xe=>Xe.type==="text"):_e?(qe=F.find(Xe=>Xe.path===_e),qe||(qe=F.find(Xe=>Xe.type===ie))):qe=F.find(Xe=>Xe.type===ie),qe){const Xe=ee(qe.type),Ze=`pane${L}`;et(A,o(A)[Ze]={filePath:qe.path,fileHref:qe.href,fileType:qe.type,contentType:Xe,selectedFileValue:qe.value,content:""});const it=await me(qe,d().id,u());it?w(L===1?Y:te,it):console.error("❌ Pane restoration failed - could not create store for:",qe.path)}}function pe(L){B.set(L.xhtml),Q.set(L.warnings),le.set(null),Ie.set(!1),Me.set(L.executionTime),be("previewUpdate",{xhtmlContent:L.xhtml,isTransforming:!1,transformError:null,transformWarnings:L.warnings,executionTime:L.executionTime,spineItemId:v()})}function ye(L){le.set(L.error),Ie.set(!1),be("previewUpdate",{xhtmlContent:"",isTransforming:!1,transformError:L.error,transformWarnings:[],executionTime:0,spineItemId:v()})}async function Ce(){if(o(z)){Ie.set(!0);try{await o(z).forcePreviewUpdate()}catch(L){ye({error:{stage:"manual-update",message:L instanceof Error?L.message:"Manual update failed"}})}}}function Ne(L){o(N)&&typeof o(N).findAndSelectText=="function"&&o(N).findAndSelectText(L.detail)}let Fe=null;async function oe(){if(!(!v()||!p())&&!D){if(Fe)try{await Fe}catch{}D=!0,Fe=Ue();try{await Fe}finally{Fe=null,D=!1}}}async function Ue(){w(b,!0),w(M,null);try{const re=(await p().loadSpineItems(d())).find(qe=>qe.id===v())||null,ie=o(y)?.id,_e=re?.id,ze=ie&&_e&&ie!==_e;w(y,re),o(y)&&o(P)&&(ze?await Je():await Ee())}catch(L){w(M,L instanceof Error?L.message:"Failed to load spine item")}finally{w(b,!1)}}async function Je(){try{await Ve(),await De(),await Ee()}catch(L){w(M,L instanceof Error?L.message:"Failed to switch spine item")}}async function De(){for(const[L,re]of J)clearTimeout(re);if(J.clear(),JSON.parse(JSON.stringify(o(A))),o(A).pane1.fileType&&Se(o(A).pane1.fileType)){o(A).pane1.filePath;const L=`SOURCE/text/${v()}.txt`;et(A,o(A).pane1.filePath=L),et(A,o(A).pane1.fileHref=L)}if(o(A).pane2.fileType&&Se(o(A).pane2.fileType)){o(A).pane2.filePath;const L=`SOURCE/text/${v()}.txt`;et(A,o(A).pane2.filePath=L),et(A,o(A).pane2.fileHref=L)}}on(()=>{T=Ct.addNavigationGuard(Be),ke()}),cr(()=>{for(const[L,re]of fe)re.destroy();fe.clear(),T&&Ct.removeNavigationGuard(T)}),_t(()=>(wt(d()),o(ae),wt(m())),()=>{if(d()?.id&&(o(ae)===null||d().id!==o(ae))){for(const[L,re]of fe)re.destroy();fe.clear(),w(Y,null),w(te,null),ih(),m().setWorkspaceExtensions(d().id).catch(L=>{console.error("Failed to load workspace extensions:",L)})}w(ae,d()?.id||null)}),_t(()=>(wt(v()),o(R),wt(d()),wt(p()),o(P)),()=>{v()!==o(R)&&(w(R,v()),d()&&p()&&(o(P)||Ae(),v()?oe():(w(y,null),w(M,null),w(z,null))))}),sn(),Rt();var Z=lt(),V=Ye(Z);{var he=L=>{var re=sh(),ie=g(f(re),2),_e=f(ie);O(ze=>x(_e,ze),[()=>n()("Loading spine item...")],Te),_(L,re)},K=(L,re)=>{{var ie=ze=>{var qe=oh(),Xe=g(f(qe),2),Ze=f(Xe);O(()=>x(Ze,o(M))),_(ze,qe)},_e=(ze,qe)=>{{var Xe=it=>{var pt=lh(),ht=g(f(pt),2),St=f(ht),mt=g(ht,2),gt=f(mt);O(($t,Ft)=>{x(St,$t),x(gt,Ft)},[()=>n()("No spine item selected"),()=>n()("Select a spine item from the sidebar to start editing")],Te),_(it,pt)},Ze=(it,pt)=>{{var ht=mt=>{var gt=ch(),$t=f(gt);Bt(Mp($t,{get availableFiles1(){return o(S)},get availableFiles2(){return o(W)},get transformError(){return i()},get transformWarnings(){return s()},get isTransforming(){return l()},get executionTime(){return c()},get editorMode(){return o(A).mode},get pane1SelectedFile(){return o(A).pane1.selectedFileValue},get pane2SelectedFile(){return o(A).pane2.selectedFileValue},get pane1FileStore(){return o(Y)},get pane2FileStore(){return o(te)},get contentService(){return h()},onPaneToggle:()=>G(),onFileSelect:(Ft,pn,Nn)=>ge({detail:{pane:Ft,filePath:pn,fileType:Nn}}),onContentChange:(Ft,pn)=>H({detail:{pane:Ft,content:pn}}),onForceUpdate:()=>Ce(),get pane1Error(){return o(Oe)},set pane1Error(Ft){w(Oe,Ft)},get pane2Error(){return o(Le)},set pane2Error(Ft){w(Le,Ft)},$$legacy:!0}),Ft=>w(N,Ft),()=>o(N)),at("preview-click",gt,Ne),_(mt,gt)},St=mt=>{var gt=dh(),$t=g(f(gt),2),Ft=f($t);O(pn=>x(Ft,pn),[()=>n()("Initializing editor...")],Te),_(mt,gt)};j(it,mt=>{o(y)&&o(P)&&o(z)?mt(ht):mt(St,!1)},pt)}};j(ze,it=>{v()?it(Ze,!1):it(Xe)},qe)}};j(L,ze=>{o(M)?ze(ie):ze(_e,!1)},re)}};j(V,L=>{o(b)?L(he):L(K,!1)})}_(r,Z),Ut(e,"onViewEnter",ke),Ut(e,"onViewLeave",We),Ut(e,"getViewData",je),Ut(e,"setViewData",Re),Ut(e,"canLeave",Be);var xe=nt({onViewEnter:ke,onViewLeave:We,getViewData:je,setViewData:Re,canLeave:Be});return a(),xe}function fh(r,e){w(e,!o(e))}var ph=I('<div class="license-preview svelte-1ksqegs"><span class="license-preview-text svelte-1ksqegs"> </span></div>'),hh=I('<div class="license-section svelte-1ksqegs"><textarea class="license-textarea svelte-1ksqegs"></textarea></div>'),vh=I('<li class="extension-item svelte-1ksqegs"><div class="extension-header svelte-1ksqegs"><span class="extension-name svelte-1ksqegs"> </span> <div class="extension-actions svelte-1ksqegs"><button type="button" class="license-button svelte-1ksqegs"> </button> <button type="button" class="remove-button svelte-1ksqegs"> </button></div></div> <!> <!></li>');function mh(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=Pe(!1),s=Pe(""),l=Pe(!1);const c=ne(()=>{if(!o(s)||!o(s).trim())return"";const F=o(s).split(`
`)[0].trim();return F.length>60?F.substring(0,57)+"...":F});let d=null;Et(()=>{e.workspaceId&&e.extension.name&&u()});async function u(){try{w(l,!0),w(s,await e.extensionManager.getExtensionLicense(e.workspaceId,e.extension.name),!0)}catch(F){console.error("Failed to load license text:",F),w(s,"")}finally{w(l,!1)}}function p(){e.isAdvancedMode&&(d&&clearTimeout(d),d=setTimeout(()=>{h()},500))}async function h(){try{await e.extensionManager.saveExtensionLicense(e.workspaceId,e.extension.name,o(s))}catch(F){console.error("Failed to save license text:",F)}}Et(()=>()=>{d&&clearTimeout(d)});var v=vh(),m=f(v),y=f(m),b=f(y),M=g(y,2),T=f(M);T.__click=[fh,i];var E=f(T),C=g(T,2);C.__click=function(...F){e.onRemove?.apply(this,F)};var k=f(C),X=g(m,2);{var P=F=>{var S=ph(),W=f(S),R=f(W);O(()=>x(R,o(c))),_(F,S)};j(X,F=>{o(c)&&F(P)})}var z=g(X,2);{var U=F=>{var S=hh(),W=f(S);W.__input=p,O(R=>{ue(W,"placeholder",R),W.readOnly=!e.isAdvancedMode,W.disabled=o(l)},[()=>n()("Paste {name} license text here",{name:e.extension.name})]),Sr(W,()=>o(s),R=>w(s,R)),_(F,S)};j(z,F=>{o(i)&&F(U)})}O((F,S)=>{x(b,e.extension.name),T.disabled=o(l),x(E,F),C.disabled=!e.isAdvancedMode,x(k,S)},[()=>n()("License"),()=>n()("Remove")]),_(r,v),nt(),a()}yt(["click","input"]);async function gh(r,e,t,a,n){if(!e.workspaceId||!o(t))return;const s=r.target.checked,l={...o(t),editor:{preview_delay_ms:o(t).editor?.preview_delay_ms??500,advanced_mode:s}};w(t,l,!0);try{await e.settingsService.saveWorkspaceSettings(e.workspaceId,l),e.onSettingsChanged?.()}catch(c){w(a,c instanceof Error?c.message:n()("Failed to save settings"),!0),w(t,{...o(t),editor:{preview_delay_ms:o(t).editor?.preview_delay_ms??500,advanced_mode:!s}},!0)}}var wh=I('<p class="no-workspace-message svelte-1qxmh9x"> </p>'),yh=I('<p class="loading-message svelte-1qxmh9x"> </p>'),bh=I('<div class="error-message svelte-1qxmh9x" role="alert"><strong> </strong> </div>'),xh=I('<p class="advanced-mode-note svelte-1qxmh9x"> </p>'),_h=I("<p> </p>"),Sh=I("<p> </p>"),Eh=I('<ul class="extensions-list svelte-1qxmh9x"></ul>'),kh=I('<div class="settings-content svelte-1qxmh9x"><section class="workspace-settings svelte-1qxmh9x"><h2 class="svelte-1qxmh9x"> </h2> <div class="setting-group svelte-1qxmh9x"><label class="setting-label svelte-1qxmh9x"><input type="checkbox" class="svelte-1qxmh9x"/> <span class="setting-text svelte-1qxmh9x"> </span></label> <p class="setting-description svelte-1qxmh9x"> </p></div></section> <section class="extensions-settings svelte-1qxmh9x"><h2 class="svelte-1qxmh9x"> </h2> <div><label for="extension-file" class="svelte-1qxmh9x"> </label> <input id="extension-file" type="file" accept=".js" class="svelte-1qxmh9x"/> <!></div> <!></section></div>'),Th=I('<div class="settings-view svelte-1qxmh9x"><div class="settings-header svelte-1qxmh9x"><h1 class="svelte-1qxmh9x"> </h1> <!></div> <!> <!></div>');function Ch(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=Pe(null),s=Pe(!1),l=Pe(null),c=Pe(Dt([])),d=Pe(!1);Et(()=>{if(!e.workspaceId||!e.settingsService)return;(async()=>{w(s,!0),w(l,null);try{w(i,await e.settingsService.loadWorkspaceSettings(e.workspaceId),!0)}catch(F){w(l,F instanceof Error?F.message:n()("Failed to load settings"),!0),w(i,e.settingsService.getDefaultWorkspaceSettings(),!0)}finally{w(s,!1)}})()}),Et(()=>{if(!e.workspaceId)return;(async()=>{w(d,!0);try{w(c,await e.extensionManager.listWorkspaceExtensions(e.workspaceId),!0)}catch(F){console.error("Failed to load extensions:",F),w(c,[],!0)}finally{w(d,!1)}})()});async function u(U){if(!o(h))return;const F=U.target,S=F.files?.[0];if(!(!S||!e.workspaceId))try{const W=e.extensionManager.detectExtensionName(S.name);await e.extensionManager.importExtension(e.workspaceId,S,W),w(c,await e.extensionManager.listWorkspaceExtensions(e.workspaceId),!0),await e.transformEngine.setWorkspaceExtensions(e.workspaceId),F.value=""}catch(W){console.error("Failed to import extension:",W),w(l,W instanceof Error?W.message:n()("Failed to import extension"),!0)}}async function p(U){if(e.workspaceId)try{await e.extensionManager.deleteWorkspaceExtension(e.workspaceId,U),w(c,await e.extensionManager.listWorkspaceExtensions(e.workspaceId),!0),await e.transformEngine.setWorkspaceExtensions(e.workspaceId)}catch(F){console.error("Failed to remove extension:",F),w(l,F instanceof Error?F.message:n()("Failed to remove extension"),!0)}}const h=ne(()=>o(i)?.editor?.advanced_mode??!1),v=ne(()=>e.workspaceId!==null&&o(i)!==null);var m=Th(),y=f(m),b=f(y),M=f(b),T=g(b,2);{var E=U=>{var F=wh(),S=f(F);O(W=>x(S,W),[()=>n()("Please select a workspace to configure settings.")]),_(U,F)},C=(U,F)=>{{var S=W=>{var R=yh(),D=f(R);O(N=>x(D,N),[()=>n()("Loading settings...")]),_(W,R)};j(U,W=>{o(s)&&W(S)},F)}};j(T,U=>{e.workspaceId?U(C,!1):U(E)})}var k=g(y,2);{var X=U=>{var F=bh(),S=f(F),W=f(S),R=g(S);O(D=>{x(W,`${D??""}:`),x(R,` ${o(l)??""}`)},[()=>n()("Error")]),_(U,F)};j(k,U=>{o(l)&&U(X)})}var P=g(k,2);{var z=U=>{var F=kh(),S=f(F),W=f(S),R=f(W),D=g(W,2),N=f(D),A=f(N);A.__change=[gh,e,i,l,n];var B=g(A,2),Q=f(B),le=g(N,2),Ie=f(le),Me=g(S,2),Oe=f(Me),Le=f(Oe),fe=g(Oe,2);let Y;var te=f(fe),ae=f(te),be=g(te,2);be.__change=u;var ke=g(be,2);{var We=Ae=>{var $e=xh(),Ve=f($e);O(ve=>x(Ve,ve),[()=>n()("Advanced Mode required for extension management")]),_(Ae,$e)};j(ke,Ae=>{o(h)||Ae(We)})}var je=g(fe,2);{var Re=Ae=>{var $e=_h(),Ve=f($e);O(ve=>x(Ve,ve),[()=>n()("Loading extensions...")]),_(Ae,$e)},Be=(Ae,$e)=>{{var Ve=me=>{var Ee=Sh(),He=f(Ee);O(ee=>x(He,ee),[()=>n()("No extensions installed.")]),_(me,Ee)},ve=me=>{var Ee=Eh();kt(Ee,21,()=>o(c),It,(He,ee)=>{var Se=lt(),ge=Ye(Se);{var Ge=H=>{mh(H,{get extension(){return o(ee)},get workspaceId(){return e.workspaceId},get isAdvancedMode(){return o(h)},get extensionManager(){return e.extensionManager},onRemove:()=>p(o(ee).name)})};j(ge,H=>{e.workspaceId&&H(Ge)})}_(He,Se)}),_(me,Ee)};j(Ae,me=>{o(c).length===0?me(Ve):me(ve,!1)},$e)}};j(je,Ae=>{o(d)?Ae(Re):Ae(Be,!1)})}O((Ae,$e,Ve,ve,me,Ee,He)=>{x(R,Ae),Vs(A,o(h)),A.disabled=o(s),x(Q,$e),x(Ie,Ve),x(Le,ve),Y=st(fe,1,"extension-import svelte-1qxmh9x",null,Y,me),x(ae,`${Ee??""}: ${He??""}`),be.disabled=o(d)},[()=>n()("Project Settings"),()=>n()("Advanced Mode"),()=>n()("Enable advanced editing features and additional controls for power users."),()=>n()("Extensions"),()=>({disabled:!o(h)}),()=>n()("Import JavaScript Extension"),()=>n()("Please copy license text into the License field below to comply with open source requirements.")]),_(U,F)};j(P,U=>{o(v)&&U(z)})}O(U=>x(M,U),[()=>n()("Settings")]),_(r,m),nt(),a()}yt(["change"]);function Ih(r,e){(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),e.onSelect())}var Fh=I('<div><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M2 5h12v1H2zm0 5h12v1H2z"></path></svg></div>'),Mh=(r,e)=>{r.stopPropagation(),e.onRenameId()},Ph=(r,e)=>{r.stopPropagation(),e.onDelete()},Lh=(r,e)=>{r.stopPropagation(),e.onMoveUp()},Dh=(r,e)=>{r.stopPropagation(),e(r)},Rh=(r,e)=>{r.stopPropagation(),e.onMoveDown()},Ah=(r,e)=>{r.stopPropagation(),e(r)},Oh=I('<div class="move-buttons svelte-1b48bnl" aria-label="Item controls"><button class="move-button svelte-1b48bnl">✎</button> <button class="move-button delete-button svelte-1b48bnl">✕</button> <button class="move-button svelte-1b48bnl">↑</button> <button class="move-button svelte-1b48bnl">↓</button></div>'),Uh=I('<span class="error-indicator svelte-1b48bnl" aria-label="Validation error">⚠️</span>'),zh=I('<div role="button" tabindex="0"><!> <span class="chapter-id svelte-1b48bnl"> </span> <!> <!></div>');function Wh(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);$(e,"index",3,0);let i=$(e,"isSelected",3,!1),s=$(e,"isExpanded",3,!0),l=$(e,"compact",3,!1),c=$(e,"dragHandleProps",19,()=>({})),d=$(e,"isFirstItem",3,!1),u=$(e,"isLastItem",3,!1);async function p(F){if(F.key==="Enter"||F.key===" "){F.preventDefault(),await e.onMoveUp();const S=document.querySelector(`[aria-label="Move ${e.item.id} up"]`);S&&S.focus()}}async function h(F){if(F.key==="Enter"||F.key===" "){F.preventDefault(),await e.onMoveDown();const S=document.querySelector(`[aria-label="Move ${e.item.id} down"]`);if(S&&!S.disabled)S.focus();else{const W=document.querySelector(`[aria-label="Move ${e.item.id} up"]`);W&&W.focus()}}}const v=ne(()=>i()&&!l());function m(F){const S=F.match(/^(\w+)[-_]?(\d+)$/i);if(S){const[,D,N]=S;return D.charAt(0).toUpperCase()+N}const W=F.split(/[\s\-_]+/).filter(D=>D.length>0);if(W.length>1)return W.map(D=>D.charAt(0).toUpperCase()).join("");const R=F.trim();return R.length<=3?R.toUpperCase():R.length<=6?R.slice(0,3):R.slice(0,2)}const y=ne(()=>l()?m(e.item.id):e.item.id);var b=zh();let M;b.__click=function(...F){e.onSelect?.apply(this,F)},b.__keydown=[Ih,e];var T=f(b);{var E=F=>{var S=Fh();_a(S,()=>({class:"drag-handle",...c(),tabindex:"-1","aria-hidden":"true"}),void 0,"svelte-1b48bnl"),_(F,S)};j(T,F=>{!l()&&s()&&F(E)})}var C=g(T,2),k=f(C),X=g(C,2);{var P=F=>{var S=Oh(),W=f(S);W.__click=[Mh,e];var R=g(W,2);R.__click=[Ph,e];var D=g(R,2);D.__click=[Lh,e],D.__keydown=[Dh,p];var N=g(D,2);N.__click=[Rh,e],N.__keydown=[Ah,h],O((A,B,Q,le)=>{ue(W,"aria-label",A),ue(W,"title",B),ue(R,"aria-label",Q),ue(R,"title",le),D.disabled=d(),ue(D,"aria-label",`Move ${e.item.id} up`),ue(D,"title",`Move ${e.item.id} up`),N.disabled=u(),ue(N,"aria-label",`Move ${e.item.id} down`),ue(N,"title",`Move ${e.item.id} down`)},[()=>n()("Rename {item}",{item:e.item.id}),()=>n()("Rename {item}",{item:e.item.id}),()=>n()("Delete chapter {name}",{name:e.item.id}),()=>n()("Delete chapter {name}",{name:e.item.id})]),_(F,S)};j(X,F=>{o(v)&&F(P)})}var z=g(X,2);{var U=F=>{var S=Uh();_(F,S)};j(z,F=>{!l()&&(!e.item.hasSourceFile||!e.item.linear)&&F(U)})}O(F=>{M=st(b,1,"spine-item svelte-1b48bnl",null,M,F),ue(b,"aria-pressed",i()),ue(b,"aria-label",`${e.item.id}${e.item.hasSourceFile?"":", has validation error"}`),x(k,o(y))},[()=>({compact:l(),selected:i(),"has-error":e.item.hasSourceFile===!1||!e.item.linear})]),_(r,b),nt(),a()}yt(["click","keydown"]);var Nh=I('<div class="loading svelte-d0f7cr"><p> </p></div>'),jh=I('<div class="error svelte-d0f7cr"><p> </p> <button class="retry-button svelte-d0f7cr"> </button></div>'),Bh=I('<div class="spine-item-wrapper svelte-d0f7cr" role="listitem"><!></div>'),$h=I('<div class="spine-list svelte-d0f7cr" role="list"></div>'),Hh=I('<div class="empty-state svelte-d0f7cr"><p> </p> <button class="retry-button svelte-d0f7cr"> </button></div>'),qh=I('<div class="empty-state svelte-d0f7cr"><p> </p></div>'),Vh=I('<div class="spine-sidebar svelte-d0f7cr"><!></div>');function Gh(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=Ke(),s=Ke();let l=$(e,"workspace",12,null),c=$(e,"spineService",8),d=$(e,"selectedItemId",8,null),u=$(e,"isExpanded",8,!0),p=$(e,"onWorkspaceUpdate",8,null),h=Ke([]),v=Ke(!0),m=Ke(null),y=!1;on(()=>{const B=()=>{E()};return window.addEventListener("append-spine-item",B),()=>{window.removeEventListener("append-spine-item",B)}});async function b(){l()&&c()&&await M()}async function M(){if(l()){w(v,!0),w(m,null);try{const B=await c().loadSpineItems(l());w(h,B)}catch(B){console.error("❌ SpineSidebar: Error loading spine items:",B),w(m,B instanceof Error?B.message:"Failed to load spine items"),w(h,[])}finally{w(v,!1)}}}function T(B){const Q=new CustomEvent("select-spine-item",{detail:{itemId:B},bubbles:!0});window.dispatchEvent(Q)}async function E(){if(l())try{w(v,!0);const B=await c().addChapter(l(),{title:"New Chapter",linear:!0,createSourceFile:!0});l(B.updatedWorkspace),p()&&p()(l()),await M(),T(B.newChapter.id)}catch(B){w(m,B instanceof Error?B.message:"Failed to create chapter")}finally{w(v,!1)}}async function C(B){if(!(y||B===0||!l())){y=!0;try{const Q=await c().moveChapterUp(l(),B);l(Q.updatedWorkspace),p()&&p()(l()),w(h,Q.newOrder),X(o(h)[B-1].id,B,B-1)}catch{await M()}finally{y=!1}}}async function k(B){if(!(y||B===o(h).length-1||!l())){y=!0;try{const Q=await c().moveChapterDown(l(),B);l(Q.updatedWorkspace),p()&&p()(l()),w(h,Q.newOrder),X(o(h)[B+1].id,B,B+1)}catch{await M()}finally{y=!1}}}function X(B,Q,le){const Ie=`${B} moved from position ${Q+1} to position ${le+1}`,Me=document.createElement("div");Me.setAttribute("role","status"),Me.setAttribute("aria-live","polite"),Me.style.position="absolute",Me.style.left="-10000px",Me.textContent=Ie,document.body.appendChild(Me),setTimeout(()=>Me.remove(),1e3)}function P(B,Q){o(i)&&(B.dataTransfer.effectAllowed="move",B.dataTransfer.setData("text/plain",Q.toString()))}function z(B){o(i)&&(B.preventDefault(),B.dataTransfer.dropEffect="move")}async function U(B,Q){if(!o(i)||y)return;B.preventDefault();const le=parseInt(B.dataTransfer.getData("text/plain"),10);if(le!==Q&&l()){y=!0;try{const Ie=await c().reorderItems(l(),le,Q);l(Ie.updatedWorkspace),p()&&p()(l()),w(h,Ie.newOrder),X(o(h)[Q].id,le,Q)}catch{await M()}finally{y=!1}}}async function F(B){if(!(!l()||!window.confirm(n()("Are you sure you want to delete chapter '{name}'? This will permanently delete the chapter and its source file.",{name:B}))))try{w(v,!0);const le=await c().deleteChapter(l(),B);if(l(le.updatedWorkspace),p()&&p()(l()),d()===B){const Ie=new CustomEvent("select-spine-item",{detail:{itemId:null},bubbles:!0});window.dispatchEvent(Ie)}w(h,await c().loadSpineItems(l()))}catch(le){console.error("Failed to delete chapter:",le)}finally{w(v,!1)}}async function S(B){if(!l())return;const Q=window.prompt(n()("Enter new ID for {item}:",{item:B}),B);if(!(!Q||Q===B))try{w(v,!0);const le=await c().renameChapterId(l(),B,Q);l(le.updatedWorkspace),p()&&p()(l()),await M(),T(Q)}catch(le){console.error("Failed to rename chapter ID:",le),alert(n()("Failed to rename chapter ID: {error}",{error:le instanceof Error?le.message:"Unknown error"}))}finally{w(v,!1)}}_t(()=>wt(u()),()=>{w(i,u())}),_t(()=>wt(l()),()=>{w(s,l()?.id)}),_t(()=>(o(s),wt(c()),wt(l())),()=>{o(s)&&c()?M():l()||(w(h,[]),w(v,!1),w(m,null))}),sn(),Rt();var W=Vh(),R=f(W);{var D=B=>{var Q=Nh(),le=f(Q),Ie=f(le);O(Me=>x(Ie,Me),[()=>n()("Loading spine items…")],Te),_(B,Q)},N=(B,Q)=>{{var le=Me=>{var Oe=jh(),Le=f(Oe),fe=f(Le),Y=g(Le,2);Y.__click=M;var te=f(Y);O(ae=>{x(fe,o(m)),x(te,ae)},[()=>n()("Retry")],Te),_(Me,Oe)},Ie=(Me,Oe)=>{{var Le=Y=>{var te=$h();kt(te,7,()=>o(h),ae=>ae.id,(ae,be,ke)=>{var We=Bh(),je=f(We);const Re=Te(()=>d()===o(be).id),Be=Te(()=>!u()),Ae=Te(()=>o(ke)===0),$e=Te(()=>o(ke)===o(h).length-1);Wh(je,{get item(){return o(be)},get index(){return o(ke)},get isSelected(){return o(Re)},get isExpanded(){return o(i)},get compact(){return o(Be)},get isFirstItem(){return o(Ae)},get isLastItem(){return o($e)},onSelect:()=>T(o(be).id),onMoveUp:async()=>await C(o(ke)),onMoveDown:async()=>await k(o(ke)),onRenameId:async()=>await S(o(be).id),onDelete:async()=>await F(o(be).id),dragHandleProps:{draggable:!0,"data-drag-handle":!0}}),O(()=>ue(We,"draggable",o(i))),at("dragstart",We,Ve=>P(Ve,o(ke))),at("dragover",We,z),at("drop",We,Ve=>U(Ve,o(ke))),_(ae,We)}),_(Y,te)},fe=(Y,te)=>{{var ae=ke=>{var We=Hh(),je=f(We),Re=f(je),Be=g(je,2);Be.__click=M;var Ae=f(Be);O(($e,Ve)=>{x(Re,$e),x(Ae,Ve)},[()=>n()("No spine items yet"),()=>n()("Refresh")],Te),_(ke,We)},be=ke=>{var We=qh(),je=f(We),Re=f(je);O(Be=>x(Re,Be),[()=>n()("No project selected")],Te),_(ke,We)};j(Y,ke=>{l()&&!o(v)?ke(ae):ke(be,!1)},te)}};j(Me,Y=>{o(h).length>0?Y(Le):Y(fe,!1)},Oe)}};j(B,Me=>{o(m)?Me(le):Me(Ie,!1)},Q)}};j(R,B=>{o(v)?B(D):B(N,!1)})}_(r,W),Ut(e,"refreshSpineItems",b);var A=nt({refreshSpineItems:b});return a(),A}yt(["click"]);const Xh=(r,e)=>{const t=r.target;w(e,t.value)},Kh=(r,e)=>{o(e)?.click()},Yh=(r,e)=>{e("itemCreate",{mode:"create-text"})},Jh=(r,e,t,a)=>{e()&&t()==="manifest"&&a("itemEdit",{item:e()})},Zh=(r,e)=>{w(e,"")};var Qh=I('<button type="button" class="clear-filter-button svelte-8hsxjr">×</button>'),ev=I('<div class="drag-overlay svelte-8hsxjr"><div class="drag-message svelte-8hsxjr"><p class="svelte-8hsxjr"> </p></div></div>'),tv=I('<p class="svelte-8hsxjr"> </p> <p class="empty-state-subtitle svelte-8hsxjr"> </p>',1),nv=I('<p class="svelte-8hsxjr"> </p> <p class="empty-state-subtitle svelte-8hsxjr"> </p>',1),rv=I('<div class="empty-state svelte-8hsxjr"><!></div>'),av=(r,e)=>e("id"),iv=(r,e)=>e("href"),sv=(r,e)=>e("size"),ov=I('<tr class="source-separator svelte-8hsxjr"><td colspan="4" class="separator-cell svelte-8hsxjr"><div class="separator-content svelte-8hsxjr"><span class="separator-label svelte-8hsxjr"> </span></div></td></tr>'),lv=I('<tr class="source-separator svelte-8hsxjr"><td colspan="4" class="separator-cell svelte-8hsxjr"><div class="separator-content svelte-8hsxjr"><span class="separator-label svelte-8hsxjr">Source Files</span></div></td></tr>'),cv=I('<tr class="source-separator svelte-8hsxjr"><td colspan="4" class="separator-cell svelte-8hsxjr"><div class="separator-content svelte-8hsxjr"><span class="separator-label svelte-8hsxjr">Package Files</span></div></td></tr>'),dv=(r,e,t,a)=>e(o(t),o(a)),uv=(r,e,t,a)=>e(r,o(t),o(a)),fv=I('<span class="property-tag svelte-8hsxjr"> </span>'),pv=I('<div class="properties-list svelte-8hsxjr"></div>'),hv=I('<!> <!> <!> <tr tabindex="0"><td class="id-cell svelte-8hsxjr"><span class="item-id svelte-8hsxjr" dir="ltr"> </span></td><td class="href-cell svelte-8hsxjr"><span class="item-href svelte-8hsxjr" dir="ltr"> </span></td><td class="size-cell svelte-8hsxjr"> </td><td class="properties-cell svelte-8hsxjr"><!></td><!></tr>',1),vv=I('<table class="manifest-table svelte-8hsxjr"><thead><tr><th scope="col" class="svelte-8hsxjr"><button type="button" class="sort-button svelte-8hsxjr"> </button></th><th scope="col" class="svelte-8hsxjr"><button type="button" class="sort-button svelte-8hsxjr"> </button></th><th scope="col" class="svelte-8hsxjr"><button type="button" class="sort-button svelte-8hsxjr"> </button></th><th scope="col" class="svelte-8hsxjr"> </th></tr></thead><tbody></tbody></table>'),mv=I('<div class="manifest-table-container svelte-8hsxjr"><div role="toolbar" tabindex="0"><div class="filter-section svelte-8hsxjr"><label for="manifest-filter" class="filter-label svelte-8hsxjr"> </label> <div class="filter-input-container svelte-8hsxjr"><input id="manifest-filter" type="text" class="filter-input svelte-8hsxjr"/> <!></div></div> <div class="action-buttons svelte-8hsxjr"><button type="button" class="action-button secondary svelte-8hsxjr"> </button> <button type="button" class="action-button primary svelte-8hsxjr"> </button> <button type="button" class="action-button secondary svelte-8hsxjr"> </button></div> <input type="file" multiple accept="*/*" style="display: none;"/> <!></div> <div class="table-container svelte-8hsxjr"><!></div></div>');function gv(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t),i=Ke(),s=Ke(),l=Ke();let c=$(e,"manifestItems",24,()=>[]),d=$(e,"sourceItems",24,()=>[]),u=$(e,"advancedMode",8,!0),p=$(e,"validationErrors",24,()=>[]),h=$(e,"selectedItem",8,null),v=$(e,"selectedItemType",8,null),m=$(e,"loading",8,!1);const y=tn();let b=Ke(""),M=Ke(!1),T=Ke(),E=Ke("id"),C=Ke("asc");const k=ee=>{o(E)===ee?w(C,o(C)==="asc"?"desc":"asc"):(w(E,ee),w(C,"asc"))},X=(ee,Se)=>{y("itemSelect",{item:ee,type:Se==="source-zip"?"source":Se})},P=(ee,Se,ge)=>{(ee.key==="Enter"||ee.key===" ")&&(ee.preventDefault(),X(Se,ge))},z=(ee,Se)=>{if(!h())return!1;const ge=Se==="source-zip"?"source":Se;return v()!==ge?!1:Se==="manifest"?ee.id===h().id:ee.path===h().path},U=ee=>p().filter(Se=>Se.itemId===ee.id),F=ee=>U(ee).length>0,S=ee=>{if(!ee)return"-";const Se=["B","KB","MB","GB"];let ge=ee,Ge=0;for(;ge>=1024&&Ge<Se.length-1;)ge/=1024,Ge++;return`${ge.toFixed(Ge===0?0:1)} ${Se[Ge]}`},W=ee=>o(E)!==ee?"↕":o(C)==="asc"?"↑":"↓",R=ee=>{const Se=ee.target;Se.files&&Se.files.length>0&&(y("fileUpload",{files:Se.files}),Se.value="")},D=ee=>{ee.preventDefault(),w(M,!0)},N=ee=>{ee.preventDefault(),w(M,!1)},A=ee=>{ee.preventDefault(),w(M,!1),ee.dataTransfer?.files&&ee.dataTransfer.files.length>0&&y("fileUpload",{files:ee.dataTransfer.files})};_t(()=>(wt(c()),wt(u()),wt(d())),()=>{w(i,[...c().map(ee=>({...ee,_type:"manifest"})),{name:"content.opf",path:"content.opf",size:void 0,_type:"opf"},...u()?d().map(ee=>({...ee,_type:"source"})):[],...u()?[]:[{name:"SOURCE.zip",path:"SOURCE.zip",size:void 0,_type:"source-zip",isPlaceholder:!0}]])}),_t(()=>(o(i),o(b)),()=>{w(s,o(i).filter(ee=>{if(!o(b))return!0;const Se=o(b).toLowerCase();if(ee._type==="manifest"){const ge=ee;return ge.id.toLowerCase().includes(Se)||ge.href.toLowerCase().includes(Se)||ge.properties?.some(Ge=>Ge.toLowerCase().includes(Se))||!1}else if(ee._type==="source"){const ge=ee;return ge.name.toLowerCase().includes(Se)||ge.path.toLowerCase().includes(Se)}else if(ee._type==="source-zip"){const ge=ee;return ge.name.toLowerCase().includes(Se)||ge.path.toLowerCase().includes(Se)}else{const ge=ee;return ge.name.toLowerCase().includes(Se)||ge.path.toLowerCase().includes(Se)}}))}),_t(()=>(o(s),o(E),o(C)),()=>{w(l,(()=>{const ee=o(s).filter(G=>G._type==="manifest"),Se=o(s).filter(G=>G._type==="source"),ge=o(s).filter(G=>G._type==="source-zip"),Ge=o(s).filter(G=>G._type==="opf"),H=G=>[...G].sort((J,de)=>{let we="",q="";return o(E)==="id"?(we=J._type==="manifest"?J.id:(J._type==="source"||J._type==="source-zip",J.name),q=de._type==="manifest"?de.id:(de._type==="source"||de._type==="source-zip",de.name)):o(E)==="href"?(we=J._type==="manifest"?J.href:(J._type==="source"||J._type==="source-zip",J.path),q=de._type==="manifest"?de.href:(de._type==="source"||de._type==="source-zip",de.path)):o(E)==="size"&&(we=J.size||0,q=de.size||0),we<q?o(C)==="asc"?-1:1:we>q?o(C)==="asc"?1:-1:0});return[...H(ee),...H(Se),...H(Ge),...H(ge)]})())}),sn(),Rt();var B=mv(),Q=f(B);let le;var Ie=f(Q),Me=f(Ie),Oe=f(Me),Le=g(Me,2),fe=f(Le);fe.__input=[Xh,b];var Y=g(fe,2);{var te=ee=>{var Se=Qh();Se.__click=[Zh,b],O(ge=>ue(Se,"aria-label",ge),[()=>n()("Clear filter")],Te),_(ee,Se)};j(Y,ee=>{o(b)&&ee(te)})}var ae=g(Ie,2),be=f(ae);be.__click=[Jh,h,v,y];var ke=f(be),We=g(be,2);We.__click=[Kh,T];var je=f(We),Re=g(We,2);Re.__click=[Yh,y];var Be=f(Re),Ae=g(ae,2);Ae.__change=R,Bt(Ae,ee=>w(T,ee),()=>o(T));var $e=g(Ae,2);{var Ve=ee=>{var Se=ev(),ge=f(Se),Ge=f(ge),H=f(Ge);O(G=>x(H,G),[()=>n()("Drop files here to add them to the manifest")],Te),_(ee,Se)};j($e,ee=>{o(M)&&ee(Ve)})}var ve=g(Q,2),me=f(ve);{var Ee=ee=>{var Se=rv(),ge=f(Se);{var Ge=G=>{var J=tv(),de=Ye(J),we=f(de),q=g(de,2),se=f(q);O((ce,pe)=>{x(we,ce),x(se,pe)},[()=>n()("No items match your filter"),()=>n()("Try adjusting your search terms")],Te),_(G,J)},H=G=>{var J=nv(),de=Ye(J),we=f(de),q=g(de,2),se=f(q);O((ce,pe)=>{x(we,ce),x(se,pe)},[()=>n()("No manifest items found"),()=>n()("Create your first item using the buttons above")],Te),_(G,J)};j(ge,G=>{o(b)?G(Ge):G(H,!1)})}_(ee,Se)},He=ee=>{var Se=vv(),ge=f(Se),Ge=f(ge),H=f(Ge),G=f(H);G.__click=[av,k];var J=f(G),de=g(H),we=f(de);we.__click=[iv,k];var q=f(we),se=g(de),ce=f(se);ce.__click=[sv,k];var pe=f(ce),ye=g(se),Ce=f(ye),Ne=g(ge);kt(Ne,5,()=>o(l),It,(Fe,oe,Ue)=>{var Je=hv();const De=Te(()=>o(oe)._type),Z=Te(()=>z(o(oe),o(De))),V=Te(()=>o(De)==="manifest"?F(o(oe)):!1),he=Te(()=>Ue>0?o(l)[Ue-1]._type:null),K=Te(()=>o(De)==="source"&&o(he)==="manifest"),xe=Te(()=>o(De)==="source-zip"&&o(he)==="opf"),L=Te(()=>o(De)==="opf"&&(o(he)==="manifest"||o(he)==="source"));var re=Ye(Je);{var ie=bt=>{var Ht=ov(),Ta=f(Ht),Ca=f(Ta),Nr=f(Ca),Ia=f(Nr);O(Io=>x(Ia,Io),[()=>n()("SOURCE.zip")],Te),_(bt,Ht)};j(re,bt=>{o(K)&&bt(ie)})}var _e=g(re,2);{var ze=bt=>{var Ht=lv();_(bt,Ht)};j(_e,bt=>{o(xe)&&bt(ze)})}var qe=g(_e,2);{var Xe=bt=>{var Ht=cv();_(bt,Ht)};j(qe,bt=>{o(L)&&bt(Xe)})}var Ze=g(qe,2);let it;Ze.__click=[dv,X,oe,De],Ze.__keydown=[uv,P,oe,De];var pt=f(Ze),ht=f(pt),St=f(ht),mt=g(pt),gt=f(mt),$t=f(gt),Ft=g(mt),pn=f(Ft),Nn=g(Ft),So=f(Nn);{var Eo=bt=>{var Ht=pv();kt(Ht,5,()=>o(oe).properties||[],It,(Ta,Ca)=>{var Nr=fv(),Ia=f(Nr);O(()=>x(Ia,o(Ca))),_(Ta,Nr)}),_(bt,Ht)},ko=bt=>{var Ht=Pt("-");_(bt,Ht)};j(So,bt=>{o(De)==="manifest"&&o(oe).properties&&(o(oe).properties?.length??0)>0?bt(Eo):bt(ko,!1)})}var To=g(Nn);{var Co=bt=>{};j(To,bt=>{o(De)==="manifest"&&bt(Co)})}O((bt,Ht)=>{it=st(Ze,1,"manifest-row svelte-8hsxjr",null,it,bt),ue(Ze,"aria-selected",o(Z)),x(St,o(De)==="manifest"?o(oe).id:(o(De)==="source"||o(De)==="source-zip")&&o(oe).name||o(oe).name),ht.dir=ht.dir,x($t,o(De)==="manifest"?o(oe).href:(o(De)==="source"||o(De)==="source-zip")&&o(oe).path||o(oe).path),gt.dir=gt.dir,x(pn,Ht)},[()=>({selected:o(Z),error:o(V),"source-item":o(De)==="source","source-zip-item":o(De)==="source-zip","opf-item":o(De)==="opf"}),()=>S(o(oe).size)],Te),_(Fe,Je)}),O((Fe,oe,Ue,Je,De,Z,V,he,K,xe)=>{ue(G,"aria-label",Fe),x(J,`${oe??""}
                ${Ue??""}`),ue(we,"aria-label",Je),x(q,`${De??""}
                ${Z??""}`),ue(ce,"aria-label",V),x(pe,`${he??""}
                ${K??""}`),x(Ce,xe)},[()=>n()("Sort by ID"),()=>n()("ID"),()=>W("id"),()=>n()("Sort by path"),()=>n()("Path"),()=>W("href"),()=>n()("Sort by size"),()=>n()("Size"),()=>W("size"),()=>n()("Properties")],Te),_(ee,Se)};j(me,ee=>{o(l).length===0?ee(Ee):ee(He,!1)})}O((ee,Se,ge,Ge,H,G,J)=>{le=st(Q,1,"manifest-toolbar svelte-8hsxjr",null,le,ee),ue(Q,"aria-label",Se),x(Oe,`${ge??""}:`),ue(fe,"placeholder",Ge),An(fe,o(b)),fe.disabled=m(),be.disabled=!h()||v()!=="manifest",x(ke,`✏️ ${H??""}`),We.disabled=m(),x(je,`📁 ${G??""}`),Re.disabled=m(),x(Be,`📝 ${J??""}`)},[()=>({"drag-active":o(M)}),()=>n()("Manifest actions"),()=>n()("Filter"),()=>n()("Filter by ID, path, or media type..."),()=>n()("Edit Item"),()=>n()("Load File"),()=>n()("Create Text File")],Te),at("dragover",Q,D),at("dragleave",Q,N),at("drop",Q,A),_(r,B),nt(),a()}yt(["input","click","change","keydown"]);class yo{static generateItemId(e){return!e||e.trim()===""?"item":e.replace(/\.[^/.]+$/,"").toLowerCase().replace(/[^a-z0-9_-]/g,"_").replace(/^[0-9]/,"item_$&").replace(/^[^a-z_]/,"item").replace(/^_+|_+$/g,"")||"item"}static detectMediaType(e,t){const a=this.getFileExtension(e).toLowerCase(),i={xhtml:"application/xhtml+xml",html:"text/html",htm:"text/html",css:"text/css",js:"application/javascript",json:"application/json",xml:"application/xml",txt:"text/plain",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",svg:"image/svg+xml",bmp:"image/bmp",ico:"image/x-icon",mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",m4a:"audio/mp4",aac:"audio/aac",flac:"audio/flac",mp4:"video/mp4",webm:"video/webm",ogv:"video/ogg",avi:"video/x-msvideo",mov:"video/quicktime",ttf:"font/ttf",otf:"font/otf",woff:"font/woff",woff2:"font/woff2",eot:"application/vnd.ms-fontobject",pdf:"application/pdf",epub:"application/epub+zip",zip:"application/zip"}[a];return i||(t&&t.byteLength>0?this.detectMediaTypeFromContent(t):"application/octet-stream")}static detectMediaTypeFromContent(e){const t=new Uint8Array(e);if(t.length>=8){if(t[0]===137&&t[1]===80&&t[2]===78&&t[3]===71)return"image/png";if(t[0]===255&&t[1]===216&&t[2]===255)return"image/jpeg";if(t[0]===71&&t[1]===73&&t[2]===70&&t[3]===56)return"image/gif";if(t[0]===37&&t[1]===80&&t[2]===68&&t[3]===70)return"application/pdf";if(t[0]===80&&t[1]===75&&(t[2]===3||t[2]===5))return"application/zip"}try{const a=new TextDecoder("utf-8",{fatal:!0}).decode(e);return a.includes("<?xml")?"application/xml":a.includes("<html")||a.includes("<!DOCTYPE html")?"text/html":"text/plain"}catch{}return"application/octet-stream"}static getMediaTypeCategories(){return{text:[{mediaType:"application/xhtml+xml",extensions:["xhtml"],description:"XHTML Document",isEpubCore:!0},{mediaType:"text/html",extensions:["html","htm"],description:"HTML Document"},{mediaType:"text/css",extensions:["css"],description:"CSS Stylesheet",isEpubCore:!0},{mediaType:"application/javascript",extensions:["js"],description:"JavaScript"},{mediaType:"application/json",extensions:["json"],description:"JSON Data"},{mediaType:"text/plain",extensions:["txt"],description:"Plain Text"},{mediaType:"application/xml",extensions:["xml"],description:"XML Document"}],image:[{mediaType:"image/jpeg",extensions:["jpg","jpeg"],description:"JPEG Image",isEpubCore:!0},{mediaType:"image/png",extensions:["png"],description:"PNG Image",isEpubCore:!0},{mediaType:"image/gif",extensions:["gif"],description:"GIF Image",isEpubCore:!0},{mediaType:"image/svg+xml",extensions:["svg"],description:"SVG Image",isEpubCore:!0},{mediaType:"image/webp",extensions:["webp"],description:"WebP Image"},{mediaType:"image/bmp",extensions:["bmp"],description:"Bitmap Image"}],audio:[{mediaType:"audio/mpeg",extensions:["mp3"],description:"MP3 Audio",isEpubCore:!0},{mediaType:"audio/mp4",extensions:["m4a"],description:"MP4 Audio",isEpubCore:!0},{mediaType:"audio/ogg",extensions:["ogg"],description:"OGG Audio"},{mediaType:"audio/wav",extensions:["wav"],description:"WAV Audio"},{mediaType:"audio/aac",extensions:["aac"],description:"AAC Audio"}],video:[{mediaType:"video/mp4",extensions:["mp4"],description:"MP4 Video",isEpubCore:!0},{mediaType:"video/webm",extensions:["webm"],description:"WebM Video"},{mediaType:"video/ogg",extensions:["ogv"],description:"OGG Video"},{mediaType:"video/quicktime",extensions:["mov"],description:"QuickTime Video"}],application:[{mediaType:"font/ttf",extensions:["ttf"],description:"TrueType Font",isEpubCore:!0},{mediaType:"font/otf",extensions:["otf"],description:"OpenType Font",isEpubCore:!0},{mediaType:"font/woff",extensions:["woff"],description:"WOFF Font",isEpubCore:!0},{mediaType:"font/woff2",extensions:["woff2"],description:"WOFF2 Font",isEpubCore:!0},{mediaType:"application/pdf",extensions:["pdf"],description:"PDF Document"},{mediaType:"application/zip",extensions:["zip"],description:"ZIP Archive"},{mediaType:"application/octet-stream",extensions:[],description:"Binary Data"}]}}static createBlobUrl(e,t){const a=typeof e=="string"?new Blob([e],{type:t}):new Blob([e],{type:t});return URL.createObjectURL(a)}static revokeBlobUrl(e){URL.revokeObjectURL(e)}static formatFileSize(e){if(e===0)return"0 B";const t=1024,a=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(2))+" "+a[n]}static getFileExtension(e){const t=e.lastIndexOf(".");return t!==-1?e.slice(t+1):""}static sanitizeFileName(e){return e.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")}}var wv=I('<p class="file-info svelte-ziknnq"> </p>'),yv=I('<div class="form-group svelte-ziknnq"><label for="file-input" class="form-label svelte-ziknnq"> <span class="required svelte-ziknnq">*</span></label> <input id="file-input" type="file" class="file-input svelte-ziknnq" required/> <!></div>'),bv=I('<p class="error-message svelte-ziknnq"> </p>'),xv=I('<p class="error-message svelte-ziknnq"> </p>'),_v=I("<option> </option>"),Sv=I('<p class="error-message svelte-ziknnq"> </p>'),Ev=I('<label class="checkbox-label svelte-ziknnq"><input type="checkbox" class="checkbox-input svelte-ziknnq"/> </label>'),kv=I('<div class="form-group svelte-ziknnq"><label for="text-content" class="form-label svelte-ziknnq"> </label> <textarea id="text-content" class="form-textarea svelte-ziknnq" rows="3"></textarea> <p class="field-help svelte-ziknnq"> </p></div>'),Tv=I('<div class="modal-overlay svelte-ziknnq" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="modal-content svelte-ziknnq"><div class="modal-header svelte-ziknnq"><h2 id="modal-title" class="svelte-ziknnq"><!></h2> <button type="button" class="close-button svelte-ziknnq">×</button></div> <form class="modal-form svelte-ziknnq"><div class="form-body svelte-ziknnq"><!> <div class="form-group svelte-ziknnq"><label for="item-id" class="form-label svelte-ziknnq"> <span class="required svelte-ziknnq">*</span></label> <input id="item-id" type="text" dir="ltr" required/> <!></div> <div class="form-group svelte-ziknnq"><label for="item-href" class="form-label svelte-ziknnq"> <span class="required svelte-ziknnq">*</span></label> <input id="item-href" type="text" dir="ltr" required/> <!></div> <div class="form-group svelte-ziknnq"><label for="item-mediatype" class="form-label svelte-ziknnq"> <span class="required svelte-ziknnq">*</span></label> <select id="item-mediatype" required><option> </option><!></select> <!></div> <div class="form-group svelte-ziknnq"><fieldset class="checkbox-fieldset svelte-ziknnq"><legend class="form-label svelte-ziknnq"> </legend> <div class="checkbox-group svelte-ziknnq"></div></fieldset></div> <!></div> <div class="modal-footer svelte-ziknnq"><button type="button" class="cancel-button svelte-ziknnq"> </button> <button type="submit" class="save-button svelte-ziknnq"><!></button></div></form></div></div>');function Cv(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"itemEditorMode",8,"create-text"),s=$(e,"item",8,null),l=$(e,"validationErrors",24,()=>[]);const c=tn();let d=Ke(),u=Ke({id:"",href:"",mediaType:"",properties:[]}),p=Ke(""),h=Ke(),v=Ke(null);const m=[{value:"application/xhtml+xml",label:"XHTML"},{value:"text/html",label:"HTML"},{value:"text/css",label:"CSS"},{value:"text/javascript",label:"JavaScript"},{value:"text/plain",label:"Plain Text"},{value:"image/jpeg",label:"JPEG Image"},{value:"image/png",label:"PNG Image"},{value:"image/svg+xml",label:"SVG Image"},{value:"audio/mpeg",label:"MP3 Audio"},{value:"audio/ogg",label:"OGG Audio"},{value:"video/mp4",label:"MP4 Video"},{value:"video/webm",label:"WebM Video"},{value:"application/pdf",label:"PDF"},{value:"application/epub+zip",label:"EPUB"}],y=[{value:"cover-image",label:"Cover Image"},{value:"mathml",label:"MathML"},{value:"nav",label:"Navigation"},{value:"remote-resources",label:"Remote Resources"},{value:"scripted",label:"Scripted"},{value:"svg",label:"SVG"}],b=()=>{c("close")},M=Z=>{Z.target===o(d)&&b()},T=Z=>{Z.key==="Escape"&&Z.target===o(d)&&b()},E=Z=>{Z.key==="Escape"&&b()},C=Z=>{const V=Z.target;if(V.files&&V.files.length>0){w(v,V.files[0]),o(u).id||et(u,o(u).id=o(v).name.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9-_]/g,"_"));const he=o(v).type,K=yo.detectMediaType(o(v).name),xe=!he||he==="application/octet-stream",L=K.startsWith("font/"),re=xe||L?K:he;o(u).href||et(u,o(u).href=Ka(o(v).name,re)),o(u).mediaType||et(u,o(u).mediaType=re)}},k=Z=>{if(Z.preventDefault(),!o(u).id||!o(u).href||!o(u).mediaType){alert(n()("Please fill in all required fields"));return}const V={id:o(u).id,href:o(u).href,mediaType:o(u).mediaType,properties:o(u).properties?.filter(he=>he.length>0)};c("save",{item:V,textContent:o(p),selectedFile:o(v)})},X=(Z,V)=>{V?et(u,o(u).properties=[...o(u).properties||[],Z]):et(u,o(u).properties=(o(u).properties||[]).filter(he=>he!==Z))},P=()=>{if(o(u).href){const Z=o(u).href.split("/").pop()||"";et(u,o(u).id=Z.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9-_]/g,"_"))}},z=()=>{if(o(u).id&&!o(u).href){const Z=U(o(u).mediaType||""),V=o(u).id+Z;et(u,o(u).href=Ka(V,o(u).mediaType||""))}},U=Z=>({"application/xhtml+xml":".xhtml","text/html":".html","text/css":".css","text/javascript":".js","text/plain":".txt","image/jpeg":".jpg","image/png":".png","image/gif":".gif","image/svg+xml":".svg","audio/mpeg":".mp3","audio/ogg":".ogg","video/mp4":".mp4","video/webm":".webm","application/pdf":".pdf"})[Z]||".dat",F=Z=>{const V=l().find(he=>he.field===Z);return V?V.message:null},S=Z=>l().some(V=>V.field===Z);_t(()=>(wt(i()),wt(s())),()=>{if(i()==="edit"&&s()&&"id"in s()){const Z=s();w(u,{id:Z.id,href:Z.href,mediaType:Z.mediaType,properties:Z.properties||[]})}else w(u,{id:"",href:"",mediaType:i()==="create-text"?"text/plain":"",properties:[]})}),sn(),Rt();var W=Tv();at("keydown",Ba,E);var R=f(W),D=f(R),N=f(D),A=f(N);{var B=Z=>{var V=Pt();O(he=>x(V,he),[()=>n()("Create Text File")],Te),_(Z,V)},Q=(Z,V)=>{{var he=xe=>{var L=Pt();O(re=>x(L,re),[()=>n()("Upload File")],Te),_(xe,L)},K=xe=>{var L=Pt();O(re=>x(L,re),[()=>n()("Edit Manifest Item")],Te),_(xe,L)};j(Z,xe=>{i()==="create-file"?xe(he):xe(K,!1)},V)}};j(A,Z=>{i()==="create-text"?Z(B):Z(Q,!1)})}var le=g(N,2),Ie=g(D,2),Me=f(Ie),Oe=f(Me);{var Le=Z=>{var V=yv(),he=f(V),K=f(he),xe=g(he,2);Bt(xe,ie=>w(h,ie),()=>o(h));var L=g(xe,2);{var re=ie=>{var _e=wv(),ze=f(_e);O((qe,Xe)=>x(ze,`${qe??""}: ${o(v).name??""} (${Xe??""} KB)`),[()=>n()("Selected"),()=>(o(v).size/1024).toFixed(1)],Te),_(ie,_e)};j(L,ie=>{o(v)&&ie(re)})}O(ie=>x(K,`${ie??""} `),[()=>n()("Select File")],Te),at("change",xe,C),_(Z,V)};j(Oe,Z=>{i()==="create-file"&&Z(Le)})}var fe=g(Oe,2),Y=f(fe),te=f(Y),ae=g(Y,2);let be;var ke=g(ae,2);{var We=Z=>{var V=bv(),he=f(V);O(K=>x(he,K),[()=>F("id")],Te),_(Z,V)};j(ke,Z=>{F("id")&&Z(We)})}var je=g(fe,2),Re=f(je),Be=f(Re),Ae=g(Re,2);let $e;var Ve=g(Ae,2);{var ve=Z=>{var V=xv(),he=f(V);O(K=>x(he,K),[()=>F("href")],Te),_(Z,V)};j(Ve,Z=>{F("href")&&Z(ve)})}var me=g(je,2),Ee=f(me),He=f(Ee),ee=g(Ee,2);O(()=>{o(u),Il(()=>{n()})});let Se;var ge=f(ee);ge.value=ge.__value="";var Ge=f(ge),H=g(ge);kt(H,1,()=>m,It,(Z,V)=>{var he=_v(),K={},xe=f(he);O(()=>{K!==(K=o(V).value)&&(he.value=(he.__value=o(V).value)??""),x(xe,o(V).label)}),_(Z,he)});var G=g(ee,2);{var J=Z=>{var V=Sv(),he=f(V);O(K=>x(he,K),[()=>F("mediaType")],Te),_(Z,V)};j(G,Z=>{F("mediaType")&&Z(J)})}var de=g(me,2),we=f(de),q=f(we),se=f(q),ce=g(q,2);kt(ce,5,()=>y,It,(Z,V)=>{var he=Ev(),K=f(he),xe=g(K);O(L=>{Vs(K,L),x(xe,` ${o(V).label??""}`)},[()=>o(u).properties?.includes(o(V).value)||!1],Te),at("change",K,L=>X(o(V).value,L.currentTarget.checked)),_(Z,he)});var pe=g(de,2);{var ye=Z=>{var V=kv(),he=f(V),K=f(he),xe=g(he,2),L=g(xe,2),re=f(L);O((ie,_e,ze)=>{x(K,ie),ue(xe,"placeholder",_e),x(re,ze)},[()=>n()("Initial Content"),()=>n()("Enter the initial content for this text file…"),()=>n()("You can edit the content later in the main editor")],Te),Sr(xe,()=>o(p),ie=>w(p,ie)),_(Z,V)};j(pe,Z=>{i()==="create-text"&&Z(ye)})}var Ce=g(Me,2),Ne=f(Ce),Fe=f(Ne),oe=g(Ne,2),Ue=f(oe);{var Je=Z=>{var V=Pt();O(he=>x(V,he),[()=>n()("Create Text File")],Te),_(Z,V)},De=(Z,V)=>{{var he=xe=>{var L=Pt();O(re=>x(L,re),[()=>n()("Upload File")],Te),_(xe,L)},K=xe=>{var L=Pt();O(re=>x(L,re),[()=>n()("Save Changes")],Te),_(xe,L)};j(Z,xe=>{i()==="create-file"?xe(he):xe(K,!1)},V)}};j(Ue,Z=>{i()==="create-text"?Z(Je):Z(De,!1)})}Bt(W,Z=>w(d,Z),()=>o(d)),O((Z,V,he,K,xe,L,re,ie,_e,ze,qe,Xe)=>{ue(le,"aria-label",Z),x(te,`${V??""} `),be=st(ae,1,"form-input svelte-ziknnq",null,be,he),ue(ae,"placeholder",K),ae.dir=ae.dir,x(Be,`${xe??""} `),$e=st(Ae,1,"form-input svelte-ziknnq",null,$e,L),ue(Ae,"placeholder",re),Ae.dir=Ae.dir,x(He,`${ie??""} `),Se=st(ee,1,"form-select svelte-ziknnq",null,Se,_e),x(Ge,ze),x(se,qe),x(Fe,Xe)},[()=>n()("Close"),()=>n()("ID"),()=>({error:S("id")}),()=>n()("Unique identifier for this item"),()=>n()("File Path"),()=>({error:S("href")}),()=>n()("OEBPS/filename.ext"),()=>n()("Media Type"),()=>({error:S("mediaType")}),()=>n()("Select media type…"),()=>n()("EPUB Properties"),()=>n()("Cancel")],Te),at("click",le,b),Sr(ae,()=>o(u).id,Z=>et(u,o(u).id=Z)),at("blur",ae,z),Sr(Ae,()=>o(u).href,Z=>et(u,o(u).href=Z)),at("blur",Ae,P),$s(ee,()=>o(u).mediaType,Z=>et(u,o(u).mediaType=Z)),at("click",Ne,b),at("submit",Ie,k),at("click",W,M),at("keydown",W,T),_(r,W),nt(),a()}var Iv=I('<div class="loading-state svelte-12tyyls"><p> </p></div>'),Fv=I('<div class="error-state svelte-12tyyls"><p class="error-message svelte-12tyyls"> </p> <button type="button" class="retry-button svelte-12tyyls"> </button></div>'),Mv=I("<!> <!>",1);function Pv(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"workspace",7,null),s=$(e,"advancedMode",3,!0),l=Pe(Dt([])),c=Pe(Dt([])),d=Pe(null),u=Pe(null),p=Pe(Dt([])),h=Pe(!0),v=Pe(null),m=Pe(!1),y=Pe("create-text");const b=async()=>{if(i())try{w(h,!0),w(v,null);const D=i().opf.manifest,N=await Promise.all(D.map(async A=>{try{const B=i().pathInfo.basePath?`${i().pathInfo.basePath}/${A.href}`:A.href,Q=await e.workspaceService.getFileInfo(i().id,B);return{...A,size:Q.size}}catch{return A}}));if(w(l,N,!0),s())try{w(c,await e.workspaceService.listSourceFiles(i()),!0)}catch(A){console.warn("Failed to load SOURCE items:",A),w(c,[],!0)}else w(c,[],!0);w(p,[],!0)}catch{w(v,n()("Failed to load manifest"),!0)}finally{w(h,!1)}},M=D=>{w(d,D.detail.item,!0),w(u,D.detail.type,!0),e.onItemSelect?.({item:D.detail.item,type:D.detail.type})},T=D=>{w(y,D.detail.mode,!0),w(m,!0)},E=D=>{w(d,D.detail.item,!0),w(u,"manifest"),w(y,"edit"),w(m,!0)},C=async D=>{if(!(!i()||!confirm(n()("Are you sure you want to delete this item?"))))try{i(await e.workspaceService.removeManifestItem(i(),D.detail.itemId)),await b(),o(d)&&"id"in o(d)&&o(d).id===D.detail.itemId&&(w(d,null),w(u,null))}catch{w(v,n()("Failed to delete item"),!0)}},k=async D=>{if(i())try{const{item:N}=D.detail;if(o(y)==="edit"&&o(d)&&"id"in o(d))i(await e.workspaceService.updateManifestItem(i(),o(d).id,N));else if(o(y)==="create-text"){i(await e.workspaceService.addManifestItem(i(),N));const A=N.href.startsWith(i().pathInfo.basePath+"/")?N.href:`${i().pathInfo.basePath}/${N.href}`;await e.workspaceService.writeFile(i().id,A,"")}w(m,!1),await b()}catch{w(v,n()("Failed to save item"),!0)}},X=async D=>{if(!i())return;const N=D.detail.files,A=[],B=[];for(const Q of N)try{const le=Q.type,Ie=yo.detectMediaType(Q.name),Me=!le||le==="application/octet-stream",Oe=Ie.startsWith("font/"),fe=Me||Oe||(Ie==="application/javascript"||Ie==="text/javascript")?Ie:le,Y={href:Ka(Q.name,fe),mediaType:fe};i(await e.workspaceService.addManifestItem(i(),Y));const te=`${i().pathInfo.basePath}/${Y.href}`;if(Q.type.startsWith("text/")||Q.type.includes("json")||Q.type.includes("xml")){const ae=await Q.text();await e.workspaceService.writeFile(i().id,te,ae)}else{const ae=await Q.arrayBuffer();await e.workspaceService.writeBinaryFile(i().id,te,ae)}A.push(Q.name)}catch(le){console.warn(`Failed to upload ${Q.name}:`,le),B.push({name:Q.name,error:le instanceof Error?le.message:"Unknown error"})}await b(),B.length===0?console.log(`Successfully uploaded ${A.length} files:`,A):A.length===0?(w(v,n()("Failed to upload all files"),!0),console.error("Upload failures:",B)):(console.log(`Uploaded ${A.length} files successfully:`,A),console.warn(`Failed to upload ${B.length} files:`,B),w(v,n()("Some files failed to upload - see console for details"),!0))},P=()=>{w(m,!1)};on(b),Et(()=>{i()&&b()}),Et(()=>{i()&&(s()?e.workspaceService.listSourceFiles(i()).then(D=>{w(c,D,!0)}).catch(D=>{console.warn("Failed to load SOURCE items:",D),w(c,[],!0)}):w(c,[],!0))}),Et(()=>{i()&&b()});var z=Mv(),U=Ye(z);{var F=D=>{var N=Iv(),A=f(N),B=f(A);O(Q=>x(B,Q),[()=>n()("Loading manifest…")]),_(D,N)},S=(D,N)=>{{var A=Q=>{var le=Fv(),Ie=f(le),Me=f(Ie),Oe=g(Ie,2);Oe.__click=b;var Le=f(Oe);O(fe=>{x(Me,o(v)),x(Le,fe)},[()=>n()("Retry")]),_(Q,le)},B=Q=>{gv(Q,{get manifestItems(){return o(l)},get sourceItems(){return o(c)},get advancedMode(){return s()},get validationErrors(){return o(p)},get selectedItem(){return o(d)},get selectedItemType(){return o(u)},$$events:{itemSelect:M,itemCreate:T,itemEdit:E,itemDelete:C,fileUpload:X}})};j(D,Q=>{o(v)?Q(A):Q(B,!1)},N)}};j(U,D=>{o(h)?D(F):D(S,!1)})}var W=g(U,2);{var R=D=>{const N=ne(()=>o(y)==="edit"?o(d):null);Cv(D,{get itemEditorMode(){return o(y)},get item(){return o(N)},get validationErrors(){return o(p)},$$events:{save:k,close:P}})};j(W,D=>{o(m)&&D(R)})}_(r,z),nt(),a()}yt(["click"]);var Lv=I('<div class="no-selection svelte-xcscli"><p class="svelte-xcscli"> </p> <p class="no-selection-subtitle svelte-xcscli"> </p></div>'),Dv=I('<div class="loading-state svelte-xcscli"><p> </p></div>'),Rv=I('<div class="error-state svelte-xcscli"><p class="error-message svelte-xcscli"> </p> <button type="button" class="retry-button svelte-xcscli"> </button></div>'),Av=I('<button type="button" class="action-button edit-button svelte-xcscli"> </button>'),Ov=I('<button type="button" class="action-button delete-button svelte-xcscli"> </button>'),Uv=I('<div class="preview-error svelte-xcscli"><p> </p></div>'),zv=I('<div class="text-preview svelte-xcscli"><pre class="text-content svelte-xcscli"> </pre></div>'),Wv=I('<div class="image-preview svelte-xcscli"><img class="preview-image svelte-xcscli"/></div>'),Nv=I('<div class="audio-preview svelte-xcscli"><audio controls class="preview-audio svelte-xcscli"><source/> </audio></div>'),jv=I('<div class="video-preview svelte-xcscli"><video controls class="preview-video svelte-xcscli"><track kind="captions"/> <source/> </video></div>',2),Bv=I('<div class="binary-preview svelte-xcscli"><p> </p> <p class="binary-info svelte-xcscli"> </p></div>'),$v=I('<div class="content-header svelte-xcscli"><span class="content-type-icon svelte-xcscli"> </span> <span class="content-type svelte-xcscli"> </span></div> <!>',1),Hv=I('<div class="preview-content svelte-xcscli"><div class="preview-header svelte-xcscli"><div class="preview-actions svelte-xcscli"><!> <button type="button" class="action-button download-button svelte-xcscli"> </button> <!></div></div> <div class="preview-body svelte-xcscli"><!></div></div>'),qv=I('<div class="manifest-preview svelte-xcscli"><!></div>');function Vv(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"selectedItem",8,null),s=$(e,"selectedItemType",8,null),l=$(e,"workspace",8,null),c=$(e,"workspaceService",8);const d=tn();let u=Ke(null),p=Ke(!1),h=Ke(null),v=null;const m=S=>S.startsWith("text/")||S.includes("json")||S.includes("xml")||S.includes("javascript"),y=S=>S.startsWith("image/"),b=S=>S.includes("css")||S.includes("javascript")||S.includes("json")||S.includes("xml")||S.startsWith("text/css")||S.startsWith("text/javascript")||S.startsWith("application/json")||S.startsWith("application/xml")||S.startsWith("application/xhtml+xml"),M=()=>{v&&(URL.revokeObjectURL(v),v=null)};cr(()=>{M()});const T=async()=>{if(!i()||!s()||!c()||!l()){w(u,null),M();return}try{if(w(p,!0),w(h,null),M(),s()==="manifest"){const S=i(),W=S.href.startsWith(l().pathInfo.basePath+"/")?S.href:`${l().pathInfo.basePath}/${S.href}`;try{let R;try{R=await c().readFile(l().id,W)}catch{R=await c().readFile(l().id,S.href)}const D=m(S.mediaType),N=y(S.mediaType);let A,B,Q;if(D)A=new TextDecoder("utf-8").decode(R),Q="text";else if(N){const le=new Blob([R],{type:S.mediaType});B=URL.createObjectURL(le),v=B,Q="image"}else Q="binary";w(u,{itemId:S.id,mediaType:S.mediaType,contentType:Q,textContent:A,previewUrl:B,metadata:{characterCount:A?A.length:void 0,lineCount:A?A.split(`
`).length:void 0,wordCount:A?A.split(/\s+/).filter(le=>le.length>0).length:void 0}})}catch{w(u,{itemId:S.id,mediaType:S.mediaType,contentType:"binary",error:"Failed to load content"})}}else if(s()==="source"){const S=i();try{const W=await c().readFile(l().id,S.path),R=m(S.mediaType||"text/plain");let D;R&&(D=new TextDecoder("utf-8").decode(W)),w(u,{itemId:S.path,mediaType:S.mediaType||"text/plain",contentType:R?"text":"binary",textContent:D,metadata:{characterCount:D?D.length:void 0,lineCount:D?D.split(`
`).length:void 0,wordCount:D?D.split(/\s+/).filter(N=>N.length>0).length:void 0}})}catch{w(u,{itemId:S.path,mediaType:S.mediaType||"text/plain",contentType:"text",error:"Failed to load SOURCE file content"})}}else if(s()==="opf"){const S=i();try{const W=await c().readFile(l().id,l().pathInfo.rootfilePath),D=new TextDecoder("utf-8").decode(W);w(u,{itemId:S.name,mediaType:"application/xml",contentType:"text",textContent:D,metadata:{characterCount:D.length,lineCount:D.split(`
`).length,wordCount:D.split(/\s+/).filter(N=>N.length>0).length}})}catch{w(u,{itemId:S.name,mediaType:"application/xml",contentType:"text",error:"Failed to load content.opf file"})}}}catch{w(h,n()("Failed to load content preview")),w(u,null)}finally{w(p,!1)}},E=()=>{i()&&s()==="manifest"&&d("itemEdit",{item:i()})},C=()=>{i()&&s()==="manifest"&&d("itemDelete",{itemId:i().id})},k=async()=>{if(!(!i()||!c()||!l()))try{let S,W,R;if(s()==="manifest"){const B=i(),Q=B.href.startsWith(l().pathInfo.basePath+"/")?B.href:`${l().pathInfo.basePath}/${B.href}`;try{S=await c().readFile(l().id,Q)}catch{S=await c().readFile(l().id,B.href)}W=B.href.split("/").pop()||B.id,R=B.mediaType}else if(s()==="source"){const B=i();S=await c().readFile(l().id,B.path),W=B.name||B.path.split("/").pop()||"source-file",R=B.mediaType||"application/octet-stream"}else if(s()==="opf"){const B=i();S=await c().readFile(l().id,l().pathInfo.rootfilePath),W="content.opf",R="application/xml"}else return;const D=new Blob([S],{type:R}),N=URL.createObjectURL(D),A=document.createElement("a");A.href=N,A.download=W,A.style.display="none",document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(N)}catch(S){console.error("Download failed:",S)}},X=S=>{switch(S){case"text":return"📄";case"image":return"🖼️";case"audio":return"🎵";case"video":return"🎥";default:return"📦"}};_t(()=>(wt(i()),wt(s()),wt(c()),wt(l())),()=>{i()&&s()&&c()&&l()&&T()}),sn(),Rt();var P=qv(),z=f(P);{var U=S=>{var W=Lv(),R=f(W),D=f(R),N=g(R,2),A=f(N);O((B,Q)=>{x(D,B),x(A,Q)},[()=>n()("Select an item to preview its content"),()=>n()("Click on any row in the table to see details")],Te),_(S,W)},F=(S,W)=>{{var R=N=>{var A=Dv(),B=f(A),Q=f(B);O(le=>x(Q,le),[()=>n()("Loading preview…")],Te),_(N,A)},D=(N,A)=>{{var B=le=>{var Ie=Rv(),Me=f(Ie),Oe=f(Me),Le=g(Me,2),fe=f(Le);O(Y=>{x(Oe,o(h)),x(fe,Y)},[()=>n()("Retry")],Te),at("click",Le,T),_(le,Ie)},Q=le=>{var Ie=Hv(),Me=f(Ie),Oe=f(Me),Le=f(Oe);{var fe=Re=>{var Be=Av(),Ae=f(Be);O($e=>x(Ae,$e),[()=>n()("Edit")],Te),at("click",Be,E),_(Re,Be)};j(Le,Re=>{s()==="manifest"&&Re(fe)})}var Y=g(Le,2),te=f(Y),ae=g(Y,2);{var be=Re=>{var Be=Ov(),Ae=f(Be);O($e=>x(Ae,$e),[()=>n()("Delete")],Te),at("click",Be,C),_(Re,Be)};j(ae,Re=>{s()==="manifest"&&Re(be)})}var ke=g(Me,2),We=f(ke);{var je=Re=>{var Be=$v(),Ae=Ye(Be),$e=f(Ae),Ve=f($e),ve=g($e,2),me=f(ve),Ee=g(Ae,2);{var He=Se=>{var ge=Uv(),Ge=f(ge),H=f(Ge);O(G=>x(H,`${G??""}: ${o(u).error??""}`),[()=>n()("Preview Error")],Te),_(Se,ge)},ee=(Se,ge)=>{{var Ge=G=>{var J=zv(),de=f(J),we=f(de);O(q=>{ue(de,"dir",q),x(we,o(u).textContent),de.dir=de.dir},[()=>b(o(u).mediaType)?"ltr":void 0],Te),_(G,J)},H=(G,J)=>{{var de=q=>{var se=Wv(),ce=f(se);O(()=>{ue(ce,"src",o(u).previewUrl),ue(ce,"alt",s()==="manifest"?i().id:i().name)}),_(q,se)},we=(q,se)=>{{var ce=ye=>{var Ce=Nv(),Ne=f(Ce),Fe=f(Ne),oe=g(Fe);O(Ue=>{ue(Fe,"src",o(u).previewUrl),ue(Fe,"type",o(u).mediaType),x(oe,` ${Ue??""}`)},[()=>n()("Your browser does not support the audio element.")],Te),_(ye,Ce)},pe=(ye,Ce)=>{{var Ne=oe=>{var Ue=jv(),Je=f(Ue),De=g(f(Je),2),Z=g(De);O(V=>{ue(De,"src",o(u).previewUrl),ue(De,"type",o(u).mediaType),x(Z,` ${V??""}`)},[()=>n()("Your browser does not support the video element.")],Te),_(oe,Ue)},Fe=oe=>{var Ue=Bv(),Je=f(Ue),De=f(Je),Z=g(Je,2),V=f(Z);O((he,K)=>{x(De,he),x(V,K)},[()=>n()("Binary file - preview not available"),()=>n()("Use the download button to access the file")],Te),_(oe,Ue)};j(ye,oe=>{o(u).contentType==="video"&&o(u).previewUrl?oe(Ne):oe(Fe,!1)},Ce)}};j(q,ye=>{o(u).contentType==="audio"&&o(u).previewUrl?ye(ce):ye(pe,!1)},se)}};j(G,q=>{o(u).contentType==="image"&&o(u).previewUrl?q(de):q(we,!1)},J)}};j(Se,G=>{o(u).contentType==="text"&&o(u).textContent?G(Ge):G(H,!1)},ge)}};j(Ee,Se=>{o(u).error?Se(He):Se(ee,!1)})}O(Se=>{x(Ve,Se),x(me,o(u).mediaType)},[()=>X(o(u).contentType)],Te),_(Re,Be)};j(We,Re=>{o(u)&&Re(je)})}O(Re=>x(te,Re),[()=>n()("Download")],Te),at("click",Y,k),_(le,Ie)};j(N,le=>{o(h)?le(B):le(Q,!1)},A)}};j(S,N=>{o(p)?N(R):N(D,!1)},W)}};j(z,S=>{i()?S(F,!1):S(U)})}_(r,P),nt(),a()}var Gv=I(`<div class="outline-editor"><textarea class="outline-editor__textarea" aria-label="Navigation content editor" aria-describedby="editor-help" spellcheck="false" aria-multiline="true"></textarea> <div id="editor-help" class="sr-only">Enter navigation content in plain text. Leave empty to auto-generate from chapter titles. Press
    Ctrl+Enter (Cmd+Enter on Mac) to save navigation content.</div></div>`);function Xv(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(s(),"$editorStore",t),i=Ke();let s=$(e,"editorStore",8),l=$(e,"placeholder",8,"Navigation content will be auto-generated from your chapters...");const c=tn();let d;function u(v){const m=v.target;clearTimeout(d),d=setTimeout(()=>{s().updateContent(m.value),c("contentChanged",{editorId:"outline-nav",timestamp:Date.now(),isEmpty:m.value.trim()===""})},300)}cr(()=>{clearTimeout(d)}),_t(()=>n(),()=>{w(i,n().content)}),sn(),Rt();var p=Gv(),h=f(p);O(()=>{An(h,o(i)),ue(h,"placeholder",l())}),at("input",h,u),_(r,p),nt(),a()}class gr{static async generateFromSpine(e,t,a,n){n||(n={rootfilePath:"OEBPS/content.opf",basePath:"OEBPS",opfFileName:"content.opf"});const i={includeUntitled:!0,titleStrategy:"heading",documentTitle:"Table of Contents",cssClasses:{}},s=[];let l=1;for(const u of e)if(u.href)try{const p=`${n.basePath}/${u.href}`,h=await t.readFile(a,p),v=new TextDecoder().decode(h),m=this.extractTitleFromXHTML(v,u.href,l,"heading");if(m||i.includeUntitled){const y={href:u.href,title:m||`Chapter ${l}`};s.push(y)}l++}catch(p){if(p instanceof Error&&p.message.includes("Workspace not found"))throw p;continue}return{xhtmlContent:this.generateNavigationXHTML(s,i.documentTitle,i.cssClasses),metadata:{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"],linear:!1}}}static async processUserContent(e,t,a,n){const i={validationLevel:"strict",errorHandling:"throw",documentTitle:"Navigation",...n};try{let l=(await t.transformText(e,a,"nav")).transformedText||"";return(!l||!l.includes('<?xml version="1.0" encoding="UTF-8"?>'))&&(l=this.generateNavigationXHTML([],i.documentTitle)),{xhtmlContent:l,metadata:{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"],linear:!1}}}catch(s){if(i.errorHandling==="throw")throw s;return{xhtmlContent:this.generateNavigationXHTML([],i.documentTitle),metadata:{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"],linear:!1}}}}static extractTitleFromXHTML(e,t,a,n){const s=new DOMParser().parseFromString(e,"application/xml");if(s.querySelector("parsererror"))throw new Error("Malformed XHTML");if(!s.querySelector("html"))throw new Error("Invalid XHTML structure");const d=s.querySelectorAll("h1, h2, h3, h4, h5, h6");for(const h of d){const v=h.textContent?.trim();if(v)return v}const p=s.querySelector("title")?.textContent?.trim();return p||this.getFallbackTitle(t,a,n)}static getFallbackTitle(e,t,a){return a==="filename"?(e.split("/").pop()||"").replace(/\.[^/.]+$/,"")||null:a==="fallback"?`Chapter ${t}`:null}static generateNavigationXHTML(e,t="Table of Contents",a={}){const n=e.map(l=>`      <li><a href="${l.href}">${this.escapeXML(l.title)}</a></li>`).join(`
`),i=a.nav?` class="${a.nav}"`:"",s=a.list?` class="${a.list}"`:"";return`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
  <title>${this.escapeXML(t)}</title>
  <meta charset="UTF-8"/>
</head>
<body>
  <nav epub:type="toc" role="navigation"${i}>
    <h1>${this.escapeXML(t)}</h1>
    <ol${s}>
${n}
    </ol>
  </nav>
</body>
</html>`}static escapeXML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}}var Kv=I('<div class="outline-view svelte-vjoxn9" role="group" aria-label="Navigation editor"><div aria-live="polite" aria-atomic="true" class="sr-only svelte-vjoxn9"></div> <div aria-live="assertive" aria-atomic="true" class="sr-only svelte-vjoxn9"></div> <!></div>');function Yv(r,e){tt(e,!1);const[t,a]=ot(),n=()=>Qe(p,"$outlineStore",t);let i=$(e,"workspace",12),s=$(e,"workspaceService",8),l=$(e,"spineService",8),c=$(e,"transformPipeline",8,void 0);const d=tn(),u=`outline-nav-${Date.now()}-${Math.random().toString(36).substring(2,8)}`,p=wo(u);let h=!1,v=null;async function m(N){try{N?await y():await b()}catch(A){d("error",{message:A instanceof Error?A.message:"Unknown error occurred",stage:N?"generation":"transform"})}}async function y(){try{const N=await l().loadSpineItems(i()),A=await gr.generateFromSpine(N,s(),i().id,i().pathInfo);d("previewUpdate",{xhtml:A.xhtmlContent})}catch(N){console.error("Failed to generate navigation from spine:",N),d("error",{message:N instanceof Error?N.message:"Failed to generate navigation",stage:"generation"})}}async function b(){const N=p.getContent();if(!c()){console.warn("TransformPipeline not available - falling back to auto-generation"),await y();return}try{const A=await gr.processUserContent(N,c(),i().id);d("previewUpdate",{xhtml:A.xhtmlContent,warnings:[]})}catch(A){console.error("Failed to process user content:",A),d("error",{message:A instanceof Error?A.message:"Failed to process navigation content",stage:"transform"})}}async function M(){await U();try{const N="SOURCE/text/nav.txt";if(await s().fileExists(i().id,N)){const B=await s().readFile(i().id,N),Q=new TextDecoder().decode(B);p.updateContent(Q)}else p.updateContent("")}catch(N){console.error("Failed to load navigation content:",N),d("error",{message:N instanceof Error?N.message:"Failed to load navigation content",stage:"generation"})}}async function T(){await U();try{const N=p.getContent();await s().writeFile(i().id,"SOURCE/text/nav.txt",N);let B;if(N.trim()===""){const Ie=await l().loadSpineItems(i());B=await gr.generateFromSpine(Ie,s(),i().id,i().pathInfo)}else if(c())B=await gr.processUserContent(N,c(),i().id);else{console.warn("TransformPipeline not available - using auto-generation instead of user content");const Ie=await l().loadSpineItems(i());B=await gr.generateFromSpine(Ie,s(),i().id,i().pathInfo)}await s().writeFile(i().id,"OEBPS/nav.xhtml",B.xhtmlContent);const le=i().opf.manifest.find(Ie=>Ie.id==="nav"||Ie.properties?.includes("nav"));le?le.href!=="nav.xhtml"&&i(await s().updateManifestItem(i(),le.id,{href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"]})):i(await s().addManifestItem(i(),{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"]}))}catch(N){console.error("Failed to save navigation content:",N),d("error",{message:N instanceof Error?N.message:"Failed to save navigation content",stage:"save"})}}function E(N){}let C=Ke(),k=Ke();async function X(N){if(N.key==="Enter"&&(N.ctrlKey||N.metaKey)){N.preventDefault();try{await T(),o(C)&&(et(C,o(C).textContent="Navigation saved successfully"),setTimeout(()=>{et(C,o(C).textContent="")},3e3))}catch(A){o(k)&&(et(k,o(k).textContent=`Save failed: ${A instanceof Error?A.message:"Unknown error"}`),setTimeout(()=>{et(k,o(k).textContent="")},5e3))}}}on(async()=>{v||(v=P()),await v}),cr(()=>{h=!1,v=null,p.destroy(),d("destroyed",{timestamp:Date.now()})});async function P(){try{h=!0,d("ready",{timestamp:Date.now()}),await M()}catch(N){console.error("Failed to initialize OutlineView:",N),d("error",{message:N instanceof Error?N.message:"Failed to initialize component",stage:"generation"})}}function z(){return h}async function U(){if(!h){if(v){await v;return}throw new Error("Component not mounted")}}_t(()=>n(),()=>{n().lastUpdated&&m(n().isEmpty)}),sn(),Rt();var F=Kv(),S=f(F);Bt(S,N=>w(C,N),()=>o(C));var W=g(S,2);Bt(W,N=>w(k,N),()=>o(k));var R=g(W,2);Xv(R,{get editorStore(){return p},placeholder:"Navigation content will be auto-generated from your chapters...",$$events:{contentChanged:E}}),at("keydown",F,X),_(r,F),Ut(e,"loadNavigationContent",M),Ut(e,"saveNavigationContent",T),Ut(e,"isReady",z),Ut(e,"waitForReady",U);var D=nt({loadNavigationContent:M,saveNavigationContent:T,isReady:z,waitForReady:U});return a(),D}var Jv=I('<div><div class="content-preview__container svelte-166aukc"><div class="content-preview__letterbox svelte-166aukc"><iframe class="content-preview__iframe svelte-166aukc" title="Content Preview"></iframe></div></div></div>');function Zv(r,e){tt(e,!1);let t=$(e,"content",8),a=$(e,"deviceSize",8,"responsive"),n=$(e,"orientation",8,"portrait"),i=$(e,"fontSizeAdjustment",8,0),s=$(e,"fontFamily",8,"default"),l=$(e,"onNavigate",8,void 0),c=$(e,"class",8,"");const d={"old-iphone":{width:375,height:667,fontSize:16,margin:12,lineHeight:1.4},"recent-iphone":{width:390,height:844,fontSize:17,margin:14,lineHeight:1.4},"large-iphone":{width:430,height:932,fontSize:18,margin:16,lineHeight:1.4},"small-tablet":{width:744,height:1133,fontSize:20,margin:20,lineHeight:1.5},"medium-tablet":{width:820,height:1180,fontSize:22,margin:24,lineHeight:1.5},"large-tablet":{width:1024,height:1366,fontSize:24,margin:28,lineHeight:1.5}};let u=Ke(),p=Ke(),h=Ke();function v(P,z){if(P==="responsive")return null;const U=d[P];return z==="landscape"?{width:U.height,height:U.width}:{width:U.width,height:U.height}}function m(P,z){if(P==="responsive")return"";const U=d[P];return`body {
      font-size: ${U.fontSize+z}px;
      margin: ${U.margin}px;
      line-height: ${U.lineHeight};
    }`}function y(P,z,U,F){if(!P)return;const S=P.contentDocument;if(!S)return;if(S.head){const R=S.head.querySelector(".device-injected-styles");R&&R.remove()}let W="";if(W+=m(z,F),W){const R=S.createElement("style");if(R.className="device-injected-styles",R.textContent=W,S.head){const D=S.head.querySelector('style, link[rel="stylesheet"]');D?S.head.insertBefore(R,D):S.head.appendChild(R)}}}function b(P,z){const U=P.width/z.width,F=P.height/z.height;return Math.min(U,F)}function M(){if(!o(u)||!o(p)||!o(h))return;const P=v(a(),n());if(!P){et(p,o(p).style.transform=""),et(p,o(p).style.width="100%"),et(p,o(p).style.height="100%"),et(h,o(h).style.width="100%"),et(h,o(h).style.height="100%");return}const z=o(u).getBoundingClientRect(),U=b(z,P);et(h,o(h).style.width=`${P.width}px`),et(h,o(h).style.height=`${P.height}px`),et(p,o(p).style.transform=`scale(${U})`),et(p,o(p).style.transformOrigin="center"),et(p,o(p).style.width=`${P.width}px`),et(p,o(p).style.height=`${P.height}px`)}function T(){o(h)&&(y(o(h),a(),s(),i()),l()&&o(h).contentDocument&&o(h).contentDocument.addEventListener("click",P=>{const z=P.target;if(z.tagName==="A"&&z.href){const U=z.getAttribute("href");if(U&&U.includes(".xhtml")){P.preventDefault();const F=U.match(/([^/]+)\.xhtml$/);if(F){const S=F[1];l()(S)}}}}))}on(()=>{M();let P=null;return typeof ResizeObserver<"u"&&(P=new ResizeObserver(()=>{M()})),o(u)&&P&&P.observe(o(u)),()=>{P&&P.disconnect()}}),_t(()=>(o(h),wt(t())),()=>{o(h)&&t()&&et(h,o(h).srcdoc=t())}),_t(()=>(o(u),o(p),o(h)),()=>{o(u)&&o(p)&&o(h)&&M()}),_t(()=>(o(h),wt(a()),wt(s()),wt(i())),()=>{o(h)&&y(o(h),a(),s(),i())}),sn(),Rt();var E=Jv(),C=f(E),k=f(C),X=f(k);Bt(X,P=>w(h,P),()=>o(h)),Bt(C,P=>w(p,P),()=>o(p)),Bt(E,P=>w(u,P),()=>o(u)),O(()=>{st(E,1,`content-preview ${c()??""}`,"svelte-166aukc"),ue(X,"srcdoc",t())}),at("load",X,T),_(r,E),nt()}const Qv=[{field:"title",xmlPattern:"dublin-core",selector:"dc:title",displayName:"Title"},{field:"language",xmlPattern:"dublin-core",selector:"dc:language",displayName:"Language"},{field:"identifier",xmlPattern:"dublin-core",selector:"dc:identifier",displayName:"Identifier"},{field:"publisher",xmlPattern:"dublin-core",selector:"dc:publisher",displayName:"Publisher"},{field:"date",xmlPattern:"dublin-core",selector:"dc:date",displayName:"Date"},{field:"description",xmlPattern:"dublin-core",selector:"dc:description",displayName:"Description"},{field:"rights",xmlPattern:"dublin-core",selector:"dc:rights",displayName:"Rights"},{field:"source",xmlPattern:"dublin-core",selector:"dc:source",displayName:"Source"},{field:"relation",xmlPattern:"dublin-core",selector:"dc:relation",displayName:"Relation"},{field:"coverage",xmlPattern:"dublin-core",selector:"dc:coverage",displayName:"Coverage"},{field:"type",xmlPattern:"dublin-core",selector:"dc:type",displayName:"Type"},{field:"format",xmlPattern:"dublin-core",selector:"dc:format",displayName:"Format"},{field:"creator",xmlPattern:"dublin-core",selector:"dc:creator",displayName:"Creator",isArray:!0},{field:"contributor",xmlPattern:"dublin-core",selector:"dc:contributor",displayName:"Contributor",isArray:!0},{field:"subject",xmlPattern:"dublin-core",selector:"dc:subject",displayName:"Subject",isArray:!0},{field:"renditionLayout",xmlPattern:"meta-property",selector:'meta[property="rendition:layout"]',displayName:"Layout"},{field:"renditionOrientation",xmlPattern:"meta-property",selector:'meta[property="rendition:orientation"]',displayName:"Orientation"},{field:"renditionSpread",xmlPattern:"meta-property",selector:'meta[property="rendition:spread"]',displayName:"Spread"}];class em{mappings;constructor(){this.mappings=Qv}highlightOPFContent(e,t={}){const{focusedField:a,highlightValues:n=!0,highlightTags:i=!0,pageProgressionDirection:s}=t;try{const l=this.formatXML(e);let c=this.escapeHTML(l);for(const d of this.mappings){const u=a===d.field;c=this.highlightFieldInXML(c,d,u,n,i)}return c=this.addStructuralHighlighting(c,s),{highlightedXML:c.trim(),fieldMappings:this.mappings}}catch(l){return console.warn("XML highlighting failed:",l),{highlightedXML:this.escapeHTML(e),fieldMappings:this.mappings}}}highlightFieldInXML(e,t,a,n,i){return t.xmlPattern==="dublin-core"?this.highlightDublinCoreField(e,t,a,n,i):this.highlightMetaPropertyField(e,t,a,n,i)}highlightDublinCoreField(e,t,a,n,i){const s=t.selector.replace("dc:",""),l=new RegExp(`(&lt;dc:${s}[^<]*?&gt;)(.*?)(&lt;/dc:${s}&gt;)`,"gi");return e.replace(l,(c,d,u,p)=>{let h="";return i?h+=`<span class="${a?"metadata-tag-focused":"metadata-tag"}">${d}</span>`:h+=d,n&&u.trim()?h+=`<span class="${a?"metadata-value-focused":"metadata-value"}">${u}</span>`:h+=u,i?h+=`<span class="${a?"metadata-tag-focused":"metadata-tag"}">${p}</span>`:h+=p,h})}highlightMetaPropertyField(e,t,a,n,i){const s=t.selector.match(/property="([^"]+)"/);if(!s)return e;const l=s[1],c=new RegExp(`(&lt;meta[^&]*?property=&quot;${l.replace(":","\\:")}&quot;[^&]*?&gt;)(.*?)(&lt;/meta&gt;)`,"gi");return e.replace(c,(d,u,p,h)=>{let v="";return i?v+=`<span class="${a?"metadata-tag-focused":"metadata-tag"}">${u}</span>`:v+=u,n&&p.trim()?v+=`<span class="${a?"metadata-value-focused":"metadata-value"}">${p}</span>`:v+=p,i?v+=`<span class="${a?"metadata-tag-focused":"metadata-tag"}">${h}</span>`:v+=h,v})}formatXML(e){return e.replace(/^<\?xml[^>]+\?>[\s\n]*/,"").replace(/></g,`>
<`).replace(/^\s*\n/gm,"").trim()}escapeHTML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}addStructuralHighlighting(e,t){let a=e;return a=a.replace(/(&lt;package[^>]*?&gt;)/g,'<span class="structural-element">$1</span>'),a=a.replace(/(&lt;\/package&gt;)/g,'<span class="structural-element">$1</span>'),a=a.replace(/(&lt;manifest&gt;[\s\S]*?&lt;\/manifest&gt;)/g,'<span class="structural-element">$1</span>'),t&&t!=="default"&&t!==""||(a=a.replace(/(&lt;spine&gt;[\s\S]*?&lt;\/spine&gt;)/g,'<span class="structural-element">$1</span>')),a}getFieldMapping(e){return this.mappings.find(t=>t.field===e)}getAllFieldMappings(){return[...this.mappings]}}const tm=new em;var nm=I(" <!>",1),rm=I('<div><div class="field-label svelte-uhoge6"> </div> <div class="field-value svelte-uhoge6"></div></div>'),am=I('<div><div class="field-label svelte-uhoge6"> </div> <div class="field-value description svelte-uhoge6"> </div></div>'),im=I('<div class="preview-body svelte-uhoge6"><div class="metadata-summary svelte-uhoge6"><div><div class="field-label svelte-uhoge6"> </div> <div class="field-value svelte-uhoge6"> </div></div> <div><div class="field-label svelte-uhoge6"> </div> <div class="field-value svelte-uhoge6"> </div></div> <!> <!> <div><div class="field-label svelte-uhoge6"> </div> <div class="field-value identifier svelte-uhoge6"> </div></div></div></div>'),sm=I('<div class="no-content svelte-uhoge6"><p> </p></div>'),om=I('<div class="simple-metadata-view svelte-uhoge6"><div class="preview-header svelte-uhoge6"><span class="content-type-icon svelte-uhoge6">📝</span> <span class="file-name svelte-uhoge6"> </span></div> <!></div>');function lm(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"focusedField",3,null),s=ne(()=>e.workspace?.opf?.metadata);var l=om(),c=f(l),d=g(f(c),2),u=f(d),p=g(c,2);{var h=m=>{var y=im(),b=f(y),M=f(b);let T;var E=f(M),C=f(E),k=g(E,2),X=f(k),P=g(M,2);let z;var U=f(P),F=f(U),S=g(U,2),W=f(S),R=g(P,2);{var D=Le=>{var fe=rm();let Y;var te=f(fe),ae=f(te),be=g(te,2);kt(be,21,()=>o(s).creator,It,(ke,We,je)=>{var Re=nm(),Be=Ye(Re),Ae=g(Be);{var $e=Ve=>{var ve=Pt(",");_(Ve,ve)};j(Ae,Ve=>{je<o(s).creator.length-1&&Ve($e)})}O(()=>x(Be,o(We))),_(ke,Re)}),O((ke,We)=>{Y=st(fe,1,"field-row svelte-uhoge6",null,Y,ke),x(ae,We)},[()=>({focused:i()==="creator"}),()=>n()("Authors")]),_(Le,fe)};j(R,Le=>{o(s).creator&&o(s).creator.length>0&&Le(D)})}var N=g(R,2);{var A=Le=>{var fe=am();let Y;var te=f(fe),ae=f(te),be=g(te,2),ke=f(be);O((We,je)=>{Y=st(fe,1,"field-row svelte-uhoge6",null,Y,We),x(ae,je),x(ke,o(s).description)},[()=>({focused:i()==="description"}),()=>n()("Description")]),_(Le,fe)};j(N,Le=>{o(s).description&&Le(A)})}var B=g(N,2);let Q;var le=f(B),Ie=f(le),Me=g(le,2),Oe=f(Me);O((Le,fe,Y,te,ae,be,ke,We,je)=>{T=st(M,1,"field-row svelte-uhoge6",null,T,Le),x(C,fe),x(X,Y),z=st(P,1,"field-row svelte-uhoge6",null,z,te),x(F,ae),x(W,be),Q=st(B,1,"field-row svelte-uhoge6",null,Q,ke),x(Ie,We),x(Oe,je)},[()=>({focused:i()==="title"}),()=>n()("Title"),()=>o(s).title||n()("Untitled"),()=>({focused:i()==="language"}),()=>n()("Language"),()=>o(s).language||n()("Not specified"),()=>({focused:i()==="identifier"}),()=>n()("Identifier"),()=>o(s).identifier||n()("Not specified")]),_(m,y)},v=m=>{var y=sm(),b=f(y),M=f(b);O(T=>x(M,T),[()=>n()("No metadata available")]),_(m,y)};j(p,m=>{o(s)?m(h):m(v,!1)})}O(m=>x(u,m),[()=>n()("Metadata Summary")]),_(r,l),nt(),a()}var cm=I('<div class="error-state svelte-vzuyuw"><p class="error-message svelte-vzuyuw"> </p> <button type="button" class="retry-button svelte-vzuyuw"> </button></div>'),dm=I('<div class="preview-body svelte-vzuyuw"><div class="text-preview svelte-vzuyuw"><pre class="text-content highlighted-xml svelte-vzuyuw" dir="ltr"><!></pre></div></div>'),um=I('<div class="no-content svelte-vzuyuw"><p> </p></div>'),fm=I('<div class="opf-preview svelte-vzuyuw"><div class="preview-header svelte-vzuyuw"><span class="content-type-icon svelte-vzuyuw">📄</span> <span class="file-name svelte-vzuyuw">content.opf</span></div> <!></div>');function pm(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(dt,"$t",t);let i=$(e,"focusedField",3,null),s=$(e,"isAdvancedMode",3,!1),l=Pe(""),c=Pe(null),d=ne(()=>()=>{if(!e.workspace)return"";try{return xt.generateOPFXML(e.workspace.opf)}catch(y){return console.error("Failed to generate OPF XML:",y),""}});Et(()=>{u()});const u=()=>{if(!o(d)()){w(l,"");return}try{const y=tm.highlightOPFContent(o(d)(),{focusedField:i(),highlightValues:!0,highlightTags:!0,pageProgressionDirection:e.workspace?.opf?.metadata?.pageProgressionDirection});w(l,y.highlightedXML,!0),w(c,null)}catch(y){console.error("Failed to highlight XML:",y),w(c,n()("Failed to generate XML preview"),!0),w(l,"")}};var p=lt(),h=Ye(p);{var v=y=>{var b=fm(),M=g(f(b),2);{var T=C=>{var k=cm(),X=f(k),P=f(X),z=g(X,2);z.__click=u;var U=f(z);O(F=>{x(P,o(c)),x(U,F)},[()=>n()("Retry")]),_(C,k)},E=(C,k)=>{{var X=z=>{var U=dm(),F=f(U),S=f(F),W=f(S);js(W,()=>o(l)),O(()=>S.dir=S.dir),_(z,U)},P=z=>{var U=um(),F=f(U),S=f(F);O(W=>x(S,W),[()=>n()("No content available")]),_(z,U)};j(C,z=>{o(l)?z(X):z(P,!1)},k)}};j(M,C=>{o(c)?C(T):C(E,!1)})}_(y,b)},m=y=>{lm(y,{get workspace(){return e.workspace},get focusedField(){return i()}})};j(h,y=>{s()?y(v):y(m,!1)})}_(r,p),nt(),a()}yt(["click"]);class Yt extends Error{constructor(e,t,a){super(e),this.code=t,this.workspaceId=a,this.name="WorkspaceServiceError"}}class hm extends Yt{constructor(e){super(`Workspace not found: ${e}. Please check workspace ID.`,"WORKSPACE_NOT_FOUND",e),this.name="WorkspaceNotFoundError"}}class vm extends Yt{constructor(e,t){super(`OPF file corrupted in workspace ${e}: ${t}. Try reimporting the EPUB.`,"OPF_CORRUPTED",e),this.name="OPFCorruptedError"}}class nn extends Yt{constructor(e,t){super(e,"VALIDATION_ERROR"),this.context=t,this.name="ValidationError",this.context=t}}class bo{constructor(e){this.fileStorage=e,this.extensionManager=new Ei(e)}extensionManager;async createWorkspace(e){const t=this.generateWorkspaceId(),a={...e,language:e.language||lo(),modifiedDate:mn()};await this.fileStorage.createWorkspace(t);const n={version:"3.0",metadata:{...a,epubVersion:"3.0"},manifest:[],spine:[],guide:[]};return await this.createEPUBStructure(t,n),{id:t,opf:n,pathInfo:{rootfilePath:"OEBPS/content.opf",basePath:"OEBPS",opfFileName:"content.opf"}}}async populateWithContent(e,t){for(const s of t.assets)await this.fileStorage.writeTextFile(e,s.path,s.content);for(const s of t.chapters)await this.fileStorage.writeTextFile(e,`SOURCE/text/${s.fileName}`,s.content),await this.fileStorage.writeTextFile(e,`OEBPS/Text/${s.id}.xhtml`,s.xhtmlContent);const a=await this.loadWorkspace(e),n={...a.opf,manifest:[...a.opf.manifest,...t.manifestUpdates],spine:[...a.opf.spine,...t.spineUpdates]},i=xt.generateOPFXML(n);return await this.fileStorage.writeTextFile(e,a.pathInfo.rootfilePath,i),{...a,opf:n}}async loadWorkspace(e){try{if(!(await this.fileStorage.listWorkspaces()).includes(e))throw new hm(e);const a=await this.getWorkspacePathInfo(e),n=await this.fileStorage.readTextFile(e,a.rootfilePath);let i;try{i=xt.parseOPFDocument(n)}catch(s){throw new vm(e,s instanceof Error?s.message:"Unknown parsing error")}return{id:e,opf:i,pathInfo:a}}catch(t){throw t instanceof Yt?t:new Yt(`Failed to load workspace: ${t instanceof Error?t.message:"Unknown error"}`,"LOAD_ERROR",e)}}async saveWorkspace(e){const t={...e},a=xt.generateOPFXML(t.opf);return await this.fileStorage.writeTextFile(e.id,e.pathInfo.rootfilePath,a),t}async deleteWorkspace(e){try{await this.fileStorage.deleteWorkspace(e)}catch(t){if(t instanceof Error&&!t.message.includes("not found"))throw new Yt(`Failed to delete workspace: ${t.message}`,"DELETE_ERROR",e)}}async updateMetadata(e,t){return this.validateMetadataUpdates(t),e.opf.metadata={...e.opf.metadata,...t},await this.saveWorkspace(e),e}async addManifestItem(e,t){if(!t.href)throw new nn("Manifest item must have href");const a=t.id||this.generateManifestId(t.href,new Set(e.opf.manifest.map(s=>s.id)));if(e.opf.manifest.some(s=>s.id===a))throw new nn(`Manifest item with ID '${a}' already exists`);const n={id:a,href:t.href,mediaType:t.mediaType||this.detectMediaType(t.href),properties:t.properties,fallback:t.fallback};let i={...e,opf:{...e.opf,manifest:[...e.opf.manifest,n],metadata:{...e.opf.metadata,modifiedDate:mn()}}};return(n.mediaType==="text/javascript"||n.mediaType==="application/javascript")&&(i=this.addScriptedPropertiesToChapters(i)),await this.saveWorkspace(i)}async removeManifestItem(e,t){const a=e.opf.manifest.findIndex(l=>l.id===t);if(a===-1)throw new nn(`Manifest item with ID '${t}' not found`);const n=e.opf.manifest[a],i=n.mediaType==="text/javascript"||n.mediaType==="application/javascript";try{const l=this.resolveManifestPath(n.href,e.pathInfo.basePath);await this.fileStorage.deleteFile(e.id,l)}catch(l){console.warn(`Failed to delete file for manifest item ${t}:`,l)}let s={...e,opf:{...e.opf,manifest:e.opf.manifest.filter(l=>l.id!==t),spine:e.opf.spine.filter(l=>l.idref!==t),metadata:{...e.opf.metadata,modifiedDate:mn()}}};return i&&(s=this.addScriptedPropertiesToChapters(s)),await this.saveWorkspace(s)}async updateManifestItem(e,t,a){const n=e.opf.manifest.findIndex(p=>p.id===t);if(n===-1)throw new nn(`Manifest item with ID '${t}' not found`);const i=e.opf.manifest[n];if(a.href&&a.href!==i.href){const p=this.resolveManifestPath(i.href,e.pathInfo.basePath),h=this.resolveManifestPath(a.href,e.pathInfo.basePath);if(await this.fileStorage.fileExists(e.id,p))try{await this.fileStorage.renameFile(e.id,p,h)}catch(v){throw new Yt(`Failed to move file from ${i.href} to ${a.href}: ${v instanceof Error?v.message:"Unknown error"}`,"FILE_MOVE_ERROR",e.id)}}const s=i.mediaType==="text/javascript"||i.mediaType==="application/javascript",l=a.mediaType==="text/javascript"||a.mediaType==="application/javascript",c=[...e.opf.manifest];c[n]={...c[n],...a};let d=e.opf.spine;if(a.id&&a.id!==t){if(e.opf.manifest.some((p,h)=>h!==n&&p.id===a.id))throw new nn(`Manifest item with ID '${a.id}' already exists`);d=e.opf.spine.map(p=>p.idref===t?{...p,idref:a.id}:p)}let u={...e,opf:{...e.opf,manifest:c,spine:d,metadata:{...e.opf.metadata,modifiedDate:mn()}}};return s!==l&&(u=this.addScriptedPropertiesToChapters(u)),await this.saveWorkspace(u)}async updateSpineOrder(e,t){const a=new Set(e.opf.manifest.map(l=>l.id)),n=t.filter(l=>!a.has(l));if(n.length>0)throw new nn(`Spine items reference missing manifest items: ${n.join(", ")}`);const i=t.map(l=>({idref:l})),s={...e,opf:{...e.opf,spine:i,metadata:{...e.opf.metadata,modifiedDate:mn()}}};return await this.saveWorkspace(s)}async addSpineItem(e,t,a){if(!e.opf.manifest.some(l=>l.id===t.idref))throw new nn(`Referenced manifest item not found: ${t.idref}`);if(e.opf.spine.some(l=>l.idref===t.idref))throw new nn(`Spine item with idref '${t.idref}' already exists`);const n=[...e.opf.spine],i=a??n.length;n.splice(i,0,t);const s={...e,opf:{...e.opf,spine:n,metadata:{...e.opf.metadata,modifiedDate:mn()}}};return await this.saveWorkspace(s)}async removeSpineItem(e,t){if(e.opf.spine.findIndex(i=>i.idref===t)===-1)throw new nn(`Spine item with idref '${t}' not found`);const n={...e,opf:{...e.opf,spine:e.opf.spine.filter(i=>i.idref!==t),metadata:{...e.opf.metadata,modifiedDate:mn()}}};return await this.saveWorkspace(n)}async listWorkspaces(){const e=await this.fileStorage.listWorkspaces(),t=[];for(const a of e)try{const n=await this.loadWorkspace(a),i=await this.fileStorage.listFiles(a),s=0;let l;try{l=(await this.fileStorage.getFileInfo(a,n.pathInfo.rootfilePath)).lastModified}catch{l=n.opf.metadata.modifiedDate?new Date(n.opf.metadata.modifiedDate):new Date}let c;try{const d=await this.extensionManager.listWorkspaceExtensions(a);d.length>0&&(c=d.map(u=>u.name))}catch{}t.push({id:a,title:n.opf.metadata.title,language:n.opf.metadata.language,lastModified:l,fileCount:i.length,totalSize:s,author:n.opf.metadata.creator?.[0]||void 0,hasError:!1,epubVersion:"3.0",extensionIds:c})}catch{continue}return t}async workspaceExists(e){try{return(await this.fileStorage.listWorkspaces()).includes(e)}catch{return!1}}async loadChapterContents(e,t){const a=[];for(const n of t){const i=e.opf.manifest.find(l=>l.id===n),s=e.opf.spine.find(l=>l.idref===n);if(!(!i||!s))try{const l=this.resolveManifestPath(i.href,e.pathInfo.basePath),c=await this.fileStorage.readTextFile(e.id,l);a.push({id:n,href:i.href,xhtmlContent:c,linear:s.linear??!0,mediaType:i.mediaType||"application/xhtml+xml"})}catch{continue}}return a}async loadAllLinearChapterContents(e){const t=e.opf.spine.filter(a=>a.linear!==!1).map(a=>a.idref);return this.loadChapterContents(e,t)}generateWorkspaceId(){return"workspace-"+crypto.randomUUID()}async createEPUBStructure(e,t){await this.fileStorage.writeTextFile(e,"mimetype","application/epub+zip");const a=xt.generateContainerXML();await this.fileStorage.writeTextFile(e,"META-INF/container.xml",a);const n=xt.generateOPFXML(t);await this.fileStorage.writeTextFile(e,"OEBPS/content.opf",n)}async getWorkspacePathInfo(e){try{const t=await this.fileStorage.readTextFile(e,"META-INF/container.xml"),a=xt.parseContainerXml(t);if(a.error)throw new Error(a.error);const n=a.rootfilePath,i=n.lastIndexOf("/");if(i===-1)return{rootfilePath:n,basePath:"",opfFileName:n};const s=n.substring(0,i),l=n.substring(i+1);return{rootfilePath:n,basePath:s,opfFileName:l}}catch(t){throw new Yt(`Failed to parse workspace container.xml: ${t instanceof Error?t.message:"Unknown error"}`,"INVALID_CONTAINER_STRUCTURE",e)}}validateMetadataUpdates(e){if(e.title!==void 0&&e.title.trim()==="")throw new nn("Title cannot be empty");if(e.language!==void 0&&!/^[a-z]{2}(-[A-Z]{2})?$/.test(e.language))throw new nn("Invalid language code format")}addScriptedPropertiesToChapters(e){const t=e.opf.manifest.some(n=>n.mediaType==="text/javascript"||n.mediaType==="application/javascript"),a=e.opf.manifest.map(n=>{if(n.mediaType==="application/xhtml+xml"&&n.id!=="nav"&&!n.properties?.includes("nav")){const i=n.properties||[],s=i.includes("scripted");if(t&&!s)return{...n,properties:[...i,"scripted"]};if(!t&&s){const l=i.filter(c=>c!=="scripted");return{...n,properties:l.length>0?l:void 0}}}return n});return{...e,opf:{...e.opf,manifest:a}}}generateManifestId(e,t){const i=(e.split("/").pop()||"item").replace(/\.[^.]+$/,"").replace(/[^a-zA-Z0-9-_]/g,"-").replace(/^[^a-zA-Z]/,"item-").toLowerCase();let s=i,l=1;for(;t.has(s);)s=`${i}-${l++}`;return s}detectMediaType(e){const t=e.split(".").pop()?.toLowerCase()||"";return{xhtml:"application/xhtml+xml",html:"application/xhtml+xml",css:"text/css",js:"application/javascript",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",svg:"image/svg+xml",mp3:"audio/mpeg",mp4:"video/mp4",ttf:"font/ttf",otf:"font/otf",woff:"font/woff",woff2:"font/woff2"}[t]||"application/octet-stream"}resolveManifestPath(e,t){return!t||e.startsWith(t+"/")?e:`${t}/${e}`}async fileExists(e,t){try{return await this.fileStorage.readFile(e,t),!0}catch{return!1}}async renameFile(e,t,a){await this.fileStorage.renameFile(e,t,a)}async readFile(e,t){try{return await this.fileStorage.readFile(e,t)}catch(a){throw new Yt(`Failed to read file ${t}: ${a instanceof Error?a.message:"Unknown error"}`,"READ_FILE_ERROR",e)}}async writeFile(e,t,a){try{const i=new TextEncoder().encode(a),s=new ArrayBuffer(i.length);new Uint8Array(s).set(i),await this.fileStorage.writeFile(e,t,s)}catch(n){throw new Yt(`Failed to write file ${t}: ${n instanceof Error?n.message:"Unknown error"}`,"WRITE_FILE_ERROR",e)}}async writeBinaryFile(e,t,a){try{await this.fileStorage.writeFile(e,t,a)}catch(n){throw new Yt(`Failed to write binary file ${t}: ${n instanceof Error?n.message:"Unknown error"}`,"WRITE_BINARY_FILE_ERROR",e)}}async listSourceFiles(e){try{const a=(await this.fileStorage.listFiles(e.id)).filter(i=>Jn(i)).filter(i=>!i.endsWith(".gitkeep")),n=[];for(const i of a)try{const s=await this.fileStorage.getFileInfo(e.id,i),l={path:i,name:i.split("/").pop()||i,type:"file",size:s.size,modified:s.lastModified,mediaType:this.detectMediaTypeForSource(i)};n.push(l)}catch{continue}return n}catch(t){throw new Yt(`Failed to list SOURCE files: ${t instanceof Error?t.message:"Unknown error"}`,"LIST_SOURCE_FILES_ERROR",e.id)}}detectMediaTypeForSource(e){const t=e.split(".").pop()?.toLowerCase()||"",a=vo(e),n={txt:"text/plain",md:"text/markdown",json:"application/json",js:"application/javascript",ts:"application/typescript",css:"text/css",html:"text/html",xhtml:"application/xhtml+xml",xml:"application/xml",py:"text/x-python",sh:"application/x-sh"};return n[t]||"text/plain"}async getFileInfo(e,t){return await this.fileStorage.getFileInfo(e,t)}}class es{static validateSyntax(e){if(!e.trim())return null;try{const t=new Function(e);try{const a={console:{log:()=>{},warn:()=>{},error:()=>{}},window:{},document:{querySelector:()=>null,createElement:()=>({}),addEventListener:()=>{}},setTimeout:()=>0,setInterval:()=>0,clearTimeout:()=>{},clearInterval:()=>{},fetch:()=>Promise.resolve(),Math,JSON,Date,Array,Object,String,Number,Boolean,RegExp};return t.call(a),null}catch(a){return a instanceof ReferenceError?`JavaScript reference error: ${a.message}`:a instanceof TypeError?`JavaScript type error: ${a.message}`:`JavaScript runtime error: ${a instanceof Error?a.message:String(a)}`}}catch(t){return t instanceof SyntaxError?`JavaScript syntax error: ${t.message}`:`JavaScript validation error: ${t instanceof Error?t.message:String(t)}`}}static shouldValidate(e){return e.includes("javascript")||e.includes("js")}}class Wa extends Error{constructor(e,t){super(`Missing translation keys for locale ${e}: ${t.join(", ")}`),this.locale=e,this.missingKeys=t,this.name="TranslationMissingError"}}let wr=class extends Error{constructor(e){super(`Unsupported locale: ${e}`),this.locale=e,this.name="UnsupportedLocaleError"}};class mm extends Error{constructor(e,t,a){super(`Invalid content for ${e}.${t}: ${a}`),this.locale=e,this.key=t,this.reason=a,this.name="InvalidContentError"}}const Xr=["sample.book.title","sample.book.description","sample.author.name","sample.publisher.name","sample.chapter1.title","sample.chapter1.content"];class gm{constructor(e){this.catalogs=e}translate(e,t){return this.catalogs[e]?.messages[t]||t}isLocaleSupported(e){return e in this.catalogs}isRTL(e){return["ar","he","fa","ur"].includes(e)}hasTranslation(e,t){const a=this.catalogs[e];if(!a)return!1;const n=a.messages[t];return n!==void 0&&n.trim()!==""}async generateLocalizedContent(e){if(!this.isLocaleSupported(e))throw new wr(e);await this.checkTranslationCompleteness(e);const t={title:this.translate(e,"sample.book.title"),description:this.translate(e,"sample.book.description"),author:this.translate(e,"sample.author.name"),publisher:this.translate(e,"sample.publisher.name")},a=await this.generateLocalizedChapters(e),n=this.isRTL(e);return{locale:e,metadata:t,chapters:a,isRTL:n,pageProgressionDirection:n?"rtl":"ltr"}}async generateLocalizedMetadata(e){if(!this.isLocaleSupported(e))throw new wr(e);const t=["sample.book.title","sample.book.description","sample.author.name","sample.publisher.name"],a=[];for(const u of t)this.hasTranslation(e,u)||a.push(u);if(a.length>0)throw new Wa(e,a);const n=Date.now(),i=performance.now(),s=Math.floor(n+i%1*1e3),l=`sample-content-${e}-${s}`,d=this.isRTL(e)?"rtl":"ltr";return{title:this.translate(e,"sample.book.title"),language:e,identifier:l,creator:[this.translate(e,"sample.author.name")],publisher:this.translate(e,"sample.publisher.name"),description:this.translate(e,"sample.book.description"),pageProgressionDirection:d}}async generateLocalizedChapters(e){if(!this.isLocaleSupported(e))throw new wr(e);const t=["sample.chapter1.title","sample.chapter1.content"],a=[];for(const n of t)this.hasTranslation(e,n)||a.push(n);if(a.length>0)throw new Wa(e,a);return[{id:"chapter1",title:this.translate(e,"sample.chapter1.title"),content:this.translate(e,"sample.chapter1.content"),linear:!0,mediaType:"application/xhtml+xml"}]}async getAvailableLocales(){const e=[],t=Object.keys(this.catalogs);for(const a of t)Xr.every(i=>this.hasTranslation(a,i))&&e.push(a);return e}async validateLocaleCompleteness(e){if(!this.isLocaleSupported(e))throw new wr(e);const t=[],a=[],n=this.catalogs[e];for(const s of Xr)if(!n||!(s in n.messages))t.push(s);else{const l=n.messages[s];(!l||l.trim()==="")&&a.push(s)}return{isValid:t.length===0&&a.length===0,missingKeys:t,emptyKeys:a,locale:e}}async checkTranslationCompleteness(e){const t=this.catalogs[e];if(!t)throw new wr(e);for(const n of Xr)if(n in t.messages){const i=t.messages[n];if(!i||i.trim()==="")throw new mm(e,n,"Translation is empty")}const a=[];for(const n of Xr)n in t.messages||a.push(n);if(a.length>0)throw new Wa(e,a)}}const wm=`/* Universal CSS for all locales with EPUB reading system compatibility */

code-sample {
  font-family: monospace;
  font-weight: 700;
  font-size: 0.7rem;
}

.action {
  text-align: center;
  margin: 3em 0 4em;
}

.action a {
  text-decoration: none;
  background-color: #00e;
  color: white;
  padding: 0.6em 1em 0.5em;
  border-radius: 0.5em;
  font-family: sans-serif;
  font-weight: 600;
}

body {
  /* System fonts with enhanced stack for global language support */
  font-family:
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    'Noto Sans',
    'Liberation Sans',
    sans-serif;

  /* Enhanced typography for reading contexts */
  font-size: 1.125rem; /* Slightly larger base for better readability */
  line-height: 1.6;

  /* Progressive enhancement: physical properties first, then logical */
  margin-left: auto;
  margin-right: auto;
  padding: 1em;
  max-width: 65ch;

  /* Modern logical properties with feature query protection */
}

@supports (margin-inline: auto) {
  body {
    margin-left: unset;
    margin-right: unset;
    max-width: unset;
    margin-inline: auto;
    max-inline-size: 65ch;
  }
}

/* Additional language-specific adjustments */
:lang(ja),
:lang(ko),
:lang(zh) {
  line-height: 1.8; /* Better spacing for CJK characters */
}

:lang(ar),
:lang(he) {
  line-height: 1.7; /* Improved RTL script readability */
}

/* Enhanced text flow and hyphenation */
body {
  hyphens: auto;
  -webkit-hyphens: auto;
  -ms-hyphens: auto;
}

/* Headings with progressive enhancement for logical spacing */
h1,
h2,
h3,
h4,
h5,
h6 {
  /* Physical properties first for compatibility */
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  margin-left: 0;
  margin-right: 0;
  font-weight: 600;
  line-height: 1.2;
}

@supports (margin-block-start: 1.5em) {
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin-top: unset;
    margin-bottom: unset;
    margin-left: unset;
    margin-right: unset;
    margin-block-start: 1.5em;
    margin-block-end: 0.5em;
    margin-inline: 0;
  }
}

h1 {
  font-size: 2em;
  padding-bottom: 0.25em;
}

h2 {
  font-size: 1.5em;
}

h3 {
  font-size: 1.25em;
}

/* Paragraphs with progressive enhancement */
p {
  /* Physical properties first */
  margin-bottom: 1em;
  text-align: left; /* Will be overridden for RTL */
}

/* RTL-specific physical fallback */
[data-dir='rtl'] p {
  text-align: right;
}

/* Lists with progressive enhancement */
ul,
ol {
  /* Physical properties first */
  margin-top: 1em;
  margin-bottom: 1em;
  padding-left: 2em;
}

li {
  margin-bottom: 0.5em;
}

/* Blockquotes with progressive enhancement */
blockquote {
  /* Physical properties first */
  margin-top: 1.5em;
  margin-bottom: 1.5em;
  margin-left: 2em;
  margin-right: 0;
  padding-left: 1em;
  font-style: italic;
}

/* Code blocks with progressive enhancement */
pre,
code {
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
  font-size: 0.875em;
}

pre {
  padding: 1em;
  border-radius: 4px;
  overflow-x: auto;
  margin-top: 1em;
  margin-bottom: 1em;
}

code {
  padding-left: 0.25em;
  padding-right: 0.25em;
  border-radius: 2px;
}

/* Images with progressive enhancement */
img {
  max-width: 100%;
  height: auto;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

/* Strong and emphasis with universal styling */
strong {
  font-weight: 600;
}

em {
  font-style: italic;
}
`,ts=`/**
 * Convert simple text to well-formed XHTML
 * @param {string} text - plain text
 * @param {string|undefined} idref - Spine item idref for context-aware transforms
 * @returns {string} Valid XHTML output
 */
function transformText(text, idref) {
  // Split content into blocks (separated by double newlines)
  const blocks = text.split(/\\n\\s*\\n/).filter(block => block.trim());
  const htmlBlocks = [];

  for (const block of blocks) {
    const trimmedBlock = block.trim();
    if (!trimmedBlock) continue;

    // Check if block is a header
    const headerMatch = trimmedBlock.match(/^(#{1,6})\\s+(.+)$/);
    if (headerMatch) {
      const level = headerMatch[1].length;
      const text = processInlineFormatting(headerMatch[2]);
      htmlBlocks.push(\`<h\${level}>\${text}</h\${level}>\`);
    } else {
      // Process as paragraph content
      let paragraphContent = processInlineFormatting(trimmedBlock);
      // Convert single newlines to <br/> within paragraphs
      paragraphContent = paragraphContent.replace(/\\n/g, '<br />');
      htmlBlocks.push(\`<p>\${paragraphContent}</p>\`);
    }
  }

  return htmlBlocks.join('\\n');
}

/**
 * Process inline formatting (bold, italic) within text
 * @param {string} text - Text to process
 * @returns {string} Text with inline HTML tags
 */
function processInlineFormatting(text) {
  let result = text;

  // Bold and italic (process bold first to handle overlap correctly)
  result = result.replace(/\\*\\*\\*(.*?)\\*\\*\\*/g, '<strong><em>$1</em></strong>');
  result = result.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');
  result = result.replace(/\\*(.*?)\\*/g, '<em>$1</em>');

  return result;
}
`,ym=`/**
 * Transform DOM by adding IDs to H2 headings for navigation
 * @param {Document} htmlDocument - HTML document to transform
 * @param {string|undefined} idref - Spine item idref for context-aware transforms
 */
function transformDOM(htmlDocument, idref) {
  try {
    // Find all H2 elements in the document
    const h2Elements = htmlDocument.querySelectorAll('h2');

    h2Elements.forEach((h2, index) => {
      // Skip if already has an ID
      if (h2.getAttribute('id')) {
        return;
      }

      // Generate ID from text content or use fallback
      const text = h2.textContent || '';
      let id = text
        .toLowerCase()
        .replace(/[^a-z0-9\\s-]/g, '') // Remove special characters
        .replace(/\\s+/g, '-') // Replace spaces with hyphens
        .replace(/-+/g, '-') // Collapse multiple hyphens
        .replace(/^-|-$/g, '') // Remove leading/trailing hyphens
        .substring(0, 50); // Limit length

      // Fallback if no usable text
      if (!id) {
        id = \`heading-\${index + 1}\`;
      }

      // Ensure ID is unique in document
      let finalId = id;
      let counter = 1;
      while (htmlDocument.getElementById(finalId)) {
        finalId = \`\${id}-\${counter}\`;
        counter++;
      }

      // Set the ID attribute
      h2.setAttribute('id', finalId);
    });
  } catch (error) {
    console.error('DOM transform error:', error);
  }
}
`;class xo extends Error{constructor(e,t){super(e),this.code=t,this.name="ContentServiceError"}}class bm extends xo{constructor(e){super(`Unsupported locale: ${e}`,"UNSUPPORTED_LOCALE"),this.name="UnsupportedLocaleError"}}class ca{constructor(e,t){this.transformExecutor=e,this.i18nSystem=t}static SUPPORTED_LOCALES=new Set(["en","es","fr","de","it","pt","nl","sv","da","no","fi","ru","pl","cs","hu","ro","bg","hr","sk","sl","et","lv","lt","el","tr","ar","he","fa","ur","hi","bn","ta","te","ml","kn","gu","pa","or","as","ne","si","my","km","lo","vi","th","id","ms","tl","zh","ja","ko"]);static RTL_LOCALES=new Set(["ar","he","fa","ur"]);async generateSampleContentData(e="en"){try{const t=await this.generateLocalizedContent(e),{chapters:a,isRTL:n}=t,i=[];for(const u of a){const p=await this.transformContent(u.content),h=`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="${e}"${n?' dir="rtl"':""}>
<head>
  <title>${u.title}</title>
  <link rel="stylesheet" type="text/css" href="../Styles/page.css"/>
</head>
<body>
  ${p.xhtml}
</body>
</html>`;i.push({id:u.id,title:u.title,fileName:`${u.id}.txt`,content:u.content,xhtmlContent:h})}const s=this.generateNavigationContent(a,e,n),l=[{path:"OEBPS/Styles/page.css",content:wm},{path:"SOURCE/scripts/transformText.js",content:ts},{path:"SOURCE/scripts/transformDom.js",content:ym},{path:"SOURCE/settings.json",content:JSON.stringify({version:"1.0.0",text_transform:"transformText.js",dom_transforms:["transformDom.js"]},null,2)},{path:"OEBPS/nav.xhtml",content:s}],c=[{id:"page-css",href:"Styles/page.css",mediaType:"text/css"},{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"]},...a.map(u=>({id:u.id,href:`Text/${u.id}.xhtml`,mediaType:"application/xhtml+xml"}))],d=a.map(u=>({idref:u.id}));return{chapters:i,assets:l,manifestUpdates:c,spineUpdates:d}}catch(t){throw new xo(`Failed to generate sample content: ${t instanceof Error?t.message:"Unknown error"}`,"SAMPLE_CONTENT_ERROR")}}generateNavigationContent(e,t,a){const n=this.i18nSystem.translate("navigation.title")||"Navigation",i=this.i18nSystem.translate("navigation.tableOfContents")||"Table of Contents",s=e.map(l=>{const c=this.i18nSystem.translate(`content.${l.id}`)||l.title;return`      <li><a href="${l.id}.xhtml">${this.escapeHtml(c)}</a></li>`}).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="${t}"${a?' dir="rtl"':""}>
<head>
  <title>${this.escapeHtml(n)}</title>
</head>
<body>
  <nav epub:type="toc" id="toc">
    <h1>${this.escapeHtml(i)}</h1>
    <ol>
${s}
    </ol>
  </nav>
</body>
</html>`}async transformContent(e,t,a){const n=Date.now(),i=[];try{const s={...t,idref:a},l=await this.transformExecutor.executeTextTransform(ts,"transformText.js",e,s,{timeoutMs:5e3}),c=Date.now()-n;return{xhtml:l,warnings:i,transformTime:c}}catch(s){const l=Date.now()-n,c=s instanceof Error?s.message:"Unknown transform error";return{xhtml:`<p>${this.escapeHtml(e)}</p>`,warnings:[c],transformTime:l}}}async previewContent(e,t){const a=await this.transformContent(e,t);return{previewHtml:a.xhtml,warnings:a.warnings}}generateNavigationFromContent(e){const a=e.filter(s=>s.linear).map(s=>{const l=this.extractTitleFromXHTML(s.xhtmlContent)||s.id;return`    <li><a href="${s.href}">${this.escapeHtml(l)}</a></li>`}).join(`
`),n=this.i18nSystem.translate("navigation.tableOfContents");return{xhtmlContent:`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
  <title>${this.escapeHtml(n)}</title>
</head>
<body>
  <nav epub:type="toc" role="navigation">
    <h1>${this.escapeHtml(n)}</h1>
    <ol>
${a}
    </ol>
  </nav>
</body>
</html>`,metadata:{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"],linear:!1}}}processUserNavigation(e){const t=this.i18nSystem.translate("navigation.tableOfContents");if(!e.trim())return{xhtmlContent:`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
  <title>${this.escapeHtml(t)}</title>
</head>
<body>
  <nav epub:type="toc" role="navigation">
    <h1>${this.escapeHtml(t)}</h1>
    <ol></ol>
  </nav>
</body>
</html>`,metadata:{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"],linear:!1}};const n=this.parseNavigationEntries(e).map(s=>`    <li><a href="${s.href}">${this.escapeHtml(s.title)}</a></li>`).join(`
`);return{xhtmlContent:`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
  <title>${this.escapeHtml(t)}</title>
</head>
<body>
  <nav epub:type="toc" role="navigation">
    <h1>${this.escapeHtml(t)}</h1>
    <ol>
${n}
    </ol>
  </nav>
</body>
</html>`,metadata:{id:"nav",href:"nav.xhtml",mediaType:"application/xhtml+xml",properties:["nav"],linear:!1}}}async generateLocalizedContent(e){if(!ca.SUPPORTED_LOCALES.has(e))throw new bm(e);const t=ca.RTL_LOCALES.has(e),a=await this.generateLocalizedMetadata(e),n=await this.generateLocalizedChapters(e);return{locale:e,metadata:a,chapters:n,isRTL:t,pageProgressionDirection:t?"rtl":"ltr"}}async generateLocalizedMetadata(e){const t=this.i18nSystem.translate("sample.title"),a=this.i18nSystem.translate("sample.author"),n=this.i18nSystem.translate("sample.description");return{title:t||"Sample Book",language:e,identifier:`urn:uuid:sample-${Date.now()}`,creator:[a||"Sample Author"],description:n||"A sample book for demonstration purposes",modifiedDate:mn()}}async generateLocalizedChapters(e){const t=this.i18nSystem.getCatalogs();return new gm(t).generateLocalizedChapters(e)}extractTitleFromXHTML(e){try{const a=new DOMParser().parseFromString(e,"text/xml"),n=["h1","h2","h3","h4","h5","h6"];for(const i of n){const s=a.querySelector(i);if(s&&s.textContent?.trim())return s.textContent.trim()}return null}catch{return null}}parseNavigationEntries(e){const t=[],a=e.split(`
`);for(const n of a){const i=n.trim();if(!i||i.startsWith("#"))continue;const s=i.match(/\[([^\]]+)\]\(([^)]+)\)/);if(s){t.push({title:s[1],href:s[2]});continue}const l=i.match(/^(.+?)\s*-\s*(.+)$/);if(l){t.push({title:l[1].trim(),href:l[2].trim()});continue}const c=i.match(/^-\s*(.+)$/);if(c){const d=c[1].trim();t.push({title:d,href:`Text/${d.toLowerCase().replace(/\s+/g,"_")}.xhtml`})}}return t}generateSampleChapterContent(e,t){return`
${`# ${this.i18nSystem.translate(`content.chapter${t}`)||`Chapter ${t}`}`}

This is sample content for demonstration purposes.

## Section 1

Here is some **bold text** and *italic text*.

## Section 2

Here is more sample content with additional paragraphs to demonstrate the transformation process.

This concludes the sample chapter.
    `.trim()}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}validateFileContent(e,t){return es.shouldValidate(t)?es.validateSyntax(e):null}}class _o{fileStorage;constructor(){this.fileStorage=Ot.getInstance()}async unpackEPUB(e,t){try{this.fileStorage.isInitialized()||await this.fileStorage.init();const a=await e.arrayBuffer(),n=new Ar(a),i=await this.validateEPUBStructure(n);if(!i.isValid)return{success:!1,error:`Invalid EPUB structure: ${i.errors.join(", ")}`};const s=await this.extractToWorkspace(n,t);return{success:s.success,workspaceId:t,extractedFiles:s.extractedFiles,totalSize:s.totalBytes,processedFiles:s.extractedFiles.length,error:s.errors.length>0?s.errors.join("; "):void 0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}async validateEPUBStructure(e){const t=[],a=[];let n,i,s;const l=e.entries.map(c=>c.fileName);if(!l.includes("mimetype"))t.push("Missing required mimetype file");else try{const c=e.entries.find(d=>d.fileName==="mimetype");if(c){const u=await(await c.extract()).text();u.trim()!=="application/epub+zip"&&t.push(`Invalid mimetype content: "${u.trim()}" (expected "application/epub+zip")`)}}catch{t.push("Failed to read mimetype file content")}if(!l.includes("META-INF/container.xml"))t.push("Missing required META-INF/container.xml file");else try{const c=e.entries.find(d=>d.fileName==="META-INF/container.xml");if(c){const u=await(await c.extract()).text(),p=xt.validateXML(u);if(!p.isValid)t.push(`Invalid XML in container.xml: ${p.error}`);else{const h=xt.parseContainerXml(u);if(h.error)t.push(h.error);else if(h.rootfilePath){i=h.rootfilePath;const v=i.split("/");v.length>1&&(s=v.slice(0,-1).join("/")),l.includes(i)||t.push(`Rootfile specified in container.xml not found: ${i}`)}}}}catch{t.push("Failed to parse META-INF/container.xml")}e.entries.length===0&&t.push("Empty ZIP file");for(const c of l)c.includes("..")&&t.push(`Invalid file path with directory traversal: ${c}`),c.startsWith("/")&&a.push(`Absolute path found: ${c}`);if(i&&l.includes(i))try{const c=e.entries.find(d=>d.fileName===i);if(c){const u=await(await c.extract()).text(),p=xt.validateXML(u);p.isValid?(n=xt.detectEPUBVersion(u),n||a.push("Could not detect EPUB version from OPF file")):t.push(`Invalid XML in OPF file (${i}): ${p.error}`)}}catch{t.push(`Failed to read or parse OPF file: ${i}`)}return s&&l.filter(d=>d.startsWith(s+"/")).length===0&&a.push(`No files found in package directory: ${s}/`),{isValid:t.length===0,errors:t,warnings:a,detectedVersion:n,rootfilePath:i,packageDirectory:s}}async extractToWorkspace(e,t){const a=[],n=[],i=[];let s=0;try{await this.fileStorage.createWorkspace(t)}catch(d){if(d instanceof Error&&!d.message.includes("already exists"))return i.push(`Failed to create workspace: ${d.message}`),{success:!1,extractedFiles:a,totalBytes:s,skippedFiles:n,errors:i}}const l=new mo(this.fileStorage);let c=null;for(const d of e.entries)try{if(d.fileName.endsWith("/"))continue;if(d.fileName==="SOURCE.zip"||d.fileName.endsWith("/SOURCE.zip")){c=d;continue}const p=await(await d.extract()).arrayBuffer();await this.fileStorage.writeFile(t,d.fileName,p),a.push(d.fileName),s+=p.byteLength}catch(u){const p=u instanceof Error?u.message:"Unknown error";i.push(`Failed to extract ${d.fileName}: ${p}`),n.push(d.fileName)}if(c)try{const d=await c.extract();await l.extractSourceZip(t,d),a.push("SOURCE.zip (extracted to SOURCE/ directory)"),s+=d.size}catch(d){const u=d instanceof Error?d.message:"Unknown error";i.push(`Failed to extract SOURCE.zip: ${u}`),n.push(c.fileName)}return{success:i.length===0,extractedFiles:a,totalBytes:s,skippedFiles:n,errors:i}}async analyzeEPUB(e){try{const t=await e.arrayBuffer(),a=new Ar(t),n=await this.validateEPUBStructure(a),i=a.entries.map(l=>l.fileName).filter(l=>!l.endsWith("/")).sort(),s=a.entries.reduce((l,c)=>l+c.uncompressedSize,0);return{isValid:n.isValid,fileCount:i.length,totalSize:s,validation:n,fileList:i}}catch(t){return{isValid:!1,fileCount:0,totalSize:0,validation:{isValid:!1,errors:[t instanceof Error?t.message:"Failed to analyze EPUB"],warnings:[]},fileList:[]}}}destroy(){this.fileStorage.destroy()}}class qn extends Error{constructor(e,t){super(e),this.code=t,this.name="EPUBProcessorError"}}class xm{constructor(e){this.fileStorage=e,this.epubUnpacker=new _o,this.epubPackager=new Si}epubUnpacker;epubPackager;async unpackEPUB(e,t){try{return this.fileStorage.isInitialized()||await this.fileStorage.init(),await this.epubUnpacker.unpackEPUB(e,t)}catch(a){throw new qn(`Failed to unpack EPUB: ${a instanceof Error?a.message:"Unknown error"}`,"EPUB_UNPACK_ERROR")}}async validateEPUBStructure(e){try{const t=new Ar(e);return await this.epubUnpacker.validateEPUBStructure(t)}catch(t){return{isValid:!1,errors:[`Validation failed: ${t instanceof Error?t.message:"Unknown error"}`],warnings:[]}}}async packageEPUB(e,t){try{return this.fileStorage.isInitialized()||await this.fileStorage.init(),await this.epubPackager.packageEPUB(e,t)}catch(a){throw new qn(`Failed to package EPUB: ${a instanceof Error?a.message:"Unknown error"}`,"EPUB_PACKAGE_ERROR")}}parseOPFDocument(e){try{return xt.parseOPFDocument(e)}catch(t){throw new qn(`Failed to parse OPF document: ${t instanceof Error?t.message:"Unknown error"}`,"OPF_PARSE_ERROR")}}generateOPFXML(e){try{return xt.generateOPFXML(e)}catch(t){throw new qn(`Failed to generate OPF XML: ${t instanceof Error?t.message:"Unknown error"}`,"OPF_GENERATE_ERROR")}}validateXML(e){return xt.validateXML(e)}parseOPFMetadata(e){try{if(!globalThis.DOMParser)throw new Error("DOMParser not available");const a=new DOMParser().parseFromString(e,"application/xml");if(a.querySelector("parsererror"))throw new Error("Invalid OPF XML");return xt.parseOPFMetadata(a)}catch(t){throw new qn(`Failed to parse OPF metadata: ${t instanceof Error?t.message:"Unknown error"}`,"OPF_METADATA_PARSE_ERROR")}}parseContainerXML(e){return xt.parseContainerXml(e)}generateContainerXML(e="OEBPS/content.opf"){return xt.generateContainerXML(e)}detectEPUBVersion(e){return xt.detectEPUBVersion(e)}validateManifestSpineConsistency(e,t){return xt.validateManifestSpineConsistency(e,t)}parseRootfilePath(e){try{return xt.parseRootfilePath(e)}catch(t){throw new qn(`Failed to parse rootfile path: ${t instanceof Error?t.message:"Unknown error"}`,"ROOTFILE_PARSE_ERROR")}}}const xn={WORKSPACE_ID:"editme_app_workspace_id",SPINE_ITEM_ID:"editme_app_spine_item_id"};class _m{constructor(e,t,a,n,i,s,l,c=!1){this.skipReactiveEffects=c,this.fileStorage=e,this.transformEngine=l,this.extensionManager=n,this.settingsService=new Qn(e,n,i,s),this.epubProcessor=new xm(e),this.workspaceService=new bo(e),this.contentService=new ca(t,a),this.loadGlobalSettings(),c||this.setupReactiveEffects()}fileStorage;transformEngine;extensionManager;workspaceService;contentService;settingsService;epubProcessor;#e=Pe(null);get workspace(){return o(this.#e)}set workspace(e){w(this.#e,e,!0)}#t=Pe(null);get selectedChapterId(){return o(this.#t)}set selectedChapterId(e){w(this.#t,e,!0)}#r=Pe(null);get selectedManifestItemId(){return o(this.#r)}set selectedManifestItemId(e){w(this.#r,e,!0)}#a=Pe(!1);get initialized(){return o(this.#a)}set initialized(e){w(this.#a,e,!0)}#n=Pe(!1);get isLoading(){return o(this.#n)}set isLoading(e){w(this.#n,e,!0)}#s=Pe(null);get errorMessage(){return o(this.#s)}set errorMessage(e){w(this.#s,e,!0)}#i=Pe(null);get globalSettings(){return o(this.#i)}set globalSettings(e){w(this.#i,e,!0)}#o=Pe(null);get workspaceSettings(){return o(this.#o)}set workspaceSettings(e){w(this.#o,e,!0)}#l=Pe(null);get epubSettings(){return o(this.#l)}set epubSettings(e){w(this.#l,e,!0)}get hasWorkspace(){return this.workspace!==null}get isWorkspaceReady(){return this.initialized&&this.workspace!==null}get currentWorkspaceId(){return this.workspace?.id||null}get workspaceInfo(){return this.workspace?{id:this.workspace.id,title:this.workspace.opf.metadata.title,language:this.workspace.opf.metadata.language,lastModified:new Date,fileCount:this.workspace.opf.manifest.length,totalSize:0,author:this.workspace.opf.metadata.creator?.[0]||void 0,hasError:!1,epubVersion:"3.0"}:null}get selectedChapter(){if(!this.workspace||!this.selectedChapterId)return null;const e=this.workspace.opf.manifest.find(t=>t.id===this.selectedChapterId);return e?{id:e.id,href:e.href,xhtmlContent:"",linear:!0,mediaType:e.mediaType||"application/xhtml+xml"}:null}get navigationItems(){return this.workspace?this.workspace.opf.spine.map((e,t)=>{const a=this.workspace.opf.manifest.find(n=>n.id===e.idref);return{id:e.idref,title:a?.id||`Chapter ${t+1}`,href:a?.href||"",order:t}}):[]}get availableChapters(){return this.workspace?this.workspace.opf.manifest.filter(e=>e.mediaType==="application/xhtml+xml").map(e=>({id:e.id,title:e.id,href:e.href})):[]}get currentTheme(){return this.globalSettings?.theme||"system"}get currentLocale(){return this.globalSettings?.locale||"en"}get editorFontSize(){return this.globalSettings?.editor_font_size||14}get isDraftMode(){return(this.workspaceSettings?.draft_id||0)>0}get currentDraftId(){return this.workspaceSettings?.draft_id||0}get isAdvancedMode(){return this.workspaceSettings?.editor?.advanced_mode??!1}getTransformEngine(){return this.transformEngine}getContentService(){return this.contentService}getSettingsService(){return this.settingsService}getExtensionManager(){return this.extensionManager}setupReactiveEffects(){vl(()=>{Et(()=>{this.workspace?.id?(this.loadWorkspaceSettings(this.workspace.id),this.loadEPUBSettings(this.workspace.id)):(this.workspaceSettings=null,this.epubSettings=null)}),Et(()=>{this.errorMessage&&setTimeout(()=>{this.errorMessage=null},5e3)})})}async initialize(){try{this.isLoading=!0,this.errorMessage=null,this.fileStorage.isInitialized()||await this.fileStorage.init(),await this.restoreWorkspaceState(),this.initialized=!0}catch(e){throw this.errorMessage=`Failed to initialize: ${e instanceof Error?e.message:"Unknown error"}`,e}finally{this.isLoading=!1}}async listWorkspaces(){try{return this.isLoading=!0,this.errorMessage=null,await this.workspaceService.listWorkspaces()}catch(e){throw this.errorMessage=`Failed to list workspaces: ${e instanceof Error?e.message:"Unknown error"}`,e}finally{this.isLoading=!1}}async createWorkspace(e,t="en"){try{this.isLoading=!0,this.errorMessage=null;const a=await this.workspaceService.createWorkspace({title:e,language:t,identifier:`urn:uuid:${crypto.randomUUID()}`}),n=await this.contentService.generateSampleContentData(t),i=await this.workspaceService.populateWithContent(a.id,n);return this.workspace=i,a.id}catch(a){throw this.errorMessage=`Failed to create workspace: ${a instanceof Error?a.message:"Unknown error"}`,a}finally{this.isLoading=!1}}async loadWorkspace(e){try{this.isLoading=!0,this.errorMessage=null,this.workspace=await this.workspaceService.loadWorkspace(e),this.selectedChapterId=null,this.selectedManifestItemId=null,this.persistWorkspaceId(e)}catch(t){throw this.errorMessage=`Failed to load workspace: ${t instanceof Error?t.message:"Unknown error"}`,t}finally{this.isLoading=!1}}async saveWorkspace(){if(!this.workspace)throw new Error("No workspace to save");try{this.isLoading=!0,this.errorMessage=null,this.workspace=await this.workspaceService.saveWorkspace(this.workspace)}catch(e){throw this.errorMessage=`Failed to save workspace: ${e instanceof Error?e.message:"Unknown error"}`,e}finally{this.isLoading=!1}}async deleteWorkspace(e){try{this.isLoading=!0,this.errorMessage=null,await this.workspaceService.deleteWorkspace(e),this.workspace?.id===e&&(this.workspace=null,this.selectedChapterId=null,this.selectedManifestItemId=null,this.clearPersistedState())}catch(t){throw this.errorMessage=`Failed to delete workspace: ${t instanceof Error?t.message:"Unknown error"}`,t}finally{this.isLoading=!1}}selectChapter(e){this.selectedChapterId=e,this.persistSpineItemId(e)}selectManifestItem(e){this.selectedManifestItemId=e}async generateSampleContent(e="en"){if(!this.workspace)throw new Error("No workspace loaded");try{this.isLoading=!0,this.errorMessage=null;const t=await this.contentService.generateLocalizedContent(e);this.workspace.opf.metadata={...this.workspace.opf.metadata,...t.metadata},t.chapters.forEach((a,n)=>{const i={id:`chapter${n+1}`,href:`Text/${a.title}.xhtml`,mediaType:"application/xhtml+xml"};this.workspace.opf.manifest.push(i),this.workspace.opf.spine.push({idref:i.id,linear:!0})}),await this.saveWorkspace()}catch(t){throw this.errorMessage=`Failed to generate sample content: ${t instanceof Error?t.message:"Unknown error"}`,t}finally{this.isLoading=!1}}loadGlobalSettings(){try{this.globalSettings=this.settingsService.loadGlobalSettings()}catch(e){console.warn("Failed to load global settings:",e),this.globalSettings=this.settingsService.getDefaultGlobalSettings()}}updateGlobalSettings(e){if(!this.globalSettings)return;const t={...this.globalSettings,...e};try{this.settingsService.saveGlobalSettings(t),this.globalSettings=t}catch(a){this.errorMessage=`Failed to save global settings: ${a instanceof Error?a.message:"Unknown error"}`}}async loadWorkspaceSettings(e){try{this.workspaceSettings=await this.settingsService.loadWorkspaceSettings(e)}catch(t){console.warn("Failed to load workspace settings:",t),this.workspaceSettings=this.settingsService.getDefaultWorkspaceSettings()}}async updateWorkspaceSettings(e){if(!this.workspace||!this.workspaceSettings)return;const t={...this.workspaceSettings,...e};try{await this.settingsService.saveWorkspaceSettings(this.workspace.id,t),this.workspaceSettings=t}catch(a){this.errorMessage=`Failed to save workspace settings: ${a instanceof Error?a.message:"Unknown error"}`}}async loadEPUBSettings(e){try{this.epubSettings=await this.settingsService.loadEPUBSettings(e)}catch(t){console.warn("Failed to load EPUB settings:",t),this.epubSettings=this.settingsService.getDefaultEPUBSettings()}}async updateEPUBSettings(e){if(!this.workspace||!this.epubSettings)return;const t={...this.epubSettings,...e};try{await this.settingsService.saveEPUBSettings(this.workspace.id,t),this.epubSettings=t}catch(a){this.errorMessage=`Failed to save EPUB settings: ${a instanceof Error?a.message:"Unknown error"}`}}async incrementDraftId(){if(this.workspace)try{const e=await this.settingsService.incrementDraftId(this.workspace.id);this.workspaceSettings&&(this.workspaceSettings.draft_id=e);const t=this.settingsService.extractDraftInfo(this.workspace.opf.metadata.title).baseTitle;this.workspace.opf.metadata.title=this.settingsService.generateDraftTitle(t,e)}catch(e){this.errorMessage=`Failed to increment draft ID: ${e instanceof Error?e.message:"Unknown error"}`}}async packageEPUB(){if(!this.workspace)throw new Error("No workspace to package");try{this.isLoading=!0,this.errorMessage=null;const e=await this.epubProcessor.packageEPUB(this.workspace.id,{compressionLevel:"balanced",validateStructure:!0,progressCallback:t=>{console.log("Package progress:",t)}});if(!e.success)throw new Error(e.error||"Package failed");return e.blob||null}catch(e){throw this.errorMessage=`Failed to package EPUB: ${e instanceof Error?e.message:"Unknown error"}`,e}finally{this.isLoading=!1}}async unpackEPUB(e){try{this.isLoading=!0,this.errorMessage=null;const t=await this.epubProcessor.unpackEPUB(e,`workspace-${Date.now()}`);if(!t.success)throw new Error(t.error||"Unpack failed");const a=t.workspaceId;return await this.loadWorkspace(a),a}catch(t){throw this.errorMessage=`Failed to unpack EPUB: ${t instanceof Error?t.message:"Unknown error"}`,t}finally{this.isLoading=!1}}async restoreWorkspaceState(){try{const e=localStorage.getItem(xn.WORKSPACE_ID);if(e){await this.loadWorkspace(e);const t=localStorage.getItem(xn.SPINE_ITEM_ID);t&&(this.selectedChapterId=t)}}catch(e){console.warn("Failed to restore workspace state:",e),this.clearPersistedState()}}persistWorkspaceId(e){try{e?localStorage.setItem(xn.WORKSPACE_ID,e):localStorage.removeItem(xn.WORKSPACE_ID)}catch(t){console.warn("Failed to persist workspace ID:",t)}}persistSpineItemId(e){try{e?localStorage.setItem(xn.SPINE_ITEM_ID,e):localStorage.removeItem(xn.SPINE_ITEM_ID)}catch(t){console.warn("Failed to persist spine item ID:",t)}}clearPersistedState(){try{localStorage.removeItem(xn.WORKSPACE_ID),localStorage.removeItem(xn.SPINE_ITEM_ID)}catch(e){console.warn("Failed to clear persisted state:",e)}}cleanup(){this.workspace=null,this.selectedChapterId=null,this.selectedManifestItemId=null,this.initialized=!1,this.isLoading=!1,this.errorMessage=null}}class Na extends Error{stage;scriptName;line;column;hasCustomStack;constructor(e){super(e.message),this.name="TransformError",this.stage=e.stage,this.scriptName=e.scriptName,this.line=e.line,this.column=e.column,this.hasCustomStack=!!e.stack,e.stack&&(this.stack=e.stack)}toUserMessage(){let a=`${{loading:"Script Loading",text:"Text Transform",dom:"DOM Transform",template:"Template Generation"}[this.stage]} Error: ${this.message}`;return this.scriptName&&(a+=`
Script: ${this.scriptName}`),this.line!==void 0&&(a+=`
Line ${this.line}`),this.column!==void 0&&(a+=`
Column ${this.column}`),a}getErrorDetails(){return{stage:this.stage,message:this.message,scriptName:this.scriptName,line:this.line,column:this.column,stack:this.hasCustomStack?this.stack:void 0,userMessage:this.toUserMessage()}}}class da{static DEFAULT_TIMEOUT_MS=2e3;async executeTextTransform(e,t,a,n,i={}){const s=i.timeoutMs||da.DEFAULT_TIMEOUT_MS;return new Promise((l,c)=>{const d=setTimeout(()=>{c(new Na({stage:"text",message:`Transform execution timed out after ${s}ms`,scriptName:t}))},s);try{const u=this.createSandboxedGlobals(i.globals),p=this.executeFunctionInSandbox(e,"transformText",[a,n.idref],u,t);clearTimeout(d),l(typeof p=="string"?p:String(p))}catch(u){clearTimeout(d),c(this.createTransformError(u,"text",t))}})}async executeDOMTransform(e,t,a,n,i={}){const s=i.timeoutMs||da.DEFAULT_TIMEOUT_MS;return new Promise((l,c)=>{const d=setTimeout(()=>{c(new Na({stage:"dom",message:`Transform execution timed out after ${s}ms`,scriptName:t}))},s);try{const u=a.cloneNode(!0),p=this.createSandboxedGlobals(i.globals),h=this.executeFunctionInSandbox(e,"transformDOM",[u,n.idref],p,t);clearTimeout(d),h instanceof Document?l(h):l(u)}catch(u){clearTimeout(d),c(this.createTransformError(u,"dom",t))}})}createSandboxedGlobals(e={}){const t={console,JSON,Math,Date,RegExp,String,Number,Boolean,Array,Object,document:typeof document<"u"?document:void 0,...e};return["eval","Function","setTimeout","setInterval","clearTimeout","clearInterval","setImmediate","clearImmediate","XMLHttpRequest","fetch","import","require","process","global","globalThis"].forEach(n=>{delete t[n]}),t}executeFunctionInSandbox(e,t,a,n,i){const s=Object.keys(n),l=Object.values(n),c=`(function(${s.join(", ")}) {
        ${e}

        if (typeof ${t} !== 'function') {
          throw new Error('Function ${t} is not defined or not a function');
        }

        return ${t};
      })`;return new Function("return "+c)()(...l)(...a)}createTransformError(e,t,a){const n=e instanceof Error?e.message:String(e),i=e instanceof Error?e.stack:void 0;let s,l;if(i){const c=i.match(/at.*:(\d+):(\d+)/);c&&(s=parseInt(c[1],10),l=parseInt(c[2],10))}return new Na({stage:t,message:n,scriptName:a,line:s,column:l,stack:i})}}const Sm=`/**
 * Transform Execution Environment Styles
 * 
 * Minimal styling for the iframe transform execution environment.
 * Focus on functionality over appearance since this is primarily
 * for sandboxed script execution.
 */

/* Reset and base styles */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 
               'Helvetica Neue', Arial, sans-serif;
  font-size: 14px;
  line-height: 1.5;
  color: #333;
  background: #fff;
}

/* Status display */
.transform-status {
  padding: 12px 16px;
  margin-bottom: 16px;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  display: none;
  border: 1px solid transparent;
}

.transform-status.visible {
  display: block;
}

/* Status variants */
.transform-status.info {
  background: #e3f2fd;
  color: #0d47a1;
  border-color: #bbdefb;
}

.transform-status.success {
  background: #e8f5e8;
  color: #2e7d32;
  border-color: #c8e6c9;
}

.transform-status.error {
  background: #ffebee;
  color: #c62828;
  border-color: #ffcdd2;
}

.transform-status.warning {
  background: #fff8e1;
  color: #f57f17;
  border-color: #ffecb3;
}

/* Debug information (hidden by default) */
.debug-info {
  margin-top: 20px;
  padding: 12px;
  background: #f5f5f5;
  border-radius: 4px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', monospace;
  font-size: 12px;
  color: #666;
  display: none;
}

.debug-info.visible {
  display: block;
}

/* Error details */
.error-details {
  margin-top: 8px;
  padding: 8px;
  background: rgba(255, 255, 255, 0.5);
  border-radius: 3px;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', monospace;
  font-size: 12px;
  white-space: pre-wrap;
  word-break: break-word;
}

/* Minimal responsive adjustments */
@media (max-width: 480px) {
  body {
    padding: 12px;
  }
  
  .transform-status {
    padding: 8px 12px;
    margin-bottom: 12px;
    font-size: 13px;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .transform-status.info {
    background: #000;
    color: #fff;
    border-color: #fff;
  }
  
  .transform-status.success {
    background: #006600;
    color: #fff;
    border-color: #fff;
  }
  
  .transform-status.error {
    background: #cc0000;
    color: #fff;
    border-color: #fff;
  }
  
  .transform-status.warning {
    background: #cc6600;
    color: #fff;
    border-color: #fff;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}`,Em=`/**
 * Transform Script Execution Engine
 *
 * Provides sandboxed execution of text and DOM transform scripts
 * with timeout protection and comprehensive error handling.
 *
 * This script runs inside the iframe and communicates with the parent
 * window via postMessage for security and isolation.
 */

/**
 * Transform execution environment with sandboxing and error handling
 */
class TransformExecutionEngine {
  constructor() {
    this.textTransformScript = '';
    this.domTransformScripts = [];
    this.loadedExtensionScripts = [];
    this.debugMode = false;
    this.messageHandlers = new Map();

    this.init();
  }

  /**
   * Initialize the execution environment
   */
  init() {
    this.setupMessageHandling();
    this.setupErrorHandling();
    this.signalReady();
  }

  /**
   * Set up message handling from parent window
   */
  setupMessageHandling() {
    window.addEventListener('message', event => {
      this.handleParentMessage(event.data);
    });

    // Register message handlers
    this.messageHandlers.set('SET_TRANSFORM_SCRIPTS', this.setTransformScripts.bind(this));
    this.messageHandlers.set('SET_EXTENSION_SCRIPTS', this.setExtensionScripts.bind(this));
    this.messageHandlers.set('EXECUTE_TRANSFORM', this.executeTransform.bind(this));
    this.messageHandlers.set('SET_DEBUG_MODE', this.setDebugMode.bind(this));
    this.messageHandlers.set('PING', this.handlePing.bind(this));
  }

  /**
   * Set up global error handling
   */
  setupErrorHandling() {
    window.addEventListener('error', event => {
      console.error('Global error in transform iframe:', event.error);
      this.notifyParent('GLOBAL_ERROR', {
        message: event.error?.message || 'Unknown global error',
        filename: event.filename,
        lineno: event.lineno,
        colno: event.colno,
        stack: event.error?.stack,
      });
    });

    window.addEventListener('unhandledrejection', event => {
      console.error('Unhandled promise rejection in transform iframe:', event.reason);
      this.notifyParent('UNHANDLED_REJECTION', {
        message: event.reason?.message || 'Unhandled promise rejection',
        stack: event.reason?.stack,
      });
    });
  }

  /**
   * Signal ready state to parent window
   */
  signalReady() {
    this.updateStatus('Transform execution environment ready', 'success');
    this.notifyParent('IFRAME_READY');

    if (this.debugMode) {
      this.debugLog('TransformExecutionEngine initialized');
    }
  }

  /**
   * Handle incoming messages from parent window
   */
  handleParentMessage(message) {
    if (!message || typeof message !== 'object') {
      return;
    }

    const { type, payload, messageId } = message;

    if (this.debugMode) {
      this.debugLog(\`Received message: \${type}\`, payload);
    }

    try {
      const handler = this.messageHandlers.get(type);
      if (handler) {
        handler(payload, messageId);
      } else {
        console.warn('Unknown message type received:', type);
        this.respondToParent(messageId, {
          success: false,
          error: { stage: 'communication', message: \`Unknown message type: \${type}\` },
        });
      }
    } catch (error) {
      console.error('Error handling message:', error);
      this.respondToParent(messageId, {
        success: false,
        error: {
          stage: 'communication',
          message: error instanceof Error ? error.message : String(error),
          stack: error instanceof Error ? error.stack : undefined,
        },
      });
    }
  }

  /**
   * Set transform scripts content
   */
  setTransformScripts(scripts, messageId) {
    try {
      this.textTransformScript = scripts.textTransform || '';
      this.domTransformScripts = scripts.domTransforms || [];

      const textScriptLength = this.textTransformScript.length;
      const domScriptCount = this.domTransformScripts.length;

      this.updateStatus(
        \`Loaded text transform (\${textScriptLength} chars) and \${domScriptCount} DOM transforms\`,
        'success'
      );

      if (this.debugMode) {
        this.debugLog('Transform scripts updated', {
          textTransform: textScriptLength > 0,
          domTransformCount: domScriptCount,
        });
      }

      this.respondToParent(messageId, { success: true });
    } catch (error) {
      this.respondToParent(messageId, {
        success: false,
        error: {
          stage: 'script-loading',
          message: error instanceof Error ? error.message : String(error),
        },
      });
    }
  }

  /**
   * Load extension scripts dynamically into iframe context
   */
  async setExtensionScripts(scripts, messageId) {
    try {
      // Clear any previously loaded extension scripts
      this.clearLoadedExtensions();

      const scriptCount = scripts.length;
      this.updateStatus(\`Loading \${scriptCount} extension scripts...\`, 'info');

      // Load each script sequentially to avoid race conditions
      for (const script of scripts) {
        await this.loadExtensionScript(script.name, script.blobUrl);
      }

      this.updateStatus(\`Successfully loaded \${scriptCount} extension libraries\`, 'success');

      if (this.debugMode) {
        this.debugLog('Extension scripts loaded', {
          scriptCount,
          scripts: scripts.map(s => s.name),
        });
      }

      this.respondToParent(messageId, { success: true });
    } catch (error) {
      this.updateStatus(\`Failed to load extension scripts: \${error.message}\`, 'error');
      this.respondToParent(messageId, {
        success: false,
        error: {
          stage: 'extension-loading',
          message: error instanceof Error ? error.message : String(error),
        },
      });
    }
  }

  /**
   * Load a single extension script
   */
  async loadExtensionScript(name, blobUrl) {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = blobUrl;

      // Set ID for easy identification in browser inspector
      // Convert name to valid HTML ID (replace invalid characters)
      const scriptId = \`extension-\${name.replace(/[^a-zA-Z0-9-_]/g, '-')}\`;
      script.id = scriptId;

      script.onload = () => {
        if (this.debugMode) {
          this.debugLog(\`Loaded extension script: \${name} (id: \${scriptId})\`);
        }
        // Clean up blob URL after loading
        URL.revokeObjectURL(blobUrl);
        resolve();
      };
      script.onerror = error => {
        URL.revokeObjectURL(blobUrl);
        reject(new Error(\`Failed to load extension script \${name}: \${error}\`));
      };

      // Add script to head to execute
      document.head.appendChild(script);

      // Store reference for cleanup
      if (!this.loadedExtensionScripts) {
        this.loadedExtensionScripts = [];
      }
      this.loadedExtensionScripts.push(script);
    });
  }

  /**
   * Clear previously loaded extension scripts
   */
  clearLoadedExtensions() {
    if (this.loadedExtensionScripts) {
      for (const script of this.loadedExtensionScripts) {
        if (script.parentNode) {
          script.parentNode.removeChild(script);
        }
      }
      this.loadedExtensionScripts = [];
    }
  }

  /**
   * Execute the complete transform pipeline
   */
  async executeTransform(request, messageId) {
    const { plainText, timeout = 3000, idref } = request;
    const startTime = performance.now();

    try {
      this.updateStatus('Executing transform pipeline...', 'info');

      if (this.debugMode) {
        this.debugLog('Starting transform execution', {
          plainTextLength: plainText.length,
          timeout,
          hasTextTransform: this.textTransformScript.length > 0,
          domTransformCount: this.domTransformScripts.length,
        });
      }

      // Step 1: Execute text transform
      let html = plainText;
      if (this.textTransformScript.trim()) {
        html = await this.executeTextTransformWithTimeout(plainText, timeout, idref);

        if (this.debugMode) {
          this.debugLog('Text transform completed', {
            inputLength: plainText.length,
            outputLength: html.length,
          });
        }
      }

      // Step 2: Execute DOM transforms in sequence
      if (this.domTransformScripts.length > 0) {
        html = await this.executeDOMTransformsWithTimeout(html, timeout, idref);

        if (this.debugMode) {
          this.debugLog('DOM transforms completed', {
            transformCount: this.domTransformScripts.length,
            finalLength: html.length,
          });
        }
      }

      const executionTime = performance.now() - startTime;
      this.updateStatus(\`Transform completed in \${executionTime.toFixed(2)}ms\`, 'success');

      this.respondToParent(messageId, {
        success: true,
        html,
        executionTime: Math.round(executionTime),
      });
    } catch (error) {
      const executionTime = performance.now() - startTime;
      this.updateStatus(
        \`Transform failed: \${error instanceof Error ? error.message : String(error)}\`,
        'error'
      );

      if (this.debugMode) {
        console.error('Transform execution failed', {
          error: error instanceof Error ? error.message : String(error),
          stage: error && typeof error === 'object' && 'stage' in error ? error.stage : 'unknown',
          executionTime: Math.round(executionTime),
        });
      }

      this.respondToParent(messageId, {
        success: false,
        error,
        executionTime: Math.round(executionTime),
      });
    }
  }

  /**
   * Execute text transform with timeout protection
   * @param {any} plainText
   * @param {any} timeout
   * @param {any} idref
   */
  executeTextTransformWithTimeout(plainText, timeout, idref) {
    return new Promise((resolve, reject) => {
      const timeoutId = setTimeout(() => {
        const error = new Error(\`Text transform execution timed out after \${timeout}ms\`);
        error.stage = 'text-timeout';
        reject(error);
      }, timeout);

      try {
        const result = this.executeTextTransformSync(plainText, idref);
        clearTimeout(timeoutId);
        resolve(result);
      } catch (error) {
        clearTimeout(timeoutId);
        if (error instanceof Error) error.stage = 'text';
        reject(this.enhanceError(error));
      }
    });
  }

  /**
   * Execute text transform synchronously
   * @param {any} plainText
   * @param {any} idref
   */
  executeTextTransformSync(plainText, idref) {
    // Create sandboxed execution environment
    const globals = this.createSafeExecutionEnvironment();
    const globalNames = Object.keys(globals);
    const globalValues = Object.values(globals);

    // Wrap script in function with restricted globals
    const wrappedScript = \`(function(\${globalNames.join(', ')}) {
      \${this.textTransformScript}

      if (typeof transformText !== 'function') {
        throw new Error('transformText function is not defined in script');
      }

      return transformText;
    })\`;

    // Execute wrapped script to get transform function
    const scriptFunction = new Function('return ' + wrappedScript)();
    const transformFunction = scriptFunction(...globalValues);

    // Execute transform with input text and idref
    const result = transformFunction(plainText, idref);

    // Ensure result is a string
    return typeof result === 'string' ? result : String(result);
  }

  /**
   * Execute DOM transforms with timeout protection
   * @param {any} html
   * @param {any} timeout
   * @param {any} idref
   */
  executeDOMTransformsWithTimeout(html, timeout, idref) {
    return new Promise((resolve, reject) => {
      const timeoutId = setTimeout(() => {
        const error = new Error(\`DOM transform execution timed out after \${timeout}ms\`);
        error.stage = 'dom-timeout';
        reject(error);
      }, timeout);

      try {
        const result = this.executeDOMTransformsSync(html, idref);
        clearTimeout(timeoutId);
        resolve(result);
      } catch (error) {
        clearTimeout(timeoutId);
        if (error instanceof Error) error.stage = 'dom';
        reject(this.enhanceError(error));
      }
    });
  }

  /**
   * Execute DOM transforms synchronously with direct live DOM when layout is needed
   * @param {any} html
   * @param {any} idref
   */
  executeDOMTransformsSync(html, idref) {
    // Check if any transform scripts need layout calculations
    const needsLayout = this.checkIfLayoutNeeded();

    if (this.debugMode) {
      this.debugLog(\`DOM transform mode decision: needsLayout=\${needsLayout}\`, {
        scriptCount: this.domTransformScripts.length,
        scriptsWithLayout: this.domTransformScripts.filter(script =>
          script.includes('getElementLayout')
        ).length,
      });
    }

    if (needsLayout) {
      // Use live DOM approach for layout-dependent transforms
      return this.executeDOMTransformsWithLiveDOM(html, idref);
    } else {
      // Use standard parsed document approach for simple transforms
      return this.executeDOMTransformsWithParsedDOM(html, idref);
    }
  }

  /**
   * Check if transform scripts need layout calculations
   */
  checkIfLayoutNeeded() {
    // Simple heuristic: check if any scripts mention getElementLayout
    return this.domTransformScripts.some(script => script.includes('getElementLayout'));
  }

  /**
   * Execute DOM transforms using live DOM for layout calculations
   */
  executeDOMTransformsWithLiveDOM(html, idref) {
    const tempContainer = this.createLiveDOMContainer();

    try {
      // Put content directly in live DOM
      tempContainer.innerHTML = html;

      if (this.debugMode) {
        this.debugLog('Live DOM container created:', {
          innerHTML: tempContainer.innerHTML.substring(0, 200) + '...',
          elementCount: tempContainer.querySelectorAll('*').length,
          containerWidth: tempContainer.offsetWidth,
          containerHeight: tempContainer.offsetHeight,
          firstElementInfo: tempContainer.firstElementChild
            ? {
                tagName: tempContainer.firstElementChild.tagName,
                offsetWidth: tempContainer.firstElementChild.offsetWidth,
                offsetHeight: tempContainer.firstElementChild.offsetHeight,
                textContent: tempContainer.firstElementChild.textContent?.substring(0, 50),
              }
            : 'no first element',
        });
      }

      // Execute transforms on live DOM elements
      for (let i = 0; i < this.domTransformScripts.length; i++) {
        try {
          // Pass the live container as a document-like object
          const mockDocument = this.createMockDocument(tempContainer);
          this.executeSingleDOMTransform(mockDocument, this.domTransformScripts[i], i, idref);
        } catch (error) {
          if (error instanceof Error) error.stage = \`dom-transform-\${i}\`;
          throw error;
        }
      }

      // Return the transformed HTML from live DOM (including body element and attributes)
      // Create a body element with the container's attributes and content
      const serializer = new XMLSerializer();
      const bodyElement = document.createElement('body');
      
      // Copy all attributes from container to body
      for (let i = 0; i < tempContainer.attributes.length; i++) {
        const attr = tempContainer.attributes[i];
        bodyElement.setAttribute(attr.name, attr.value);
      }
      bodyElement.innerHTML = tempContainer.innerHTML;
      
      return serializer.serializeToString(bodyElement);
    } finally {
      this.cleanupTempAttachment(tempContainer);
    }
  }

  /**
   * Execute DOM transforms using parsed DOM (traditional approach)
   */
  executeDOMTransformsWithParsedDOM(html, idref) {
    // Parse HTML to DOM document
    const parser = new DOMParser();
    let document = parser.parseFromString(
      \`<!DOCTYPE html><html><head></head><body>\${html}</body></html>\`,
      'text/html'
    );

    // Execute each DOM transform in sequence
    for (let i = 0; i < this.domTransformScripts.length; i++) {
      try {
        document = this.executeSingleDOMTransform(document, this.domTransformScripts[i], i, idref);
      } catch (error) {
        if (error instanceof Error) error.stage = \`dom-transform-\${i}\`;
        throw error;
      }
    }

    // Return transformed HTML content with XHTML compliance (including body element and attributes)
    const serializer = new XMLSerializer();
    const fullBodySerialization = serializer.serializeToString(document.body);
    return fullBodySerialization;
  }

  /**
   * Create a live DOM container for layout calculations
   */
  createLiveDOMContainer() {
    const container = document.createElement('div');
    container.id = 'transform-live-container';

    // Set styles via JavaScript properties instead of CSS strings
    // This works better in iframe environments
    const style = container.style;
    style.position = 'fixed';
    style.top = '0px';
    style.left = '0px';
    style.width = '800px';
    style.minHeight = '600px';
    style.visibility = 'hidden';
    style.pointerEvents = 'none';
    style.fontFamily = 'Georgia, serif';
    style.fontSize = '16px';
    style.lineHeight = '1.6';
    style.color = 'black';
    style.backgroundColor = 'white';
    style.display = 'block';
    style.boxSizing = 'border-box';
    style.padding = '20px';

    document.body.appendChild(container);

    // Force layout calculation by accessing offsetWidth immediately
    const forceLayout1 = container.offsetWidth;

    // Try a different approach if that didn't work - temporarily make visible
    if (forceLayout1 === 0) {
      style.visibility = 'visible';
      style.opacity = '0';
      const forceLayout2 = container.offsetWidth;
      style.visibility = 'hidden';
      style.opacity = '1';

      if (this.debugMode) {
        this.debugLog('Container had zero width, tried visibility workaround', {
          beforeWorkaround: forceLayout1,
          afterWorkaround: forceLayout2,
        });
      }
    }

    if (this.debugMode) {
      this.debugLog('Created live DOM container for layout calculations', {
        offsetWidth: container.offsetWidth,
        offsetHeight: container.offsetHeight,
        clientWidth: container.clientWidth,
        clientHeight: container.clientHeight,
        computedWidth: window.getComputedStyle(container).width,
        computedDisplay: window.getComputedStyle(container).display,
        parentElement: container.parentElement ? container.parentElement.tagName : 'none',
        documentBody: document.body ? 'exists' : 'missing',
      });
    }

    return container;
  }

  /**
   * Create a mock document object that uses the live container as its body
   */
  createMockDocument(container) {
    return {
      body: container,
      querySelector: selector => container.querySelector(selector),
      querySelectorAll: selector => container.querySelectorAll(selector),
      createElement: tagName => document.createElement(tagName),
      // Add other document methods as needed
    };
  }

  /**
   * Clean up temporary DOM container
   */
  cleanupTempAttachment(container) {
    if (container && container.parentNode) {
      container.parentNode.removeChild(container);

      if (this.debugMode) {
        this.debugLog('Cleaned up temporary DOM container');
      }
    }
  }

  /**
   * Execute a single DOM transform script
   * @param {any} document
   * @param {any} script
   * @param {any} index
   * @param {any} idref
   */
  executeSingleDOMTransform(document, script, index, idref) {
    // Create sandboxed execution environment
    const globals = this.createSafeExecutionEnvironment();
    const globalNames = Object.keys(globals);
    const globalValues = Object.values(globals);

    // Wrap script in function with restricted globals
    const wrappedScript = \`(function(\${globalNames.join(', ')}) {
      \${script}

      if (typeof transformDOM !== 'function') {
        throw new Error('transformDOM function is not defined in script \${index}');
      }

      return transformDOM;
    })\`;

    // Execute wrapped script to get transform function
    const scriptFunction = new Function('return ' + wrappedScript)();
    const transformFunction = scriptFunction(...globalValues);

    // Execute transform with document and idref
    const result = transformFunction(document, idref);

    // Ensure result is a Document, return original if not
    return result instanceof Document ? result : document;
  }

  /**
   * Create safe execution environment with restricted globals
   */
  createSafeExecutionEnvironment() {
    // Start with safe browser APIs
    const safeGlobals = {
      // Safe JavaScript built-ins
      console,
      JSON,
      Math,
      Date,
      RegExp,
      String,
      Number,
      Boolean,
      Array,
      Object,
      parseInt,
      parseFloat,
      isNaN,
      isFinite,

      // Safe DOM APIs (document is special-cased for transforms)
      document: typeof document !== 'undefined' ? document : undefined,
      DOMParser: typeof DOMParser !== 'undefined' ? DOMParser : undefined,

      // Layout calculation utilities for attached DOM elements
      getElementLayout: this.createLayoutUtility(),

      // Extension libraries are available as native window globals after dynamic loading
    };

    // Explicitly remove dangerous globals that could break sandbox
    const dangerousGlobals = [
      'eval',
      'Function',
      'setTimeout',
      'setInterval',
      'clearTimeout',
      'clearInterval',
      'setImmediate',
      'clearImmediate',
      'requestAnimationFrame',
      'XMLHttpRequest',
      'fetch',
      'WebSocket',
      'EventSource',
      'import',
      'require',
      'process',
      'global',
      'globalThis',
      'window',
      'self',
      'parent',
      'top',
      'frames',
      'location',
      'history',
      'navigator',
      'localStorage',
      'sessionStorage',
      'indexedDB',
      'Worker',
      'SharedWorker',
    ];

    dangerousGlobals.forEach(dangerous => {
      delete safeGlobals[dangerous];
    });

    return safeGlobals;
  }

  /**
   * Create layout calculation utility for transform scripts
   */
  createLayoutUtility() {
    return element => {
      // Check if this is a real DOM element in the browser
      if (!element || !element.getBoundingClientRect) {
        if (this.debugMode) {
          this.debugLog('Layout requested for non-live element, returning defaults');
        }
        return {
          width: 0,
          height: 0,
          offsetWidth: 0,
          offsetHeight: 0,
          clientWidth: 0,
          clientHeight: 0,
          scrollWidth: 0,
          scrollHeight: 0,
          isAttached: false,
        };
      }

      // Element is live DOM - calculate real layout information
      const computedStyle = window.getComputedStyle(element);
      const rect = element.getBoundingClientRect();

      const layout = {
        // Dimensions from getBoundingClientRect (actual rendered size)
        width: rect.width,
        height: rect.height,

        // Element properties (includes padding/border/scrollbars)
        offsetWidth: element.offsetWidth,
        offsetHeight: element.offsetHeight,

        // Client dimensions (content + padding, excludes scrollbars/border)
        clientWidth: element.clientWidth,
        clientHeight: element.clientHeight,

        // Scroll dimensions (total content size)
        scrollWidth: element.scrollWidth,
        scrollHeight: element.scrollHeight,

        // Computed styles (useful for layout calculations)
        marginLeft: parseInt(computedStyle.marginLeft, 10) || 0,
        marginRight: parseInt(computedStyle.marginRight, 10) || 0,
        marginTop: parseInt(computedStyle.marginTop, 10) || 0,
        marginBottom: parseInt(computedStyle.marginBottom, 10) || 0,

        paddingLeft: parseInt(computedStyle.paddingLeft, 10) || 0,
        paddingRight: parseInt(computedStyle.paddingRight, 10) || 0,
        paddingTop: parseInt(computedStyle.paddingTop, 10) || 0,
        paddingBottom: parseInt(computedStyle.paddingBottom, 10) || 0,

        borderLeftWidth: parseInt(computedStyle.borderLeftWidth, 10) || 0,
        borderRightWidth: parseInt(computedStyle.borderRightWidth, 10) || 0,
        borderTopWidth: parseInt(computedStyle.borderTopWidth, 10) || 0,
        borderBottomWidth: parseInt(computedStyle.borderBottomWidth, 10) || 0,

        // Position information
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,

        // Attachment status
        isAttached: true,
      };

      if (this.debugMode) {
        this.debugLog('Layout calculated for live DOM element', {
          tagName: element.tagName,
          width: layout.width,
          height: layout.height,
          isAttached: layout.isAttached,
        });
      }

      return layout;
    };
  }

  /**
   * Enhance error object with additional context
   */
  enhanceError(error) {
    const enhanced = {
      message: error && error.message ? error.message : 'Unknown error',
      stage: error && error.stage ? error.stage : 'unknown',
      stack: error && error.stack ? error.stack : undefined,
    };

    // Try to extract line/column information from stack trace
    if (error && error.stack) {
      const lineMatch = error.stack.match(/at.*:(\\d+):(\\d+)/);
      if (lineMatch) {
        enhanced.line = parseInt(lineMatch[1], 10);
        enhanced.column = parseInt(lineMatch[2], 10);
      }
    }

    return enhanced;
  }

  /**
   * Set debug mode
   * @param {any} enabled
   * @param {any} messageId
   */
  setDebugMode(enabled, messageId) {
    this.debugMode = Boolean(enabled);
    this.updateStatus(\`Debug mode \${this.debugMode ? 'enabled' : 'disabled'}\`, 'info');
    this.respondToParent(messageId, { success: true, debugMode: this.debugMode });
  }

  /**
   * Handle ping message for connectivity testing
   * @param {any} payload
   * @param {any} messageId
   */
  handlePing(payload, messageId) {
    const timestamp = Date.now();
    this.respondToParent(messageId, {
      success: true,
      pong: true,
      timestamp,
      payload,
    });
  }

  /**
   * Update status display in iframe
   * @param {any} message
   * @param {string} type
   */
  updateStatus(message, type = 'info') {
    const statusElement = document.getElementById('status');
    if (statusElement) {
      statusElement.textContent = message;
      statusElement.className = \`transform-status visible \${type}\`;
    }

    if (this.debugMode) {
      console.log(\`[\${type.toUpperCase()}] \${message}\`);
    }
  }

  /**
   * Send notification to parent window (no response expected)
   * @param {any} type
   * @param {any} payload
   */
  notifyParent(type, payload = {}) {
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({ type, payload }, '*');
    }
  }

  /**
   * Respond to parent window message
   * @param {any} messageId
   * @param {any} result
   */
  respondToParent(messageId, result) {
    if (window.parent && window.parent !== window) {
      window.parent.postMessage(
        {
          type: 'TRANSFORM_RESULT',
          messageId,
          payload: {
            result: result,
          },
        },
        '*'
      );
    }
  }

  /**
   * Debug logging utility
   * @param {any} message
   * @param {any} data
   */
  debugLog(message, data = null) {
    if (this.debugMode) {
      const timestamp = new Date().toISOString();
      console.log(\`[DEBUG \${timestamp}] \${message}\`, data || '');
    }
  }
}

// Initialize the transform execution engine when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', () => {
    new TransformExecutionEngine();
  });
} else {
  new TransformExecutionEngine();
}
`;class km{constructor(e,t){this.extensionManager=t,this.blobURLManager=e}iframe=null;messageId=0;pendingMessages=new Map;blobURLManager;async initialize(){this.iframe=this.createPersistentIframe(),document.body.appendChild(this.iframe),window.addEventListener("message",this.handleMessage.bind(this)),await this.waitForReady()}async setTransformScripts(e){if(!this.iframe)throw new Error("Transform engine not initialized");await this.sendMessage("SET_TRANSFORM_SCRIPTS",e)}async executeTransform(e,t=3e3,a){if(!this.iframe)throw new Error("Transform engine not initialized");return await this.sendMessage("EXECUTE_TRANSFORM",{plainText:e,timeout:t,idref:a})}async setDebugMode(e){if(!this.iframe)throw new Error("Transform engine not initialized");await this.sendMessage("SET_DEBUG_MODE",e)}async ping(e){if(!this.iframe)throw new Error("Transform engine not initialized");return await this.sendMessage("PING",e)}async setWorkspaceExtensions(e){if(this.extensionManager)try{const t=await this.loadExtensionScripts(e);await this.sendMessage("SET_EXTENSION_SCRIPTS",t)}catch(t){console.error("Failed to load workspace extensions:",t)}}async loadExtensionScripts(e){if(!this.extensionManager)return[];const t=await this.extensionManager.listWorkspaceExtensions(e),a=[];for(const n of t)try{const i=n.files.filter(s=>s.type==="javascript");for(const s of i){const l=`SOURCE/extensions/${n.name}/${s.filename}`,d=await Ot.getInstance().readFile(e,l),u="application/javascript",p=new Blob([d],{type:u}),h=URL.createObjectURL(p);a.push({name:`${n.name}/${s.filename}`,blobUrl:h})}}catch(i){console.warn(`Failed to load extension ${n.name}:`,i)}return a}cleanup(){for(const[e,t]of this.pendingMessages)clearTimeout(t.timeout),t.reject(new Error("Transform engine shutting down"));this.pendingMessages.clear(),this.iframe&&(this.iframe.remove(),this.iframe=null),window.removeEventListener("message",this.handleMessage.bind(this))}createPersistentIframe(){const e=document.createElement("iframe");e.style.visibility="hidden",e.style.position="absolute",e.style.left="-9999px",e.style.top="0px",e.style.width="800px",e.style.height="600px";const t=this.createIframeDocument(),a=new Blob([t],{type:"text/html"}),n=URL.createObjectURL(a);return e.src=n,e.onload=()=>{URL.revokeObjectURL(n)},e}createIframeDocument(){return`<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Transform Engine</title>
  <style>
${Sm}
  </style>
</head>
<body>
  <div id="status" class="transform-status">Transform engine initializing...</div>
  <script>
${Em}
  <\/script>
</body>
</html>`}async sendMessage(e,t){const a=++this.messageId;return new Promise((n,i)=>{const s=setTimeout(()=>{this.pendingMessages.delete(a),i(new Error(`Message timeout: ${e}`))},5e3);this.pendingMessages.set(a,{resolve:l=>{clearTimeout(s),n(l)},reject:l=>{clearTimeout(s),i(l)},timeout:s}),this.iframe?.contentWindow?this.iframe.contentWindow.postMessage({type:e,payload:t,messageId:a},"*"):(this.pendingMessages.delete(a),clearTimeout(s),i(new Error("Iframe not available")))})}handleMessage(e){if(e.source!==this.iframe?.contentWindow)return;const{type:t,messageId:a,payload:n}=e.data;if(t==="TRANSFORM_RESULT"&&a){const i=this.pendingMessages.get(a);if(i)if(this.pendingMessages.delete(a),n?.result?.success)i.resolve(n.result);else{const s=n?.result?.error||{message:"Unknown transform error"},l={stage:s.stage||"unknown",message:String(s.message||s||"Transform failed"),line:s.line,column:s.column,stack:s.stack};i.reject(l)}}else t==="IFRAME_READY"||(t==="GLOBAL_ERROR"||t==="UNHANDLED_REJECTION")&&console.error(`Transform engine ${t.toLowerCase()}:`,n)}waitForReady(){return new Promise((e,t)=>{const a=setTimeout(()=>{t(new Error("Transform engine initialization timeout"))},1e4),n=i=>{i.source===this.iframe?.contentWindow&&i.data.type==="IFRAME_READY"&&(clearTimeout(a),window.removeEventListener("message",n),e())};window.addEventListener("message",n)})}}class Tt extends Error{constructor(e,t,a){super(e),this.code=t,this.workspaceId=a,this.name="SpineServiceError"}}class Tm{constructor(e){this.workspaceService=e}async loadSpineItems(e){try{const t=[];for(const a of e.opf.spine){const n=e.opf.manifest.find(l=>l.id===a.idref);if(!n)continue;const i=`SOURCE/text/${n.id}.txt`,s=await this.workspaceService.fileExists(e.id,i);t.push({idref:n.id,linear:a.linear??!0,id:n.id,href:n.href,mediaType:n.mediaType,sourcePath:s?i:void 0,hasSourceFile:s})}return t}catch(t){throw new Tt(`Failed to load spine items: ${t instanceof Error?t.message:"Unknown error"}`,"LOAD_ERROR",e.id)}}async addChapter(e,t){try{const a=this.generateUniqueChapterId(e),n=`Text/${a}.xhtml`,i={id:a,href:n,mediaType:"application/xhtml+xml"};let s=await this.workspaceService.addManifestItem(e,i);const l={idref:a,linear:t.linear??!0};s=await this.workspaceService.addSpineItem(s,l,t.insertIndex);const c=this.generateChapterXHTML(t.title);await this.workspaceService.writeFile(e.id,n,c);let d=!1,u;if(t.createSourceFile){u=`SOURCE/text/${a}.txt`;const h=`# ${t.title}

Your chapter content goes here...`;await this.workspaceService.writeFile(e.id,u,h),d=!0}const p={idref:a,linear:t.linear??!0,id:a,href:n,mediaType:"application/xhtml+xml",sourcePath:d?u:void 0,hasSourceFile:d};return{updatedWorkspace:s,newChapter:p}}catch(a){throw new Tt(`Failed to add chapter: ${a instanceof Error?a.message:"Unknown error"}`,"ADD_CHAPTER_ERROR",e.id)}}async moveChapterUp(e,t){try{if(t<=0)throw new Tt("Cannot move first chapter up","INVALID_MOVE",e.id);const a=await this.loadSpineItems(e);if(t>=a.length)throw new Tt("Invalid chapter index","INVALID_INDEX",e.id);const n=[...a];return[n[t-1],n[t]]=[n[t],n[t-1]],{updatedWorkspace:await this.workspaceService.updateSpineOrder(e,n.map(s=>s.id)),newOrder:n}}catch(a){throw a instanceof Tt?a:new Tt(`Failed to move chapter up: ${a instanceof Error?a.message:"Unknown error"}`,"MOVE_ERROR",e.id)}}async moveChapterDown(e,t){try{const a=await this.loadSpineItems(e);if(t<0||t>=a.length-1)throw new Tt("Cannot move last chapter down","INVALID_MOVE",e.id);const n=[...a];return[n[t],n[t+1]]=[n[t+1],n[t]],{updatedWorkspace:await this.workspaceService.updateSpineOrder(e,n.map(s=>s.id)),newOrder:n}}catch(a){throw a instanceof Tt?a:new Tt(`Failed to move chapter down: ${a instanceof Error?a.message:"Unknown error"}`,"MOVE_ERROR",e.id)}}async reorderItems(e,t,a){try{const n=await this.loadSpineItems(e);if(t<0||t>=n.length||a<0||a>=n.length)throw new Tt("Invalid reorder indices","INVALID_INDEX",e.id);const i=[...n],[s]=i.splice(t,1);return i.splice(a,0,s),{updatedWorkspace:await this.workspaceService.updateSpineOrder(e,i.map(c=>c.id)),newOrder:i}}catch(n){throw n instanceof Tt?n:new Tt(`Failed to reorder items: ${n instanceof Error?n.message:"Unknown error"}`,"REORDER_ERROR",e.id)}}generateUniqueChapterId(e){const t=new Set(e.opf.manifest.map(i=>i.id));let a=1,n=`chapter${a.toString().padStart(2,"0")}`;for(;t.has(n);)a++,n=`chapter${a.toString().padStart(2,"0")}`;return n}generateChapterXHTML(e){return`<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
    <title>${e}</title>
    <link rel="stylesheet" type="text/css" href="../Styles/styles.css"/>
</head>
<body>
    <section class="chapter">
        <h1>${e}</h1>
        <p>Your chapter content goes here...</p>
    </section>
</body>
</html>`}async deleteChapter(e,t){try{if(e.opf.spine.findIndex(l=>l.idref===t)===-1)throw new Tt("Chapter not found in spine","CHAPTER_NOT_FOUND",e.id);const n=e.opf.manifest.findIndex(l=>l.id===t);if(n===-1)throw new Tt("Chapter not found in manifest","MANIFEST_ITEM_NOT_FOUND",e.id);const i=e.opf.manifest[n],s={...e,opf:{...e.opf,spine:e.opf.spine.filter(l=>l.idref!==t),manifest:e.opf.manifest.filter(l=>l.id!==t)}};await this.workspaceService.saveWorkspace(s);try{const l=i.href.startsWith(e.pathInfo.basePath)?i.href:`${e.pathInfo.basePath}/${i.href}`;await this.workspaceService.fileStorage.deleteFile(s.id,l)}catch(l){console.warn("Failed to delete XHTML file:",l)}try{const l=`SOURCE/text/${t}.txt`;await this.workspaceService.fileStorage.deleteFile(s.id,l)}catch(l){console.warn("Failed to delete source file:",l)}return{updatedWorkspace:s}}catch(a){throw a instanceof Tt?a:new Tt(`Failed to delete chapter: ${a instanceof Error?a.message:"Unknown error"}`,"DELETE_ERROR",e.id)}}async renameChapterId(e,t,a){try{if(!/^[a-zA-Z_][a-zA-Z0-9_.-]*$/.test(a))throw new Tt("Invalid ID format. ID must start with a letter or underscore and contain only letters, numbers, hyphens, periods, and underscores.","INVALID_ID_FORMAT",e.id);if(e.opf.manifest.some(d=>d.id===a))throw new Tt(`ID '${a}' already exists`,"DUPLICATE_ID",e.id);const n=e.opf.manifest.find(d=>d.id===t);if(!n)throw new Tt(`Item with ID '${t}' not found`,"ITEM_NOT_FOUND",e.id);const i=n.href.replace(t,a);let s=await this.workspaceService.updateManifestItem(e,t,{id:a,href:i});const l=`SOURCE/text/${t}.txt`,c=`SOURCE/text/${a}.txt`;return await this.workspaceService.fileExists(e.id,l)&&await this.workspaceService.renameFile(e.id,l,c),{updatedWorkspace:s}}catch(n){throw new Tt(`Failed to rename chapter ID: ${n instanceof Error?n.message:"Unknown error"}`,"RENAME_ERROR",e.id)}}}var Cm=I('<div class="error-state svelte-141k6tx"><h2 class="svelte-141k6tx">Transform Engine Failed</h2> <p class="svelte-141k6tx"> </p> <p class="svelte-141k6tx">Please refresh the page to try again.</p></div>'),Im=I('<div class="loading-state svelte-141k6tx"><div class="spinner svelte-141k6tx"></div> <p>Initializing transform engine...</p></div>'),Fm=I('<div class="loading-state svelte-141k6tx"><div class="spinner svelte-141k6tx"></div> <p>Initializing application...</p></div>'),Mm=I('<div class="placeholder-content svelte-141k6tx"><p class="svelte-141k6tx"> </p></div>'),Pm=I('<div class="placeholder-content svelte-141k6tx"><p class="svelte-141k6tx"> </p></div>'),Lm=I('<div class="placeholder-content svelte-141k6tx"><p class="svelte-141k6tx"> </p></div>'),Dm=(r,e,t)=>e(o(t).id),Rm=I('<div class="package-epub-section svelte-141k6tx"><button class="package-epub-button svelte-141k6tx"> </button></div>'),Am=I('<div class="placeholder-content svelte-141k6tx"><h3 class="svelte-141k6tx"> </h3> <p class="svelte-141k6tx"> </p></div>'),Om=I('<div class="placeholder-content svelte-141k6tx"><h3 class="svelte-141k6tx"> </h3> <p class="svelte-141k6tx"> </p></div>'),Um=I('<div class="placeholder-content svelte-141k6tx"><h3 class="svelte-141k6tx"> </h3> <p class="svelte-141k6tx"> </p></div>'),zm=I('<div class="placeholder-content svelte-141k6tx"><h3 class="svelte-141k6tx"> </h3> <p class="svelte-141k6tx"> </p> <p class="current-view-info svelte-141k6tx"> <strong> </strong></p></div>');function Wm(r,e){tt(e,!0);const[t,a]=ot(),n=()=>Qe(Ct,"$navigationStore",t),i=()=>Qe(On,"$layoutStore",t),s=()=>Qe(dt,"$t",t);let l=Pe(void 0);const c={setTheme:()=>{},useSystemPreference:()=>{},getCurrentTheme:()=>"system"},d={setLocale:()=>{},getCurrentLocale:()=>"en"},u=Ot.getInstance(),p=new da,h=new bo(u),v=new Tm(h),m=new qf(h),y=new Si,b=new _o;let M,T=null,E=Pe(!1),C=Pe(null),k=Pe(null),X=ne(()=>n().currentView),P=ne(()=>i().sidebar.isExpanded),z=ne(()=>o(k)?.currentWorkspaceId),U=ne(()=>o(k)?.selectedChapterId),F=ne(()=>o(k)?.initialized||!1),S=ne(()=>o(k)?.workspace),W=Pe(null),R=ne(()=>o(S)?.opf?.metadata),D=ne(()=>o(R)?.title),N=ne(()=>o(D)?`${o(D)}`:"EDITME"),A=Pe(null),B=Pe(null),Q=Pe(null),le=Pe(Dt({xhtmlContent:"",isTransforming:!1,transformError:null,transformWarnings:[],executionTime:0,spineItemId:null}));const Ie=ve=>{w(A,ve.item,!0),w(B,ve.type,!0)},Me=async ve=>{const{field:me}=ve.detail;(me==="creator"||me==="title"||me==="language")&&window.dispatchEvent(new CustomEvent("workspace-list-refresh"))},Oe=ve=>{w(W,ve.detail.field,!0)},Le=ve=>{w(Q,ve.detail.xhtml,!0)};function fe(ve){const me=o(S)?.opf?.manifest?.find(Ee=>Ee.href?.includes(`${ve}.xhtml`));if(me){const Ee=new CustomEvent("select-spine-item",{detail:{itemId:me.id},bubbles:!0});window.dispatchEvent(Ee)}}const Y=ve=>{w(le,{xhtmlContent:ve.detail.xhtmlContent,isTransforming:ve.detail.isTransforming,transformError:ve.detail.transformError,transformWarnings:ve.detail.transformWarnings,executionTime:ve.detail.executionTime,spineItemId:ve.detail.spineItemId},!0)},te=ve=>{const me=document.querySelector("[data-spine-view]");me&&me.dispatchEvent(new CustomEvent("preview-click",{detail:ve,bubbles:!0}))},ae=async ve=>{if(!(!o(S)||!o(k)||!confirm(s()("Are you sure you want to delete this item?"))))try{const Ee=await h.removeManifestItem(o(S),ve.detail.itemId);o(k).workspace=Ee,o(A)&&o(A).id===ve.detail.itemId&&(w(A,null),w(B,null))}catch(Ee){console.error("Failed to delete manifest item:",Ee)}},be=async(ve,me)=>{if(!o(k)){console.error("AppState not initialized");return}try{let Ee;if(ve)Ee=ve;else if(me){console.log(`Downloading EPUB from: ${me}`);const ge=await fetch(me);if(!ge.ok)throw new Error(`Failed to download EPUB: ${ge.status} ${ge.statusText}`);const Ge=await ge.blob(),H=ke(me);Ee=new File([Ge],H,{type:"application/epub+zip"})}else Ee=await We();const He="workspace-"+crypto.randomUUID();console.log(`Importing EPUB: ${Ee.name} to workspace: ${He}`);const ee=await b.unpackEPUB(Ee,He);if(!ee.success)throw new Error(ee.error||"Failed to unpack EPUB");console.log(`✅ Successfully imported EPUB: ${ee.extractedFiles?.length} files extracted`),await o(k).loadWorkspace(He);const Se=o(k).workspace?.opf?.spine?.[0];Se?(o(k).selectChapter(Se.idref),Ct.navigateTo("spine")):Ct.navigateTo("metadata"),location.hash=""}catch(Ee){console.error("Failed to import EPUB:",Ee);const He=Ee instanceof Error?Ee.message:"Unknown error";alert(`Failed to import EPUB: ${He}`)}},ke=ve=>{try{const He=new URL(ve).pathname.split("/").pop()||"imported-epub.epub";return He.endsWith(".epub")?He:`${He}.epub`}catch{return"imported-epub.epub"}},We=()=>new Promise((ve,me)=>{const Ee=document.createElement("input");Ee.type="file",Ee.accept=".epub",Ee.onchange=He=>{const ee=He.target.files?.[0];ee?ve(ee):me(new Error("No file selected"))},Ee.oncancel=()=>{me(new Error("File selection cancelled"))},Ee.click()}),je=ve=>{if(!o(k))return;const me=o(k).workspace?.opf?.spine?.[0];me?(o(k).selectChapter(me.idref),Ct.navigateTo("spine")):Ct.navigateTo("metadata")},Re=async ve=>{if(o(S))try{const me=await h.updateMetadata(o(S),{modifiedDate:mn()});o(k)&&(o(k).workspace=me);const Ee=await y.packageEPUB(ve,{progressCallback:He=>{console.log(`Packaging progress: ${He.phase} - ${He.processedFiles}/${He.totalFiles} files`)}});if(Ee.success&&Ee.blob&&Ee.filename)y.downloadEPUB(Ee.blob,Ee.filename),console.log(`✅ Successfully packaged and downloaded: ${Ee.filename}`);else throw new Error(Ee.error||"Unknown packaging error")}catch(me){throw console.error("Failed to package EPUB:",me),me}};on(()=>{(async()=>{try{await u.init(),w(l,new Ei(u),!0),M=new go({fileStorage:u,basePath:"OEBPS",maxBlobURLs:100,onCapacityReached:()=>{console.warn("Blob URL capacity reached - consider cleanup")}}),T=new km(M,o(l)),await T.initialize(),w(E,!0),w(k,new _m(u,p,po,o(l),c,d,T),!0),await o(k).initialize()}catch(He){console.error("Failed to initialize app:",He),w(C,He instanceof Error?He.message:"Initialization failed",!0)}})();const ve=He=>{if(!o(k))return;const ee=He;o(k).selectChapter(ee.detail.itemId),Ct.navigateTo("spine")},me=()=>{o(k)&&o(k).selectChapter(null)},Ee=()=>{const He=window.location.hash.slice(1);if(He.startsWith("http"))try{const ee=decodeURIComponent(He);console.log(`Hash change detected: importing EPUB from ${ee}`),be(void 0,ee)}catch(ee){console.error("Failed to decode URL from hash:",ee),alert("Invalid URL in hash fragment")}};return window.location.hash&&Ee(),window.addEventListener("select-spine-item",ve),window.addEventListener("clear-spine-selection",me),window.addEventListener("hashchange",Ee),()=>{window.removeEventListener("select-spine-item",ve),window.removeEventListener("clear-spine-selection",me),window.removeEventListener("hashchange",Ee),o(k)?.cleanup(),T?.cleanup()}});var Be=lt();Nl(ve=>{O(()=>gs.title=o(N))});var Ae=Ye(Be);{var $e=ve=>{var me=Cm(),Ee=g(f(me),2),He=f(Ee);O(()=>x(He,o(C))),_(ve,me)},Ve=(ve,me)=>{{var Ee=ee=>{var Se=Im();_(ee,Se)},He=(ee,Se)=>{{var ge=H=>{var G=Fm();_(H,G)},Ge=H=>{const G=ne(()=>!!o(z));uu(H,{get hasWorkspace(){return o(G)},get currentWorkspace(){return o(S)},get workspaceTitle(){return o(D)},get extensionManager(){return o(l)},$$slots:{"sidebar-spine":(J,de)=>{var we=lt(),q=Ye(we);{var se=pe=>{var ye=Mm(),Ce=f(ye),Ne=f(Ce);O(Fe=>x(Ne,Fe),[()=>s()("Loading project…")]),_(pe,ye)},ce=(pe,ye)=>{{var Ce=Fe=>{var oe=Pm(),Ue=f(oe),Je=f(Ue);O(De=>x(Je,De),[()=>s()("No project selected")]),_(Fe,oe)},Ne=(Fe,oe)=>{{var Ue=De=>{Gh(De,{get workspace(){return o(S)},get spineService(){return v},get selectedItemId(){return o(U)},get isExpanded(){return o(P)},onWorkspaceUpdate:Z=>{o(k)&&(o(k).workspace=Z)}})},Je=De=>{var Z=Lm(),V=f(Z),he=f(V);O(K=>x(he,K),[()=>s()("Loading project…")]),_(De,Z)};j(Fe,De=>{o(S)?De(Ue):De(Je,!1)},oe)}};j(pe,Fe=>{o(S)?Fe(Ne,!1):Fe(Ce)},ye)}};j(q,pe=>{o(F)?pe(ce,!1):pe(se)})}_(J,we)},"sidebar-footer":(J,de)=>{var we=lt(),q=Ye(we);{var se=ce=>{var pe=Rm(),ye=f(pe);ye.__click=[Dm,Re,S];var Ce=f(ye);O((Ne,Fe)=>{ue(ye,"title",Ne),x(Ce,Fe)},[()=>s()("Package EPUB"),()=>s()("Package EPUB")]),_(ce,pe)};j(q,ce=>{o(S)&&ce(se)})}_(J,we)},"left-content":(J,de)=>{var we=lt(),q=Ye(we);{var se=pe=>{gu(pe,{})},ce=(pe,ye)=>{{var Ce=Fe=>{ef(Fe,{onListWorkspaces:()=>o(k)?.listWorkspaces()??Promise.resolve([]),onCreateWorkspace:oe=>o(k)?.createWorkspace(oe.title,oe.language)??Promise.resolve(""),onDeleteWorkspace:oe=>o(k)?.deleteWorkspace(oe)??Promise.resolve(),onLoadWorkspace:oe=>o(k)?.loadWorkspace(oe)??Promise.resolve(),onEpubImportRequested:be,get currentWorkspaceId(){return o(z)},onNavigationRequested:oe=>{Ct.navigateTo(oe)},onSmartNavigationRequested:je,onWorkspaceOpened:()=>{},onWorkspaceChanged:()=>{}})},Ne=(Fe,oe)=>{{var Ue=De=>{var Z=lt(),V=Ye(Z);{var he=xe=>{Qf(xe,{get metadataService(){return m},get workspace(){return o(k).workspace},set workspace(L){o(k).workspace=L},$$events:{metadataChanged:Me,fieldFocus:Oe}})},K=xe=>{const L=ne(()=>s()("EPUB Metadata")),re=ne(()=>s()("Configure publication metadata and details"));Vr(xe,{viewType:"metadata",get title(){return o(L)},get description(){return o(re)},icon:"📝"})};j(V,xe=>{o(F)&&o(S)&&o(k)?xe(he):xe(K,!1)})}_(De,Z)},Je=(De,Z)=>{{var V=K=>{var xe=lt(),L=Ye(xe);{var re=_e=>{Pv(_e,{get workspace(){return o(S)},get workspaceService(){return h},get advancedMode(){return o(k).isAdvancedMode},onItemSelect:Ie})},ie=_e=>{const ze=ne(()=>s()("File Manifest")),qe=ne(()=>s()("Manage EPUB files and resources"));Vr(_e,{viewType:"manifest",get title(){return o(ze)},get description(){return o(qe)},icon:"📋"})};j(L,_e=>{o(F)&&o(S)?_e(re):_e(ie,!1)})}_(K,xe)},he=(K,xe)=>{{var L=ie=>{var _e=lt(),ze=Ye(_e);{var qe=Ze=>{Yv(Ze,{get workspace(){return o(S)},get workspaceService(){return h},get spineService(){return v},$$events:{previewUpdate:Le}})},Xe=Ze=>{const it=ne(()=>s()("Table of Contents")),pt=ne(()=>s()("Loading project…"));Vr(Ze,{viewType:"navigation",get title(){return o(it)},get description(){return o(pt)},icon:"📖"})};j(ze,Ze=>{o(F)&&o(S)?Ze(qe):Ze(Xe,!1)})}_(ie,_e)},re=(ie,_e)=>{{var ze=Xe=>{var Ze=lt(),it=Ye(Ze);{var pt=St=>{const mt=ne(()=>o(k).getTransformEngine()),gt=ne(()=>o(k).getContentService());uh(St,{get workspace(){return o(S)},get workspaceService(){return h},get spineService(){return v},get selectedItemId(){return o(U)},get transformEngine(){return o(mt)},get contentService(){return o(gt)},$$events:{previewUpdate:Y}})},ht=St=>{const mt=ne(()=>s()("Spine Items")),gt=ne(()=>s()("Loading project…"));Vr(St,{viewType:"spine",get title(){return o(mt)},get description(){return o(gt)},icon:"📚"})};j(it,St=>{o(F)&&o(S)&&o(k)?St(pt):St(ht,!1)})}_(Xe,Ze)},qe=(Xe,Ze)=>{{var it=ht=>{const St=ne(()=>o(k).getSettingsService()),mt=ne(()=>o(k).getExtensionManager()),gt=ne(()=>o(k).getTransformEngine());Ch(ht,{get settingsService(){return o(St)},get extensionManager(){return o(mt)},get transformEngine(){return o(gt)},get workspaceId(){return o(k).currentWorkspaceId},onSettingsChanged:()=>{o(k)?.currentWorkspaceId&&o(k).loadWorkspaceSettings(o(k).currentWorkspaceId)}})},pt=ht=>{var St=Am(),mt=f(St),gt=f(mt),$t=g(mt,2),Ft=f($t);O((pn,Nn)=>{x(gt,pn),x(Ft,`${Nn??""}: ${o(X)??""}`)},[()=>s()("Unknown View"),()=>s()("View type")]),_(ht,St)};j(Xe,ht=>{o(X)==="settings"?ht(it):ht(pt,!1)},Ze)}};j(ie,Xe=>{o(X)==="spine"?Xe(ze):Xe(qe,!1)},_e)}};j(K,ie=>{o(X)==="navigation"?ie(L):ie(re,!1)},xe)}};j(De,K=>{o(X)==="manifest"?K(V):K(he,!1)},Z)}};j(Fe,De=>{o(X)==="metadata"?De(Ue):De(Je,!1)},oe)}};j(pe,Fe=>{o(X)==="workspace"&&o(F)?Fe(Ce):Fe(Ne,!1)},ye)}};j(q,pe=>{o(X)==="about"?pe(se):pe(ce,!1)})}_(J,we)},"right-content":(J,de)=>{var we=lt(),q=Ye(we);{var se=pe=>{xu(pe,{})},ce=(pe,ye)=>{{var Ce=Fe=>{const oe=ne(()=>o(k)?.isAdvancedMode??!1);pm(Fe,{get workspace(){return o(S)},get focusedField(){return o(W)},get isAdvancedMode(){return o(oe)}})},Ne=(Fe,oe)=>{{var Ue=De=>{Vv(De,{get selectedItem(){return o(A)},get selectedItemType(){return o(B)},get workspace(){return o(S)},get workspaceService(){return h},$$events:{itemDelete:ae}})},Je=(De,Z)=>{{var V=K=>{var xe=lt(),L=Ye(xe);{var re=_e=>{Zv(_e,{get content(){return o(Q)},onNavigate:fe})},ie=_e=>{var ze=Om(),qe=f(ze),Xe=f(qe),Ze=g(qe,2),it=f(Ze);O((pt,ht)=>{x(Xe,pt),x(it,ht)},[()=>s()("Navigation Preview"),()=>s()("Generating navigation from chapters...")]),_(_e,ze)};j(L,_e=>{o(Q)?_e(re):_e(ie,!1)})}_(K,xe)},he=(K,xe)=>{{var L=ie=>{var _e=lt(),ze=Ye(_e);{var qe=Ze=>{Yp(Ze,{get xhtmlContent(){return o(le).xhtmlContent},get isTransforming(){return o(le).isTransforming},get transformError(){return o(le).transformError},get transformWarnings(){return o(le).transformWarnings},get executionTime(){return o(le).executionTime},get spineItemId(){return o(le).spineItemId},onPreviewClick:te})},Xe=Ze=>{var it=Um(),pt=f(it),ht=f(pt),St=g(pt,2),mt=f(St);O((gt,$t)=>{x(ht,gt),x(mt,$t)},[()=>s()("Spine Preview"),()=>s()("Select a spine item to see the preview here")]),_(Ze,it)};j(ze,Ze=>{o(le).spineItemId?Ze(qe):Ze(Xe,!1)})}_(ie,_e)},re=ie=>{var _e=zm(),ze=f(_e),qe=f(ze),Xe=g(ze,2),Ze=f(Xe),it=g(Xe,2),pt=f(it),ht=g(pt),St=f(ht);O((mt,gt,$t)=>{x(qe,mt),x(Ze,gt),x(pt,`${$t??""}: `),x(St,o(X))},[()=>s()("Preview Pane"),()=>s()("Content preview will appear here based on the current view"),()=>s()("Current view")]),_(ie,_e)};j(K,ie=>{o(X)==="spine"?ie(L):ie(re,!1)},xe)}};j(De,K=>{o(X)==="navigation"?K(V):K(he,!1)},Z)}};j(Fe,De=>{o(X)==="manifest"&&o(F)&&o(S)?De(Ue):De(Je,!1)},oe)}};j(pe,Fe=>{o(X)==="metadata"&&o(F)&&o(S)?Fe(Ce):Fe(Ne,!1)},ye)}};j(q,pe=>{o(X)==="about"?pe(se):pe(ce,!1)})}_(J,we)}}})};j(ee,H=>{o(k)?H(Ge,!1):H(ge)},Se)}};j(ve,ee=>{o(E)?ee(He,!1):ee(Ee)},me)}};j(Ae,ve=>{o(C)?ve($e):ve(Ve,!1)})}_(r,Be),nt(),a()}yt(["click"]);fo().catch(r=>{console.error("Failed to initialize i18n:",r)});Bl(Wm,{target:document.getElementById("app")});</script>
    <style rel="stylesheet" crossorigin>:root{--color-neutral-50: #ffffff;--color-neutral-100: #f8f8f8;--color-neutral-200: #f0f0f0;--color-neutral-300: #e0e0e0;--color-neutral-400: #cccccc;--color-neutral-500: #999999;--color-neutral-600: #666666;--color-neutral-700: #444444;--color-neutral-800: #333333;--color-neutral-900: #222222;--color-neutral-950: #000000;--color-primary-50: #f0f0ff;--color-primary-100: #e6e6ff;--color-primary-200: #ccccff;--color-primary-300: #9999ff;--color-primary-400: #6666ff;--color-primary-500: #3333ff;--color-primary-600: #0000ee;--color-primary-700: #0000cc;--color-primary-800: #0000aa;--color-primary-900: #000088;--color-primary-950: #000066;--color-success-50: #f0fdf4;--color-success-100: #e6f5e6;--color-success-200: #cceecc;--color-success-300: #99dd99;--color-success-400: #66cc66;--color-success-500: #33bb33;--color-success-600: #22aa22;--color-success-700: #118811;--color-success-800: #006600;--color-success-900: #005500;--color-success-950: #004400;--color-warning-50: #fffbeb;--color-warning-100: #fef3c7;--color-warning-200: #fde68a;--color-warning-300: #fcd34d;--color-warning-400: #fbbf24;--color-warning-500: #f59e0b;--color-warning-600: #d97706;--color-warning-700: #b45309;--color-warning-800: #92400e;--color-warning-900: #78350f;--color-warning-950: #451a03;--color-error-50: #fef2f2;--color-error-100: #fee2e2;--color-error-200: #fecaca;--color-error-300: #fca5a5;--color-error-400: #f87171;--color-error-500: #ef4444;--color-error-600: #dc2626;--color-error-700: #b91c1c;--color-error-800: #991b1b;--color-error-900: #7f1d1d;--color-error-950: #450a0a;--color-white: #ffffff;--color-black: #000000;--color-transparent: transparent;--color-link-visited: #551a8b;--color-craigslist-bg: #f0f0f0;--color-craigslist-border: #ccc;--color-bg-primary: var(--color-white);--color-bg-secondary: var(--color-craigslist-bg);--color-bg-tertiary: var(--color-neutral-100);--color-bg-quaternary: var(--color-neutral-200);--color-bg-inverse: var(--color-neutral-900);--color-bg-accent: var(--color-primary-50);--color-bg-success: var(--color-success-50);--color-bg-warning: var(--color-warning-50);--color-bg-error: var(--color-error-50);--color-text-primary: var(--color-neutral-900);--color-text-secondary: var(--color-neutral-600);--color-text-tertiary: var(--color-neutral-500);--color-text-quaternary: var(--color-neutral-400);--color-text-inverse: var(--color-white);--color-text-accent: var(--color-primary-600);--color-text-success: var(--color-success-700);--color-text-warning: var(--color-warning-700);--color-text-error: var(--color-error-700);--color-text-link: var(--color-primary-600);--color-text-link-hover: var(--color-primary-700);--color-text-link-visited: var(--color-link-visited);--color-border-default: var(--color-craigslist-border);--color-border-strong: var(--color-neutral-400);--color-border-subtle: var(--color-neutral-300);--color-border-inverse: var(--color-neutral-700);--color-border-accent: var(--color-primary-300);--color-border-success: var(--color-success-600);--color-border-warning: var(--color-warning-300);--color-border-error: var(--color-error-300);--color-border-focus: var(--color-success-600);--color-interactive-primary: var(--color-primary-600);--color-interactive-primary-hover: var(--color-primary-700);--color-interactive-primary-active: var(--color-primary-800);--color-interactive-secondary: var(--color-neutral-100);--color-interactive-secondary-hover: var(--color-neutral-200);--color-interactive-secondary-active: var(--color-neutral-300);--color-interactive-disabled: var(--color-neutral-300);--color-interactive-disabled-text: var(--color-neutral-500);--color-surface-primary: var(--color-white);--color-surface-secondary: var(--color-neutral-50);--color-surface-tertiary: var(--color-neutral-100);--color-surface-overlay: rgba(0, 0, 0, .5);--color-surface-elevated: var(--color-white);--color-sidebar-bg: var(--color-bg-primary);--color-sidebar-border: var(--color-border-default);--color-sidebar-item-hover: var(--color-neutral-100);--color-sidebar-item-active: var(--color-neutral-200);--color-sidebar-text: var(--color-text-primary);--color-sidebar-text-secondary: var(--color-text-secondary);--color-button-primary-bg: var(--color-neutral-100);--color-button-primary-bg-hover: var(--color-neutral-200);--color-button-primary-text: var(--color-text-primary);--color-button-primary-border: var(--color-neutral-400);--color-button-secondary-bg: var(--color-white);--color-button-secondary-bg-hover: var(--color-neutral-100);--color-button-secondary-text: var(--color-text-primary);--color-button-secondary-border: var(--color-border-default);--color-input-bg: var(--color-bg-primary);--color-input-border: var(--color-border-default);--color-input-border-focus: var(--color-success-600);--color-input-text: var(--color-text-primary);--color-input-placeholder: var(--color-text-tertiary);--color-input-border-active: var(--color-success-600);--color-status-success: var(--color-success-600);--color-status-warning: var(--color-warning-600);--color-status-error: var(--color-error-600);--color-status-info: var(--color-primary-600);--color-focus: var(--color-primary-600);--color-focus-ring: var(--color-primary-500);--color-forced-bg: Canvas;--color-forced-text: CanvasText;--color-forced-border: ButtonBorder;--color-forced-link: LinkText;--color-forced-visited: VisitedText;--color-forced-active: ActiveText;--color-forced-button-face: ButtonFace;--color-forced-button-text: ButtonText;--color-error-text: #dc2626;--color-error-bg: #fef2f2;--color-success-text: #166534;--color-success-bg: #f0fdf4;--color-warning-text: #92400e;--color-warning-bg: #fffbeb}@media (prefers-contrast: high){:root{--color-text-primary: var(--color-forced-text);--color-bg-primary: var(--color-forced-bg);--color-border-default: var(--color-forced-border);--color-text-link: var(--color-forced-link);--color-focus: var(--color-forced-active)}}:root{--space-0: 0;--space-px: 1px;--space-0-5: .125rem;--space-1: .25rem;--space-1-5: .375rem;--space-2: .5rem;--space-2-5: .625rem;--space-3: .75rem;--space-3-5: .875rem;--space-4: 1rem;--space-5: 1.25rem;--space-6: 1.5rem;--space-7: 1.75rem;--space-8: 2rem;--space-9: 2.25rem;--space-10: 2.5rem;--space-11: 2.75rem;--space-12: 3rem;--space-14: 3.5rem;--space-16: 4rem;--space-20: 5rem;--space-24: 6rem;--space-28: 7rem;--space-32: 8rem;--space-36: 9rem;--space-40: 10rem;--space-44: 11rem;--space-48: 12rem;--space-52: 13rem;--space-56: 14rem;--space-60: 15rem;--space-64: 16rem;--space-72: 18rem;--space-80: 20rem;--space-96: 24rem;--spacing-component-xs: var(--space-0-5);--spacing-component-sm: var(--space-1);--spacing-component-md: var(--space-2);--spacing-component-lg: var(--space-3);--spacing-component-xl: var(--space-4);--spacing-layout-xs: var(--space-1);--spacing-layout-sm: var(--space-2);--spacing-layout-md: var(--space-3);--spacing-layout-lg: var(--space-4);--spacing-layout-xl: var(--space-6);--spacing-content-xs: var(--space-2);--spacing-content-sm: var(--space-3);--spacing-content-md: var(--space-4);--spacing-content-lg: var(--space-5);--spacing-content-xl: var(--space-6);--layout-sidebar-width-expanded: 250px;--layout-sidebar-width-collapsed: 40px;--layout-header-height: 60px;--layout-header-padding: var(--space-4);--layout-content-padding: var(--space-3);--layout-content-max-width: 960px;--layout-content-gap: var(--space-2);--layout-panel-padding-block: var(--space-3);--layout-panel-padding-inline: var(--space-3);--layout-panel-gap: var(--space-2);--layout-panel-border-radius: var(--radius-none);--layout-resize-handle-width: 4px;--layout-resize-handle-hover-width: 6px;--form-field-spacing: var(--space-2);--form-group-spacing: var(--space-3);--form-section-spacing: var(--space-4);--list-item-padding-block: var(--space-1);--list-item-padding-inline: var(--space-1);--list-item-gap: var(--space-1);--list-section-gap: var(--space-3);--card-padding-block: var(--space-3);--card-padding-inline: var(--space-3);--card-gap: var(--space-2);--card-header-padding-block: var(--space-2);--card-header-padding-inline: var(--space-2);--button-padding-inline: var(--space-2);--button-padding-block: var(--space-1);--button-gap: var(--space-1);--layout-direction: ltr;--content-align-start: left;--content-align-end: right;--focus-ring-width: 2px;--focus-ring-offset: 2px;--focus-ring-style: solid;--touch-target-min: 44px;--touch-target-spacing: var(--space-2);--sr-only-clip: rect(0, 0, 0, 0);--radius-none: 0;--radius-xs: .0625rem;--radius-sm: .125rem;--radius-md: .1875rem;--radius-lg: .25rem;--radius-xl: .375rem;--radius-2xl: .5rem;--radius-3xl: .75rem;--radius-full: 9999px;--radius-button: var(--radius-sm);--radius-input: var(--radius-xs);--radius-card: var(--radius-none);--radius-panel: var(--radius-none);--radius-modal: var(--radius-sm);--radius-tooltip: var(--radius-none);--breakpoint-sm: 640px;--breakpoint-md: 768px;--breakpoint-lg: 1024px;--breakpoint-xl: 1280px;--breakpoint-2xl: 1536px;--container-sm: 640px;--container-md: 768px;--container-lg: 1024px;--container-xl: 1280px;--container-2xl: 1536px;--container-full: 100%}[data-dir=rtl]{--layout-direction: rtl;--content-align-start: right;--content-align-end: left}:root{--font-sans: Helvetica, Arial, sans-serif;--font-mono: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace;--font-serif: Georgia, "Times New Roman", Times, serif;--text-xs: .6875rem;--text-sm: .8125rem;--text-base: .875rem;--text-lg: 1rem;--text-xl: 1.125rem;--text-2xl: 1.25rem;--text-3xl: 1.5rem;--text-4xl: 1.875rem;--text-5xl: 2.25rem;--text-6xl: 3rem;--text-7xl: 3.75rem;--text-8xl: 4.5rem;--text-9xl: 6rem;--font-thin: 100;--font-extralight: 200;--font-light: 300;--font-normal: 400;--font-medium: 500;--font-semibold: 600;--font-bold: 700;--font-extrabold: 800;--font-black: 900;--leading-none: 1;--leading-tight: 1.2;--leading-snug: 1.3;--leading-normal: 1.4;--leading-relaxed: 1.5;--leading-loose: 1.6;--leading-xs: 1rem;--leading-sm: 1.25rem;--leading-base: 1.5rem;--leading-lg: 1.75rem;--leading-xl: 1.75rem;--leading-2xl: 2rem;--leading-3xl: 2.25rem;--leading-4xl: 2.5rem;--leading-5xl: 1;--leading-6xl: 1;--leading-7xl: 1;--leading-8xl: 1;--leading-9xl: 1;--tracking-tighter: -.05em;--tracking-tight: -.025em;--tracking-normal: 0em;--tracking-wide: .025em;--tracking-wider: .05em;--tracking-widest: .1em;--text-display-2xl: var(--text-5xl);--text-display-xl: var(--text-4xl);--text-display-lg: var(--text-3xl);--text-display-md: var(--text-2xl);--text-display-sm: var(--text-xl);--text-heading-2xl: var(--text-4xl);--text-heading-xl: var(--text-3xl);--text-heading-lg: var(--text-2xl);--text-heading-md: var(--text-xl);--text-heading-sm: var(--text-lg);--text-heading-xs: var(--text-base);--text-body-xl: var(--text-xl);--text-body-lg: var(--text-lg);--text-body-md: var(--text-base);--text-body-sm: var(--text-sm);--text-body-xs: var(--text-xs);--text-label-lg: var(--text-sm);--text-label-md: var(--text-xs);--text-label-sm: var(--text-xs);--button-text-lg: var(--text-base);--button-text-md: var(--text-sm);--button-text-sm: var(--text-xs);--button-font-weight: var(--font-normal);--button-letter-spacing: var(--tracking-normal);--input-text-size: var(--text-base);--input-font-weight: var(--font-normal);--input-letter-spacing: var(--tracking-normal);--input-placeholder-weight: var(--font-normal);--nav-text-size: var(--text-base);--nav-font-weight: var(--font-normal);--nav-letter-spacing: var(--tracking-normal);--sidebar-text-size: var(--text-sm);--sidebar-font-weight: var(--font-normal);--sidebar-heading-weight: var(--font-semibold);--sidebar-letter-spacing: var(--tracking-normal);--code-text-size: var(--text-sm);--code-font-family: var(--font-mono);--code-font-weight: var(--font-normal);--code-letter-spacing: var(--tracking-normal);--code-line-height: var(--leading-relaxed);--caption-text-size: var(--text-xs);--caption-font-weight: var(--font-normal);--caption-letter-spacing: var(--tracking-normal);--caption-line-height: var(--leading-normal);--text-decoration-none: none;--text-decoration-underline: underline;--text-decoration-line-through: line-through;--link-text-decoration: underline;--link-text-decoration-hover: underline;--link-underline-offset: .1em;--text-transform-none: none;--text-transform-uppercase: uppercase;--text-transform-lowercase: lowercase;--text-transform-capitalize: capitalize;--editor-font-family: var(--font-serif);--editor-text-size: var(--text-base);--editor-line-height: var(--leading-relaxed);--editor-letter-spacing: var(--tracking-normal);--editor-font-weight: var(--font-normal);--preview-font-family: var(--font-serif);--preview-text-size: var(--text-base);--preview-line-height: var(--leading-relaxed);--preview-letter-spacing: var(--tracking-normal);--metadata-font-family: var(--font-sans);--metadata-text-size: var(--text-sm);--metadata-line-height: var(--leading-normal);--metadata-label-weight: var(--font-medium)}:root{--shadow-xs: 0 1px 2px rgba(0, 0, 0, .05);--shadow-sm: 0 1px 3px rgba(0, 0, 0, .1), 0 1px 2px rgba(0, 0, 0, .06);--shadow-md: 0 4px 6px rgba(0, 0, 0, .07), 0 2px 4px rgba(0, 0, 0, .06);--shadow-lg: 0 10px 15px rgba(0, 0, 0, .1), 0 4px 6px rgba(0, 0, 0, .05);--shadow-xl: 0 20px 25px rgba(0, 0, 0, .1), 0 10px 10px rgba(0, 0, 0, .04);--shadow-2xl: 0 25px 50px rgba(0, 0, 0, .25);--shadow-inner: inset 0 2px 4px rgba(0, 0, 0, .06);--shadow-none: none;--shadow-primary: 0 4px 14px rgba(59, 130, 246, .25);--shadow-success: 0 4px 14px rgba(34, 197, 94, .25);--shadow-warning: 0 4px 14px rgba(245, 158, 11, .25);--shadow-error: 0 4px 14px rgba(239, 68, 68, .25);--shadow-focus-primary: 0 0 0 3px rgba(59, 130, 246, .1);--shadow-focus-success: 0 0 0 3px rgba(34, 197, 94, .1);--shadow-focus-warning: 0 0 0 3px rgba(245, 158, 11, .1);--shadow-focus-error: 0 0 0 3px rgba(239, 68, 68, .1);--z-base: 0;--z-raised: 10;--z-overlay: 20;--z-sticky: 30;--z-fixed: 40;--z-dropdown: 1000;--z-tooltip: 1100;--z-modal-backdrop: 1200;--z-modal: 1300;--z-popover: 1400;--z-toast: 1500;--z-loading: 1600;--z-maximum: 9999;--elevation-card-flat: var(--shadow-none);--elevation-card-raised: var(--shadow-sm);--elevation-card-floating: var(--shadow-md);--elevation-card-elevated: var(--shadow-lg);--elevation-panel-flat: var(--shadow-none);--elevation-panel-inset: var(--shadow-inner);--elevation-panel-raised: var(--shadow-sm);--elevation-panel-floating: var(--shadow-lg);--elevation-button-flat: var(--shadow-none);--elevation-button-raised: var(--shadow-sm);--elevation-button-hover: var(--shadow-md);--elevation-button-active: var(--shadow-xs);--elevation-input-flat: var(--shadow-none);--elevation-input-inset: var(--shadow-inner);--elevation-input-focus: var(--shadow-focus-primary);--elevation-nav-flat: var(--shadow-none);--elevation-nav-floating: var(--shadow-md);--elevation-nav-sticky: var(--shadow-sm);--elevation-modal-backdrop: var(--shadow-none);--elevation-modal: var(--shadow-2xl);--elevation-tooltip: var(--shadow-lg);--elevation-dropdown: var(--shadow-lg);--elevation-sidebar: var(--shadow-sm);--elevation-sidebar-floating: var(--shadow-md);--elevation-header: var(--shadow-sm);--elevation-header-floating: var(--shadow-md);--elevation-content-primary: var(--shadow-none);--elevation-content-secondary: var(--shadow-sm);--elevation-resize-handle: var(--shadow-none);--elevation-resize-handle-hover: var(--shadow-sm);--border-width-0: 0;--border-width-1: 1px;--border-width-2: 2px;--border-width-4: 4px;--border-width-8: 8px;--border-style-solid: solid;--border-style-dashed: dashed;--border-style-dotted: dotted;--border-style-none: none;--border-default: var(--border-width-1) var(--border-style-solid) var(--color-border-default);--border-strong: var(--border-width-1) var(--border-style-solid) var(--color-border-strong);--border-accent: var(--border-width-1) var(--border-style-solid) var(--color-border-accent);--border-focus: var(--border-width-2) var(--border-style-solid) var(--color-border-focus);--opacity-0: 0;--opacity-5: .05;--opacity-10: .1;--opacity-20: .2;--opacity-25: .25;--opacity-30: .3;--opacity-40: .4;--opacity-50: .5;--opacity-60: .6;--opacity-70: .7;--opacity-75: .75;--opacity-80: .8;--opacity-90: .9;--opacity-95: .95;--opacity-100: 1;--opacity-disabled: var(--opacity-50);--opacity-hover: var(--opacity-80);--opacity-loading: var(--opacity-60);--opacity-overlay: var(--opacity-50);--opacity-backdrop: var(--opacity-75)}:root{--duration-instant: 0ms;--duration-fast: .15s;--duration-normal: .25s;--duration-slow: .35s;--duration-slower: .5s;--duration-slowest: .75s;--duration-tooltip: var(--duration-fast);--duration-button-hover: var(--duration-fast);--duration-input-focus: var(--duration-fast);--duration-dropdown: var(--duration-normal);--duration-modal: var(--duration-normal);--duration-sidebar-toggle: var(--duration-normal);--duration-theme-switch: var(--duration-normal);--duration-page-transition: var(--duration-slow);--duration-loading: var(--duration-slower);--ease-linear: linear;--ease-in: cubic-bezier(.4, 0, 1, 1);--ease-out: cubic-bezier(0, 0, .2, 1);--ease-in-out: cubic-bezier(.4, 0, .2, 1);--ease-elastic: cubic-bezier(.68, -.55, .265, 1.55);--ease-bounce: cubic-bezier(.175, .885, .32, 1.275);--ease-smooth: cubic-bezier(.25, .1, .25, 1);--ease-sharp: cubic-bezier(.4, 0, .6, 1);--ease-ui-out: var(--ease-out);--ease-ui-in: var(--ease-in);--ease-ui-in-out: var(--ease-in-out);--ease-ui-smooth: var(--ease-smooth);--transition-colors: color var(--duration-fast) var(--ease-ui-out), background-color var(--duration-fast) var(--ease-ui-out), border-color var(--duration-fast) var(--ease-ui-out);--transition-opacity: opacity var(--duration-fast) var(--ease-ui-out);--transition-transform: transform var(--duration-fast) var(--ease-ui-out);--transition-shadow: box-shadow var(--duration-fast) var(--ease-ui-out);--transition-size: width var(--duration-normal) var(--ease-ui-out), height var(--duration-normal) var(--ease-ui-out);--transition-button: var(--transition-colors), var(--transition-shadow), transform var(--duration-button-hover) var(--ease-ui-out);--transition-input: var(--transition-colors), border-color var(--duration-input-focus) var(--ease-ui-out), box-shadow var(--duration-input-focus) var(--ease-ui-out);--transition-panel: var(--transition-colors), var(--transition-shadow);--transition-modal: opacity var(--duration-modal) var(--ease-ui-out), transform var(--duration-modal) var(--ease-ui-out);--transition-dropdown: opacity var(--duration-dropdown) var(--ease-ui-out), transform var(--duration-dropdown) var(--ease-ui-out);--transition-sidebar: width var(--duration-sidebar-toggle) var(--ease-ui-out);--transition-resize: all var(--duration-fast) var(--ease-ui-out);--transition-theme: background-color var(--duration-theme-switch) var(--ease-ui-out), color var(--duration-theme-switch) var(--ease-ui-out), border-color var(--duration-theme-switch) var(--ease-ui-out), box-shadow var(--duration-theme-switch) var(--ease-ui-out);--animation-spin: spin 1s linear infinite;--animation-ping: ping 1s cubic-bezier(0, 0, .2, 1) infinite;--animation-pulse: pulse 2s cubic-bezier(.4, 0, .6, 1) infinite;--animation-bounce: bounce 1s infinite;--animation-fade-in: fadeIn var(--duration-normal) var(--ease-ui-out);--animation-slide-in-up: slideInUp var(--duration-normal) var(--ease-ui-out);--animation-slide-in-down: slideInDown var(--duration-normal) var(--ease-ui-out);--animation-slide-in-left: slideInLeft var(--duration-normal) var(--ease-ui-out);--animation-slide-in-right: slideInRight var(--duration-normal) var(--ease-ui-out);--animation-scale-in: scaleIn var(--duration-normal) var(--ease-ui-out);--animation-fade-out: fadeOut var(--duration-normal) var(--ease-ui-in);--animation-slide-out-up: slideOutUp var(--duration-normal) var(--ease-ui-in);--animation-slide-out-down: slideOutDown var(--duration-normal) var(--ease-ui-in);--animation-slide-out-left: slideOutLeft var(--duration-normal) var(--ease-ui-in);--animation-slide-out-right: slideOutRight var(--duration-normal) var(--ease-ui-in);--animation-scale-out: scaleOut var(--duration-normal) var(--ease-ui-in);@media (prefers-reduced-motion: reduce){:root{--duration-fast: 50ms;--duration-normal: .1s;--duration-slow: .15s;--duration-slower: .2s;--duration-slowest: .25s;--ease-ui-out: ease;--ease-ui-in: ease;--ease-ui-in-out: ease;--ease-ui-smooth: ease;--animation-spin: none;--animation-ping: none;--animation-pulse: none;--animation-bounce: none}}--layout-transition-duration: var(--duration-normal);--layout-transition-easing: var(--ease-ui-out);--nav-transition-duration: var(--duration-fast);--nav-transition-easing: var(--ease-ui-out);--content-transition-duration: var(--duration-normal);--content-transition-easing: var(--ease-ui-out);--interactive-hover-duration: var(--duration-fast);--interactive-focus-duration: var(--duration-fast);--interactive-active-duration: var(--duration-instant)}*,*:before,*:after{transition:var(--transition-theme)}.theme-initializing *,.theme-initializing *:before,.theme-initializing *:after{transition:none!important}:root{color-scheme:light}[data-theme=dark]{color-scheme:dark}[data-theme=auto]{color-scheme:light dark}::-webkit-scrollbar-track{background:var(--color-bg-secondary)}::-webkit-scrollbar-thumb{background:var(--color-border-strong);border-radius:var(--radius-full)}::-webkit-scrollbar-thumb:hover{background:var(--color-text-tertiary)}*{scrollbar-width:thin;scrollbar-color:var(--color-border-strong) var(--color-bg-secondary)}::selection{background-color:var(--color-bg-accent);color:var(--color-text-primary)}::-moz-selection{background-color:var(--color-bg-accent);color:var(--color-text-primary)}*:focus{outline:none}*:focus-visible{outline:2px solid var(--color-border-focus);outline-offset:2px}button:focus-visible,input:focus-visible,select:focus-visible,textarea:focus-visible,[role=button]:focus-visible,[tabindex]:focus-visible{box-shadow:var(--shadow-focus-primary)}@media (prefers-contrast: high){:root{--color-text-primary: var(--color-black);--color-text-secondary: var(--color-neutral-800);--color-bg-primary: var(--color-white);--color-border-default: var(--color-neutral-900);--color-border-focus: var(--color-primary-900)}[data-theme=dark]{--color-text-primary: var(--color-white);--color-text-secondary: var(--color-neutral-200);--color-bg-primary: var(--color-black);--color-border-default: var(--color-white);--color-border-focus: var(--color-primary-300)}}@media print{*{color:#000!important;background:#fff!important;box-shadow:none!important}button,.nav,.sidebar,[role=navigation]{display:none!important}}@media (prefers-reduced-motion: reduce){*,*:before,*:after{transition:none!important;animation:none!important}*:focus-visible{transition:box-shadow .1s ease!important}}.theme-loading{visibility:hidden}.theme-loaded{visibility:visible}.theme-ready{transition:var(--transition-theme)}a:focus-visible,button:focus-visible,input:focus-visible,select:focus-visible,textarea:focus-visible,[role=button]:focus-visible,[tabindex="0"]:focus-visible{outline:2px solid var(--color-border-focus);outline-offset:2px}[data-theme=light]{--color-bg-primary: var(--color-white);--color-bg-secondary: var(--color-neutral-100);--color-bg-tertiary: var(--color-neutral-200);--color-bg-quaternary: var(--color-neutral-300);--color-bg-inverse: var(--color-neutral-900);--color-bg-accent: var(--color-primary-50);--color-bg-success: var(--color-success-50);--color-bg-warning: var(--color-warning-50);--color-bg-error: var(--color-error-50);--color-text-primary: var(--color-neutral-900);--color-text-secondary: var(--color-neutral-600);--color-text-tertiary: var(--color-neutral-500);--color-text-quaternary: var(--color-neutral-400);--color-text-inverse: var(--color-white);--color-text-accent: var(--color-primary-600);--color-text-success: var(--color-success-700);--color-text-warning: var(--color-warning-700);--color-text-error: var(--color-error-700);--color-text-link: var(--color-primary-600);--color-text-link-hover: var(--color-primary-700);--color-border-default: var(--color-neutral-200);--color-border-strong: var(--color-neutral-300);--color-border-subtle: var(--color-neutral-100);--color-border-inverse: var(--color-neutral-700);--color-border-accent: var(--color-primary-300);--color-border-success: var(--color-success-300);--color-border-warning: var(--color-warning-300);--color-border-error: var(--color-error-300);--color-border-focus: var(--color-primary-500);--color-border-hover: var(--color-neutral-300);--color-interactive-primary: var(--color-primary-600);--color-interactive-primary-hover: var(--color-primary-700);--color-interactive-primary-active: var(--color-primary-800);--color-interactive-secondary: var(--color-neutral-100);--color-interactive-secondary-hover: var(--color-neutral-200);--color-interactive-secondary-active: var(--color-neutral-300);--color-interactive-disabled: var(--color-neutral-300);--color-interactive-disabled-text: var(--color-neutral-500);--color-surface-primary: var(--color-white);--color-surface-secondary: var(--color-neutral-50);--color-surface-tertiary: var(--color-neutral-100);--color-surface-overlay: rgba(0, 0, 0, .5);--color-surface-elevated: var(--color-white);--color-sidebar-bg: var(--color-bg-secondary);--color-sidebar-border: var(--color-border-default);--color-sidebar-item-hover: var(--color-bg-tertiary);--color-sidebar-item-active: var(--color-bg-accent);--color-sidebar-text: var(--color-text-primary);--color-sidebar-text-secondary: var(--color-text-secondary);--color-button-primary-bg: var(--color-interactive-primary);--color-button-primary-bg-hover: var(--color-interactive-primary-hover);--color-button-primary-text: var(--color-text-inverse);--color-button-secondary-bg: var(--color-interactive-secondary);--color-button-secondary-bg-hover: var(--color-interactive-secondary-hover);--color-button-secondary-text: var(--color-text-primary);--color-button-secondary-border: var(--color-border-default);--color-input-bg: var(--color-bg-primary);--color-input-border: var(--color-border-default);--color-input-border-focus: var(--color-border-focus);--color-input-text: var(--color-text-primary);--color-input-placeholder: var(--color-text-tertiary);--color-status-success: var(--color-success-600);--color-status-warning: var(--color-warning-600);--color-status-error: var(--color-error-600);--color-status-info: var(--color-primary-600);--color-focus: var(--color-primary-600);--color-focus-ring: var(--color-primary-500);--color-error-text: #dc2626;--color-error-bg: #fef2f2;--color-success-text: #166534;--color-success-bg: #f0fdf4;--color-warning-text: #92400e;--color-warning-bg: #fffbeb;--color-surface-disabled: var(--color-neutral-100);--color-text-disabled: var(--color-neutral-400);--color-surface-hover: var(--color-neutral-50);--shadow-xs: 0 1px 2px rgba(0, 0, 0, .05);--shadow-sm: 0 1px 3px rgba(0, 0, 0, .1), 0 1px 2px rgba(0, 0, 0, .06);--shadow-md: 0 4px 6px rgba(0, 0, 0, .07), 0 2px 4px rgba(0, 0, 0, .06);--shadow-lg: 0 10px 15px rgba(0, 0, 0, .1), 0 4px 6px rgba(0, 0, 0, .05);--shadow-xl: 0 20px 25px rgba(0, 0, 0, .1), 0 10px 10px rgba(0, 0, 0, .04);--shadow-2xl: 0 25px 50px rgba(0, 0, 0, .25);--shadow-inner: inset 0 2px 4px rgba(0, 0, 0, .06);--shadow-primary: 0 4px 14px rgba(59, 130, 246, .25);--shadow-success: 0 4px 14px rgba(34, 197, 94, .25);--shadow-warning: 0 4px 14px rgba(245, 158, 11, .25);--shadow-error: 0 4px 14px rgba(239, 68, 68, .25);--shadow-focus-primary: 0 0 0 3px rgba(59, 130, 246, .1);--shadow-focus-success: 0 0 0 3px rgba(34, 197, 94, .1);--shadow-focus-warning: 0 0 0 3px rgba(245, 158, 11, .1);--shadow-focus-error: 0 0 0 3px rgba(239, 68, 68, .1);color-scheme:light}@media (prefers-color-scheme: light){:root:not([data-theme]){color-scheme:light}}[data-theme=dark]{--color-bg-primary: var(--color-neutral-900);--color-bg-secondary: var(--color-neutral-800);--color-bg-tertiary: var(--color-neutral-700);--color-bg-quaternary: var(--color-neutral-600);--color-bg-inverse: var(--color-neutral-50);--color-bg-accent: var(--color-primary-950);--color-bg-success: var(--color-success-950);--color-bg-warning: var(--color-warning-950);--color-bg-error: var(--color-error-950);--color-text-primary: var(--color-neutral-50);--color-text-secondary: var(--color-neutral-300);--color-text-tertiary: var(--color-neutral-400);--color-text-quaternary: var(--color-neutral-500);--color-text-inverse: var(--color-neutral-900);--color-text-accent: var(--color-primary-400);--color-text-success: var(--color-success-400);--color-text-warning: var(--color-warning-400);--color-text-error: var(--color-error-400);--color-text-link: var(--color-primary-400);--color-text-link-hover: var(--color-primary-300);--color-border-default: var(--color-neutral-700);--color-border-strong: var(--color-neutral-600);--color-border-subtle: var(--color-neutral-800);--color-border-inverse: var(--color-neutral-300);--color-border-accent: var(--color-primary-600);--color-border-success: var(--color-success-600);--color-border-warning: var(--color-warning-600);--color-border-error: var(--color-error-600);--color-border-focus: var(--color-primary-400);--color-border-hover: var(--color-neutral-600);--color-interactive-primary: var(--color-primary-500);--color-interactive-primary-hover: var(--color-primary-400);--color-interactive-primary-active: var(--color-primary-600);--color-interactive-secondary: var(--color-neutral-800);--color-interactive-secondary-hover: var(--color-neutral-700);--color-interactive-secondary-active: var(--color-neutral-600);--color-interactive-disabled: var(--color-neutral-700);--color-interactive-disabled-text: var(--color-neutral-500);--color-surface-primary: var(--color-neutral-900);--color-surface-secondary: var(--color-neutral-800);--color-surface-tertiary: var(--color-neutral-700);--color-surface-overlay: rgba(0, 0, 0, .8);--color-surface-elevated: var(--color-neutral-800);--color-sidebar-bg: var(--color-neutral-900);--color-sidebar-border: var(--color-neutral-700);--color-sidebar-item-hover: var(--color-neutral-800);--color-sidebar-item-active: var(--color-neutral-700);--color-sidebar-text: var(--color-neutral-100);--color-sidebar-text-secondary: var(--color-neutral-400);--color-button-primary-bg: var(--color-primary-600);--color-button-primary-bg-hover: var(--color-primary-500);--color-button-primary-text: var(--color-white);--color-button-secondary-bg: var(--color-neutral-800);--color-button-secondary-bg-hover: var(--color-neutral-700);--color-button-secondary-text: var(--color-neutral-100);--color-button-secondary-border: var(--color-neutral-600);--color-input-bg: var(--color-neutral-800);--color-input-border: var(--color-neutral-600);--color-input-border-focus: var(--color-primary-400);--color-input-text: var(--color-neutral-100);--color-input-placeholder: var(--color-neutral-400);--color-status-success: var(--color-success-400);--color-status-warning: var(--color-warning-400);--color-status-error: var(--color-error-400);--color-status-info: var(--color-primary-400);--color-focus: var(--color-primary-400);--color-focus-ring: var(--color-primary-300);--color-error-text: #fca5a5;--color-error-bg: var(--color-error-950);--color-success-text: #86efac;--color-success-bg: var(--color-success-950);--color-warning-text: #fcd34d;--color-warning-bg: var(--color-warning-950);--color-surface-disabled: var(--color-neutral-800);--color-text-disabled: var(--color-neutral-500);--color-surface-hover: var(--color-neutral-700);--shadow-xs: 0 1px 2px rgba(0, 0, 0, .3);--shadow-sm: 0 1px 3px rgba(0, 0, 0, .4), 0 1px 2px rgba(0, 0, 0, .3);--shadow-md: 0 4px 6px rgba(0, 0, 0, .4), 0 2px 4px rgba(0, 0, 0, .3);--shadow-lg: 0 10px 15px rgba(0, 0, 0, .4), 0 4px 6px rgba(0, 0, 0, .2);--shadow-xl: 0 20px 25px rgba(0, 0, 0, .4), 0 10px 10px rgba(0, 0, 0, .2);--shadow-2xl: 0 25px 50px rgba(0, 0, 0, .6);--shadow-inner: inset 0 2px 4px rgba(0, 0, 0, .4);--shadow-primary: 0 4px 14px rgba(59, 130, 246, .4);--shadow-success: 0 4px 14px rgba(34, 197, 94, .4);--shadow-warning: 0 4px 14px rgba(245, 158, 11, .4);--shadow-error: 0 4px 14px rgba(239, 68, 68, .4);--shadow-focus-primary: 0 0 0 3px rgba(96, 165, 250, .3);--shadow-focus-success: 0 0 0 3px rgba(74, 222, 128, .3);--shadow-focus-warning: 0 0 0 3px rgba(251, 191, 36, .3);--shadow-focus-error: 0 0 0 3px rgba(248, 113, 113, .3)}@media (prefers-color-scheme: dark){:root:not([data-theme]){--color-bg-primary: var(--color-neutral-900);--color-bg-secondary: var(--color-neutral-800);--color-bg-tertiary: var(--color-neutral-700);--color-bg-quaternary: var(--color-neutral-600);--color-bg-inverse: var(--color-neutral-50);--color-bg-accent: var(--color-primary-950);--color-bg-success: var(--color-success-950);--color-bg-warning: var(--color-warning-950);--color-bg-error: var(--color-error-950);--color-text-primary: var(--color-neutral-50);--color-text-secondary: var(--color-neutral-300);--color-text-tertiary: var(--color-neutral-400);--color-text-quaternary: var(--color-neutral-500);--color-text-inverse: var(--color-neutral-900);--color-text-accent: var(--color-primary-400);--color-text-success: var(--color-success-400);--color-text-warning: var(--color-warning-400);--color-text-error: var(--color-error-400);--color-text-link: var(--color-primary-400);--color-text-link-hover: var(--color-primary-300);--color-border-default: var(--color-neutral-700);--color-border-strong: var(--color-neutral-600);--color-border-subtle: var(--color-neutral-800);--color-border-inverse: var(--color-neutral-300);--color-border-accent: var(--color-primary-600);--color-border-success: var(--color-success-600);--color-border-warning: var(--color-warning-600);--color-border-error: var(--color-error-600);--color-border-focus: var(--color-primary-400);color-scheme:dark}}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.inline-grid{display:inline-grid}.table{display:table}.table-cell{display:table-cell}.table-row{display:table-row}.hidden{display:none}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0}.inset-auto{inset:auto}.inset-inline-0{inset-inline:0}.inset-inline-auto{inset-inline:auto}.inset-block-0{inset-block:0}.inset-block-auto{inset-block:auto}.start-0{inset-inline-start:0}.start-auto{inset-inline-start:auto}.end-0{inset-inline-end:0}.end-auto{inset-inline-end:auto}.top-0{inset-block-start:0}.top-auto{inset-block-start:auto}.bottom-0{inset-block-end:0}.bottom-auto{inset-block-end:auto}.flex-row{flex-direction:row}.flex-row-reverse{flex-direction:row-reverse}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.flex-wrap-reverse{flex-wrap:wrap-reverse}.flex-nowrap{flex-wrap:nowrap}.flex-1{flex:1 1 0%}.flex-auto{flex:1 1 auto}.flex-initial{flex:0 1 auto}.flex-none{flex:none}.flex-grow{flex-grow:1}.flex-grow-0{flex-grow:0}.flex-shrink{flex-shrink:1}.flex-shrink-0{flex-shrink:0}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.justify-evenly{justify-content:space-evenly}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-baseline{align-items:baseline}.items-stretch{align-items:stretch}.content-start{align-content:flex-start}.content-end{align-content:flex-end}.content-center{align-content:center}.content-between{align-content:space-between}.content-around{align-content:space-around}.content-evenly{align-content:space-evenly}.self-auto{align-self:auto}.self-start{align-self:flex-start}.self-end{align-self:flex-end}.self-center{align-self:center}.self-stretch{align-self:stretch}.self-baseline{align-self:baseline}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.grid-cols-none{grid-template-columns:none}.grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))}.grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))}.grid-rows-6{grid-template-rows:repeat(6,minmax(0,1fr))}.grid-rows-none{grid-template-rows:none}.col-auto{grid-column:auto}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.col-span-3{grid-column:span 3 / span 3}.col-span-4{grid-column:span 4 / span 4}.col-span-5{grid-column:span 5 / span 5}.col-span-6{grid-column:span 6 / span 6}.col-span-full{grid-column:1 / -1}.row-auto{grid-row:auto}.row-span-1{grid-row:span 1 / span 1}.row-span-2{grid-row:span 2 / span 2}.row-span-3{grid-row:span 3 / span 3}.row-span-4{grid-row:span 4 / span 4}.row-span-5{grid-row:span 5 / span 5}.row-span-6{grid-row:span 6 / span 6}.row-span-full{grid-row:1 / -1}.gap-0{gap:0}.gap-1{gap:var(--space-1)}.gap-2{gap:var(--space-2)}.gap-3{gap:var(--space-3)}.gap-4{gap:var(--space-4)}.gap-5{gap:var(--space-5)}.gap-6{gap:var(--space-6)}.gap-8{gap:var(--space-8)}.gap-10{gap:var(--space-10)}.gap-12{gap:var(--space-12)}.gap-x-0{column-gap:0}.gap-x-1{column-gap:var(--space-1)}.gap-x-2{column-gap:var(--space-2)}.gap-x-3{column-gap:var(--space-3)}.gap-x-4{column-gap:var(--space-4)}.gap-x-5{column-gap:var(--space-5)}.gap-x-6{column-gap:var(--space-6)}.gap-x-8{column-gap:var(--space-8)}.gap-y-0{row-gap:0}.gap-y-1{row-gap:var(--space-1)}.gap-y-2{row-gap:var(--space-2)}.gap-y-3{row-gap:var(--space-3)}.gap-y-4{row-gap:var(--space-4)}.gap-y-5{row-gap:var(--space-5)}.gap-y-6{row-gap:var(--space-6)}.gap-y-8{row-gap:var(--space-8)}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-clip{overflow:clip}.overflow-visible{overflow:visible}.overflow-scroll{overflow:scroll}.overflow-x-auto{overflow-x:auto}.overflow-x-hidden{overflow-x:hidden}.overflow-x-clip{overflow-x:clip}.overflow-x-visible{overflow-x:visible}.overflow-x-scroll{overflow-x:scroll}.overflow-y-auto{overflow-y:auto}.overflow-y-hidden{overflow-y:hidden}.overflow-y-clip{overflow-y:clip}.overflow-y-visible{overflow-y:visible}.overflow-y-scroll{overflow-y:scroll}.container{width:100%;margin-left:auto;margin-right:auto}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.box-border{box-sizing:border-box}.box-content{box-sizing:content-box}.float-start{float:inline-start}.float-end{float:inline-end}.float-none{float:none}.clear-start{clear:inline-start}.clear-end{clear:inline-end}.clear-both{clear:both}.clear-none{clear:none}.isolate{isolation:isolate}.isolation-auto{isolation:auto}.object-contain{object-fit:contain}.object-cover{object-fit:cover}.object-fill{object-fit:fill}.object-none{object-fit:none}.object-scale-down{object-fit:scale-down}.object-bottom{object-position:bottom}.object-center{object-position:center}.object-start{object-position:left}.object-start-bottom{object-position:left bottom}.object-start-top{object-position:left top}.object-end{object-position:right}.object-end-bottom{object-position:right bottom}.object-end-top{object-position:right top}.object-top{object-position:top}[data-dir=rtl] .object-start{object-position:right}[data-dir=rtl] .object-start-bottom{object-position:right bottom}[data-dir=rtl] .object-start-top{object-position:right top}[data-dir=rtl] .object-end{object-position:left}[data-dir=rtl] .object-end-bottom{object-position:left bottom}[data-dir=rtl] .object-end-top{object-position:left top}.text-start{text-align:start}.text-end{text-align:end}.text-center{text-align:center}.text-justify{text-align:justify}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:var(--sr-only-clip);white-space:nowrap;border:0}.sr-only-focusable:focus,.sr-only-focusable:active{position:static;width:auto;height:auto;padding:inherit;margin:inherit;overflow:visible;clip:auto;white-space:inherit}.focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.touch-target{min-width:var(--touch-target-min);min-height:var(--touch-target-min)}.m-0{margin:0}.m-1{margin:var(--space-1)}.m-2{margin:var(--space-2)}.m-3{margin:var(--space-3)}.m-4{margin:var(--space-4)}.m-5{margin:var(--space-5)}.m-6{margin:var(--space-6)}.m-8{margin:var(--space-8)}.m-auto{margin:auto}.mx-0{margin-inline:0}.mx-1{margin-inline:var(--space-1)}.mx-2{margin-inline:var(--space-2)}.mx-3{margin-inline:var(--space-3)}.mx-4{margin-inline:var(--space-4)}.mx-5{margin-inline:var(--space-5)}.mx-6{margin-inline:var(--space-6)}.mx-8{margin-inline:var(--space-8)}.mx-auto{margin-inline:auto}.my-0{margin-block:0}.my-1{margin-block:var(--space-1)}.my-2{margin-block:var(--space-2)}.my-3{margin-block:var(--space-3)}.my-4{margin-block:var(--space-4)}.my-5{margin-block:var(--space-5)}.my-6{margin-block:var(--space-6)}.my-8{margin-block:var(--space-8)}.my-auto{margin-block:auto}.ms-0{margin-inline-start:0}.ms-1{margin-inline-start:var(--space-1)}.ms-2{margin-inline-start:var(--space-2)}.ms-3{margin-inline-start:var(--space-3)}.ms-4{margin-inline-start:var(--space-4)}.ms-5{margin-inline-start:var(--space-5)}.ms-6{margin-inline-start:var(--space-6)}.ms-8{margin-inline-start:var(--space-8)}.ms-auto{margin-inline-start:auto}.me-0{margin-inline-end:0}.me-1{margin-inline-end:var(--space-1)}.me-2{margin-inline-end:var(--space-2)}.me-3{margin-inline-end:var(--space-3)}.me-4{margin-inline-end:var(--space-4)}.me-5{margin-inline-end:var(--space-5)}.me-6{margin-inline-end:var(--space-6)}.me-8{margin-inline-end:var(--space-8)}.me-auto{margin-inline-end:auto}.mt-0{margin-block-start:0}.mt-1{margin-block-start:var(--space-1)}.mt-2{margin-block-start:var(--space-2)}.mt-3{margin-block-start:var(--space-3)}.mt-4{margin-block-start:var(--space-4)}.mt-5{margin-block-start:var(--space-5)}.mt-6{margin-block-start:var(--space-6)}.mt-8{margin-block-start:var(--space-8)}.mt-auto{margin-block-start:auto}.mb-0{margin-block-end:0}.mb-1{margin-block-end:var(--space-1)}.mb-2{margin-block-end:var(--space-2)}.mb-3{margin-block-end:var(--space-3)}.mb-4{margin-block-end:var(--space-4)}.mb-5{margin-block-end:var(--space-5)}.mb-6{margin-block-end:var(--space-6)}.mb-8{margin-block-end:var(--space-8)}.mb-auto{margin-block-end:auto}.p-0{padding:0}.p-1{padding:var(--space-1)}.p-2{padding:var(--space-2)}.p-3{padding:var(--space-3)}.p-4{padding:var(--space-4)}.p-5{padding:var(--space-5)}.p-6{padding:var(--space-6)}.p-8{padding:var(--space-8)}.px-0{padding-inline:0}.px-1{padding-inline:var(--space-1)}.px-2{padding-inline:var(--space-2)}.px-3{padding-inline:var(--space-3)}.px-4{padding-inline:var(--space-4)}.px-5{padding-inline:var(--space-5)}.px-6{padding-inline:var(--space-6)}.px-8{padding-inline:var(--space-8)}.py-0{padding-block:0}.py-1{padding-block:var(--space-1)}.py-2{padding-block:var(--space-2)}.py-3{padding-block:var(--space-3)}.py-4{padding-block:var(--space-4)}.py-5{padding-block:var(--space-5)}.py-6{padding-block:var(--space-6)}.py-8{padding-block:var(--space-8)}.ps-0{padding-inline-start:0}.ps-1{padding-inline-start:var(--space-1)}.ps-2{padding-inline-start:var(--space-2)}.ps-3{padding-inline-start:var(--space-3)}.ps-4{padding-inline-start:var(--space-4)}.ps-5{padding-inline-start:var(--space-5)}.ps-6{padding-inline-start:var(--space-6)}.ps-8{padding-inline-start:var(--space-8)}.pe-0{padding-inline-end:0}.pe-1{padding-inline-end:var(--space-1)}.pe-2{padding-inline-end:var(--space-2)}.pe-3{padding-inline-end:var(--space-3)}.pe-4{padding-inline-end:var(--space-4)}.pe-5{padding-inline-end:var(--space-5)}.pe-6{padding-inline-end:var(--space-6)}.pe-8{padding-inline-end:var(--space-8)}.pt-0{padding-block-start:0}.pt-1{padding-block-start:var(--space-1)}.pt-2{padding-block-start:var(--space-2)}.pt-3{padding-block-start:var(--space-3)}.pt-4{padding-block-start:var(--space-4)}.pt-5{padding-block-start:var(--space-5)}.pt-6{padding-block-start:var(--space-6)}.pt-8{padding-block-start:var(--space-8)}.pb-0{padding-block-end:0}.pb-1{padding-block-end:var(--space-1)}.pb-2{padding-block-end:var(--space-2)}.pb-3{padding-block-end:var(--space-3)}.pb-4{padding-block-end:var(--space-4)}.pb-5{padding-block-end:var(--space-5)}.pb-6{padding-block-end:var(--space-6)}.pb-8{padding-block-end:var(--space-8)}.input{display:block;width:100%;padding:var(--button-padding-block) var(--button-padding-inline);font-family:var(--font-sans);font-size:var(--input-text-size);font-weight:var(--input-font-weight);line-height:var(--leading-normal);color:var(--color-input-text);background-color:var(--color-input-bg);border:1px solid var(--color-input-border);border-radius:var(--radius-input);transition:border-color .15s ease-in-out}.input:focus{outline:none;border-color:var(--color-input-border-focus)}.input::placeholder{color:var(--color-input-placeholder);font-weight:var(--input-placeholder-weight)}.input-sm{padding:var(--space-0-5) var(--space-1);font-size:var(--text-xs)}.input-lg{padding:var(--space-2) var(--space-3);font-size:var(--text-lg)}.textarea{display:block;width:100%;min-height:120px;padding:var(--button-padding-block) var(--button-padding-inline);font-family:var(--font-sans);font-size:var(--input-text-size);font-weight:var(--input-font-weight);line-height:var(--leading-normal);color:var(--color-input-text);background-color:var(--color-input-bg);border:1px solid var(--color-input-border);border-radius:var(--radius-input);resize:vertical;transition:border-color .15s ease-in-out}.textarea:focus{outline:none;border-color:var(--color-input-border-focus)}.textarea::placeholder{color:var(--color-input-placeholder);font-weight:var(--input-placeholder-weight)}.select{display:block;width:100%;padding:var(--button-padding-block) var(--button-padding-inline);padding-inline-end:var(--space-6);font-family:var(--font-sans);font-size:var(--input-text-size);font-weight:var(--input-font-weight);line-height:var(--leading-normal);color:var(--color-input-text);background-color:var(--color-input-bg);background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right var(--space-2) center;background-size:1em;border:1px solid var(--color-input-border);border-radius:var(--radius-input);appearance:none;cursor:pointer;transition:border-color .15s ease-in-out}.select:focus{outline:none;border-color:var(--color-input-border-focus)}[data-dir=rtl] .select{background-position:left var(--space-2) center}.checkbox,.radio{display:inline-block;width:1rem;height:1rem;margin:0;margin-inline-end:var(--space-1);vertical-align:middle;background-color:var(--color-input-bg);border:1px solid var(--color-input-border);appearance:none;cursor:pointer;transition:all .15s ease-in-out}.checkbox{border-radius:var(--radius-xs)}.radio{border-radius:var(--radius-full)}.checkbox:checked,.radio:checked{background-color:var(--color-primary-600);border-color:var(--color-primary-600)}.checkbox:checked:after{content:"";display:block;width:100%;height:100%;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='20 6 9 17 4 12'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:center;background-size:.75rem}.radio:checked:after{content:"";display:block;width:100%;height:100%;background:#fff;border-radius:var(--radius-full);transform:scale(.4)}.checkbox:focus,.radio:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}.label{display:inline-block;margin-block-end:var(--space-1);font-size:var(--text-label-md);font-weight:var(--font-medium);color:var(--color-text-primary)}.label-required:after{content:" *";color:var(--color-error-600)}.form-group{margin-block-end:var(--form-field-spacing)}.form-section{margin-block-end:var(--form-section-spacing);padding-block-end:var(--form-section-spacing);border-block-end:1px solid var(--color-border-default)}.form-section:last-child{margin-block-end:0;padding-block-end:0;border-block-end:none}.field-help{margin-block-start:var(--space-1);font-size:var(--text-xs);color:var(--color-text-secondary)}.field-error{margin-block-start:var(--space-1);font-size:var(--text-xs);color:var(--color-error-text)}.btn{display:inline-flex;align-items:center;justify-content:center;gap:var(--button-gap);padding:var(--button-padding-block) var(--button-padding-inline);font-family:var(--font-sans);font-size:var(--button-text-md);font-weight:var(--button-font-weight);line-height:var(--leading-tight);text-align:center;text-decoration:none;color:var(--color-button-primary-text);background-color:var(--color-button-primary-bg);border:1px solid var(--color-button-primary-border);border-radius:var(--radius-button);cursor:pointer;transition:all .15s ease-in-out;user-select:none}.btn:hover{background-color:var(--color-button-primary-bg-hover)}.btn:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}.btn:disabled{opacity:.5;cursor:not-allowed}.btn-primary{color:var(--color-text-primary);background-color:var(--color-neutral-100);border-color:var(--color-neutral-400)}.btn-primary:hover{background-color:var(--color-neutral-200)}.btn-secondary{color:var(--color-button-secondary-text);background-color:var(--color-button-secondary-bg);border-color:var(--color-button-secondary-border)}.btn-secondary:hover{background-color:var(--color-button-secondary-bg-hover)}.btn-link{padding:0;color:var(--color-text-link);background-color:transparent;border:none;text-decoration:var(--link-text-decoration)}.btn-link:hover{color:var(--color-text-link-hover);text-decoration:var(--link-text-decoration-hover);background-color:transparent}.btn-sm{padding:var(--space-0-5) var(--space-1-5);font-size:var(--button-text-sm)}.btn-lg{padding:var(--space-2) var(--space-4);font-size:var(--button-text-lg)}fieldset{margin:0;padding:var(--space-3);border:1px solid var(--color-border-default);border-radius:var(--radius-md)}legend{padding-inline:var(--space-1);font-size:var(--text-sm);font-weight:var(--font-medium);color:var(--color-text-primary)}.form-inline{display:flex;flex-wrap:wrap;align-items:center;gap:var(--space-2)}.form-inline .form-group{margin-block-end:0;flex:1 1 auto}.form-inline .input,.form-inline .select{width:auto}.input-craigslist:focus,.textarea-craigslist:focus,.select-craigslist:focus{border-color:var(--color-success-600)}.btn-minimal{padding:var(--space-1) var(--space-2);color:var(--color-text-primary);background-color:var(--color-neutral-100);border:1px solid var(--color-neutral-400);border-radius:var(--radius-sm)}.btn-minimal:hover{background-color:var(--color-neutral-200)}.btn-text{padding:0;color:var(--color-text-link);background:none;border:none;text-decoration:underline;cursor:pointer}.btn-text:hover{color:var(--color-text-link-hover)}*,*:before,*:after{box-sizing:border-box}*{margin:0;padding:0}html{-webkit-text-size-adjust:none;text-size-adjust:none}:root[data-dir=rtl]{direction:rtl}:root[data-dir=ltr]{direction:ltr}body{min-height:100vh;line-height:var(--leading-normal);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:var(--font-sans);font-size:var(--text-base);color:var(--color-text-primary);background-color:var(--color-bg-secondary)}img,picture,video,canvas,svg{display:block;max-width:100%;height:auto}input,button,textarea,select{font:inherit}p,h1,h2,h3,h4,h5,h6{overflow-wrap:break-word}h1,h2,h3,h4,h5,h6{font-weight:var(--font-bold);line-height:var(--leading-tight);color:var(--color-text-primary)}h1{font-size:var(--text-heading-2xl);margin-block-end:var(--space-4)}h2{font-size:var(--text-heading-xl);margin-block-end:var(--space-3)}h3{font-size:var(--text-heading-lg);margin-block-end:var(--space-3)}h4{font-size:var(--text-heading-md);margin-block-end:var(--space-2)}h5{font-size:var(--text-heading-sm);margin-block-end:var(--space-2)}h6{font-size:var(--text-heading-xs);margin-block-end:var(--space-2)}p{margin-block-end:var(--space-3)}p:last-child{margin-block-end:0}a{color:var(--color-text-link);text-decoration:var(--link-text-decoration);text-underline-offset:var(--link-underline-offset);transition:color .15s ease-in-out}a:hover{color:var(--color-text-link-hover);text-decoration:var(--link-text-decoration-hover)}a:visited{color:var(--color-text-link-visited)}a:focus{outline:2px solid var(--color-focus);outline-offset:2px}ul,ol{margin-block-end:var(--space-3);padding-inline-start:var(--space-5)}ul ul,ul ol,ol ul,ol ol{margin-block-end:0}li{margin-block-end:var(--space-1)}li:last-child{margin-block-end:0}table{width:100%;border-collapse:collapse;margin-block-end:var(--space-4)}th,td{padding:var(--space-2);text-align:start;border-block-end:1px solid var(--color-border-default)}th{font-weight:var(--font-semibold);background-color:var(--color-bg-tertiary)}code,kbd,samp,pre{font-family:var(--font-mono);font-size:var(--code-text-size)}code{padding:var(--space-0-5) var(--space-1);background-color:var(--color-bg-tertiary);border-radius:var(--radius-xs)}pre{overflow-x:auto;padding:var(--space-3);margin-block-end:var(--space-4);background-color:var(--color-bg-tertiary);border-radius:var(--radius-sm)}pre code{padding:0;background-color:transparent}blockquote{padding-inline-start:var(--space-4);margin-block-end:var(--space-4);border-inline-start:3px solid var(--color-border-strong);color:var(--color-text-secondary)}hr{height:0;margin-block:var(--space-6);border:0;border-block-start:1px solid var(--color-border-default)}:focus-visible{outline:2px solid var(--color-focus);outline-offset:2px}::selection{background-color:var(--color-primary-200);color:var(--color-text-primary)}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:var(--color-bg-tertiary)}::-webkit-scrollbar-thumb{background:var(--color-neutral-400);border-radius:var(--radius-sm)}::-webkit-scrollbar-thumb:hover{background:var(--color-neutral-500)}.skip-link{position:absolute;top:-40px;left:0;padding:var(--space-2) var(--space-4);background:var(--color-bg-primary);color:var(--color-text-link);text-decoration:none;z-index:100}.skip-link:focus{top:0}@media (prefers-reduced-motion: reduce){*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}#app{margin:0;padding:0;width:100vw;height:100vh;overflow:hidden;display:flex;flex-direction:column}body:not(.sb-show-main){overflow:hidden}html{height:100%}html,body{margin:0;padding:0}.theme-toggle.svelte-v7l3jb{display:inline-flex;align-items:center;gap:var(--space-2);padding-block:var(--space-2);padding-inline:var(--space-3);background-color:var(--color-bg-secondary);color:var(--color-text-primary);border:1px solid var(--color-border-default);border-radius:var(--radius-md);font-family:var(--font-sans);font-size:var(--text-sm);font-weight:var(--font-medium);cursor:pointer;transition:all var(--duration-fast) ease;outline:none;min-inline-size:var(--touch-target-min);min-block-size:var(--touch-target-min)}.theme-toggle.svelte-v7l3jb:hover{background-color:var(--color-bg-tertiary);border-color:var(--color-border-hover);transform:translateY(-1px);box-shadow:var(--shadow-sm)}.theme-toggle.svelte-v7l3jb:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.theme-toggle.svelte-v7l3jb:active{transform:translateY(0);box-shadow:none}.theme-toggle--small.svelte-v7l3jb{padding-block:var(--space-1);padding-inline:var(--space-2);font-size:var(--text-xs);gap:var(--space-1)}.theme-toggle--large.svelte-v7l3jb{padding-block:var(--space-3);padding-inline:var(--space-4);font-size:var(--text-base);gap:var(--space-3)}.theme-toggle__icon.svelte-v7l3jb{display:flex;align-items:center;justify-content:center;inline-size:1.2em;block-size:1.2em;flex-shrink:0}.theme-toggle__icon.svelte-v7l3jb svg:where(.svelte-v7l3jb){inline-size:100%;block-size:100%}.theme-toggle__label.svelte-v7l3jb{white-space:nowrap}.theme-toggle--small.svelte-v7l3jb .theme-toggle__icon:where(.svelte-v7l3jb){inline-size:1em;block-size:1em}.theme-toggle--large.svelte-v7l3jb .theme-toggle__icon:where(.svelte-v7l3jb){inline-size:1.4em;block-size:1.4em}@media (prefers-contrast: high){.theme-toggle.svelte-v7l3jb{border:2px solid var(--color-forced-border)}.theme-toggle.svelte-v7l3jb:focus-visible{outline:3px solid var(--color-forced-active)}}@media (prefers-reduced-motion: reduce){.theme-toggle.svelte-v7l3jb{transition:none}.theme-toggle.svelte-v7l3jb:hover,.theme-toggle.svelte-v7l3jb:active{transform:none}}.sidebar.svelte-trxc5p{--sidebar-width: 250px;--sidebar-collapsed-width: 48px;inline-size:100%;background:var(--color-sidebar-bg);display:flex;flex-direction:column;overflow-x:visible;overflow-y:hidden;block-size:100vh;position:relative}.sidebar.collapsed.svelte-trxc5p{inline-size:100%}.sidebar-header.svelte-trxc5p{display:flex;align-items:center;padding-block:var(--space-1);padding-inline:var(--space-2);border-block-end:1px solid var(--color-border-default);background:var(--color-bg-primary);flex-shrink:0;min-block-size:var(--touch-target-min)}.sidebar-toggle.svelte-trxc5p{background:none;border:none;font-size:var(--text-lg);cursor:pointer;padding-block:var(--space-2);padding-inline:var(--space-2);border-radius:var(--radius-sm);transition:background-color var(--duration-fast) ease;display:flex;align-items:center;justify-content:center;inline-size:32px;block-size:32px;min-inline-size:var(--touch-target-min);min-block-size:var(--touch-target-min)}.sidebar-toggle.svelte-trxc5p:hover{background:var(--color-interactive-secondary-hover)}.sidebar-toggle.svelte-trxc5p:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.sidebar-title.svelte-trxc5p{margin:0;margin-inline-start:var(--space-2);font-size:var(--text-sm);color:var(--color-text-secondary);flex:1}.header-actions.svelte-trxc5p{display:flex;align-items:center;gap:var(--space-1);margin-inline-start:var(--space-2)}.header-actions.compact.svelte-trxc5p{margin-inline-start:0;justify-content:center}.sidebar-main.svelte-trxc5p{flex:1;overflow-y:auto;overflow-x:visible;display:flex;flex-direction:column;background:var(--color-bg-secondary)}.sidebar-nav.svelte-trxc5p{padding-block:0;padding-inline:0;flex-shrink:0}.sidebar-footer.svelte-trxc5p{flex-shrink:0;background:var(--color-bg-secondary);border-top:1px solid var(--color-border-default)}.sidebar-section.svelte-trxc5p{inline-size:100%;background:transparent;border:none;display:flex;align-items:center;padding-block:var(--space-2);padding-inline:var(--space-2);cursor:pointer;transition:background-color .1s ease;text-align:start;color:var(--color-text-link);min-block-size:var(--touch-target-min);font-size:var(--text-sm);outline:none;position:relative}.sidebar-section.svelte-trxc5p:hover{text-decoration:underline}.sidebar-section.svelte-trxc5p:hover:not(.active){background:var(--color-bg-tertiary)}.sidebar-section.svelte-trxc5p:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset);z-index:1}.sidebar .sidebar-section.active{background:var(--color-bg-primary)!important;color:var(--color-text-primary)!important;font-weight:var(--font-normal)!important;border-top:1px solid var(--color-border-default)!important;border-bottom:1px solid var(--color-border-default)!important;border-right:1px solid var(--color-bg-primary)!important;margin-inline-end:-1px!important;position:relative!important;z-index:1!important}.sidebar .sidebar-section.active .section-label{text-decoration:none!important}.spine-section-header.svelte-trxc5p{display:flex;align-items:center;justify-content:space-between;padding-block:var(--space-2);padding-inline:var(--space-2);min-block-size:var(--touch-target-min);color:var(--color-text-primary);background:transparent}.spine-section-header.svelte-trxc5p .section-label:where(.svelte-trxc5p){font-size:var(--text-sm);font-weight:var(--font-normal)}.spine-section-header.compact.svelte-trxc5p{justify-content:center;flex-direction:column;gap:var(--space-1);padding-block:var(--space-1)}.spine-section-header.compact.svelte-trxc5p .section-label:where(.svelte-trxc5p){font-size:var(--text-xs);text-align:center}.append-button-nav.svelte-trxc5p{display:flex;align-items:center;justify-content:center;inline-size:var(--touch-target-min);block-size:var(--touch-target-min);border:none;background:var(--color-bg-primary);border-radius:var(--radius-xs);cursor:pointer;font-size:var(--text-sm);color:var(--color-text-secondary);transition:all var(--duration-fast) ease}.append-button-nav.svelte-trxc5p:hover{background:var(--color-bg-tertiary);color:var(--color-text-primary)}.append-button-nav.svelte-trxc5p:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset);z-index:1}.append-button-nav.compact.svelte-trxc5p{inline-size:var(--touch-target-min);block-size:var(--touch-target-min);font-size:var(--text-xs)}.append-icon.svelte-trxc5p{font-size:var(--text-sm);font-weight:var(--font-medium)}.spine-items-container.svelte-trxc5p{flex:1}.section-label.svelte-trxc5p{font-size:var(--text-base);font-weight:var(--font-normal)}.sidebar.collapsed.svelte-trxc5p .section-label:where(.svelte-trxc5p){font-size:var(--text-xs);text-align:center;font-weight:var(--font-medium)}.sidebar.collapsed.svelte-trxc5p .sidebar-section:where(.svelte-trxc5p){justify-content:center;padding-inline:var(--space-1)}.sidebar-main.svelte-trxc5p::-webkit-scrollbar{inline-size:6px}.sidebar-main.svelte-trxc5p::-webkit-scrollbar-track{background:var(--color-bg-secondary)}.sidebar-main.svelte-trxc5p::-webkit-scrollbar-thumb{background:var(--color-border-strong);border-radius:var(--radius-xs)}.sidebar-main.svelte-trxc5p::-webkit-scrollbar-thumb:hover{background:var(--color-text-tertiary)}.sidebar.svelte-trxc5p{--sidebar-width: 250px}.sidebar.collapsed.svelte-trxc5p{--sidebar-width: 48px}@media (prefers-contrast: high){.sidebar.svelte-trxc5p{border-inline-end:2px solid var(--color-forced-border)}.sidebar-header.svelte-trxc5p{border-block-end:2px solid var(--color-forced-border)}.sidebar-section.active.svelte-trxc5p{border-inline-end:4px solid var(--color-forced-active)}}[dir=rtl] .sidebar-toggle.svelte-trxc5p{transform:scaleX(-1)}.sidebar-section.svelte-trxc5p:disabled{opacity:.5;cursor:not-allowed;color:var(--color-text-disabled, var(--color-text-tertiary))}.sidebar-section.svelte-trxc5p:disabled:hover{text-decoration:none;background:transparent}.append-button-nav.svelte-trxc5p:disabled{opacity:.5;cursor:not-allowed;background:var(--color-bg-primary);color:var(--color-text-disabled, var(--color-text-tertiary))}.append-button-nav.svelte-trxc5p:disabled:hover{background:var(--color-bg-primary);color:var(--color-text-disabled, var(--color-text-tertiary))}.workspace-title-section.svelte-trxc5p{border-top:1px solid var(--color-border-default);border-bottom:1px solid var(--color-border-default);background:var(--color-bg-tertiary);margin-block:var(--space-2)}.workspace-title-header.svelte-trxc5p{display:flex;align-items:center;gap:var(--space-2);padding-block:var(--space-3);padding-inline:var(--space-2);min-block-size:var(--touch-target-min);overflow:hidden}.workspace-title-header.compact.svelte-trxc5p{justify-content:center;flex-direction:column;gap:var(--space-1);padding-block:var(--space-2)}.workspace-title.svelte-trxc5p{margin:0;font-size:var(--text-sm);font-weight:var(--font-bold);color:var(--color-text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;min-width:0}.workspace-title-compact.svelte-trxc5p{font-size:var(--text-xs);font-weight:var(--font-medium);color:var(--color-text-primary);text-align:center}.workspace-extensions.svelte-trxc5p{font-size:var(--text-xs);color:var(--color-text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-shrink:1;min-width:0}.extensions-indicator.svelte-trxc5p{font-size:var(--text-xs);color:var(--color-text-secondary);text-align:center;margin-block-start:var(--space-1)}.app-layout.svelte-4h1481{display:grid;height:100vh;width:100vw;margin:0;padding:0}.main-content.svelte-4h1481{min-inline-size:0;overflow:hidden}.pane-content.svelte-4h1481{flex:1;overflow:auto;background:var(--color-bg-primary);height:100%}.single-pane-container.svelte-4h1481{height:100%;overflow:auto;background:var(--color-bg-primary)}[data-pane-resizer]{background:var(--color-border-default);inline-size:4px;cursor:col-resize;transition:background-color var(--duration-fast) ease}[data-pane-resizer]:hover{background:var(--color-border-strong)}[data-pane-resizer][data-resize-handle-active]{background:var(--color-border-accent)}[data-pane-resizer]:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}@media (prefers-contrast: high){.main-content.svelte-4h1481{border-inline-start:2px solid var(--color-forced-border)}}.about-view.svelte-jmnys0{height:100%;overflow:auto;padding:var(--space-4);background:var(--color-bg-primary)}.about-content.svelte-jmnys0{max-width:800px;margin:0 auto}.about-header.svelte-jmnys0{text-align:center;margin-bottom:var(--space-6);padding-bottom:var(--space-4);border-bottom:1px solid var(--color-border-default)}.app-title.svelte-jmnys0{font-size:var(--text-3xl);font-weight:var(--font-bold);color:var(--color-text-primary);margin:0 0 var(--space-2) 0}.app-version.svelte-jmnys0{font-size:var(--text-sm);color:var(--color-text-tertiary);margin:0}.about-section.svelte-jmnys0{margin-bottom:var(--space-6)}.about-section.svelte-jmnys0 h2:where(.svelte-jmnys0){font-size:var(--text-xl);font-weight:var(--font-semibold);color:var(--color-text-primary);margin:0 0 var(--space-3) 0;border-bottom:1px solid var(--color-border-subtle);padding-bottom:var(--space-1)}.about-section.svelte-jmnys0 p:where(.svelte-jmnys0){font-size:var(--text-base);line-height:1.6;color:var(--color-text-secondary);margin:0 0 var(--space-3) 0}.external-link.svelte-jmnys0{color:var(--color-text-link);text-decoration:underline}.external-link.svelte-jmnys0:hover{color:var(--color-text-link-hover)}.license-text.svelte-jmnys0{background:var(--color-bg-secondary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:var(--space-3);font-family:var(--font-mono);font-size:var(--text-sm);line-height:1.5;color:var(--color-text-primary);white-space:pre-wrap;overflow-x:auto;overflow-y:auto}@media (max-width: 640px){.about-view.svelte-jmnys0{padding:var(--space-3)}.app-title.svelte-jmnys0{font-size:var(--text-2xl)}}@media (prefers-contrast: high){.license-text.svelte-jmnys0{border-width:2px}}@media (prefers-reduced-motion: reduce){.about-view.svelte-jmnys0{scroll-behavior:auto}}.thirdparty-view.svelte-3a2w4e{height:100%;overflow:auto;padding:var(--space-4);background:var(--color-bg-primary)}.thirdparty-content.svelte-3a2w4e{max-width:800px;margin:0 auto}.thirdparty-header.svelte-3a2w4e{text-align:center;margin-bottom:var(--space-6);padding-bottom:var(--space-4);border-bottom:1px solid var(--color-border-default)}.thirdparty-header.svelte-3a2w4e h1:where(.svelte-3a2w4e){font-size:var(--text-2xl);font-weight:var(--font-bold);color:var(--color-text-primary);margin:0 0 var(--space-3) 0}.thirdparty-intro.svelte-3a2w4e{font-size:var(--text-base);line-height:1.6;color:var(--color-text-secondary);margin:0}.libraries-section.svelte-3a2w4e{margin-bottom:var(--space-6)}.external-link.svelte-3a2w4e{color:var(--color-text-link);text-decoration:underline}.external-link.svelte-3a2w4e:hover{color:var(--color-text-link-hover)}.license-text.svelte-3a2w4e{background:var(--color-bg-secondary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:var(--space-3);font-family:var(--font-mono);font-size:var(--text-sm);line-height:1.5;color:var(--color-text-primary);white-space:pre-wrap;overflow-x:auto;overflow-y:auto}.library-list.svelte-3a2w4e{display:flex;flex-direction:column;gap:var(--space-4)}.library-item.svelte-3a2w4e{border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:var(--space-3);background:var(--color-bg-secondary)}.library-name.svelte-3a2w4e{font-size:var(--text-base);font-weight:var(--font-semibold);color:var(--color-text-primary);margin:0 0 var(--space-1) 0;display:flex;align-items:center;gap:var(--space-2)}.library-version.svelte-3a2w4e{font-size:var(--text-sm);font-weight:var(--font-normal);color:var(--color-text-tertiary);background:var(--color-bg-tertiary);padding:var(--space-1) var(--space-2);border-radius:var(--radius-xs)}.library-description.svelte-3a2w4e{font-size:var(--text-sm);color:var(--color-text-secondary);margin:var(--space-1) 0}.library-copyright.svelte-3a2w4e{font-size:var(--text-xs);color:var(--color-text-tertiary);margin:var(--space-1) 0 0 0;font-family:var(--font-mono)}.mit-license-section.svelte-3a2w4e{margin-top:var(--space-5);padding-top:var(--space-4);border-top:1px solid var(--color-border-subtle)}.mit-license-section.svelte-3a2w4e h3:where(.svelte-3a2w4e){font-size:var(--text-lg);font-weight:var(--font-semibold);color:var(--color-text-primary);margin:0 0 var(--space-3) 0}@media (max-width: 640px){.thirdparty-view.svelte-3a2w4e{padding:var(--space-3)}.thirdparty-header.svelte-3a2w4e h1:where(.svelte-3a2w4e){font-size:var(--text-xl)}.library-name.svelte-3a2w4e{flex-direction:column;align-items:flex-start;gap:var(--space-1)}}@media (prefers-contrast: high){.license-text.svelte-3a2w4e,.library-item.svelte-3a2w4e{border-width:2px}}@media (prefers-reduced-motion: reduce){.thirdparty-view.svelte-3a2w4e{scroll-behavior:auto}}.workspace-action-bar.svelte-4wg9d{margin-block-end:var(--space-6)}.section-title.svelte-4wg9d{margin:0 0 var(--space-4) 0;font-size:var(--text-lg);font-weight:600;color:var(--color-text-primary)}.action-buttons.svelte-4wg9d{display:grid;grid-template-columns:repeat(auto-fit,minmax(15em,1fr));gap:var(--space-4)}.action-button.svelte-4wg9d{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4);border:2px solid var(--color-border-default);border-radius:var(--radius-md);background-color:var(--color-surface-primary);color:var(--color-text-primary);font-family:inherit;cursor:pointer;transition:all var(--duration-normal) ease;text-align:left;min-height:80px;position:relative}.action-button.svelte-4wg9d:not(:disabled):hover{border-color:var(--color-border-hover);background-color:var(--color-surface-hover);transform:translateY(-2px);box-shadow:var(--shadow-md)}.action-button.svelte-4wg9d:focus-visible{outline:none;border-color:var(--color-primary);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.action-button.primary.svelte-4wg9d{border-color:var(--color-primary);background-color:var(--color-primary);color:var(--color-surface)}.action-button.primary.svelte-4wg9d:not(:disabled):hover{border-color:var(--color-primary-hover);background-color:var(--color-primary-hover)}.action-button.svelte-4wg9d:disabled{opacity:.6;cursor:not-allowed;transform:none}.action-button.svelte-4wg9d:disabled:hover{border-color:var(--color-border-default);background-color:var(--color-surface-primary);transform:none;box-shadow:none}.action-button.primary.svelte-4wg9d:disabled:hover{border-color:var(--color-primary);background-color:var(--color-primary)}.button-icon.svelte-4wg9d{font-size:2rem;flex-shrink:0}.button-content.svelte-4wg9d{display:flex;flex-direction:column;gap:var(--space-1);flex:1;min-width:0}.button-title.svelte-4wg9d{font-size:var(--text-base);font-weight:600;line-height:1.2}.button-subtitle.svelte-4wg9d{font-size:var(--text-sm);opacity:.8;line-height:1.2}.action-button.primary.svelte-4wg9d .button-subtitle:where(.svelte-4wg9d){opacity:.9}.action-button.svelte-4wg9d:disabled .button-icon:where(.svelte-4wg9d){opacity:.5}@media (max-width: 768px){.action-buttons.svelte-4wg9d{grid-template-columns:1fr;gap:var(--space-3)}.action-button.svelte-4wg9d{min-height:70px;padding:var(--space-3)}.button-icon.svelte-4wg9d{font-size:1.5rem}}@media (max-width: 480px){.action-button.svelte-4wg9d{flex-direction:column;text-align:center;gap:var(--space-2);min-height:90px}.button-content.svelte-4wg9d{align-items:center}}.workspace-item.svelte-ijd5ei{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4);border:1px solid var(--color-border-default);border-radius:var(--radius-md);background-color:var(--color-surface-primary);cursor:pointer;transition:all var(--duration-fast) ease;margin-block-end:var(--space-3);min-height:44px}.workspace-item.svelte-ijd5ei:hover{border-color:var(--color-border-hover);background-color:var(--color-surface-hover);box-shadow:var(--shadow-sm)}.workspace-item.svelte-ijd5ei:focus-visible{outline:none;border-color:var(--color-primary);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.workspace-item.current.svelte-ijd5ei{border-color:var(--color-primary);background-color:var(--color-primary-surface)}.workspace-item.current.svelte-ijd5ei:hover{border-color:var(--color-primary-hover);background-color:var(--color-primary-surface-hover)}.workspace-item.error.svelte-ijd5ei{border-color:var(--color-warning);background-color:var(--color-warning-surface)}.workspace-item.error.svelte-ijd5ei:hover{border-color:var(--color-warning-hover)}.workspace-main.svelte-ijd5ei{display:flex;align-items:center;gap:var(--space-3);flex:1;min-width:0}.workspace-icon-container.svelte-ijd5ei{flex-shrink:0}.workspace-icon.svelte-ijd5ei{font-size:1.5rem;display:block}.workspace-icon.error.svelte-ijd5ei{font-size:1.25rem;color:var(--color-warning)}.workspace-info.svelte-ijd5ei{flex:1;min-width:0;display:flex;flex-direction:column;gap:var(--space-1)}.workspace-header.svelte-ijd5ei{display:flex;align-items:center;justify-content:space-between;gap:var(--space-2)}.workspace-title.svelte-ijd5ei{margin:0;font-size:var(--text-base);font-weight:600;color:var(--color-text-primary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:flex;align-items:center;gap:var(--space-2);flex:1;min-width:0}.current-badge.svelte-ijd5ei{font-size:var(--text-xs);font-weight:500;padding:2px var(--space-1);background-color:var(--color-primary);color:var(--color-surface);border-radius:var(--radius-xs);flex-shrink:0}.workspace-time.svelte-ijd5ei{font-size:var(--text-sm);color:var(--color-text-secondary);flex-shrink:0}.workspace-meta.svelte-ijd5ei{display:flex;align-items:center;gap:var(--space-1);font-size:var(--text-sm);color:var(--color-text-secondary);overflow:hidden}.workspace-author-inline.svelte-ijd5ei{color:var(--color-text-secondary);font-weight:400}.meta-separator.svelte-ijd5ei{flex-shrink:0;opacity:.6}.workspace-language.svelte-ijd5ei{flex-shrink:0;text-transform:uppercase;font-weight:500}.workspace-stats.svelte-ijd5ei{flex-shrink:0}.workspace-actions.svelte-ijd5ei{display:flex;gap:var(--space-2);flex-shrink:0}.delete-button.svelte-ijd5ei{min-width:44px;min-height:44px;padding:var(--space-2);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background-color:var(--color-surface-secondary);color:var(--color-text-secondary);font-size:1.25rem;cursor:pointer;transition:all var(--duration-fast) ease;display:flex;align-items:center;justify-content:center}.delete-button.svelte-ijd5ei:hover{border-color:var(--color-error);background-color:var(--color-error-surface);color:var(--color-error)}.delete-button.svelte-ijd5ei:focus-visible{outline:none;border-color:var(--color-error);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}@media (max-width: 640px){.workspace-item.svelte-ijd5ei{padding:var(--space-3)}.workspace-header.svelte-ijd5ei{flex-direction:column;align-items:flex-start;gap:var(--space-1)}.workspace-time.svelte-ijd5ei{order:-1;align-self:flex-end}.workspace-meta.svelte-ijd5ei{flex-wrap:wrap}.workspace-stats.svelte-ijd5ei{flex:1 0 100%;margin-block-start:var(--space-1)}}@media (max-width: 480px){.workspace-main.svelte-ijd5ei{flex-direction:column;align-items:flex-start;gap:var(--space-2)}.workspace-icon-container.svelte-ijd5ei{align-self:center}.workspace-info.svelte-ijd5ei{width:100%}.workspace-actions.svelte-ijd5ei{align-self:center}}.workspace-list.svelte-1juhm6m{display:flex;flex-direction:column;gap:var(--space-4)}.list-header.svelte-1juhm6m{display:flex;flex-direction:column;gap:var(--space-3)}.search-container.svelte-1juhm6m{display:flex;justify-content:flex-end}.search-input-wrapper.svelte-1juhm6m{position:relative;max-width:300px;width:100%}.search-input.svelte-1juhm6m{width:100%;padding:var(--space-2) var(--space-3);padding-inline-end:var(--space-8);border:1px solid var(--color-border-default);border-radius:var(--radius-md);background-color:var(--color-surface-primary);color:var(--color-text-primary);font-size:var(--text-sm);transition:all var(--duration-fast) ease}.search-input.svelte-1juhm6m:focus{outline:none;border-color:var(--color-primary);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.search-input.svelte-1juhm6m::placeholder{color:var(--color-text-tertiary)}.clear-search.svelte-1juhm6m{position:absolute;top:50%;inset-inline-end:var(--space-2);transform:translateY(-50%);width:24px;height:24px;border:none;border-radius:var(--radius-sm);background-color:var(--color-surface-tertiary);color:var(--color-text-secondary);font-size:1rem;font-weight:700;cursor:pointer;transition:all var(--duration-fast) ease;display:flex;align-items:center;justify-content:center}.clear-search.svelte-1juhm6m:hover{background-color:var(--color-surface-hover);color:var(--color-text-primary)}.list-content.svelte-1juhm6m{min-height:200px}.loading-state.svelte-1juhm6m{display:flex;flex-direction:column;gap:var(--space-3)}.skeleton-item.svelte-1juhm6m{height:80px;background-color:var(--color-surface-tertiary);border-radius:var(--radius-md);animation:svelte-1juhm6m-pulse 2s infinite;opacity:.6}@keyframes svelte-1juhm6m-pulse{0%,to{opacity:.6}50%{opacity:.8}}.loading-text.svelte-1juhm6m{text-align:center;color:var(--color-text-secondary);font-style:italic;margin:var(--space-4) 0 0 0}.empty-state.svelte-1juhm6m{text-align:center;padding:var(--space-8) var(--space-4);color:var(--color-text-secondary)}.empty-tips.svelte-1juhm6m{max-width:400px;margin:0 auto;text-align:left}.tips-title.svelte-1juhm6m{margin:0 0 var(--space-2) 0;font-size:var(--text-base);font-weight:600;color:var(--color-text-primary)}.tips-list.svelte-1juhm6m{margin:0;padding-inline-start:var(--space-4);list-style-type:disc}.tips-list.svelte-1juhm6m li:where(.svelte-1juhm6m){margin-block-end:var(--space-1);font-size:var(--text-sm);line-height:1.5}.no-results.svelte-1juhm6m{text-align:center;padding:var(--space-8) var(--space-4);color:var(--color-text-secondary)}.no-results-icon.svelte-1juhm6m{font-size:3rem;margin-block-end:var(--space-4);display:block;opacity:.6}.no-results-title.svelte-1juhm6m{margin:0 0 var(--space-2) 0;font-size:var(--text-lg);font-weight:600;color:var(--color-text-primary)}.no-results-description.svelte-1juhm6m{margin:0 0 var(--space-4) 0;font-size:var(--text-base)}.clear-search-button.svelte-1juhm6m{padding:var(--space-2) var(--space-4);border:1px solid var(--color-primary);border-radius:var(--radius-md);background-color:transparent;color:var(--color-primary);font-size:var(--text-sm);cursor:pointer;transition:all var(--duration-fast) ease}.clear-search-button.svelte-1juhm6m:hover{background-color:var(--color-primary);color:var(--color-surface)}.workspace-grid.svelte-1juhm6m{display:flex;flex-direction:column;gap:0}.search-results-info.svelte-1juhm6m{margin-block-start:var(--space-4);padding-block-start:var(--space-4);border-block-start:1px solid var(--color-border-default)}.results-text.svelte-1juhm6m{margin:0;text-align:center;font-size:var(--text-sm);color:var(--color-text-secondary);font-style:italic}@media (max-width: 768px){.list-header.svelte-1juhm6m{gap:var(--space-2)}.search-container.svelte-1juhm6m{justify-content:stretch}.search-input-wrapper.svelte-1juhm6m{max-width:none}.empty-state.svelte-1juhm6m{padding:var(--space-6) var(--space-2)}.empty-tips.svelte-1juhm6m{text-align:center}}.workspace-view.svelte-9tke9n{height:100%;display:flex;flex-direction:column;background-color:var(--color-bg-primary);color:var(--color-text-primary)}.view-content.svelte-9tke9n{flex:1;padding:var(--space-6);overflow-y:auto}.error-banner.svelte-9tke9n{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4);margin-block-end:var(--space-6);background-color:var(--color-error-surface);color:var(--color-error);border:1px solid var(--color-error);border-radius:var(--radius-md)}.error-icon.svelte-9tke9n{font-size:1.25rem;flex-shrink:0}.error-text.svelte-9tke9n{flex:1;font-weight:500}.retry-button.svelte-9tke9n{padding:var(--space-2) var(--space-3);border:1px solid var(--color-error);border-radius:var(--radius-sm);background-color:transparent;color:var(--color-error);font-size:var(--text-sm);font-weight:500;cursor:pointer;transition:all var(--duration-fast) ease;min-height:44px}.retry-button.svelte-9tke9n:hover{background-color:var(--color-error);color:var(--color-surface)}.retry-button.svelte-9tke9n:focus-visible{outline:none;box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.unsaved-indicator.svelte-9tke9n{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-3);margin-block-start:var(--space-6);background-color:var(--color-warning-surface);color:var(--color-warning);border:1px solid var(--color-warning);border-radius:var(--radius-md);font-size:var(--text-sm)}.indicator-icon.svelte-9tke9n{font-size:var(--text-base);flex-shrink:0}@media (max-width: 768px){.view-content.svelte-9tke9n{padding:var(--space-4)}}.metadata-tab.svelte-z75kp3{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;border:none;border-block-end:2px solid transparent;background-color:transparent;color:var(--color-text-secondary);font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;white-space:nowrap}.metadata-tab.svelte-z75kp3:hover:not(.disabled){color:var(--color-text-primary);background-color:var(--color-surface-hover)}.metadata-tab.svelte-z75kp3:focus-visible{outline:none;box-shadow:inset 0 0 0 2px var(--color-focus-ring);border-radius:var(--radius-sm)}.metadata-tab.active.svelte-z75kp3{color:var(--color-primary);border-block-end-color:var(--color-primary);background-color:var(--color-surface-primary)}.metadata-tab.has-errors.svelte-z75kp3{color:var(--color-error)}.metadata-tab.has-errors.active.svelte-z75kp3{border-block-end-color:var(--color-error)}.metadata-tab.disabled.svelte-z75kp3{color:var(--color-text-disabled);cursor:not-allowed}.tab-label.svelte-z75kp3{flex:1}.error-indicator.svelte-z75kp3{display:inline-flex;align-items:center;justify-content:center;width:1.25rem;height:1.25rem;border-radius:50%;background-color:var(--color-error);color:var(--color-surface);font-size:.75rem;font-weight:700;line-height:1}[dir=rtl] .metadata-tab.svelte-z75kp3{flex-direction:row-reverse}.metadata-tab-bar.svelte-1pzcjt6{display:flex;border-block-end:1px solid var(--color-border-default);background-color:var(--color-surface-primary);overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none}.metadata-tab-bar.svelte-1pzcjt6::-webkit-scrollbar{display:none}@media (max-width: 480px){.metadata-tab-bar.svelte-1pzcjt6{flex-wrap:wrap}}.metadata-field.svelte-cp96ig{margin-block-end:1rem}.field-label.svelte-cp96ig{display:block;font-weight:500;margin-block-end:.5rem;color:var(--color-text-primary);font-size:.875rem}.field-label.needs-attention.svelte-cp96ig{color:var(--color-success-600)}.field-input.svelte-cp96ig{width:100%;padding:.75rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);font-size:1rem;background-color:var(--color-bg-primary);color:var(--color-text-primary);transition:border-color .2s ease}.field-input.svelte-cp96ig:focus{outline:none;border-color:var(--color-focus);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.field-input.svelte-cp96ig:disabled{background-color:var(--color-surface-disabled);color:var(--color-text-disabled);cursor:not-allowed}.field-input.error.svelte-cp96ig{border-color:var(--color-error)}.field-input.error.svelte-cp96ig:focus{border-color:var(--color-error);box-shadow:0 0 0 2px var(--color-error-300)}.field-input.needs-attention.svelte-cp96ig{border-color:var(--color-success-600)}.field-input.needs-attention.svelte-cp96ig:focus{border-color:var(--color-success-600);box-shadow:0 0 0 2px #228b2233}.field-error.svelte-cp96ig{margin-block-start:.25rem;color:var(--color-error);font-size:.875rem}.metadata-field.svelte-bssb4o{margin-block-end:1rem}.field-label.svelte-bssb4o{display:block;font-weight:500;margin-block-end:.5rem;color:var(--color-text-primary);font-size:.875rem}.field-label.needs-attention.svelte-bssb4o{color:var(--color-success-600)}.field-select.svelte-bssb4o{width:100%;padding:.75rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);font-size:1rem;background-color:var(--color-bg-primary);color:var(--color-text-primary);transition:border-color .2s ease;cursor:pointer}.field-select.svelte-bssb4o:focus{outline:none;border-color:var(--color-focus);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.field-select.svelte-bssb4o:disabled{background-color:var(--color-surface-disabled);color:var(--color-text-disabled);cursor:not-allowed}.field-select.error.svelte-bssb4o{border-color:var(--color-error)}.field-select.error.svelte-bssb4o:focus{border-color:var(--color-error);box-shadow:0 0 0 2px var(--color-error-300)}.field-select.needs-attention.svelte-bssb4o{border-color:var(--color-success-600)}.field-select.needs-attention.svelte-bssb4o:focus{border-color:var(--color-success-600);box-shadow:0 0 0 2px #228b2233}.field-error.svelte-bssb4o{margin-block-start:.25rem;color:var(--color-error);font-size:.875rem}.metadata-field.svelte-1c704qf{margin-block-end:1rem}.field-label.svelte-1c704qf{display:block;font-weight:500;margin-block-end:.5rem;color:var(--color-text-primary);font-size:.875rem}.field-label.needs-attention.svelte-1c704qf{color:var(--color-success-600)}.required.svelte-1c704qf{color:var(--color-error);margin-inline-start:.25rem}.field-textarea.svelte-1c704qf{width:100%;padding:.75rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);font-size:1rem;background-color:var(--color-bg-primary);color:var(--color-text-primary);transition:border-color .2s ease;resize:vertical;font-family:inherit;line-height:1.5;field-sizing:content;min-height:calc(4.5em + 1.5rem)}.field-textarea.svelte-1c704qf:focus{outline:none;border-color:var(--color-focus);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.field-textarea.svelte-1c704qf:disabled{background-color:var(--color-surface-disabled);color:var(--color-text-disabled);cursor:not-allowed;resize:none}.field-textarea.error.svelte-1c704qf{border-color:var(--color-error)}.field-textarea.error.svelte-1c704qf:focus{border-color:var(--color-error);box-shadow:0 0 0 2px var(--color-error-300)}.field-textarea.needs-attention.svelte-1c704qf{border-color:var(--color-success-600)}.field-textarea.needs-attention.svelte-1c704qf:focus{border-color:var(--color-success-600);box-shadow:0 0 0 2px #228b2233}.field-error.svelte-1c704qf{margin-block-start:.25rem;color:var(--color-error);font-size:.875rem}.basic-info-fields.svelte-1nofkco{padding:1.5rem}.form-columns.svelte-1nofkco{display:grid;grid-template-columns:1fr;gap:2rem}@media (min-width: 768px){.form-columns.svelte-1nofkco{grid-template-columns:1fr 1fr}}.column.svelte-1nofkco{min-width:0}.field-group.svelte-1nofkco{margin-block-end:2rem;background-color:var(--color-bg-tertiary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:1.5rem}.field-group.svelte-1nofkco:last-child{margin-block-end:0}.group-title.svelte-1nofkco{font-size:1.125rem;font-weight:600;color:var(--color-text-primary)}.identifier-field.svelte-1nofkco{display:flex;gap:.5rem;align-items:flex-end}.identifier-field.svelte-1nofkco .metadata-field{flex:1;margin-block-end:0}.generate-button.svelte-1nofkco{padding:.75rem 1rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background-color:var(--color-surface-primary);color:var(--color-text-secondary);font-size:.875rem;cursor:pointer;transition:all .2s ease;white-space:nowrap;height:fit-content}.generate-button.svelte-1nofkco:hover:not(:disabled){background-color:var(--color-surface-hover);border-color:var(--color-border-hover)}.generate-button.svelte-1nofkco:focus{outline:none;border-color:var(--color-primary);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.generate-button.svelte-1nofkco:disabled{opacity:.6;cursor:not-allowed}.array-field.svelte-1nofkco{display:flex;flex-direction:column;gap:.75rem}.array-item.svelte-1nofkco{display:flex;gap:0;align-items:flex-start;background-color:var(--color-bg-primary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:0;overflow:hidden;position:relative}.array-item.svelte-1nofkco .metadata-field{flex:1;margin-block-end:0}.array-item.svelte-1nofkco .field-input{border:none;background-color:transparent;border-radius:0}.array-item.svelte-1nofkco .field-input:focus{border:none;box-shadow:inset 0 0 0 2px var(--color-focus)}.array-item.svelte-1nofkco .field-input.error:focus{box-shadow:inset 0 0 0 2px var(--color-error)}.array-item.svelte-1nofkco .field-input.needs-attention:focus{box-shadow:inset 0 0 0 2px var(--color-success-600)}.remove-button.svelte-1nofkco{width:2.5rem;height:calc(3rem - 1px);border:none;border-inline-start:1px solid var(--color-border-default);border-radius:0;background-color:var(--color-bg-secondary);color:var(--color-error);font-size:1.25rem;font-weight:700;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;margin-block-start:0;flex-shrink:0}.remove-button.svelte-1nofkco:hover:not(:disabled){background-color:var(--color-error-bg);border-inline-start-color:var(--color-error-600)}.remove-button.svelte-1nofkco:focus{outline:none;background-color:var(--color-error-bg);border-inline-start-color:var(--color-error-600);box-shadow:inset 0 0 0 2px var(--color-focus-ring),inset 0 0 0 1px var(--color-error-600)}.remove-button.svelte-1nofkco:disabled{opacity:.6;cursor:not-allowed}.add-button.svelte-1nofkco{padding:.75rem 1rem;border:1px dashed var(--color-border-default);border-radius:var(--radius-sm);background-color:transparent;color:var(--color-primary);font-size:.875rem;cursor:pointer;transition:all .2s ease}.add-button.svelte-1nofkco:hover:not(:disabled){background-color:var(--color-primary-surface);border-color:var(--color-primary);border-style:solid}.add-button.svelte-1nofkco:focus{outline:none;border-color:var(--color-primary);box-shadow:inset 0 0 0 2px var(--color-focus-ring);border-style:solid}.add-button.svelte-1nofkco:disabled{opacity:.6;cursor:not-allowed}.metadata-field.svelte-14vfa0w{margin-block-end:1rem}.field-label.svelte-14vfa0w{display:block;font-weight:500;margin-block-end:.5rem;color:var(--color-text-primary);font-size:.875rem}.field-label.needs-attention.svelte-14vfa0w{color:var(--color-success-600)}.required.svelte-14vfa0w{color:var(--color-error);margin-inline-start:.25rem}.date-input-wrapper.svelte-14vfa0w{display:flex;gap:.5rem;align-items:center}.field-input.svelte-14vfa0w{flex:1;padding:.75rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);font-size:1rem;background-color:var(--color-bg-primary);color:var(--color-text-primary);transition:border-color .2s ease}.field-input.svelte-14vfa0w:focus{outline:none;border-color:var(--color-focus);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.field-input.svelte-14vfa0w:disabled{background-color:var(--color-surface-disabled);color:var(--color-text-disabled);cursor:not-allowed}.field-input.error.svelte-14vfa0w{border-color:var(--color-error)}.field-input.error.svelte-14vfa0w:focus{border-color:var(--color-error);box-shadow:0 0 0 2px var(--color-error-300)}.field-input.needs-attention.svelte-14vfa0w{border-color:var(--color-success-600)}.field-input.needs-attention.svelte-14vfa0w:focus{border-color:var(--color-success-600);box-shadow:0 0 0 2px #228b2233}.today-button.svelte-14vfa0w{padding:.5rem 1rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background-color:var(--color-surface-primary);color:var(--color-text-secondary);font-size:.875rem;cursor:pointer;transition:all .2s ease;white-space:nowrap}.today-button.svelte-14vfa0w:hover{background-color:var(--color-surface-hover);border-color:var(--color-border-hover)}.today-button.svelte-14vfa0w:focus{outline:none;border-color:var(--color-focus);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}.field-error.svelte-14vfa0w{margin-block-start:.25rem;color:var(--color-error);font-size:.875rem}.advanced-fields.svelte-fuok1{padding:1.5rem}.form-columns.svelte-fuok1{display:grid;grid-template-columns:1fr;gap:2rem}@media (min-width: 768px){.form-columns.svelte-fuok1{grid-template-columns:1fr 1fr}}.column.svelte-fuok1{min-width:0}.field-group.svelte-fuok1{margin-block-end:2rem;background-color:var(--color-bg-tertiary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:1.5rem}.field-group.svelte-fuok1:last-child{margin-block-end:0}.group-title.svelte-fuok1{font-size:1.125rem;font-weight:600;color:var(--color-text-primary)}.array-field.svelte-fuok1{display:flex;flex-direction:column;gap:.75rem}.array-item.svelte-fuok1{display:flex;gap:0;align-items:flex-start;background-color:var(--color-bg-primary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:0;overflow:hidden;position:relative}.array-item.svelte-fuok1 .metadata-field{flex:1;margin-block-end:0}.array-item.svelte-fuok1 .field-input{border:none;background-color:transparent;border-radius:0}.array-item.svelte-fuok1 .field-input:focus{border:none;box-shadow:inset 0 0 0 2px var(--color-focus)}.array-item.svelte-fuok1 .field-input.error:focus{box-shadow:inset 0 0 0 2px var(--color-error)}.array-item.svelte-fuok1 .field-input.needs-attention:focus{box-shadow:inset 0 0 0 2px var(--color-success-600)}.remove-button.svelte-fuok1{width:2.5rem;height:calc(3rem - 1px);border:none;border-inline-start:1px solid var(--color-border-default);border-radius:0;background-color:var(--color-bg-secondary);color:var(--color-error);font-size:1.25rem;font-weight:700;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;margin-block-start:0;flex-shrink:0}.remove-button.svelte-fuok1:hover:not(:disabled){background-color:var(--color-error-bg);border-inline-start-color:var(--color-error-600)}.remove-button.svelte-fuok1:focus{outline:none;background-color:var(--color-error-bg);border-inline-start-color:var(--color-error-600);box-shadow:inset 0 0 0 2px var(--color-focus-ring),inset 0 0 0 1px var(--color-error-600)}.remove-button.svelte-fuok1:disabled{opacity:.6;cursor:not-allowed}.add-button.svelte-fuok1{padding:.75rem 1rem;border:1px dashed var(--color-border-default);border-radius:var(--radius-sm);background-color:transparent;color:var(--color-primary);font-size:.875rem;cursor:pointer;transition:all .2s ease}.add-button.svelte-fuok1:hover:not(:disabled){background-color:var(--color-primary-surface);border-color:var(--color-primary);border-style:solid}.add-button.svelte-fuok1:focus{outline:none;border-color:var(--color-primary);box-shadow:inset 0 0 0 2px var(--color-focus-ring);border-style:solid}.add-button.svelte-fuok1:disabled{opacity:.6;cursor:not-allowed}.metadata-editor.svelte-17s3g49{display:flex;flex-direction:column;height:100%;background-color:var(--color-surface-primary)}.pane-header.svelte-17s3g49{flex-shrink:0;border-block-end:1px solid var(--color-border-default)}.pane-content.svelte-17s3g49{flex:1;overflow-y:auto;background-color:var(--color-bg-primary)}.tab-panel.svelte-17s3g49{height:100%}.loading-state.svelte-17s3g49,.error-state.svelte-17s3g49{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem;text-align:center}.error-message.svelte-17s3g49{color:var(--color-error);margin-block-end:1rem}.retry-button.svelte-17s3g49{padding:.75rem 1.5rem;border:1px solid var(--color-primary);border-radius:var(--radius-sm);background-color:var(--color-primary);color:var(--color-surface);font-size:.875rem;cursor:pointer;transition:all .2s ease}.retry-button.svelte-17s3g49:hover{background-color:var(--color-interactive-primary-hover);border-color:var(--color-interactive-primary-hover)}.retry-button.svelte-17s3g49:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}.placeholder-panel.svelte-17s3g49{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem;text-align:center;color:var(--color-text-secondary)}.placeholder-panel.svelte-17s3g49 p:where(.svelte-17s3g49):first-child{font-size:1.125rem;font-weight:600;margin-block-end:.5rem}.placeholder-description.svelte-17s3g49{font-size:.875rem;opacity:.8}.placeholder-view.svelte-skhkuy{height:100%;display:flex;flex-direction:column;background-color:var(--color-bg-primary);color:var(--color-text-primary)}.view-header.svelte-skhkuy{display:flex;align-items:center;justify-content:space-between;padding:var(--space-6);border-bottom:1px solid var(--color-border-default);background-color:var(--color-bg-secondary)}.header-content.svelte-skhkuy{display:flex;align-items:center;gap:var(--space-3)}.view-icon.svelte-skhkuy{font-size:var(--text-2xl)}.header-text.svelte-skhkuy h2:where(.svelte-skhkuy){margin:0 0 var(--space-1) 0;font-size:var(--text-xl);font-weight:var(--font-semibold);color:var(--color-text-primary)}.header-text.svelte-skhkuy p:where(.svelte-skhkuy){margin:0;font-size:var(--text-sm);color:var(--color-text-secondary)}.coming-soon-badge.svelte-skhkuy{padding:var(--space-1) var(--space-2);background-color:var(--color-accent);color:#fff;border-radius:var(--radius-md);font-size:var(--text-xs);font-weight:var(--font-medium)}.view-content.svelte-skhkuy{flex:1;overflow-y:auto;display:flex;align-items:center;justify-content:center;padding:var(--space-6)}.placeholder-content.svelte-skhkuy{max-width:600px;text-align:center}.placeholder-icon.svelte-skhkuy{margin-bottom:var(--space-6)}.large-icon.svelte-skhkuy{font-size:4rem;opacity:.6}.placeholder-content.svelte-skhkuy h3:where(.svelte-skhkuy){margin:0 0 var(--space-4) 0;font-size:var(--text-2xl);font-weight:var(--font-semibold);color:var(--color-text-primary)}.placeholder-description.svelte-skhkuy{margin:0 0 var(--space-8) 0;font-size:var(--text-base);color:var(--color-text-secondary);line-height:var(--leading-relaxed)}.feature-preview.svelte-skhkuy{margin-bottom:var(--space-8);text-align:left}.feature-preview.svelte-skhkuy h4:where(.svelte-skhkuy){margin:0 0 var(--space-3) 0;font-size:var(--text-lg);font-weight:var(--font-medium);color:var(--color-text-primary);text-align:center}.feature-list.svelte-skhkuy{list-style:none;margin:0;padding:0;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:var(--space-2)}.feature-list.svelte-skhkuy li:where(.svelte-skhkuy){padding:var(--space-2);background-color:var(--color-bg-secondary);border:1px solid var(--color-border-default);border-radius:var(--radius-md);font-size:var(--text-sm);color:var(--color-text-primary)}.demo-actions.svelte-skhkuy{margin-bottom:var(--space-6)}.demo-actions.svelte-skhkuy h4:where(.svelte-skhkuy){margin:0 0 var(--space-3) 0;font-size:var(--text-lg);font-weight:var(--font-medium);color:var(--color-text-primary)}.action-buttons.svelte-skhkuy{display:flex;gap:var(--space-3);justify-content:center;flex-wrap:wrap}.btn.svelte-skhkuy{display:inline-flex;align-items:center;gap:var(--space-2);padding:var(--space-2) var(--space-4);border:none;border-radius:var(--radius-md);font-family:var(--font-sans);font-size:var(--text-sm);font-weight:var(--font-medium);cursor:pointer;transition:all var(--duration-fast) ease;text-decoration:none}.btn-primary.svelte-skhkuy{color:var(--color-text-inverse)}.btn-primary.svelte-skhkuy:hover{background-color:var(--color-accent-dark, var(--color-accent));transform:translateY(-1px);box-shadow:var(--shadow-sm)}.btn-secondary.svelte-skhkuy{background-color:var(--color-bg-secondary);color:var(--color-text-primary);border:1px solid var(--color-border-default)}.btn-secondary.svelte-skhkuy:hover{background-color:var(--color-bg-tertiary);border-color:var(--color-border-hover)}.last-action.svelte-skhkuy{display:flex;align-items:center;justify-content:center;gap:var(--space-2);padding:var(--space-3);background-color:var(--color-success-bg, #d4edda);color:var(--color-success-text, #155724);border:1px solid var(--color-success-border, #c3e6cb);border-radius:var(--radius-md);font-size:var(--text-sm)}.action-icon.svelte-skhkuy{font-size:var(--text-base)}.editor-pane-container.svelte-1o393xc{display:flex;flex-direction:column;height:100%;background:var(--color-bg-secondary)}.editor-header.svelte-1o393xc{display:flex;justify-content:space-between;align-items:center;padding:var(--space-2);border-bottom:1px solid var(--color-border-default);background:var(--color-bg-tertiary)}.editor-controls.svelte-1o393xc{display:flex;gap:var(--space-2)}.pane-toggle-btn.svelte-1o393xc{display:flex;align-items:center;gap:var(--space-1);padding:var(--space-2) var(--space-3);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-secondary);color:var(--color-text-primary);cursor:pointer;transition:all var(--duration-fast) ease;font-size:var(--text-sm);font-weight:var(--font-medium)}.pane-toggle-btn.svelte-1o393xc:hover{background:var(--color-bg-hover);border-color:var(--color-accent-primary)}.pane-toggle-btn.svelte-1o393xc:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.toggle-icon.svelte-1o393xc{font-size:var(--text-base);font-weight:700}.toggle-label.svelte-1o393xc{font-size:var(--text-sm)}.editor-status.svelte-1o393xc{display:flex;align-items:center;gap:var(--space-2)}.status-indicator.svelte-1o393xc{display:flex;align-items:center;gap:var(--space-1);padding:var(--space-1) var(--space-2);border-radius:var(--radius-sm);font-size:var(--text-xs);font-weight:var(--font-medium)}.status-indicator.transforming.svelte-1o393xc{background:var(--color-info-bg);color:var(--color-info-text)}.status-indicator.error.svelte-1o393xc{background:var(--color-error-bg);color:var(--color-error-text)}.status-indicator.warning.svelte-1o393xc{background:var(--color-warning-bg);color:var(--color-warning-text)}.status-indicator.success.svelte-1o393xc{background:var(--color-success-bg);color:var(--color-success-text)}.status-spinner.svelte-1o393xc{width:12px;height:12px;border:2px solid currentColor;border-top:2px solid transparent;border-radius:50%;animation:svelte-1o393xc-spin var(--duration-normal) linear infinite}@keyframes svelte-1o393xc-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.force-update-btn.svelte-1o393xc{padding:var(--space-1);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-secondary);cursor:pointer;font-size:var(--text-sm);transition:all var(--duration-fast) ease}.force-update-btn.svelte-1o393xc:hover:not(:disabled){background:var(--color-bg-hover)}.force-update-btn.svelte-1o393xc:disabled{opacity:.5;cursor:not-allowed}.editor-content.svelte-1o393xc{flex:1;overflow:hidden}.editor-panes.svelte-1o393xc{display:flex;flex-direction:column;height:100%}.editor-pane.svelte-1o393xc{display:flex;flex-direction:column;flex:1;min-height:0}.editor-panes.dual-mode.svelte-1o393xc .editor-pane:where(.svelte-1o393xc){flex:1}.pane-2.svelte-1o393xc{border-bottom:1px solid var(--color-border-default)}.pane-header.svelte-1o393xc{padding:var(--space-2);background:var(--color-bg-tertiary);border-bottom:1px solid var(--color-border-default)}.file-selector.svelte-1o393xc{width:100%;padding:var(--space-2);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-primary);color:var(--color-text-primary);font-size:var(--text-sm);cursor:pointer}.file-selector.svelte-1o393xc:focus{outline:none;border-color:var(--color-accent-primary);box-shadow:0 0 0 var(--focus-ring-width) var(--color-focus)}.textarea-container.svelte-1o393xc{flex:1;padding:var(--space-2);overflow:hidden;position:relative}.content-textarea.svelte-1o393xc{width:100%;height:100%;padding:var(--space-3);border:1px solid var(--color-border-default);border-radius:var(--radius-md);background:var(--color-bg-primary);color:var(--color-text-primary);font-family:var(--font-mono);font-size:var(--text-sm);line-height:var(--leading-relaxed);resize:none;outline:none}.content-textarea.svelte-1o393xc:focus{border-color:var(--color-accent-primary);box-shadow:0 0 0 var(--focus-ring-width) var(--color-focus)}.content-textarea.has-error.svelte-1o393xc{border-color:var(--color-error-border)}.content-textarea.has-error.svelte-1o393xc:focus{border-color:var(--color-error-border);box-shadow:0 0 0 var(--focus-ring-width) var(--color-error-text)}.pane-error-overlay.svelte-1o393xc{position:absolute;bottom:var(--space-3);left:var(--space-3);right:var(--space-3);display:flex;align-items:center;gap:var(--space-2);padding:var(--space-2) var(--space-3);background:var(--color-error-bg);border:1px solid var(--color-error-border);border-radius:var(--radius-sm);color:var(--color-error-text);font-size:var(--text-sm);box-shadow:0 2px 8px #00000026;z-index:10}.pane-error-overlay.svelte-1o393xc .error-icon:where(.svelte-1o393xc){font-size:var(--text-base);flex-shrink:0}.pane-error-overlay.svelte-1o393xc .error-message:where(.svelte-1o393xc){flex:1;font-family:var(--font-mono)}.error-display.svelte-1o393xc,.warnings-display.svelte-1o393xc{margin:var(--space-2);padding:var(--space-3);border-radius:var(--radius-md)}.error-display.svelte-1o393xc{background:var(--color-error-bg);border:1px solid var(--color-error-border);color:var(--color-error-text)}.warnings-display.svelte-1o393xc{background:var(--color-warning-bg);border:1px solid var(--color-warning-border);color:var(--color-warning-text)}.error-header.svelte-1o393xc,.warnings-header.svelte-1o393xc{display:flex;align-items:center;gap:var(--space-2);margin-bottom:var(--space-2)}.error-message.svelte-1o393xc{font-family:var(--font-mono);font-size:var(--text-sm)}.error-stack.svelte-1o393xc{margin-top:var(--space-2)}.error-stack.svelte-1o393xc pre:where(.svelte-1o393xc){font-family:var(--font-mono);font-size:var(--text-xs);overflow-x:auto;margin:var(--space-1) 0 0}.warnings-list.svelte-1o393xc{margin:0;padding-left:var(--space-4);font-size:var(--text-sm)}.warnings-list.svelte-1o393xc li:where(.svelte-1o393xc){margin-bottom:var(--space-1)}@media (prefers-reduced-motion: reduce){.status-spinner.svelte-1o393xc{animation:none}.pane-toggle-btn.svelte-1o393xc,.force-update-btn.svelte-1o393xc{transition:none}}.preview-pane-container.svelte-32psnf{display:flex;flex-direction:column;height:100%;background:var(--color-bg-secondary)}.preview-header.svelte-32psnf{display:flex;justify-content:space-between;align-items:center;padding:var(--space-2);border-bottom:1px solid var(--color-border-default);background:var(--color-bg-tertiary)}.preview-title.svelte-32psnf{display:flex;align-items:center;gap:var(--space-2);font-weight:var(--font-medium);color:var(--color-text-primary)}.preview-controls.svelte-32psnf{display:flex;align-items:center;gap:var(--space-2)}.orientation-toggle.svelte-32psnf{padding:var(--space-1) var(--space-2);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-secondary);color:var(--color-text-primary);font-size:var(--text-sm);cursor:pointer;margin-right:var(--space-2);min-width:32px;display:inline-flex;align-items:center;justify-content:center}.orientation-toggle.svelte-32psnf:hover{background:var(--color-bg-hover)}.orientation-toggle.svelte-32psnf:focus{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.device-selector.svelte-32psnf{padding:var(--space-1) var(--space-2);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-primary);color:var(--color-text-primary);font-size:var(--text-xs);cursor:pointer}.device-selector.svelte-32psnf:focus{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.view-toggle.svelte-32psnf{padding:var(--space-1);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-secondary);cursor:pointer;font-size:var(--text-sm)}.view-toggle.svelte-32psnf:hover{background:var(--color-bg-hover)}.view-toggle.active.svelte-32psnf{background:var(--color-accent-primary);color:var(--color-accent-contrast);border-color:var(--color-accent-primary)}.transform-status.svelte-32psnf{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-2);font-size:var(--text-sm);font-weight:var(--font-medium)}.transform-status.transforming.svelte-32psnf{background:var(--color-info-bg);color:var(--color-info-text)}.transform-status.error.svelte-32psnf{background:var(--color-error-bg);color:var(--color-error-text)}.transform-status.warning.svelte-32psnf{background:var(--color-warning-bg);color:var(--color-warning-text)}.status-spinner.svelte-32psnf{width:16px;height:16px;border:2px solid currentColor;border-top:2px solid transparent;border-radius:50%;animation:svelte-32psnf-spin var(--duration-normal) linear infinite}@keyframes svelte-32psnf-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.preview-content.svelte-32psnf{flex:1;overflow:hidden;background:var(--color-bg-primary)}.source-view.svelte-32psnf{height:100%;overflow:auto}.source-code.svelte-32psnf{margin:0;padding:var(--space-3);font-family:var(--font-mono);font-size:var(--text-xs);line-height:var(--leading-relaxed);color:var(--color-text-primary);background:var(--color-bg-primary);white-space:pre-wrap}.preview-viewport.svelte-32psnf{height:100%;display:flex;justify-content:center;align-items:center;background-color:var(--color-bg-tertiary)}.preview-frame-wrapper.svelte-32psnf{position:relative}.preview-frame-container.svelte-32psnf{width:100%;height:100%;border:1px solid var(--color-border-default);border-radius:var(--radius-md);overflow:hidden}.preview-frame-container.device-frame.svelte-32psnf{box-shadow:var(--shadow-lg);border:2px solid var(--color-border-strong)}.preview-iframe.svelte-32psnf{width:100%;height:100%;border:none;background:#fff}.preview-error.svelte-32psnf,.preview-empty.svelte-32psnf{display:flex;align-items:center;justify-content:center;height:100%;padding:var(--space-4)}.error-content.svelte-32psnf,.empty-content.svelte-32psnf{text-align:center;max-width:400px}.error-content.svelte-32psnf{color:var(--color-error-text)}.error-content.svelte-32psnf h3:where(.svelte-32psnf){margin:0 0 var(--space-2) 0;font-size:var(--text-lg)}.error-content.svelte-32psnf p:where(.svelte-32psnf){margin:var(--space-1) 0;font-size:var(--text-sm)}.error-stack.svelte-32psnf{font-family:var(--font-mono);font-size:var(--text-xs);text-align:left;background:var(--color-bg-secondary);padding:var(--space-2);border-radius:var(--radius-sm);margin-top:var(--space-2);overflow-x:auto}.empty-content.svelte-32psnf{color:var(--color-text-secondary)}.empty-icon.svelte-32psnf{font-size:var(--text-4xl);display:block;margin-bottom:var(--space-3)}.empty-content.svelte-32psnf h3:where(.svelte-32psnf){margin:0 0 var(--space-2) 0;font-size:var(--text-lg);color:var(--color-text-primary)}.empty-content.svelte-32psnf p:where(.svelte-32psnf){margin:0;font-size:var(--text-sm)}.preview-footer.svelte-32psnf{padding:var(--space-2);border-top:1px solid var(--color-border-default);background:var(--color-bg-tertiary)}.meta-info.svelte-32psnf{display:flex;justify-content:space-between;align-items:center;font-size:var(--text-xs);color:var(--color-text-tertiary)}.meta-info.svelte-32psnf>span:where(.svelte-32psnf){margin-right:var(--space-3)}.meta-info.svelte-32psnf>span:where(.svelte-32psnf):last-child{margin-right:0}.warning-count.svelte-32psnf{color:var(--color-warning-text);background:var(--color-warning-bg);padding:var(--space-1) var(--space-2);border-radius:var(--radius-sm)}@media (prefers-reduced-motion: reduce){.status-spinner.svelte-32psnf{animation:none}.view-toggle.svelte-32psnf{transition:none}}@media (prefers-contrast: high){.preview-frame-container.svelte-32psnf{border:2px solid var(--color-forced-border)}}.loading-state.svelte-19lb94x,.error-state.svelte-19lb94x,.empty-state.svelte-19lb94x{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;text-align:center;padding:var(--space-8);background-color:var(--color-bg-primary);color:var(--color-text-primary)}.spinner.svelte-19lb94x{width:40px;height:40px;border:3px solid var(--color-border-default);border-top-color:var(--color-accent-primary);border-radius:50%;animation:svelte-19lb94x-spin 1s linear infinite;margin-bottom:var(--space-4)}@keyframes svelte-19lb94x-spin{to{transform:rotate(360deg)}}.error-icon.svelte-19lb94x{font-size:var(--text-2xl);margin-bottom:var(--space-3)}.error-state.svelte-19lb94x{color:var(--color-error-text)}.empty-icon.svelte-19lb94x{font-size:3rem;opacity:.5;margin-bottom:var(--space-4)}.empty-state.svelte-19lb94x h3:where(.svelte-19lb94x){margin:0 0 var(--space-2) 0;font-size:var(--text-lg);font-weight:var(--font-medium)}.empty-state.svelte-19lb94x p:where(.svelte-19lb94x){margin:0;color:var(--color-text-secondary);font-size:var(--text-sm)}.spine-editor-wrapper.svelte-19lb94x{height:100%;display:flex;flex-direction:column}@media (prefers-reduced-motion: reduce){.spinner.svelte-19lb94x{animation:none}}.extension-item.svelte-1ksqegs{border:1px solid var(--border-color, #ddd);border-radius:.25rem;margin-bottom:.5rem;background:var(--bg-primary, #fff);overflow:hidden}.extension-header.svelte-1ksqegs{display:flex;align-items:center;justify-content:space-between;padding:.75rem}.extension-name.svelte-1ksqegs{font-weight:500;color:var(--text-primary, #333)}.extension-actions.svelte-1ksqegs{display:flex;gap:.5rem}.license-button.svelte-1ksqegs{background:var(--color-accent-primary, #007acc);color:#fff;border:none;padding:.25rem .75rem;border-radius:.25rem;cursor:pointer;font-size:.875rem}.license-button.svelte-1ksqegs:hover:not(:disabled){background:var(--color-accent-primary-hover, #005a9e)}.license-button.svelte-1ksqegs:disabled{opacity:.6;cursor:not-allowed}.remove-button.svelte-1ksqegs{background:var(--error-bg, #dc3545);color:#fff;border:none;padding:.25rem .75rem;border-radius:.25rem;cursor:pointer;font-size:.875rem}.remove-button.svelte-1ksqegs:hover:not(:disabled){background:var(--error-hover, #c82333)}.remove-button.svelte-1ksqegs:disabled{opacity:.6;cursor:not-allowed}.license-preview.svelte-1ksqegs{padding:.5rem .75rem 0;border-bottom:1px solid var(--color-border-subtle, #e9ecef)}.license-preview-text.svelte-1ksqegs{font-size:.75rem;color:var(--color-text-tertiary, #6c757d);font-style:italic;line-height:1.3}.license-section.svelte-1ksqegs{border-top:1px solid var(--border-color, #ddd);padding:.75rem;background:var(--color-bg-secondary, #f8f9fa)}.license-textarea.svelte-1ksqegs{width:100%;min-height:120px;padding:.5rem;border:1px solid var(--border-color, #ddd);border-radius:.25rem;font-family:var(--font-mono, monospace);font-size:.875rem;line-height:1.4;resize:vertical;background:var(--bg-primary, #fff);color:var(--text-primary, #333)}.license-textarea.svelte-1ksqegs:focus{outline:2px solid var(--focus-color, #007acc);outline-offset:2px;border-color:var(--focus-color, #007acc)}.license-textarea.svelte-1ksqegs:read-only{background:var(--color-bg-tertiary, #f1f3f4);cursor:not-allowed}.license-textarea.svelte-1ksqegs:disabled{opacity:.6;cursor:not-allowed}@media (max-width: 640px){.extension-header.svelte-1ksqegs{flex-direction:column;align-items:flex-start;gap:.5rem}.extension-actions.svelte-1ksqegs{align-self:stretch;justify-content:flex-end}}.settings-view.svelte-1qxmh9x{padding:1rem;max-width:100%;width:100%;margin:0}.settings-header.svelte-1qxmh9x h1:where(.svelte-1qxmh9x){margin:0 0 .5rem;font-size:1.5rem;font-weight:600}.no-workspace-message.svelte-1qxmh9x,.loading-message.svelte-1qxmh9x{color:var(--text-muted, #666);font-style:italic}.error-message.svelte-1qxmh9x{background:var(--error-bg, #fee);color:var(--error-text, #c33);padding:.75rem;border-radius:.25rem;border:1px solid var(--error-border, #fcc);margin-bottom:1rem}.settings-content.svelte-1qxmh9x{display:grid;grid-template-columns:1fr 1fr;gap:2rem;max-width:1000px;margin:0 auto}@media (max-width: 1024px){.settings-content.svelte-1qxmh9x{grid-template-columns:1fr}}section.svelte-1qxmh9x{border:1px solid var(--border-color, #ddd);border-radius:.5rem;padding:1.5rem}section.svelte-1qxmh9x h2:where(.svelte-1qxmh9x){margin:0 0 1rem;font-size:1.25rem;font-weight:500;color:var(--text-primary, #333)}.setting-group.svelte-1qxmh9x{margin-bottom:1rem}.setting-label.svelte-1qxmh9x{display:flex;align-items:flex-start;gap:.5rem;cursor:pointer}.setting-label.svelte-1qxmh9x input[type=checkbox]:where(.svelte-1qxmh9x){margin-top:.125rem;cursor:pointer}.setting-text.svelte-1qxmh9x{font-weight:500;color:var(--text-primary, #333)}.setting-description.svelte-1qxmh9x{margin:.5rem 0 0 1.75rem;color:var(--text-muted, #666);font-size:.875rem;line-height:1.4}.extension-import.svelte-1qxmh9x{margin-bottom:1.5rem}.extension-import.svelte-1qxmh9x label:where(.svelte-1qxmh9x){display:block;margin-bottom:.5rem;font-weight:500;color:var(--text-primary, #333)}.extension-import.svelte-1qxmh9x input[type=file]:where(.svelte-1qxmh9x){width:100%;padding:.5rem;border:1px solid var(--border-color, #ddd);border-radius:.25rem;cursor:pointer}.extension-import.svelte-1qxmh9x input[type=file]:where(.svelte-1qxmh9x):disabled{opacity:.6;cursor:not-allowed}.extension-import.disabled.svelte-1qxmh9x{opacity:.6;pointer-events:none}.advanced-mode-note.svelte-1qxmh9x{font-size:var(--text-sm);color:var(--color-text-tertiary);font-style:italic;margin-top:var(--space-2);margin-bottom:0}.extensions-list.svelte-1qxmh9x{list-style:none;padding:0;margin:0}.setting-label.svelte-1qxmh9x:focus-within .setting-text:where(.svelte-1qxmh9x){outline:2px solid var(--focus-color, #007acc);outline-offset:2px}input[type=checkbox].svelte-1qxmh9x:focus-visible{outline:2px solid var(--focus-color, #007acc);outline-offset:2px}.spine-item.svelte-1b48bnl{display:flex;align-items:center;gap:var(--space-1);border-top:1px solid transparent;border-bottom:1px solid transparent;padding-block:var(--space-2);padding-inline-start:var(--space-2);padding-inline-end:var(--space-2);border-radius:0;cursor:pointer;transition:background-color var(--duration-fast) ease;min-block-size:var(--touch-target-min);position:relative;background:transparent}.spine-item.svelte-1b48bnl:hover:not(.selected){background:var(--color-bg-tertiary)}.spine-item.svelte-1b48bnl:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset);position:relative;z-index:1}.spine-item.selected.svelte-1b48bnl{background:var(--color-bg-primary);border-top:1px solid var(--color-border-default);border-bottom:1px solid var(--color-border-default);margin-inline-start:calc(var(--space-2) * -1);margin-inline-end:0;padding-inline-start:calc(var(--space-2) * 2);padding-inline-end:var(--space-2)}.spine-item.compact.svelte-1b48bnl{padding-block:2px;padding-inline:var(--space-1);justify-content:center;min-block-size:var( --touch-target-min )}.spine-item.compact.selected.svelte-1b48bnl{margin-inline:0;padding-inline:var(--space-1)}.spine-item.compact.svelte-1b48bnl .chapter-id:where(.svelte-1b48bnl){font-size:var(--text-xs);text-align:center;font-weight:var(--font-medium)}.drag-handle.svelte-1b48bnl{flex-shrink:0;display:flex;align-items:center;justify-content:center;inline-size:20px;block-size:20px;color:var(--color-text-tertiary);cursor:grab}.drag-handle.svelte-1b48bnl:active{cursor:grabbing}.chapter-id.svelte-1b48bnl{flex:1;font-size:var(--text-sm);color:var(--color-text-primary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.error-indicator.svelte-1b48bnl{flex-shrink:0;font-size:var(--text-sm);color:var(--color-status-warning)}.move-buttons.svelte-1b48bnl{display:flex;gap:var(--space-1);margin-inline-start:auto}.move-button.svelte-1b48bnl{display:flex;align-items:center;justify-content:center;inline-size:28px;block-size:28px;border:none;background:var(--color-bg-primary);border-radius:var(--radius-xs);cursor:pointer;font-size:var(--text-sm);color:var(--color-text-secondary);transition:all var(--duration-fast) ease}.move-button.svelte-1b48bnl:hover:not(:disabled){background:var(--color-interactive-secondary-hover);color:var(--color-text-primary)}.move-button.svelte-1b48bnl:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.move-button.svelte-1b48bnl:disabled{opacity:.5;cursor:not-allowed;color:var(--color-text-tertiary)}.delete-button.svelte-1b48bnl:hover:not(:disabled){background:var(--color-danger);color:var(--color-bg-primary)}@media (prefers-contrast: high){.spine-item.selected.svelte-1b48bnl{border:2px solid var(--color-forced-active)}.error-indicator.svelte-1b48bnl{font-weight:700}}.spine-sidebar.svelte-d0f7cr{display:flex;flex-direction:column;block-size:100%;gap:var(--space-2);background:var(--color-bg-secondary);padding:0;padding-inline-end:0}.loading.svelte-d0f7cr,.error.svelte-d0f7cr,.empty-state.svelte-d0f7cr{padding:var(--space-2);text-align:center;color:var(--color-text-secondary);font-size:var(--text-sm)}.error.svelte-d0f7cr{color:var(--color-status-error)}.retry-button.svelte-d0f7cr{margin-block-start:var(--space-2);padding-block:var(--space-2);padding-inline:var(--space-4);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background:var(--color-bg-primary);color:var(--color-text-primary);font-size:var(--text-sm);cursor:pointer;transition:all var(--duration-fast) ease}.retry-button.svelte-d0f7cr:hover{background:var(--color-interactive-secondary-hover);border-color:var(--color-border-strong)}.retry-button.svelte-d0f7cr:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.spine-list.svelte-d0f7cr{flex:1;overflow-y:auto;overflow-x:visible;display:flex;flex-direction:column;gap:0;list-style:none;padding:0;margin:0}.spine-list.svelte-d0f7cr>*{border:none}.spine-item-wrapper.svelte-d0f7cr{transition:transform var(--duration-fast) ease;border:none;outline:none}.spine-item-wrapper[draggable=true].svelte-d0f7cr:active{opacity:.8;transform:scale(.98)}.spine-list.svelte-d0f7cr::-webkit-scrollbar{inline-size:6px}.spine-list.svelte-d0f7cr::-webkit-scrollbar-track{background:var(--color-bg-secondary)}.spine-list.svelte-d0f7cr::-webkit-scrollbar-thumb{background:var(--color-border-strong);border-radius:var(--radius-xs)}.spine-list.svelte-d0f7cr::-webkit-scrollbar-thumb:hover{background:var(--color-text-tertiary)}.manifest-table-container.svelte-8hsxjr{height:100%;display:flex;flex-direction:column;background-color:var(--color-surface)}.manifest-toolbar.svelte-8hsxjr{display:flex;align-items:center;justify-content:space-between;padding:1rem;background-color:var(--color-surface-primary);border-block-end:1px solid var(--color-border-default);position:relative;min-height:3rem;flex-shrink:0}.filter-section.svelte-8hsxjr{display:flex;align-items:center;gap:.5rem;flex:1;max-width:400px}.filter-label.svelte-8hsxjr{font-size:.875rem;font-weight:500;color:var(--color-text-secondary);white-space:nowrap}.filter-input-container.svelte-8hsxjr{position:relative;flex:1}.filter-input.svelte-8hsxjr{width:100%;padding:.5rem .75rem;padding-inline-end:2rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background-color:var(--color-surface);color:var(--color-text-primary);font-size:.875rem;transition:border-color .2s ease}.filter-input.svelte-8hsxjr:focus{outline:none;border-color:var(--color-focus-ring);box-shadow:0 0 0 2px var(--color-focus-ring)}.filter-input.svelte-8hsxjr:disabled{opacity:.6;cursor:not-allowed}.filter-input.svelte-8hsxjr::placeholder{color:var(--color-text-placeholder)}.clear-filter-button.svelte-8hsxjr{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:none;border:none;font-size:1.25rem;color:var(--color-text-secondary);cursor:pointer;padding:.25rem;line-height:1;transition:color .2s ease}.clear-filter-button.svelte-8hsxjr:hover{color:var(--color-text-primary)}.clear-filter-button.svelte-8hsxjr:focus{outline:none;color:var(--color-text-primary)}.action-buttons.svelte-8hsxjr{display:flex;gap:.5rem}.action-button.svelte-8hsxjr{padding:.5rem 1rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);font-size:.875rem;cursor:pointer;transition:all .2s ease;white-space:nowrap}.action-button.svelte-8hsxjr:disabled{opacity:.6;cursor:not-allowed}.action-button.primary.svelte-8hsxjr{background-color:var(--color-primary);color:var(--color-surface);border-color:var(--color-primary)}.action-button.primary.svelte-8hsxjr:hover:not(:disabled){background-color:var(--color-interactive-primary-hover);border-color:var(--color-interactive-primary-hover)}.action-button.secondary.svelte-8hsxjr{background-color:var(--color-surface);color:var(--color-text-primary)}.action-button.secondary.svelte-8hsxjr:hover:not(:disabled){background-color:var(--color-interactive-secondary-hover);border-color:var(--color-interactive-secondary-hover)}.drag-overlay.svelte-8hsxjr{position:absolute;inset:0;background-color:rgba(var(--color-primary-rgb),.1);border:2px dashed var(--color-primary);border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;z-index:10}.drag-message.svelte-8hsxjr{padding:1rem;background-color:var(--color-surface);border-radius:var(--radius-sm);box-shadow:var(--shadow-sm)}.drag-message.svelte-8hsxjr p:where(.svelte-8hsxjr){margin:0;font-size:.875rem;color:var(--color-text-primary);text-align:center}.drag-active.svelte-8hsxjr{background-color:rgba(var(--color-primary-rgb),.05)}.table-container.svelte-8hsxjr{flex:1;overflow:auto}.empty-state.svelte-8hsxjr{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem;text-align:center;color:var(--color-text-secondary)}.empty-state.svelte-8hsxjr p:where(.svelte-8hsxjr){margin:.5rem 0}.empty-state-subtitle.svelte-8hsxjr{font-size:.875rem;opacity:.8}.manifest-table.svelte-8hsxjr{width:100%;border-collapse:collapse;font-size:.875rem}.manifest-table.svelte-8hsxjr th:where(.svelte-8hsxjr),.manifest-table.svelte-8hsxjr td:where(.svelte-8hsxjr){padding:.5rem .75rem;text-align:left;border-bottom:1px solid var(--color-border-default)}.manifest-table.svelte-8hsxjr th:where(.svelte-8hsxjr){background-color:var(--color-surface-secondary);font-weight:600;color:var(--color-text-primary);position:sticky;top:0;z-index:1}.sort-button.svelte-8hsxjr{background:none;border:none;font-size:inherit;font-weight:inherit;color:inherit;cursor:pointer;padding:0;display:flex;align-items:center;gap:.25rem}.sort-button.svelte-8hsxjr:hover{color:var(--color-interactive-primary)}.sort-button.svelte-8hsxjr:focus{outline:none;color:var(--color-interactive-primary)}.manifest-row.svelte-8hsxjr{cursor:pointer;transition:background-color .15s ease;position:relative}.manifest-row.svelte-8hsxjr:hover{background-color:var(--color-surface-hover)}.manifest-row.svelte-8hsxjr:focus:not(.selected){outline:2px solid var(--color-focus-ring);outline-offset:-2px;background-color:var(--color-surface-hover)}.manifest-row.selected.svelte-8hsxjr:focus{outline:2px solid var(--color-focus-ring);outline-offset:-2px}.manifest-row.selected.svelte-8hsxjr{background-color:var(--color-bg-accent)}.manifest-row.error.svelte-8hsxjr{background-color:var(--color-bg-error)}.manifest-row.source-zip-item.svelte-8hsxjr{opacity:.8;font-style:italic;background-color:var(--color-bg-muted, rgba(0, 0, 0, .05))}.manifest-row.source-zip-item.svelte-8hsxjr .item-id:where(.svelte-8hsxjr),.manifest-row.source-zip-item.svelte-8hsxjr .item-href:where(.svelte-8hsxjr){color:var(--color-text-secondary)}.source-separator.svelte-8hsxjr{background-color:var(--color-bg-secondary)}.separator-cell.svelte-8hsxjr{padding:.75rem;border-bottom:2px solid var(--color-border-strong);border-top:1px solid var(--color-border-default)}.separator-content.svelte-8hsxjr{display:flex;align-items:center;justify-content:flex-start}.separator-label.svelte-8hsxjr{font-size:.8125rem;font-weight:600;color:var(--color-text-secondary);letter-spacing:.05em}.id-cell.svelte-8hsxjr{display:flex;align-items:center;gap:.5rem;max-width:200px}.item-id.svelte-8hsxjr{font-weight:500;word-break:break-word}.href-cell.svelte-8hsxjr{max-width:300px}.item-href.svelte-8hsxjr{font-family:var(--font-mono);font-size:.8125rem;word-break:break-all}.size-cell.svelte-8hsxjr{text-align:right;color:var(--color-text-secondary)}.properties-list.svelte-8hsxjr{display:flex;flex-wrap:wrap;gap:.25rem}.property-tag.svelte-8hsxjr{background-color:var(--color-bg-accent);color:var(--color-primary);padding:.125rem .375rem;border-radius:var(--radius-xs);font-size:.75rem;font-weight:500}.action-button.svelte-8hsxjr{padding:.375rem;border:1px solid var(--color-border-default);border-radius:var(--radius-xs);background-color:var(--color-surface);color:var(--color-text-primary);font-size:.875rem;cursor:pointer;transition:all .15s ease;min-width:32px;height:32px;display:flex;align-items:center;justify-content:center}.action-button.svelte-8hsxjr:hover{background-color:var(--color-surface-hover);border-color:var(--color-border-hover)}.action-button.svelte-8hsxjr:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}@media (max-width: 768px){.manifest-toolbar.svelte-8hsxjr{flex-direction:column;gap:1rem;align-items:stretch}.filter-section.svelte-8hsxjr{max-width:none}.action-buttons.svelte-8hsxjr{justify-content:center}.manifest-table.svelte-8hsxjr{font-size:.8125rem}.manifest-table.svelte-8hsxjr th:where(.svelte-8hsxjr),.manifest-table.svelte-8hsxjr td:where(.svelte-8hsxjr){padding:.5rem .25rem}.href-cell.svelte-8hsxjr{max-width:150px}.properties-list.svelte-8hsxjr{flex-direction:column}}.modal-overlay.svelte-ziknnq{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content.svelte-ziknnq{background-color:var(--color-surface-primary);border-radius:var(--radius-modal);box-shadow:var(--elevation-modal);max-width:600px;width:90%;max-height:90vh;display:flex;flex-direction:column}.modal-header.svelte-ziknnq{display:flex;align-items:center;justify-content:space-between;padding:1.5rem;border-bottom:1px solid var(--color-border-default)}.modal-header.svelte-ziknnq h2:where(.svelte-ziknnq){margin:0;font-size:1.25rem;font-weight:600;color:var(--color-text-primary)}.close-button.svelte-ziknnq{background:none;border:none;font-size:1.5rem;color:var(--color-text-secondary);cursor:pointer;padding:.25rem;line-height:1;transition:color .2s ease}.close-button.svelte-ziknnq:hover{color:var(--color-text-primary)}.close-button.svelte-ziknnq:focus{outline:none;color:var(--color-text-primary)}.modal-form.svelte-ziknnq{display:flex;flex-direction:column;height:100%}.form-body.svelte-ziknnq{flex:1;overflow-y:auto;padding:1.5rem}.form-group.svelte-ziknnq{margin-bottom:1.5rem}.form-label.svelte-ziknnq{display:block;margin-bottom:.5rem;font-weight:500;color:var(--color-text-primary)}.required.svelte-ziknnq{color:var(--color-error-text)}.form-input.svelte-ziknnq,.form-select.svelte-ziknnq,.form-textarea.svelte-ziknnq{width:100%;padding:.75rem;border:1px solid var(--color-border-default);border-radius:var(--radius-input);background-color:var(--color-input-bg);color:var(--color-text-primary);font-size:.875rem;transition:border-color .2s ease}.form-input.svelte-ziknnq:focus,.form-select.svelte-ziknnq:focus,.form-textarea.svelte-ziknnq:focus{outline:none;border-color:var(--color-input-border-focus);box-shadow:0 0 0 2px var(--color-focus)}.form-input.error.svelte-ziknnq,.form-select.error.svelte-ziknnq{border-color:var(--color-error-text)}.form-input.svelte-ziknnq::placeholder,.form-textarea.svelte-ziknnq::placeholder{color:var(--color-input-placeholder)}.file-input.svelte-ziknnq{width:100%;padding:.75rem;border:2px dashed var(--color-border-default);border-radius:var(--radius-input);background-color:var(--color-bg-secondary);cursor:pointer;transition:border-color .2s ease}.file-input.svelte-ziknnq:hover{border-color:var(--color-interactive-primary)}.file-input.svelte-ziknnq:focus{outline:none;border-color:var(--color-focus)}.file-info.svelte-ziknnq{margin-top:.5rem;font-size:.875rem;color:var(--color-text-secondary)}.checkbox-fieldset.svelte-ziknnq{border:none;margin:0;padding:0}.checkbox-fieldset.svelte-ziknnq .form-label:where(.svelte-ziknnq){display:block;margin-bottom:.5rem;font-weight:500}.checkbox-group.svelte-ziknnq{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:.5rem}.checkbox-label.svelte-ziknnq{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--color-text-primary);cursor:pointer}.checkbox-input.svelte-ziknnq{width:1rem;height:1rem;border:1px solid var(--color-border-default);border-radius:var(--radius-xs);background-color:var(--color-input-bg);cursor:pointer}.checkbox-input.svelte-ziknnq:checked{background-color:var(--color-interactive-primary);border-color:var(--color-interactive-primary)}.checkbox-input.svelte-ziknnq:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus)}.error-message.svelte-ziknnq{margin-top:.25rem;font-size:.8125rem;color:var(--color-error-text)}.field-help.svelte-ziknnq{margin-top:.25rem;font-size:.8125rem;color:var(--color-text-secondary)}.modal-footer.svelte-ziknnq{display:flex;gap:.75rem;justify-content:flex-end;padding:1.5rem;border-top:1px solid var(--color-border-default)}.cancel-button.svelte-ziknnq,.save-button.svelte-ziknnq{padding:.75rem 1.5rem;border:1px solid var(--color-border-default);border-radius:var(--radius-button);font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease}.cancel-button.svelte-ziknnq{background-color:var(--color-button-secondary-bg);color:var(--color-text-primary)}.cancel-button.svelte-ziknnq:hover{background-color:var(--color-button-secondary-bg-hover);border-color:var(--color-border-default)}.save-button.svelte-ziknnq{background-color:var(--color-interactive-primary);color:var(--color-white);border-color:var(--color-interactive-primary)}.save-button.svelte-ziknnq:hover{background-color:var(--color-interactive-primary-hover);border-color:var(--color-interactive-primary-hover)}.cancel-button.svelte-ziknnq:focus,.save-button.svelte-ziknnq:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus)}@media (max-width: 768px){.modal-content.svelte-ziknnq{width:95%;max-height:95vh}.modal-header.svelte-ziknnq,.form-body.svelte-ziknnq{padding:1rem}.modal-footer.svelte-ziknnq{padding:1rem;flex-direction:column}.checkbox-group.svelte-ziknnq{grid-template-columns:1fr}}.loading-state.svelte-12tyyls,.error-state.svelte-12tyyls{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem;text-align:center}.error-message.svelte-12tyyls{color:var(--color-error);margin-block-end:1rem}.retry-button.svelte-12tyyls{padding:.75rem 1.5rem;border:1px solid var(--color-primary);border-radius:var(--radius-sm);background-color:var(--color-primary);color:var(--color-surface);font-size:.875rem;cursor:pointer;transition:all .2s ease}.retry-button.svelte-12tyyls:hover{background-color:var(--color-interactive-primary-hover);border-color:var(--color-interactive-primary-hover)}.retry-button.svelte-12tyyls:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}.manifest-preview.svelte-xcscli{height:100%;display:flex;flex-direction:column;background-color:var(--color-surface)}.no-selection.svelte-xcscli{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem;text-align:center;color:var(--color-text-secondary)}.no-selection.svelte-xcscli p:where(.svelte-xcscli){margin:.5rem 0}.no-selection-subtitle.svelte-xcscli{font-size:.875rem;opacity:.8}.loading-state.svelte-xcscli,.error-state.svelte-xcscli{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem;text-align:center}.error-message.svelte-xcscli{color:var(--color-error);margin-block-end:1rem}.retry-button.svelte-xcscli{padding:.75rem 1.5rem;border:1px solid var(--color-primary);border-radius:var(--radius-sm);background-color:var(--color-primary);color:var(--color-surface);font-size:.875rem;cursor:pointer;transition:all .2s ease}.retry-button.svelte-xcscli:hover{background-color:var(--color-interactive-primary-hover);border-color:var(--color-interactive-primary-hover)}.retry-button.svelte-xcscli:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}.preview-content.svelte-xcscli{height:100%;display:flex;flex-direction:column}.preview-header.svelte-xcscli{flex-shrink:0;padding:1rem;border-bottom:1px solid var(--color-border-default);background-color:var(--color-surface-secondary);display:flex;justify-content:space-between;align-items:flex-start;gap:1rem}.preview-body.svelte-xcscli{flex:1;overflow-y:auto;padding:1rem;display:flex;flex-direction:column}.content-header.svelte-xcscli{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem}.content-type-icon.svelte-xcscli{font-size:1.25rem}.content-type.svelte-xcscli{font-family:var(--font-mono);font-size:.875rem;color:var(--color-text-secondary)}.preview-error.svelte-xcscli{color:var(--color-error);padding:1rem;background-color:var(--color-error-subtle);border-radius:var(--radius-sm);margin-bottom:1rem}.text-preview.svelte-xcscli{flex:1}.text-content.svelte-xcscli{background-color:var(--color-surface-secondary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);padding:1rem;font-family:var(--font-mono);font-size:.8125rem;line-height:1.4;overflow:auto;white-space:pre-wrap;word-wrap:break-word}.image-preview.svelte-xcscli,.audio-preview.svelte-xcscli,.video-preview.svelte-xcscli{margin-bottom:1rem}.preview-image.svelte-xcscli{max-width:100%;height:auto;border-radius:var(--radius-sm);box-shadow:var(--shadow-sm)}.preview-audio.svelte-xcscli{width:100%;max-width:400px}.preview-video.svelte-xcscli{width:100%;max-width:600px;height:auto;border-radius:var(--radius-sm)}.binary-preview.svelte-xcscli{padding:1rem;background-color:var(--color-surface-secondary);border-radius:var(--radius-sm);text-align:center;color:var(--color-text-secondary);margin-bottom:1rem}.binary-info.svelte-xcscli{font-size:.875rem;margin-top:.5rem}.preview-actions.svelte-xcscli{flex-shrink:0;display:flex;gap:.5rem;align-items:flex-start}.action-button.svelte-xcscli{padding:.5rem 1rem;border:1px solid var(--color-border-default);border-radius:var(--radius-sm);background-color:var(--color-surface);color:var(--color-text-primary);font-size:.875rem;cursor:pointer;transition:all .2s ease}.action-button.svelte-xcscli:hover{background-color:var(--color-surface-hover);border-color:var(--color-border-hover)}.action-button.svelte-xcscli:focus{outline:none;box-shadow:0 0 0 2px var(--color-focus-ring)}.download-button.svelte-xcscli:hover{color:var(--color-interactive-secondary);border-color:var(--color-interactive-secondary)}.edit-button.svelte-xcscli:hover{color:var(--color-interactive-primary);border-color:var(--color-interactive-primary)}.delete-button.svelte-xcscli:hover{color:var(--color-error);border-color:var(--color-error)}.outline-editor{display:flex;flex-direction:column;height:100%;width:100%}.outline-editor__textarea{flex:1;min-height:200px;padding:var(--spacing-4);font-family:var(--font-family-mono);font-size:var(--font-size-base);line-height:var(--line-height-relaxed);border:1px solid var(--color-border-subtle);border-radius:var(--border-radius-md);background-color:var(--color-surface);color:var(--color-text-primary);resize:none;overflow-y:auto;transition:border-color var(--transition-fast)}.outline-editor__textarea:focus{outline:none;border-color:var(--color-border-focus);box-shadow:0 0 0 var(--focus-ring-width) var(--color-focus-ring)}.outline-editor__textarea::placeholder{color:var(--color-text-subtle);font-style:italic}@media (prefers-contrast: high){.outline-editor__textarea{border-width:2px}.outline-editor__textarea:focus{border-color:var(--color-text-primary);box-shadow:0 0 0 calc(var(--focus-ring-width) + 1px) var(--color-focus-ring)}}@media (prefers-reduced-motion: reduce){.outline-editor__textarea{transition:none}}@media (max-width: 768px){.outline-editor__textarea{min-height:44px;padding:var(--spacing-3);font-size:var(--font-size-lg)}}[data-theme=dark] .outline-editor__textarea{background-color:var(--color-surface-elevated);border-color:var(--color-border-subtle)}[data-theme=dark] .outline-editor__textarea:focus{border-color:var(--color-border-focus)}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.outline-view.svelte-vjoxn9{height:100%;width:100%}.sr-only.svelte-vjoxn9{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.content-preview.svelte-166aukc{display:flex;justify-content:center;align-items:center;width:100%;height:100%;background:#000;overflow:hidden}.content-preview__container.svelte-166aukc{transform-origin:center;width:100%;height:100%}.content-preview__letterbox.svelte-166aukc{background:#000;display:flex;justify-content:center;align-items:center;width:100%;height:100%}.content-preview__iframe.svelte-166aukc{border:none;background:#fff;min-width:320px;min-height:400px}.simple-metadata-view.svelte-uhoge6{display:flex;flex-direction:column;height:100%;background:var(--color-bg-primary);border-radius:var(--radius-md);overflow:hidden}.preview-header.svelte-uhoge6{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-3);background:var(--color-bg-secondary);border-bottom:1px solid var(--color-border-default)}.content-type-icon.svelte-uhoge6{font-size:var(--text-lg)}.file-name.svelte-uhoge6{font-family:var(--font-mono);font-weight:var(--font-medium);color:var(--color-text-primary)}.preview-body.svelte-uhoge6{flex:1;overflow:auto;padding:var(--space-4)}.metadata-summary.svelte-uhoge6{display:flex;flex-direction:column;gap:var(--space-4)}.field-row.svelte-uhoge6{display:flex;flex-direction:column;gap:var(--space-1);padding:var(--space-3);border-radius:var(--radius-sm);transition:all var(--duration-fast) ease}.field-row.focused.svelte-uhoge6{background:var(--color-bg-accent);border:1px solid var(--color-interactive-primary)}.field-label.svelte-uhoge6{font-size:var(--text-sm);font-weight:var(--font-medium);color:var(--color-text-secondary);text-transform:uppercase;letter-spacing:var(--tracking-wide)}.field-value.svelte-uhoge6{font-size:var(--text-base);color:var(--color-text-primary);line-height:var(--leading-relaxed)}.field-value.description.svelte-uhoge6{white-space:pre-wrap;word-wrap:break-word}.field-value.identifier.svelte-uhoge6{font-family:var(--font-mono);font-size:var(--text-sm);color:var(--color-text-secondary);word-break:break-all}.no-content.svelte-uhoge6{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;padding:var(--space-4);text-align:center;color:var(--color-text-secondary)}.opf-preview.svelte-vzuyuw{display:flex;flex-direction:column;height:100%;background:var(--color-bg-primary);border-radius:var(--radius-md);overflow:hidden}.preview-header.svelte-vzuyuw{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-3);background:var(--color-bg-secondary);border-bottom:1px solid var(--color-border-default)}.content-type-icon.svelte-vzuyuw{font-size:var(--text-lg)}.file-name.svelte-vzuyuw{font-family:var(--font-mono);font-weight:var(--font-medium);color:var(--color-text-primary)}.preview-body.svelte-vzuyuw{flex:1;overflow:auto;padding:var(--space-3)}.text-preview.svelte-vzuyuw{height:100%}.text-content.svelte-vzuyuw{font-family:var(--font-mono);font-size:var(--text-sm);line-height:var(--leading-relaxed);color:var(--color-text-primary);background:var(--color-bg-primary);border:none;margin:0;padding:0;height:100%;overflow:auto;white-space:pre;tab-size:2}.error-state.svelte-vzuyuw,.no-content.svelte-vzuyuw{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;padding:var(--space-4);text-align:center;color:var(--color-text-secondary)}.error-state.svelte-vzuyuw{color:var(--color-status-error)}.error-message.svelte-vzuyuw{margin-bottom:var(--space-3)}.retry-button.svelte-vzuyuw{padding:var(--space-2) var(--space-4);background:var(--color-bg-primary);border:1px solid var(--color-border-default);border-radius:var(--radius-sm);color:var(--color-text-primary);cursor:pointer;font-size:var(--text-sm);transition:all var(--duration-fast) ease}.retry-button.svelte-vzuyuw:hover{background:var(--color-interactive-secondary-hover);border-color:var(--color-border-strong)}.retry-button.svelte-vzuyuw:focus-visible{outline:var(--focus-ring-width) var(--focus-ring-style) var(--color-focus);outline-offset:var(--focus-ring-offset)}.highlighted-xml.svelte-vzuyuw .metadata-value{font-weight:var(--font-bold);color:var(--color-text-primary)}.highlighted-xml.svelte-vzuyuw .metadata-value-focused{font-weight:var(--font-bold);color:var(--color-interactive-primary);background:var(--color-bg-accent);border-radius:var(--radius-xs)}.highlighted-xml.svelte-vzuyuw .metadata-tag{color:var(--color-syntax-tag)}.highlighted-xml.svelte-vzuyuw .metadata-tag-focused{color:var(--color-interactive-primary);font-weight:var(--font-medium)}.highlighted-xml.svelte-vzuyuw{font-family:var(--font-mono);line-height:var(--leading-relaxed)}.highlighted-xml.svelte-vzuyuw meta,.highlighted-xml.svelte-vzuyuw dc\\:title,.highlighted-xml.svelte-vzuyuw dc\\:language,.highlighted-xml.svelte-vzuyuw dc\\:identifier,.highlighted-xml.svelte-vzuyuw dc\\:creator,.highlighted-xml.svelte-vzuyuw dc\\:contributor,.highlighted-xml.svelte-vzuyuw dc\\:subject,.highlighted-xml.svelte-vzuyuw dc\\:publisher,.highlighted-xml.svelte-vzuyuw dc\\:date,.highlighted-xml.svelte-vzuyuw dc\\:description,.highlighted-xml.svelte-vzuyuw dc\\:rights{display:inline}.highlighted-xml.svelte-vzuyuw .structural-element{color:var(--color-text-tertiary)}.loading-state.svelte-141k6tx,.error-state.svelte-141k6tx{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;text-align:center;padding:2rem;background-color:var(--color-bg-primary);color:var(--color-text-primary)}.spinner.svelte-141k6tx{width:40px;height:40px;border:3px solid var(--color-border-default);border-top-color:var(--color-accent-primary);border-radius:50%;animation:svelte-141k6tx-spin 1s linear infinite;margin-bottom:1rem}@keyframes svelte-141k6tx-spin{to{transform:rotate(360deg)}}.error-state.svelte-141k6tx{color:var(--color-error-text)}.error-state.svelte-141k6tx h2:where(.svelte-141k6tx){margin:0 0 1rem;font-size:1.5rem;font-weight:600}.error-state.svelte-141k6tx p:where(.svelte-141k6tx){margin:.5rem 0;font-size:1rem}@media (prefers-reduced-motion: reduce){.spinner.svelte-141k6tx{animation:none}}.placeholder-content.svelte-141k6tx{padding:1rem;color:var(--color-text-secondary)}.placeholder-content.svelte-141k6tx h3:where(.svelte-141k6tx){margin:0 0 .5rem;font-size:1rem;font-weight:600}.placeholder-content.svelte-141k6tx p:where(.svelte-141k6tx){margin:0;font-size:.875rem;opacity:.8}.current-view-info.svelte-141k6tx{margin-top:1rem!important;padding:.5rem;background:var(--color-bg-secondary);border-radius:4px;font-size:.75rem!important}.package-epub-section.svelte-141k6tx{padding:var(--space-3);border-top:1px solid var(--color-border-default)}.package-epub-button.svelte-141k6tx{width:100%;padding:var(--space-2) var(--space-3);border:1px solid var(--color-button-primary-bg);border-radius:var(--radius-sm);background-color:var(--color-button-primary-bg);color:#fff;font-size:var(--text-sm);font-weight:500;cursor:pointer;transition:all var(--duration-fast) ease;min-height:36px}.package-epub-button.svelte-141k6tx:hover:not(:disabled){background-color:var(--color-button-primary-bg-hover);border-color:var(--color-button-primary-bg-hover)}.package-epub-button.svelte-141k6tx:disabled{opacity:.6;cursor:not-allowed}.package-epub-button.svelte-141k6tx:focus-visible{outline:none;border-color:var(--color-button-primary-bg);box-shadow:inset 0 0 0 2px var(--color-focus-ring)}</style>
  <script>window.__EDITME_I18N_BUNDLE__ = 'data:application/zip;base64,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';</script></head>
  <body>
    <div id="app"></div>
  </body>
</html>
